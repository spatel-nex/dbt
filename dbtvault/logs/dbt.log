

============================== 2023-02-17 08:48:00.240065 | 04d44e28-e41a-4a70-902f-e9b9334ee2d8 ==============================
08:48:00.240070 [info ] [MainThread]: Running with dbt=1.1.1
08:48:00.240279 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
08:48:00.240347 [debug] [MainThread]: Tracking: tracking
08:48:00.255786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd28e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe9ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600d1c0>]}
08:48:00.256944 [debug] [MainThread]: Set downloads directory='/var/folders/ft/vyzwzhsj5pz7mw7_yvfwm3y80000gq/T/dbt-downloads-e46j4wog'
08:48:00.257256 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
08:48:00.388415 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
08:48:00.388671 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
08:48:00.452322 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
08:48:00.456391 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
08:48:00.523563 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
08:48:00.570901 [info ] [MainThread]: Installing Datavault-UK/dbtvault
08:48:00.924061 [info ] [MainThread]:   Installed from version 0.8.3
08:48:00.924288 [info ] [MainThread]:   Updated version available: 0.9.4
08:48:00.924494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '04d44e28-e41a-4a70-902f-e9b9334ee2d8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff3070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600dfd0>]}
08:48:00.924659 [info ] [MainThread]: Installing dbt-labs/dbt_utils
08:48:01.293702 [info ] [MainThread]:   Installed from version 0.8.6
08:48:01.293907 [info ] [MainThread]:   Updated version available: 1.0.0
08:48:01.294083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '04d44e28-e41a-4a70-902f-e9b9334ee2d8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f8430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f85e0>]}
08:48:01.294210 [info ] [MainThread]: 
08:48:01.294314 [info ] [MainThread]: Updates available for packages: ['Datavault-UK/dbtvault', 'dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
08:48:01.296538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106028850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff3040>]}


============================== 2023-02-17 08:48:39.147198 | 3be0a532-fcd6-4b30-829e-4dcc954e14bd ==============================
08:48:39.147203 [info ] [MainThread]: Running with dbt=1.1.1
08:48:39.147395 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
08:48:39.147472 [debug] [MainThread]: Tracking: tracking
08:48:39.159347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036ae880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036c5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036e91c0>]}
08:48:39.160807 [debug] [MainThread]: Set downloads directory='/var/folders/ft/vyzwzhsj5pz7mw7_yvfwm3y80000gq/T/dbt-downloads-n43rdcx2'
08:48:39.161153 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
08:48:39.255783 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
08:48:39.256035 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
08:48:39.346147 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
08:48:39.350380 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
08:48:39.419570 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
08:48:39.466307 [info ] [MainThread]: Installing Datavault-UK/dbtvault
08:48:40.076881 [info ] [MainThread]:   Installed from version 0.9.4
08:48:40.077103 [info ] [MainThread]:   Up to date!
08:48:40.077298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3be0a532-fcd6-4b30-829e-4dcc954e14bd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036cfb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036e9a00>]}
08:48:40.077447 [info ] [MainThread]: Installing dbt-labs/dbt_utils
08:48:40.483310 [info ] [MainThread]:   Installed from version 1.0.0
08:48:40.483503 [info ] [MainThread]:   Up to date!
08:48:40.483651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3be0a532-fcd6-4b30-829e-4dcc954e14bd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037d3b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037d39d0>]}
08:48:40.485849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103704460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036cfcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036e97c0>]}


============================== 2023-02-17 09:55:19.971679 | f0ec0d65-6dcd-4e3b-91aa-f7cdec0a58c7 ==============================
09:55:19.971683 [info ] [MainThread]: Running with dbt=1.1.1
09:55:19.972860 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
09:55:19.972945 [debug] [MainThread]: Tracking: tracking
09:55:19.983611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760f7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075fd400>]}
09:55:20.000913 [debug] [MainThread]: Executing "git --help"
09:55:20.110781 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
09:55:20.111184 [debug] [MainThread]: STDERR: "b''"
09:55:20.111542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760f610>]}


============================== 2023-02-17 10:00:27.384150 | fbfe0dc0-4955-4d8d-b488-821d90abd9f7 ==============================
10:00:27.384154 [info ] [MainThread]: Running with dbt=1.1.1
10:00:27.384345 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
10:00:27.384415 [debug] [MainThread]: Tracking: tracking
10:00:27.397968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037aebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037ae790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10379e6d0>]}
10:00:27.416248 [debug] [MainThread]: Executing "git --help"
10:00:27.422416 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
10:00:27.422772 [debug] [MainThread]: STDERR: "b''"
10:00:27.423104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037aea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037ae5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037ae580>]}


============================== 2023-02-17 10:00:52.016728 | 024ec6e3-ee61-4a9a-b473-acceadf28883 ==============================
10:00:52.016732 [info ] [MainThread]: Running with dbt=1.1.1
10:00:52.016920 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
10:00:52.016988 [debug] [MainThread]: Tracking: tracking
10:00:52.030455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107722c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107722d60>]}
10:00:55.410314 [debug] [MainThread]: Executing "git --help"
10:00:55.416610 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
10:00:55.416884 [debug] [MainThread]: STDERR: "b''"
10:00:55.436297 [debug] [MainThread]: Acquiring new snowflake connection "debug"
10:00:55.437494 [debug] [MainThread]: Using snowflake connection "debug"
10:00:55.437604 [debug] [MainThread]: On debug: select 1 as id
10:00:55.437703 [debug] [MainThread]: Opening a new connection, currently in state init
10:00:57.407121 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.97 seconds
10:00:57.409741 [debug] [MainThread]: On debug: Close
10:00:57.550702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108da3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a691c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a69340>]}
10:00:57.947882 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-02-17 10:01:04.736085 | 428a1c02-d928-48ae-b948-5545c638dd09 ==============================
10:01:04.736099 [info ] [MainThread]: Running with dbt=1.1.1
10:01:04.736384 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
10:01:04.736460 [debug] [MainThread]: Tracking: tracking
10:01:04.736810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108000880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080008e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108000940>]}
10:01:04.748870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108019580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080190d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108019880>]}


============================== 2023-02-17 10:01:48.474765 | b9b0e359-c945-42f5-9365-52405c880858 ==============================
10:01:48.474780 [info ] [MainThread]: Running with dbt=1.1.1
10:01:48.475105 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
10:01:48.475196 [debug] [MainThread]: Tracking: tracking
10:01:48.475426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec80a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec8160>]}
10:01:48.493681 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
10:01:48.493858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9b0e359-c945-42f5-9365-52405c880858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec8e50>]}
10:01:48.527425 [debug] [MainThread]: Parsing macros/catalog.sql
10:01:48.528789 [debug] [MainThread]: Parsing macros/adapters.sql
10:01:48.551181 [debug] [MainThread]: Parsing macros/materializations/merge.sql
10:01:48.553104 [debug] [MainThread]: Parsing macros/materializations/seed.sql
10:01:48.555810 [debug] [MainThread]: Parsing macros/materializations/view.sql
10:01:48.556437 [debug] [MainThread]: Parsing macros/materializations/table.sql
10:01:48.557963 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
10:01:48.562367 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
10:01:48.562837 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
10:01:48.564708 [debug] [MainThread]: Parsing macros/materializations/configs.sql
10:01:48.565798 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
10:01:48.566590 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
10:01:48.575107 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
10:01:48.582398 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
10:01:48.588394 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
10:01:48.590621 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
10:01:48.591462 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
10:01:48.592311 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
10:01:48.594440 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
10:01:48.603854 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
10:01:48.604576 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
10:01:48.609818 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
10:01:48.618395 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
10:01:48.622513 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
10:01:48.623838 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
10:01:48.627680 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
10:01:48.628273 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
10:01:48.629575 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
10:01:48.630624 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
10:01:48.633769 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
10:01:48.642751 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
10:01:48.643437 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
10:01:48.644602 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
10:01:48.645354 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
10:01:48.645777 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
10:01:48.646145 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
10:01:48.646467 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
10:01:48.647367 [debug] [MainThread]: Parsing macros/etc/statement.sql
10:01:48.649520 [debug] [MainThread]: Parsing macros/etc/datetime.sql
10:01:48.653833 [debug] [MainThread]: Parsing macros/adapters/schema.sql
10:01:48.654829 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
10:01:48.656072 [debug] [MainThread]: Parsing macros/adapters/relation.sql
10:01:48.660793 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
10:01:48.662168 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
10:01:48.664293 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
10:01:48.667912 [debug] [MainThread]: Parsing macros/adapters/columns.sql
10:01:48.672763 [debug] [MainThread]: Parsing tests/generic/builtin.sql
10:01:48.674171 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
10:01:48.675099 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
10:01:48.676348 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
10:01:48.677063 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
10:01:48.679371 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
10:01:48.681456 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
10:01:48.682539 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
10:01:48.684234 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
10:01:48.685277 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
10:01:48.686467 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
10:01:48.687506 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
10:01:48.688516 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
10:01:48.689893 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
10:01:48.690865 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
10:01:48.691772 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
10:01:48.693362 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
10:01:48.695329 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
10:01:48.697064 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
10:01:48.697960 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
10:01:48.703227 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
10:01:48.703725 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
10:01:48.704242 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
10:01:48.704783 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
10:01:48.705277 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
10:01:48.705980 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
10:01:48.706914 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
10:01:48.709007 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
10:01:48.709746 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
10:01:48.711424 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
10:01:48.713547 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
10:01:48.715225 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
10:01:48.715996 [debug] [MainThread]: Parsing macros/sql/star.sql
10:01:48.718978 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
10:01:48.722179 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
10:01:48.722669 [debug] [MainThread]: Parsing macros/sql/union.sql
10:01:48.729880 [debug] [MainThread]: Parsing macros/sql/groupby.sql
10:01:48.730504 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
10:01:48.732292 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
10:01:48.732988 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
10:01:48.734011 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
10:01:48.734778 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
10:01:48.738397 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
10:01:48.741256 [debug] [MainThread]: Parsing macros/sql/pivot.sql
10:01:48.743332 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
10:01:48.744636 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
10:01:48.747377 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
10:01:48.748459 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
10:01:48.749720 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
10:01:48.750464 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
10:01:48.751913 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
10:01:48.754893 [debug] [MainThread]: Parsing macros/tables/databricks/sat.sql
10:01:48.755441 [debug] [MainThread]: Parsing macros/tables/databricks/hub.sql
10:01:48.755889 [debug] [MainThread]: Parsing macros/tables/databricks/link.sql
10:01:48.756338 [debug] [MainThread]: Parsing macros/tables/bigquery/xts.sql
10:01:48.756786 [debug] [MainThread]: Parsing macros/tables/bigquery/pit.sql
10:01:48.771022 [debug] [MainThread]: Parsing macros/tables/bigquery/ma_sat.sql
10:01:48.777950 [debug] [MainThread]: Parsing macros/tables/bigquery/t_link.sql
10:01:48.778465 [debug] [MainThread]: Parsing macros/tables/bigquery/sat.sql
10:01:48.778992 [debug] [MainThread]: Parsing macros/tables/bigquery/hub.sql
10:01:48.784014 [debug] [MainThread]: Parsing macros/tables/bigquery/eff_sat.sql
10:01:48.791527 [debug] [MainThread]: Parsing macros/tables/bigquery/link.sql
10:01:48.797247 [debug] [MainThread]: Parsing macros/tables/bigquery/bridge.sql
10:01:48.797771 [debug] [MainThread]: Parsing macros/tables/snowflake/xts.sql
10:01:48.805991 [debug] [MainThread]: Parsing macros/tables/snowflake/pit.sql
10:01:48.821378 [debug] [MainThread]: Parsing macros/tables/snowflake/ma_sat.sql
10:01:48.828503 [debug] [MainThread]: Parsing macros/tables/snowflake/t_link.sql
10:01:48.831627 [debug] [MainThread]: Parsing macros/tables/snowflake/sat.sql
10:01:48.839293 [debug] [MainThread]: Parsing macros/tables/snowflake/hub.sql
10:01:48.846176 [debug] [MainThread]: Parsing macros/tables/snowflake/eff_sat.sql
10:01:48.855196 [debug] [MainThread]: Parsing macros/tables/snowflake/link.sql
10:01:48.862854 [debug] [MainThread]: Parsing macros/tables/snowflake/bridge.sql
10:01:48.868161 [debug] [MainThread]: Parsing macros/tables/postgres/sat.sql
10:01:48.873483 [debug] [MainThread]: Parsing macros/tables/postgres/hub.sql
10:01:48.878031 [debug] [MainThread]: Parsing macros/tables/postgres/link.sql
10:01:48.884337 [debug] [MainThread]: Parsing macros/tables/sqlserver/xts.sql
10:01:48.884804 [debug] [MainThread]: Parsing macros/tables/sqlserver/pit.sql
10:01:48.885314 [debug] [MainThread]: Parsing macros/tables/sqlserver/ma_sat.sql
10:01:48.891973 [debug] [MainThread]: Parsing macros/tables/sqlserver/t_link.sql
10:01:48.892492 [debug] [MainThread]: Parsing macros/tables/sqlserver/sat.sql
10:01:48.893001 [debug] [MainThread]: Parsing macros/tables/sqlserver/hub.sql
10:01:48.898907 [debug] [MainThread]: Parsing macros/tables/sqlserver/eff_sat.sql
10:01:48.906232 [debug] [MainThread]: Parsing macros/tables/sqlserver/link.sql
10:01:48.912101 [debug] [MainThread]: Parsing macros/tables/sqlserver/bridge.sql
10:01:48.912615 [debug] [MainThread]: Parsing macros/staging/hash_columns.sql
10:01:48.914795 [debug] [MainThread]: Parsing macros/staging/source_columns.sql
10:01:48.915383 [debug] [MainThread]: Parsing macros/staging/stage.sql
10:01:48.922819 [debug] [MainThread]: Parsing macros/staging/rank_columns.sql
10:01:48.928087 [debug] [MainThread]: Parsing macros/staging/null_columns.sql
10:01:48.934031 [debug] [MainThread]: Parsing macros/staging/derive_columns.sql
10:01:48.940465 [debug] [MainThread]: Parsing macros/internal/metadata_processing/as_constant.sql
10:01:48.941487 [debug] [MainThread]: Parsing macros/internal/metadata_processing/escape_column_names.sql
10:01:48.946367 [debug] [MainThread]: Parsing macros/internal/metadata_processing/alias.sql
10:01:48.948172 [debug] [MainThread]: Parsing macros/internal/metadata_processing/concat_ws.sql
10:01:48.949342 [debug] [MainThread]: Parsing macros/internal/metadata_processing/multikey.sql
10:01:48.952019 [debug] [MainThread]: Parsing macros/internal/metadata_processing/get_escape_characters.sql
10:01:48.953421 [debug] [MainThread]: Parsing macros/internal/metadata_processing/expand_column_list.sql
10:01:48.954932 [debug] [MainThread]: Parsing macros/internal/metadata_processing/process_payload_column_excludes.sql
10:01:48.957149 [debug] [MainThread]: Parsing macros/internal/metadata_processing/check_required_parameters.sql
10:01:48.957930 [debug] [MainThread]: Parsing macros/internal/metadata_processing/escape_column_name.sql
10:01:48.958848 [debug] [MainThread]: Parsing macros/internal/metadata_processing/alias_all.sql
10:01:48.960805 [debug] [MainThread]: Parsing macros/internal/helpers/prepend_generated_by.sql
10:01:48.960974 [debug] [MainThread]: Parsing macros/internal/helpers/is_checks.sql
10:01:48.963435 [debug] [MainThread]: Parsing macros/internal/helpers/dateadd.sql
10:01:48.964310 [debug] [MainThread]: Parsing macros/internal/helpers/stage_processing_macros/extract_null_column_names.sql
10:01:48.965690 [debug] [MainThread]: Parsing macros/internal/helpers/stage_processing_macros/print_list.sql
10:01:48.966433 [debug] [MainThread]: Parsing macros/internal/helpers/stage_processing_macros/process_columns_to_escape.sql
10:01:48.968745 [debug] [MainThread]: Parsing macros/internal/helpers/stage_processing_macros/process_columns_to_select.sql
10:01:48.969950 [debug] [MainThread]: Parsing macros/internal/helpers/stage_processing_macros/process_hash_column_excludes.sql
10:01:48.971954 [debug] [MainThread]: Parsing macros/internal/helpers/stage_processing_macros/extract_column_names.sql
10:01:48.972575 [debug] [MainThread]: Parsing macros/internal/helpers/logging/log_relation_sources.sql
10:01:48.973916 [debug] [MainThread]: Parsing macros/materialisations/drop_temporary.sql
10:01:48.974536 [debug] [MainThread]: Parsing macros/materialisations/vault_insert_by_rank_materialization.sql
10:01:48.984076 [debug] [MainThread]: Parsing macros/materialisations/incremental_bridge_materialization.sql
10:01:48.986833 [debug] [MainThread]: Parsing macros/materialisations/shared_helpers.sql
10:01:48.987351 [debug] [MainThread]: Parsing macros/materialisations/vault_insert_by_period_materialization.sql
10:01:49.005129 [debug] [MainThread]: Parsing macros/materialisations/incremental_pit_bridge_replace.sql
10:01:49.006326 [debug] [MainThread]: Parsing macros/materialisations/incremental_pit_materialization.sql
10:01:49.009071 [debug] [MainThread]: Parsing macros/materialisations/mat_is_checks.sql
10:01:49.012370 [debug] [MainThread]: Parsing macros/materialisations/rank_mat_helpers/get_min_max_ranks.sql
10:01:49.014207 [debug] [MainThread]: Parsing macros/materialisations/rank_mat_helpers/replace_placeholder_with_rank_filter.sql
10:01:49.016148 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/replace_placeholder_with_period_filter.sql
10:01:49.021351 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_period_boundaries.sql
10:01:49.031795 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_start_stop_dates.sql
10:01:49.034202 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_period_filter_sql.sql
10:01:49.038554 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_period_of_load.sql
10:01:49.042060 [debug] [MainThread]: Parsing macros/supporting/as_of_date_window.sql
10:01:49.045294 [debug] [MainThread]: Parsing macros/supporting/max_datetime.sql
10:01:49.046158 [debug] [MainThread]: Parsing macros/supporting/hash.sql
10:01:49.052460 [debug] [MainThread]: Parsing macros/supporting/bridge_shared.sql
10:01:49.057664 [debug] [MainThread]: Parsing macros/supporting/prefix.sql
10:01:49.062502 [debug] [MainThread]: Parsing macros/supporting/get_query_results_as_dict.sql
10:01:49.063371 [debug] [MainThread]: Parsing macros/supporting/data_types/type_timestamp.sql
10:01:49.063842 [debug] [MainThread]: Parsing macros/supporting/data_types/type_binary.sql
10:01:49.064820 [debug] [MainThread]: Parsing macros/supporting/data_types/type_string.sql
10:01:49.066083 [debug] [MainThread]: Parsing macros/supporting/ghost_records/create_ghost_record.sql
10:01:49.071118 [debug] [MainThread]: Parsing macros/supporting/ghost_records/binary_ghost.sql
10:01:49.072928 [debug] [MainThread]: Parsing macros/supporting/ghost_records/null_ghost.sql
10:01:49.073959 [debug] [MainThread]: Parsing macros/supporting/hash_components/standard_column_wrapper.sql
10:01:49.077257 [debug] [MainThread]: Parsing macros/supporting/hash_components/null_expression.sql
10:01:49.079249 [debug] [MainThread]: Parsing macros/supporting/hash_components/select_hash_alg.sql
10:01:49.082869 [debug] [MainThread]: Parsing macros/supporting/casting/cast_binary.sql
10:01:49.084703 [debug] [MainThread]: Parsing macros/supporting/casting/cast_datetime.sql
10:01:49.088063 [debug] [MainThread]: Parsing macros/supporting/casting/cast_date.sql
10:01:49.457427 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_customer_order.sql
10:01:49.504977 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
10:01:49.505576 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_customer_nation.sql
10:01:49.511209 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
10:01:49.511884 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_inventory.sql
10:01:49.517795 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
10:01:49.518332 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_nation_region.sql
10:01:49.525980 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
10:01:49.526511 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
10:01:49.532696 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
10:01:49.533234 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_lineitem.sql
10:01:49.539135 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
10:01:49.539671 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_supplier_nation.sql
10:01:49.545199 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
10:01:49.545879 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_order.sql
10:01:49.559868 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
10:01:49.560427 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_nation.sql
10:01:49.567225 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
10:01:49.567757 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_part.sql
10:01:49.575226 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
10:01:49.575773 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
10:01:49.581161 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
10:01:49.581696 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_customer.sql
10:01:49.586511 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
10:01:49.587051 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_supplier.sql
10:01:49.594372 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
10:01:49.594909 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_region.sql
10:01:49.601769 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
10:01:49.602322 [debug] [MainThread]: 1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
10:01:49.613890 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
10:01:49.614437 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
10:01:49.642777 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
10:01:49.643341 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
10:01:49.655499 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
10:01:49.656042 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
10:01:49.678090 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
10:01:49.678640 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
10:01:49.692096 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
10:01:49.693034 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
10:01:49.701478 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
10:01:49.702029 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
10:01:49.710551 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
10:01:49.711097 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
10:01:49.721174 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
10:01:49.721725 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
10:01:49.736656 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
10:01:49.737209 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
10:01:49.746142 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
10:01:49.746688 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
10:01:49.762978 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
10:01:49.764429 [debug] [MainThread]: 1603: static parser failed on raw_stage/raw_transactions.sql
10:01:49.766718 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
10:01:49.767452 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage/raw_inventory.sql
10:01:49.768740 [debug] [MainThread]: 1603: static parser failed on raw_stage/raw_orders.sql
10:01:49.772277 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
10:01:49.772854 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_orders.sql
10:01:49.903866 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
10:01:49.904465 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_inventory.sql
10:01:49.947704 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
10:01:49.948243 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_transactions.sql
10:01:49.959198 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
10:01:50.017048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9b0e359-c945-42f5-9365-52405c880858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b39160>]}
10:01:50.024891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9b0e359-c945-42f5-9365-52405c880858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a81730>]}
10:01:50.025034 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 507 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
10:01:50.025153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b0e359-c945-42f5-9365-52405c880858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f18070>]}
10:01:50.026276 [info ] [MainThread]: 
10:01:50.026479 [debug] [MainThread]: Acquiring new snowflake connection "master"
10:01:50.027548 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SNOWFLAKE_SAMPLE_DATA"
10:01:50.034653 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_SAMPLE_DATA"
10:01:50.034782 [debug] [ThreadPool]: On list_SNOWFLAKE_SAMPLE_DATA: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_SNOWFLAKE_SAMPLE_DATA"} */

    show terse schemas in database SNOWFLAKE_SAMPLE_DATA
    limit 10000
10:01:50.034849 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:01:50.950893 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.92 seconds
10:01:50.955982 [debug] [ThreadPool]: On list_SNOWFLAKE_SAMPLE_DATA: Close
10:01:51.084707 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF10"
10:01:51.091902 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF10"
10:01:51.092058 [debug] [ThreadPool]: On list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF10: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF10"} */

    show terse objects in SNOWFLAKE_SAMPLE_DATA.TPCH_SF10
10:01:51.092169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:01:51.955985 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.86 seconds
10:01:51.962168 [debug] [ThreadPool]: On list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF10: Close
10:01:52.076942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b0e359-c945-42f5-9365-52405c880858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b2d610>]}
10:01:52.077732 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
10:01:52.078116 [info ] [MainThread]: 
10:01:52.084268 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.raw_orders
10:01:52.084490 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_transactions
10:01:52.085216 [info ] [Thread-2  ]: 2 of 31 START view model TPCH_SF10.raw_transactions ............................ [RUN]
10:01:52.085519 [info ] [Thread-1  ]: 1 of 31 START view model TPCH_SF10.raw_orders .................................. [RUN]
10:01:52.086064 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
10:01:52.086501 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
10:01:52.086665 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_transactions
10:01:52.086819 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.raw_orders
10:01:52.086983 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.raw_transactions
10:01:52.087112 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.raw_orders
10:01:52.091341 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
10:01:52.096297 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
10:01:52.096966 [debug] [Thread-1  ]: finished collecting timing info
10:01:52.097081 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.raw_orders
10:01:52.103477 [debug] [Thread-2  ]: finished collecting timing info
10:01:52.113399 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
10:01:52.113612 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_transactions
10:01:52.115780 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
10:01:52.118342 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
10:01:52.119121 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
10:01:52.119205 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */

  create or replace  view SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.raw_orders
  
   as (
    SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
10:01:52.119354 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */

  create or replace  view SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.raw_transactions
  
   as (
    SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS  AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
10:01:52.119489 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:01:52.119594 [debug] [Thread-2  ]: Opening a new connection, currently in state init
10:01:52.599528 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01aa6379-0000-461c-0000-f0ad0001707e
10:01:52.599901 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 003540 (42501): SQL execution error: Creating view on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
10:01:52.600305 [debug] [Thread-2  ]: finished collecting timing info
10:01:52.600541 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: Close
10:01:52.724894 [debug] [Thread-2  ]: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  003540 (42501): SQL execution error: Creating view on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_stage/raw_transactions.sql
10:01:52.725358 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b0e359-c945-42f5-9365-52405c880858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd5a30>]}
10:01:52.725768 [error] [Thread-2  ]: 2 of 31 ERROR creating view model TPCH_SF10.raw_transactions ................... [[31mERROR[0m in 0.64s]
10:01:52.726211 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_transactions
10:01:52.726775 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.v_stg_transactions
10:01:52.727042 [info ] [Thread-4  ]: 3 of 31 SKIP relation TPCH_SF10.v_stg_transactions ............................. [[33mSKIP[0m]
10:01:52.727425 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
10:01:52.727793 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.t_link_transactions
10:01:52.728033 [info ] [Thread-2  ]: 4 of 31 SKIP relation TPCH_SF10.t_link_transactions ............................ [[33mSKIP[0m]
10:01:52.728403 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.t_link_transactions
10:01:52.879250 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01aa6379-0000-4613-0000-f0ad0001a05e
10:01:52.879695 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 003540 (42501): SQL execution error: Creating view on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
10:01:52.880071 [debug] [Thread-1  ]: finished collecting timing info
10:01:52.880295 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: Close
10:01:52.997041 [debug] [Thread-1  ]: Database Error in model raw_orders (models/raw_stage/raw_orders.sql)
  003540 (42501): SQL execution error: Creating view on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_stage/raw_orders.sql
10:01:52.997527 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b0e359-c945-42f5-9365-52405c880858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd85b0>]}
10:01:52.998073 [error] [Thread-1  ]: 1 of 31 ERROR creating view model TPCH_SF10.raw_orders ......................... [[31mERROR[0m in 0.91s]
10:01:52.998636 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.raw_orders
10:01:52.999604 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.raw_inventory
10:01:53.000037 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.v_stg_orders
10:01:53.000240 [info ] [Thread-4  ]: 5 of 31 SKIP relation TPCH_SF10.raw_inventory .................................. [[33mSKIP[0m]
10:01:53.000451 [info ] [Thread-3  ]: 6 of 31 SKIP relation TPCH_SF10.v_stg_orders ................................... [[33mSKIP[0m]
10:01:53.000849 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.raw_inventory
10:01:53.001375 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_orders
10:01:53.002361 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.v_stg_inventory
10:01:53.002682 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
10:01:53.002856 [info ] [Thread-1  ]: 7 of 31 SKIP relation TPCH_SF10.v_stg_inventory ................................ [[33mSKIP[0m]
10:01:53.003023 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
10:01:53.003182 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_order
10:01:53.003359 [info ] [Thread-2  ]: 8 of 31 SKIP relation TPCH_SF10.hub_customer ................................... [[33mSKIP[0m]
10:01:53.003771 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
10:01:53.003933 [info ] [Thread-4  ]: 9 of 31 SKIP relation TPCH_SF10.hub_lineitem ................................... [[33mSKIP[0m]
10:01:53.004095 [info ] [Thread-3  ]: 10 of 31 SKIP relation TPCH_SF10.hub_order ..................................... [[33mSKIP[0m]
10:01:53.004434 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
10:01:53.004623 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_customer_nation
10:01:53.005149 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
10:01:53.005839 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
10:01:53.006140 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_customer_order
10:01:53.006397 [info ] [Thread-1  ]: 11 of 31 SKIP relation TPCH_SF10.link_customer_nation .......................... [[33mSKIP[0m]
10:01:53.006573 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
10:01:53.006769 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_order_lineitem
10:01:53.006914 [info ] [Thread-2  ]: 12 of 31 SKIP relation TPCH_SF10.link_customer_order ........................... [[33mSKIP[0m]
10:01:53.007363 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_nation
10:01:53.007538 [info ] [Thread-4  ]: 13 of 31 SKIP relation TPCH_SF10.link_inventory_allocation ..................... [[33mSKIP[0m]
10:01:53.007791 [info ] [Thread-3  ]: 14 of 31 SKIP relation TPCH_SF10.link_order_lineitem ........................... [[33mSKIP[0m]
10:01:53.008230 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_order
10:01:53.008412 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
10:01:53.008723 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
10:01:53.009298 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
10:01:53.009572 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
10:01:53.009772 [info ] [Thread-1  ]: 15 of 31 SKIP relation TPCH_SF10.sat_order_cust_nation_details ................. [[33mSKIP[0m]
10:01:53.010012 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
10:01:53.010262 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
10:01:53.010456 [info ] [Thread-2  ]: 16 of 31 SKIP relation TPCH_SF10.sat_order_cust_region_details ................. [[33mSKIP[0m]
10:01:53.010901 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
10:01:53.011112 [info ] [Thread-4  ]: 17 of 31 SKIP relation TPCH_SF10.sat_order_customer_details .................... [[33mSKIP[0m]
10:01:53.011273 [info ] [Thread-3  ]: 18 of 31 SKIP relation TPCH_SF10.sat_order_lineitem_details .................... [[33mSKIP[0m]
10:01:53.011567 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
10:01:53.011723 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_order_details
10:01:53.012103 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
10:01:53.012438 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
10:01:53.012579 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
10:01:53.012745 [info ] [Thread-1  ]: 19 of 31 SKIP relation TPCH_SF10.sat_order_order_details ....................... [[33mSKIP[0m]
10:01:53.012885 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_part
10:01:53.013051 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_region
10:01:53.013200 [info ] [Thread-2  ]: 20 of 31 SKIP relation TPCH_SF10.hub_nation .................................... [[33mSKIP[0m]
10:01:53.013452 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
10:01:53.013569 [info ] [Thread-4  ]: 21 of 31 SKIP relation TPCH_SF10.hub_part ...................................... [[33mSKIP[0m]
10:01:53.013703 [info ] [Thread-3  ]: 22 of 31 SKIP relation TPCH_SF10.hub_region .................................... [[33mSKIP[0m]
10:01:53.014408 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
10:01:53.014651 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
10:01:53.015019 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
10:01:53.015296 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
10:01:53.015413 [info ] [Thread-1  ]: 23 of 31 SKIP relation TPCH_SF10.hub_supplier .................................. [[33mSKIP[0m]
10:01:53.015562 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_inventory
10:01:53.015769 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_nation_region
10:01:53.015940 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_supplier_nation
10:01:53.016240 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
10:01:53.016362 [info ] [Thread-2  ]: 24 of 31 SKIP relation TPCH_SF10.link_inventory ................................ [[33mSKIP[0m]
10:01:53.016483 [info ] [Thread-4  ]: 25 of 31 SKIP relation TPCH_SF10.link_nation_region ............................ [[33mSKIP[0m]
10:01:53.016595 [info ] [Thread-3  ]: 26 of 31 SKIP relation TPCH_SF10.link_supplier_nation .......................... [[33mSKIP[0m]
10:01:53.016720 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
10:01:53.016944 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory
10:01:53.017398 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_nation_region
10:01:53.017534 [info ] [Thread-1  ]: 27 of 31 SKIP relation TPCH_SF10.sat_inv_inventory_details ..................... [[33mSKIP[0m]
10:01:53.017675 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
10:01:53.017804 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
10:01:53.018010 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
10:01:53.018376 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
10:01:53.018507 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
10:01:53.018642 [info ] [Thread-2  ]: 28 of 31 SKIP relation TPCH_SF10.sat_inv_part_details .......................... [[33mSKIP[0m]
10:01:53.018754 [info ] [Thread-4  ]: 29 of 31 SKIP relation TPCH_SF10.sat_inv_supp_nation_details ................... [[33mSKIP[0m]
10:01:53.018870 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
10:01:53.018998 [info ] [Thread-3  ]: 30 of 31 SKIP relation TPCH_SF10.sat_inv_supp_region_details ................... [[33mSKIP[0m]
10:01:53.019227 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
10:01:53.019452 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
10:01:53.019550 [info ] [Thread-1  ]: 31 of 31 SKIP relation TPCH_SF10.sat_inv_supplier_details ...................... [[33mSKIP[0m]
10:01:53.019753 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
10:01:53.020131 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
10:01:53.021062 [debug] [MainThread]: Acquiring new snowflake connection "master"
10:01:53.021388 [info ] [MainThread]: 
10:01:53.021565 [info ] [MainThread]: Finished running 6 view models, 25 incremental models in 2.99s.
10:01:53.021718 [debug] [MainThread]: Connection 'master' was properly closed.
10:01:53.021813 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.raw_orders' was properly closed.
10:01:53.021901 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.raw_transactions' was properly closed.
10:01:53.031834 [info ] [MainThread]: 
10:01:53.032091 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
10:01:53.032286 [info ] [MainThread]: 
10:01:53.032439 [error] [MainThread]: [33mDatabase Error in model raw_transactions (models/raw_stage/raw_transactions.sql)[0m
10:01:53.032585 [error] [MainThread]:   003540 (42501): SQL execution error: Creating view on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
10:01:53.032726 [error] [MainThread]:   compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_stage/raw_transactions.sql
10:01:53.032855 [info ] [MainThread]: 
10:01:53.032986 [error] [MainThread]: [33mDatabase Error in model raw_orders (models/raw_stage/raw_orders.sql)[0m
10:01:53.033133 [error] [MainThread]:   003540 (42501): SQL execution error: Creating view on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
10:01:53.033317 [error] [MainThread]:   compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_stage/raw_orders.sql
10:01:53.033479 [info ] [MainThread]: 
10:01:53.033636 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=29 TOTAL=31
10:01:53.033957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f274c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f34670>]}


============================== 2023-02-17 10:09:50.359431 | 423326f5-1243-4cce-ba3f-1b37e183e6b7 ==============================
10:09:50.359458 [info ] [MainThread]: Running with dbt=1.1.1
10:09:50.359800 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
10:09:50.359875 [debug] [MainThread]: Tracking: tracking
10:09:50.360158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10432f1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10432f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10432f280>]}
10:09:50.385732 [info ] [MainThread]: Unable to do partial parsing because profile has changed
10:09:50.385960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042be5e0>]}
10:09:50.410000 [debug] [MainThread]: Parsing macros/catalog.sql
10:09:50.411336 [debug] [MainThread]: Parsing macros/adapters.sql
10:09:50.433421 [debug] [MainThread]: Parsing macros/materializations/merge.sql
10:09:50.435334 [debug] [MainThread]: Parsing macros/materializations/seed.sql
10:09:50.438009 [debug] [MainThread]: Parsing macros/materializations/view.sql
10:09:50.438634 [debug] [MainThread]: Parsing macros/materializations/table.sql
10:09:50.440148 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
10:09:50.444415 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
10:09:50.444857 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
10:09:50.446704 [debug] [MainThread]: Parsing macros/materializations/configs.sql
10:09:50.447785 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
10:09:50.448575 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
10:09:50.457088 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
10:09:50.464300 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
10:09:50.470368 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
10:09:50.472611 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
10:09:50.473455 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
10:09:50.474299 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
10:09:50.476425 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
10:09:50.485804 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
10:09:50.486523 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
10:09:50.491776 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
10:09:50.500289 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
10:09:50.504374 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
10:09:50.505713 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
10:09:50.509546 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
10:09:50.510132 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
10:09:50.511434 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
10:09:50.512484 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
10:09:50.515628 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
10:09:50.524634 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
10:09:50.525322 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
10:09:50.526478 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
10:09:50.527202 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
10:09:50.527616 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
10:09:50.527984 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
10:09:50.528297 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
10:09:50.529011 [debug] [MainThread]: Parsing macros/etc/statement.sql
10:09:50.531171 [debug] [MainThread]: Parsing macros/etc/datetime.sql
10:09:50.535478 [debug] [MainThread]: Parsing macros/adapters/schema.sql
10:09:50.536483 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
10:09:50.537728 [debug] [MainThread]: Parsing macros/adapters/relation.sql
10:09:50.542439 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
10:09:50.543805 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
10:09:50.545903 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
10:09:50.549508 [debug] [MainThread]: Parsing macros/adapters/columns.sql
10:09:50.554359 [debug] [MainThread]: Parsing tests/generic/builtin.sql
10:09:50.555764 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
10:09:50.556691 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
10:09:50.557934 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
10:09:50.558650 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
10:09:50.560955 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
10:09:50.563035 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
10:09:50.564116 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
10:09:50.565820 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
10:09:50.566815 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
10:09:50.567996 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
10:09:50.569026 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
10:09:50.570041 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
10:09:50.571415 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
10:09:50.572380 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
10:09:50.573293 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
10:09:50.574879 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
10:09:50.576837 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
10:09:50.578554 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
10:09:50.579457 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
10:09:50.584716 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
10:09:50.585215 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
10:09:50.585728 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
10:09:50.586272 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
10:09:50.586770 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
10:09:50.587463 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
10:09:50.588395 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
10:09:50.590595 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
10:09:50.591336 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
10:09:50.593009 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
10:09:50.595118 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
10:09:50.596784 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
10:09:50.597586 [debug] [MainThread]: Parsing macros/sql/star.sql
10:09:50.600584 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
10:09:50.603768 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
10:09:50.604262 [debug] [MainThread]: Parsing macros/sql/union.sql
10:09:50.611450 [debug] [MainThread]: Parsing macros/sql/groupby.sql
10:09:50.612063 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
10:09:50.613846 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
10:09:50.614583 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
10:09:50.615622 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
10:09:50.616384 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
10:09:50.620012 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
10:09:50.622855 [debug] [MainThread]: Parsing macros/sql/pivot.sql
10:09:50.624930 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
10:09:50.626240 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
10:09:50.628993 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
10:09:50.630077 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
10:09:50.631300 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
10:09:50.632043 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
10:09:50.633477 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
10:09:50.636432 [debug] [MainThread]: Parsing macros/tables/databricks/sat.sql
10:09:50.636976 [debug] [MainThread]: Parsing macros/tables/databricks/hub.sql
10:09:50.637427 [debug] [MainThread]: Parsing macros/tables/databricks/link.sql
10:09:50.637880 [debug] [MainThread]: Parsing macros/tables/bigquery/xts.sql
10:09:50.638329 [debug] [MainThread]: Parsing macros/tables/bigquery/pit.sql
10:09:50.652535 [debug] [MainThread]: Parsing macros/tables/bigquery/ma_sat.sql
10:09:50.659342 [debug] [MainThread]: Parsing macros/tables/bigquery/t_link.sql
10:09:50.659863 [debug] [MainThread]: Parsing macros/tables/bigquery/sat.sql
10:09:50.660384 [debug] [MainThread]: Parsing macros/tables/bigquery/hub.sql
10:09:50.665428 [debug] [MainThread]: Parsing macros/tables/bigquery/eff_sat.sql
10:09:50.672955 [debug] [MainThread]: Parsing macros/tables/bigquery/link.sql
10:09:50.678666 [debug] [MainThread]: Parsing macros/tables/bigquery/bridge.sql
10:09:50.679191 [debug] [MainThread]: Parsing macros/tables/snowflake/xts.sql
10:09:50.687390 [debug] [MainThread]: Parsing macros/tables/snowflake/pit.sql
10:09:50.702651 [debug] [MainThread]: Parsing macros/tables/snowflake/ma_sat.sql
10:09:50.709961 [debug] [MainThread]: Parsing macros/tables/snowflake/t_link.sql
10:09:50.713157 [debug] [MainThread]: Parsing macros/tables/snowflake/sat.sql
10:09:50.720894 [debug] [MainThread]: Parsing macros/tables/snowflake/hub.sql
10:09:50.727783 [debug] [MainThread]: Parsing macros/tables/snowflake/eff_sat.sql
10:09:50.736859 [debug] [MainThread]: Parsing macros/tables/snowflake/link.sql
10:09:50.744520 [debug] [MainThread]: Parsing macros/tables/snowflake/bridge.sql
10:09:50.749849 [debug] [MainThread]: Parsing macros/tables/postgres/sat.sql
10:09:50.755156 [debug] [MainThread]: Parsing macros/tables/postgres/hub.sql
10:09:50.759706 [debug] [MainThread]: Parsing macros/tables/postgres/link.sql
10:09:50.765987 [debug] [MainThread]: Parsing macros/tables/sqlserver/xts.sql
10:09:50.766456 [debug] [MainThread]: Parsing macros/tables/sqlserver/pit.sql
10:09:50.766956 [debug] [MainThread]: Parsing macros/tables/sqlserver/ma_sat.sql
10:09:50.773609 [debug] [MainThread]: Parsing macros/tables/sqlserver/t_link.sql
10:09:50.774140 [debug] [MainThread]: Parsing macros/tables/sqlserver/sat.sql
10:09:50.774669 [debug] [MainThread]: Parsing macros/tables/sqlserver/hub.sql
10:09:50.780630 [debug] [MainThread]: Parsing macros/tables/sqlserver/eff_sat.sql
10:09:50.787974 [debug] [MainThread]: Parsing macros/tables/sqlserver/link.sql
10:09:50.793856 [debug] [MainThread]: Parsing macros/tables/sqlserver/bridge.sql
10:09:50.794374 [debug] [MainThread]: Parsing macros/staging/hash_columns.sql
10:09:50.796579 [debug] [MainThread]: Parsing macros/staging/source_columns.sql
10:09:50.797177 [debug] [MainThread]: Parsing macros/staging/stage.sql
10:09:50.804613 [debug] [MainThread]: Parsing macros/staging/rank_columns.sql
10:09:50.809889 [debug] [MainThread]: Parsing macros/staging/null_columns.sql
10:09:50.815816 [debug] [MainThread]: Parsing macros/staging/derive_columns.sql
10:09:50.822255 [debug] [MainThread]: Parsing macros/internal/metadata_processing/as_constant.sql
10:09:50.823277 [debug] [MainThread]: Parsing macros/internal/metadata_processing/escape_column_names.sql
10:09:50.828129 [debug] [MainThread]: Parsing macros/internal/metadata_processing/alias.sql
10:09:50.829938 [debug] [MainThread]: Parsing macros/internal/metadata_processing/concat_ws.sql
10:09:50.831166 [debug] [MainThread]: Parsing macros/internal/metadata_processing/multikey.sql
10:09:50.833842 [debug] [MainThread]: Parsing macros/internal/metadata_processing/get_escape_characters.sql
10:09:50.835258 [debug] [MainThread]: Parsing macros/internal/metadata_processing/expand_column_list.sql
10:09:50.836777 [debug] [MainThread]: Parsing macros/internal/metadata_processing/process_payload_column_excludes.sql
10:09:50.839008 [debug] [MainThread]: Parsing macros/internal/metadata_processing/check_required_parameters.sql
10:09:50.839788 [debug] [MainThread]: Parsing macros/internal/metadata_processing/escape_column_name.sql
10:09:50.840702 [debug] [MainThread]: Parsing macros/internal/metadata_processing/alias_all.sql
10:09:50.842658 [debug] [MainThread]: Parsing macros/internal/helpers/prepend_generated_by.sql
10:09:50.842830 [debug] [MainThread]: Parsing macros/internal/helpers/is_checks.sql
10:09:50.845289 [debug] [MainThread]: Parsing macros/internal/helpers/dateadd.sql
10:09:50.846172 [debug] [MainThread]: Parsing macros/internal/helpers/stage_processing_macros/extract_null_column_names.sql
10:09:50.847554 [debug] [MainThread]: Parsing macros/internal/helpers/stage_processing_macros/print_list.sql
10:09:50.848299 [debug] [MainThread]: Parsing macros/internal/helpers/stage_processing_macros/process_columns_to_escape.sql
10:09:50.850595 [debug] [MainThread]: Parsing macros/internal/helpers/stage_processing_macros/process_columns_to_select.sql
10:09:50.851796 [debug] [MainThread]: Parsing macros/internal/helpers/stage_processing_macros/process_hash_column_excludes.sql
10:09:50.853785 [debug] [MainThread]: Parsing macros/internal/helpers/stage_processing_macros/extract_column_names.sql
10:09:50.854401 [debug] [MainThread]: Parsing macros/internal/helpers/logging/log_relation_sources.sql
10:09:50.855765 [debug] [MainThread]: Parsing macros/materialisations/drop_temporary.sql
10:09:50.856386 [debug] [MainThread]: Parsing macros/materialisations/vault_insert_by_rank_materialization.sql
10:09:50.865927 [debug] [MainThread]: Parsing macros/materialisations/incremental_bridge_materialization.sql
10:09:50.868683 [debug] [MainThread]: Parsing macros/materialisations/shared_helpers.sql
10:09:50.869204 [debug] [MainThread]: Parsing macros/materialisations/vault_insert_by_period_materialization.sql
10:09:50.886964 [debug] [MainThread]: Parsing macros/materialisations/incremental_pit_bridge_replace.sql
10:09:50.888164 [debug] [MainThread]: Parsing macros/materialisations/incremental_pit_materialization.sql
10:09:50.890906 [debug] [MainThread]: Parsing macros/materialisations/mat_is_checks.sql
10:09:50.894160 [debug] [MainThread]: Parsing macros/materialisations/rank_mat_helpers/get_min_max_ranks.sql
10:09:50.895984 [debug] [MainThread]: Parsing macros/materialisations/rank_mat_helpers/replace_placeholder_with_rank_filter.sql
10:09:50.897916 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/replace_placeholder_with_period_filter.sql
10:09:50.903108 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_period_boundaries.sql
10:09:50.913543 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_start_stop_dates.sql
10:09:50.915949 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_period_filter_sql.sql
10:09:50.920252 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_period_of_load.sql
10:09:50.923732 [debug] [MainThread]: Parsing macros/supporting/as_of_date_window.sql
10:09:50.927006 [debug] [MainThread]: Parsing macros/supporting/max_datetime.sql
10:09:50.927871 [debug] [MainThread]: Parsing macros/supporting/hash.sql
10:09:50.934174 [debug] [MainThread]: Parsing macros/supporting/bridge_shared.sql
10:09:50.939309 [debug] [MainThread]: Parsing macros/supporting/prefix.sql
10:09:50.944032 [debug] [MainThread]: Parsing macros/supporting/get_query_results_as_dict.sql
10:09:50.944875 [debug] [MainThread]: Parsing macros/supporting/data_types/type_timestamp.sql
10:09:50.945341 [debug] [MainThread]: Parsing macros/supporting/data_types/type_binary.sql
10:09:50.946289 [debug] [MainThread]: Parsing macros/supporting/data_types/type_string.sql
10:09:50.947540 [debug] [MainThread]: Parsing macros/supporting/ghost_records/create_ghost_record.sql
10:09:50.952545 [debug] [MainThread]: Parsing macros/supporting/ghost_records/binary_ghost.sql
10:09:50.954332 [debug] [MainThread]: Parsing macros/supporting/ghost_records/null_ghost.sql
10:09:50.955352 [debug] [MainThread]: Parsing macros/supporting/hash_components/standard_column_wrapper.sql
10:09:50.958632 [debug] [MainThread]: Parsing macros/supporting/hash_components/null_expression.sql
10:09:50.960627 [debug] [MainThread]: Parsing macros/supporting/hash_components/select_hash_alg.sql
10:09:50.964250 [debug] [MainThread]: Parsing macros/supporting/casting/cast_binary.sql
10:09:50.966079 [debug] [MainThread]: Parsing macros/supporting/casting/cast_datetime.sql
10:09:50.969442 [debug] [MainThread]: Parsing macros/supporting/casting/cast_date.sql
10:09:51.337418 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_customer_order.sql
10:09:51.384194 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
10:09:51.384779 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_customer_nation.sql
10:09:51.390328 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
10:09:51.390990 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_inventory.sql
10:09:51.396552 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
10:09:51.397149 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_nation_region.sql
10:09:51.405029 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
10:09:51.405555 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
10:09:51.411670 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
10:09:51.412196 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_lineitem.sql
10:09:51.417703 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
10:09:51.418369 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_supplier_nation.sql
10:09:51.424230 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
10:09:51.424758 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_order.sql
10:09:51.438574 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
10:09:51.439110 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_nation.sql
10:09:51.445814 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
10:09:51.446359 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_part.sql
10:09:51.453544 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
10:09:51.454071 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
10:09:51.459333 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
10:09:51.459859 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_customer.sql
10:09:51.464561 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
10:09:51.465088 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_supplier.sql
10:09:51.471863 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
10:09:51.472388 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_region.sql
10:09:51.479630 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
10:09:51.480171 [debug] [MainThread]: 1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
10:09:51.491691 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
10:09:51.492240 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
10:09:51.520096 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
10:09:51.520645 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
10:09:51.533066 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
10:09:51.533621 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
10:09:51.555438 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
10:09:51.555986 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
10:09:51.569235 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
10:09:51.569936 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
10:09:51.578612 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
10:09:51.579159 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
10:09:51.587661 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
10:09:51.588200 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
10:09:51.597760 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
10:09:51.598302 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
10:09:51.613375 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
10:09:51.613922 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
10:09:51.622260 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
10:09:51.622801 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
10:09:51.639396 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
10:09:51.640118 [debug] [MainThread]: 1603: static parser failed on raw_stage/raw_transactions.sql
10:09:51.642184 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
10:09:51.643013 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage/raw_inventory.sql
10:09:51.644645 [debug] [MainThread]: 1603: static parser failed on raw_stage/raw_orders.sql
10:09:51.647930 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
10:09:51.648503 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_orders.sql
10:09:51.780622 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
10:09:51.781276 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_inventory.sql
10:09:51.824663 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
10:09:51.825191 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_transactions.sql
10:09:51.836152 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
10:09:51.894489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c4e20>]}
10:09:51.902021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c4250>]}
10:09:51.902161 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 507 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
10:09:51.902278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042be400>]}
10:09:51.903411 [info ] [MainThread]: 
10:09:51.903639 [debug] [MainThread]: Acquiring new snowflake connection "master"
10:09:51.904768 [debug] [ThreadPool]: Acquiring new snowflake connection "list_ANALYTICS"
10:09:51.912062 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
10:09:51.912220 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_ANALYTICS"} */

    show terse schemas in database ANALYTICS
    limit 10000
10:09:51.912286 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:09:52.578878 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.67 seconds
10:09:52.582222 [debug] [ThreadPool]: On list_ANALYTICS: Close
10:09:52.696331 [debug] [ThreadPool]: Acquiring new snowflake connection "list_ANALYTICS_DBT_SPATEL"
10:09:52.706211 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_SPATEL"
10:09:52.706445 [debug] [ThreadPool]: On list_ANALYTICS_DBT_SPATEL: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_SPATEL"} */

    show terse objects in ANALYTICS.DBT_SPATEL
10:09:52.706573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:09:53.208000 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.5 seconds
10:09:53.212227 [debug] [ThreadPool]: On list_ANALYTICS_DBT_SPATEL: Close
10:09:53.353172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ac730>]}
10:09:53.353730 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
10:09:53.353952 [info ] [MainThread]: 
10:09:53.357062 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.raw_orders
10:09:53.357241 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_transactions
10:09:53.357812 [info ] [Thread-1  ]: 1 of 31 START view model DBT_SPATEL.raw_orders ................................. [RUN]
10:09:53.357974 [info ] [Thread-2  ]: 2 of 31 START view model DBT_SPATEL.raw_transactions ........................... [RUN]
10:09:53.358352 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
10:09:53.358640 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
10:09:53.358751 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.raw_orders
10:09:53.358845 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_transactions
10:09:53.358997 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.raw_orders
10:09:53.359123 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.raw_transactions
10:09:53.364059 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
10:09:53.366726 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
10:09:53.367302 [debug] [Thread-1  ]: finished collecting timing info
10:09:53.367426 [debug] [Thread-2  ]: finished collecting timing info
10:09:53.367564 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.raw_orders
10:09:53.367690 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_transactions
10:09:53.392527 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
10:09:53.393454 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
10:09:53.394505 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
10:09:53.396274 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
10:09:53.396347 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */

  create or replace  view ANALYTICS.DBT_SPATEL.raw_transactions
  
   as (
    SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS  AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
10:09:53.396418 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */

  create or replace  view ANALYTICS.DBT_SPATEL.raw_orders
  
   as (
    SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
10:09:53.396505 [debug] [Thread-2  ]: Opening a new connection, currently in state init
10:09:53.396580 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:09:54.048492 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.65 seconds
10:09:54.057992 [debug] [Thread-2  ]: finished collecting timing info
10:09:54.058310 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: Close
10:09:54.171366 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ac3d0>]}
10:09:54.172232 [info ] [Thread-2  ]: 2 of 31 OK created view model DBT_SPATEL.raw_transactions ...................... [[32mSUCCESS 1[0m in 0.81s]
10:09:54.172933 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_transactions
10:09:54.173655 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.v_stg_transactions
10:09:54.173991 [info ] [Thread-4  ]: 3 of 31 START view model DBT_SPATEL.v_stg_transactions ......................... [RUN]
10:09:54.174545 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
10:09:54.174708 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
10:09:54.174865 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.v_stg_transactions
10:09:54.191074 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
10:09:54.191247 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table ANALYTICS.DBT_SPATEL.raw_transactions
10:09:54.191356 [debug] [Thread-4  ]: Opening a new connection, currently in state init
10:09:54.242558 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.85 seconds
10:09:54.243672 [debug] [Thread-1  ]: finished collecting timing info
10:09:54.243816 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: Close
10:09:54.438736 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b5850>]}
10:09:54.439037 [info ] [Thread-1  ]: 1 of 31 OK created view model DBT_SPATEL.raw_orders ............................ [[32mSUCCESS 1[0m in 1.08s]
10:09:54.439318 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.raw_orders
10:09:54.439598 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_inventory
10:09:54.439729 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.v_stg_orders
10:09:54.439859 [info ] [Thread-2  ]: 4 of 31 START view model DBT_SPATEL.raw_inventory .............................. [RUN]
10:09:54.440002 [info ] [Thread-3  ]: 5 of 31 START view model DBT_SPATEL.v_stg_orders ............................... [RUN]
10:09:54.440253 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
10:09:54.440548 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
10:09:54.440663 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_inventory
10:09:54.440766 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
10:09:54.440869 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.raw_inventory
10:09:54.440968 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.v_stg_orders
10:09:54.444178 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
10:09:54.454451 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
10:09:54.455316 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table ANALYTICS.DBT_SPATEL.raw_orders
10:09:54.455420 [debug] [Thread-3  ]: Opening a new connection, currently in state init
10:09:54.456450 [debug] [Thread-2  ]: finished collecting timing info
10:09:54.456586 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_inventory
10:09:54.458521 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
10:09:54.460225 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
10:09:54.460318 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */

  create or replace  view ANALYTICS.DBT_SPATEL.raw_inventory
  
   as (
    SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PARTSUPP AS a
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN ANALYTICS.DBT_SPATEL.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
  );
10:09:54.460385 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
10:09:54.529700 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0.34 seconds
10:09:54.587388 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
10:09:54.587467 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table ANALYTICS.DBT_SPATEL.raw_transactions
10:09:54.735064 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0.15 seconds
10:09:54.745791 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
10:09:54.746112 [debug] [Thread-4  ]: finished collecting timing info
10:09:54.746189 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
10:09:54.747916 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
10:09:54.749389 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
10:09:54.749455 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

  create or replace  view ANALYTICS.DBT_SPATEL.v_stg_transactions
  
   as (
    







-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM ANALYTICS.DBT_SPATEL.raw_transactions
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATEADD(DAY, 1, TRANSACTION_DATE) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS TRANSACTION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS VARCHAR))), '')) AS BINARY(16)) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
10:09:54.861927 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0.41 seconds
10:09:55.043177 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
10:09:55.043268 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table ANALYTICS.DBT_SPATEL.raw_orders
10:09:55.084200 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.33 seconds
10:09:55.085002 [debug] [Thread-4  ]: finished collecting timing info
10:09:55.085111 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: Close
10:09:55.123222 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0.08 seconds
10:09:55.203334 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
10:09:55.203659 [debug] [Thread-3  ]: finished collecting timing info
10:09:55.203732 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_orders
10:09:55.205111 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
10:09:55.205333 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104844640>]}
10:09:55.205506 [info ] [Thread-4  ]: 3 of 31 OK created view model DBT_SPATEL.v_stg_transactions .................... [[32mSUCCESS 1[0m in 1.03s]
10:09:55.205683 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
10:09:55.205948 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.t_link_transactions
10:09:55.206057 [info ] [Thread-1  ]: 6 of 31 START incremental model DBT_SPATEL.t_link_transactions ................. [RUN]
10:09:55.206240 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
10:09:55.206316 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
10:09:55.206381 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.t_link_transactions
10:09:55.216575 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
10:09:55.216706 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

  create or replace  view ANALYTICS.DBT_SPATEL.v_stg_orders
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM ANALYTICS.DBT_SPATEL.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMERKEY AS CUSTOMER_KEY,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS REGION_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '')) AS BINARY(16)) AS ORDER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '')) AS BINARY(16)) AS PART_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
  );
10:09:55.221081 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
10:09:55.221627 [debug] [Thread-1  ]: finished collecting timing info
10:09:55.221715 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.t_link_transactions
10:09:55.240458 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
10:09:55.241800 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
10:09:55.241882 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.t_link_transactions  as
      (-- Generated by dbtvault.

    

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_transactions
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    
)

SELECT * FROM records_to_insert
      );
10:09:55.241940 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:09:55.367042 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.91 seconds
10:09:55.372718 [debug] [Thread-2  ]: finished collecting timing info
10:09:55.372810 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_inventory: Close
10:09:55.482258 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048440a0>]}
10:09:55.482541 [info ] [Thread-2  ]: 4 of 31 OK created view model DBT_SPATEL.raw_inventory ......................... [[32mSUCCESS 1[0m in 1.04s]
10:09:55.482823 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_inventory
10:09:55.483174 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.v_stg_inventory
10:09:55.483403 [info ] [Thread-4  ]: 7 of 31 START view model DBT_SPATEL.v_stg_inventory ............................ [RUN]
10:09:55.483702 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
10:09:55.483799 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
10:09:55.483890 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.v_stg_inventory
10:09:55.492742 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
10:09:55.492843 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table ANALYTICS.DBT_SPATEL.raw_inventory
10:09:55.492917 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
10:09:55.813655 [debug] [Thread-4  ]: SQL status: SUCCESS 24 in 0.32 seconds
10:09:55.839793 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.62 seconds
10:09:55.842220 [debug] [Thread-3  ]: finished collecting timing info
10:09:55.849979 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: Close
10:09:55.899145 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
10:09:55.899218 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table ANALYTICS.DBT_SPATEL.raw_inventory
10:09:55.996824 [debug] [Thread-4  ]: SQL status: SUCCESS 24 in 0.1 seconds
10:09:56.052976 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
10:09:56.053315 [debug] [Thread-4  ]: finished collecting timing info
10:09:56.053393 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
10:09:56.054857 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
10:09:56.055088 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104842d90>]}
10:09:56.055248 [info ] [Thread-3  ]: 5 of 31 OK created view model DBT_SPATEL.v_stg_orders .......................... [[32mSUCCESS 1[0m in 1.61s]
10:09:56.055434 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_orders
10:09:56.055798 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
10:09:56.055889 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
10:09:56.055980 [info ] [Thread-2  ]: 8 of 31 START incremental model DBT_SPATEL.hub_customer ........................ [RUN]
10:09:56.056114 [info ] [Thread-3  ]: 9 of 31 START incremental model DBT_SPATEL.hub_lineitem ........................ [RUN]
10:09:56.056310 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
10:09:56.056471 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
10:09:56.056544 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
10:09:56.061451 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
10:09:56.061613 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
10:09:56.061728 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.hub_customer
10:09:56.061816 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

  create or replace  view ANALYTICS.DBT_SPATEL.v_stg_inventory
  
   as (
    








WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM ANALYTICS.DBT_SPATEL.raw_inventory
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS NATION_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_SUPPLIER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '')) AS BINARY(16)) AS PART_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS PART_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_REGION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_NATION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging
  );
10:09:56.061880 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_lineitem
10:09:56.068874 [info ] [Thread-2  ]: 10:09:56 + Loading ANALYTICS.DBT_SPATEL.hub_customer from 1 source(s)
10:09:56.071977 [info ] [Thread-3  ]: 10:09:56 + Loading ANALYTICS.DBT_SPATEL.hub_lineitem from 1 source(s)
10:09:56.079628 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
10:09:56.081067 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
10:09:56.081401 [debug] [Thread-2  ]: finished collecting timing info
10:09:56.081526 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
10:09:56.081604 [debug] [Thread-3  ]: finished collecting timing info
10:09:56.084152 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
10:09:56.084271 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
10:09:56.085963 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
10:09:56.086819 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
10:09:56.087365 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
10:09:56.087433 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.hub_customer  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
10:09:56.087504 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.hub_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
10:09:56.087575 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
10:09:56.087639 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
10:09:56.418248 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.35 seconds
10:09:56.419517 [debug] [Thread-4  ]: finished collecting timing info
10:09:56.419649 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: Close
10:09:56.533636 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048fdf70>]}
10:09:56.534093 [info ] [Thread-4  ]: 7 of 31 OK created view model DBT_SPATEL.v_stg_inventory ....................... [[32mSUCCESS 1[0m in 1.05s]
10:09:56.534492 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
10:09:56.534665 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_order
10:09:56.535093 [info ] [Thread-4  ]: 10 of 31 START incremental model DBT_SPATEL.hub_order .......................... [RUN]
10:09:56.535822 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
10:09:56.536008 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
10:09:56.536181 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.hub_order
10:09:56.541371 [info ] [Thread-4  ]: 10:09:56 + Loading ANALYTICS.DBT_SPATEL.hub_order from 1 source(s)
10:09:56.547260 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
10:09:56.547745 [debug] [Thread-4  ]: finished collecting timing info
10:09:56.547864 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
10:09:56.550359 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
10:09:56.551401 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
10:09:56.551499 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.hub_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
10:09:56.551582 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
10:09:58.577227 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.34 seconds
10:09:58.587199 [debug] [Thread-1  ]: finished collecting timing info
10:09:58.587542 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.t_link_transactions: Close
10:09:58.700375 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104366e50>]}
10:09:58.701182 [info ] [Thread-1  ]: 6 of 31 OK created incremental model DBT_SPATEL.t_link_transactions ............ [[32mSUCCESS 1[0m in 3.49s]
10:09:58.701952 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.t_link_transactions
10:09:58.702304 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_customer_nation
10:09:58.702704 [info ] [Thread-1  ]: 11 of 31 START incremental model DBT_SPATEL.link_customer_nation ............... [RUN]
10:09:58.703472 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
10:09:58.703757 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
10:09:58.704026 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.link_customer_nation
10:09:58.716732 [info ] [Thread-1  ]: 10:09:58 + Loading ANALYTICS.DBT_SPATEL.link_customer_nation from 1 source(s)
10:09:58.727653 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
10:09:58.728461 [debug] [Thread-1  ]: finished collecting timing info
10:09:58.728633 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_nation
10:09:58.732350 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
10:09:58.734103 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
10:09:58.734235 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.link_customer_nation  as
      (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
10:09:58.734350 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:10:01.356459 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 5.27 seconds
10:10:01.357139 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 5.27 seconds
10:10:01.360250 [debug] [Thread-2  ]: finished collecting timing info
10:10:01.362829 [debug] [Thread-3  ]: finished collecting timing info
10:10:01.363230 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: Close
10:10:01.363440 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: Close
10:10:01.472008 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.92 seconds
10:10:01.474412 [debug] [Thread-4  ]: finished collecting timing info
10:10:01.475013 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a99d60>]}
10:10:01.475218 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: Close
10:10:01.476461 [info ] [Thread-2  ]: 8 of 31 OK created incremental model DBT_SPATEL.hub_customer ................... [[32mSUCCESS 1[0m in 5.42s]
10:10:01.478258 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
10:10:01.478578 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_customer_order
10:10:01.478846 [info ] [Thread-2  ]: 12 of 31 START incremental model DBT_SPATEL.link_customer_order ................ [RUN]
10:10:01.479376 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
10:10:01.479570 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_order
10:10:01.479819 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.link_customer_order
10:10:01.487216 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d115b0>]}
10:10:01.489619 [info ] [Thread-2  ]: 10:10:01 + Loading ANALYTICS.DBT_SPATEL.link_customer_order from 1 source(s)
10:10:01.490250 [info ] [Thread-3  ]: 9 of 31 OK created incremental model DBT_SPATEL.hub_lineitem ................... [[32mSUCCESS 1[0m in 5.43s]
10:10:01.494780 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
10:10:01.495530 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
10:10:01.496442 [info ] [Thread-3  ]: 13 of 31 START incremental model DBT_SPATEL.link_inventory_allocation .......... [RUN]
10:10:01.497967 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
10:10:01.498600 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.76 seconds
10:10:01.499339 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
10:10:01.501199 [debug] [Thread-1  ]: finished collecting timing info
10:10:01.501550 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.link_inventory_allocation
10:10:01.501963 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_nation: Close
10:10:01.511068 [info ] [Thread-3  ]: 10:10:01 + Loading ANALYTICS.DBT_SPATEL.link_inventory_allocation from 1 source(s)
10:10:01.519318 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
10:10:01.520279 [debug] [Thread-2  ]: finished collecting timing info
10:10:01.520411 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_order
10:10:01.523123 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
10:10:01.526336 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
10:10:01.526537 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.link_customer_order  as
      (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
10:10:01.526745 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
10:10:01.530546 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
10:10:01.531000 [debug] [Thread-3  ]: finished collecting timing info
10:10:01.531112 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
10:10:01.533323 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
10:10:01.534879 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
10:10:01.534989 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.link_inventory_allocation  as
      (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
10:10:01.535086 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
10:10:01.664163 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d8bf10>]}
10:10:01.664557 [info ] [Thread-1  ]: 11 of 31 OK created incremental model DBT_SPATEL.link_customer_nation .......... [[32mSUCCESS 1[0m in 2.96s]
10:10:01.664767 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_nation
10:10:01.664862 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_order_lineitem
10:10:01.664961 [info ] [Thread-1  ]: 14 of 31 START incremental model DBT_SPATEL.link_order_lineitem ................ [RUN]
10:10:01.665156 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
10:10:01.665291 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
10:10:01.666480 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.link_order_lineitem
10:10:01.666719 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048448b0>]}
10:10:01.669687 [info ] [Thread-1  ]: 10:10:01 + Loading ANALYTICS.DBT_SPATEL.link_order_lineitem from 1 source(s)
10:10:01.671056 [info ] [Thread-4  ]: 10 of 31 OK created incremental model DBT_SPATEL.hub_order ..................... [[32mSUCCESS 1[0m in 5.13s]
10:10:01.676598 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
10:10:01.677030 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
10:10:01.678109 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
10:10:01.678462 [info ] [Thread-4  ]: 15 of 31 START incremental model DBT_SPATEL.sat_order_cust_nation_details ...... [RUN]
10:10:01.678674 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
10:10:01.678747 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
10:10:01.678815 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_order_cust_nation_details
10:10:01.688435 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
10:10:01.690357 [debug] [Thread-1  ]: finished collecting timing info
10:10:01.690452 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
10:10:01.692000 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
10:10:01.692512 [debug] [Thread-4  ]: finished collecting timing info
10:10:01.692592 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
10:10:01.693989 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
10:10:01.695667 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
10:10:01.695734 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.link_order_lineitem  as
      (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
10:10:01.696160 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:10:01.697936 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
10:10:01.698011 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.sat_order_cust_nation_details  as
      (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
10:10:01.698321 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
10:10:03.866598 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.34 seconds
10:10:03.870282 [debug] [Thread-2  ]: finished collecting timing info
10:10:03.870690 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_order: Close
10:10:03.974662 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.28 seconds
10:10:03.981761 [debug] [Thread-4  ]: finished collecting timing info
10:10:03.982133 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
10:10:03.989178 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d11820>]}
10:10:03.989959 [info ] [Thread-2  ]: 12 of 31 OK created incremental model DBT_SPATEL.link_customer_order ........... [[32mSUCCESS 1[0m in 2.51s]
10:10:03.990665 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_order
10:10:03.990931 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
10:10:03.991256 [info ] [Thread-2  ]: 16 of 31 START incremental model DBT_SPATEL.sat_order_cust_region_details ...... [RUN]
10:10:03.991803 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
10:10:03.992013 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
10:10:03.992230 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_order_cust_region_details
10:10:04.020965 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
10:10:04.021600 [debug] [Thread-2  ]: finished collecting timing info
10:10:04.021750 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
10:10:04.025241 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
10:10:04.026531 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
10:10:04.026645 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.sat_order_cust_region_details  as
      (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
10:10:04.026746 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
10:10:04.099366 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dbceb0>]}
10:10:04.099793 [info ] [Thread-4  ]: 15 of 31 OK created incremental model DBT_SPATEL.sat_order_cust_nation_details . [[32mSUCCESS 1[0m in 2.42s]
10:10:04.100347 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
10:10:04.100626 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
10:10:04.100936 [info ] [Thread-4  ]: 17 of 31 START incremental model DBT_SPATEL.sat_order_customer_details ......... [RUN]
10:10:04.107535 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
10:10:04.113964 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
10:10:04.120410 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
10:10:04.174008 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
10:10:04.190022 [debug] [Thread-4  ]: finished collecting timing info
10:10:04.190107 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
10:10:04.191633 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
10:10:04.197498 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
10:10:04.197570 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.sat_order_customer_details  as
      (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
10:10:04.197628 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
10:10:05.775080 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.24 seconds
10:10:05.784066 [debug] [Thread-3  ]: finished collecting timing info
10:10:05.784954 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
10:10:05.829195 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.13 seconds
10:10:05.834612 [debug] [Thread-1  ]: finished collecting timing info
10:10:05.835399 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: Close
10:10:05.943698 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dc2d90>]}
10:10:05.945577 [info ] [Thread-3  ]: 13 of 31 OK created incremental model DBT_SPATEL.link_inventory_allocation ..... [[32mSUCCESS 1[0m in 4.45s]
10:10:05.947558 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
10:10:05.948623 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
10:10:05.949168 [info ] [Thread-3  ]: 18 of 31 START incremental model DBT_SPATEL.sat_order_lineitem_details ......... [RUN]
10:10:05.950566 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
10:10:05.951384 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
10:10:05.951719 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_order_lineitem_details
10:10:05.975572 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da66d0>]}
10:10:05.976146 [info ] [Thread-1  ]: 14 of 31 OK created incremental model DBT_SPATEL.link_order_lineitem ........... [[32mSUCCESS 1[0m in 4.31s]
10:10:05.977291 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
10:10:05.977526 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_order_details
10:10:05.978172 [info ] [Thread-1  ]: 19 of 31 START incremental model DBT_SPATEL.sat_order_order_details ............ [RUN]
10:10:05.979216 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
10:10:05.979694 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
10:10:05.980082 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.sat_order_order_details
10:10:06.053465 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
10:10:06.060867 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
10:10:06.061099 [debug] [Thread-1  ]: finished collecting timing info
10:10:06.061190 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
10:10:06.062828 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
10:10:06.062964 [debug] [Thread-3  ]: finished collecting timing info
10:10:06.063038 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
10:10:06.064455 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
10:10:06.065217 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
10:10:06.065283 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.sat_order_order_details  as
      (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS a
    WHERE a.ORDER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
10:10:06.065344 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:10:06.066704 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
10:10:06.066771 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.sat_order_lineitem_details  as
      (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
10:10:06.066859 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
10:10:06.271169 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.24 seconds
10:10:06.274032 [debug] [Thread-2  ]: finished collecting timing info
10:10:06.274162 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
10:10:06.383019 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103b38e0>]}
10:10:06.383333 [info ] [Thread-2  ]: 16 of 31 OK created incremental model DBT_SPATEL.sat_order_cust_region_details . [[32mSUCCESS 1[0m in 2.39s]
10:10:06.383567 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
10:10:06.383672 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
10:10:06.383780 [info ] [Thread-2  ]: 20 of 31 START incremental model DBT_SPATEL.hub_nation ......................... [RUN]
10:10:06.384208 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
10:10:06.384334 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
10:10:06.384420 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.hub_nation
10:10:06.387686 [info ] [Thread-2  ]: 10:10:06 + Loading ANALYTICS.DBT_SPATEL.hub_nation from 2 source(s)
10:10:06.393262 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
10:10:06.393629 [debug] [Thread-2  ]: finished collecting timing info
10:10:06.393703 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
10:10:06.395475 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
10:10:06.396662 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
10:10:06.396745 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.hub_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
10:10:06.396803 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
10:10:08.742738 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.55 seconds
10:10:08.746646 [debug] [Thread-4  ]: finished collecting timing info
10:10:08.746971 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
10:10:08.876282 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104df2430>]}
10:10:08.877155 [info ] [Thread-4  ]: 17 of 31 OK created incremental model DBT_SPATEL.sat_order_customer_details .... [[32mSUCCESS 1[0m in 4.77s]
10:10:08.877928 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
10:10:08.878292 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_part
10:10:08.878682 [info ] [Thread-4  ]: 21 of 31 START incremental model DBT_SPATEL.hub_part ........................... [RUN]
10:10:08.879455 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
10:10:08.880893 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
10:10:08.881216 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.hub_part
10:10:08.894332 [info ] [Thread-4  ]: 10:10:08 + Loading ANALYTICS.DBT_SPATEL.hub_part from 2 source(s)
10:10:08.907074 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
10:10:08.907726 [debug] [Thread-4  ]: finished collecting timing info
10:10:08.907877 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
10:10:08.911550 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
10:10:08.913768 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
10:10:08.913917 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.hub_part  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
10:10:08.914032 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
10:10:09.046959 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.98 seconds
10:10:09.054066 [debug] [Thread-1  ]: finished collecting timing info
10:10:09.054159 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: Close
10:10:09.188818 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110313730>]}
10:10:09.189177 [info ] [Thread-1  ]: 19 of 31 OK created incremental model DBT_SPATEL.sat_order_order_details ....... [[32mSUCCESS 1[0m in 3.21s]
10:10:09.189499 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
10:10:09.189657 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_region
10:10:09.189896 [info ] [Thread-1  ]: 22 of 31 START incremental model DBT_SPATEL.hub_region ......................... [RUN]
10:10:09.190280 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
10:10:09.190398 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
10:10:09.190501 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_region
10:10:09.194389 [info ] [Thread-1  ]: 10:10:09 + Loading ANALYTICS.DBT_SPATEL.hub_region from 2 source(s)
10:10:09.201925 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
10:10:09.202379 [debug] [Thread-1  ]: finished collecting timing info
10:10:09.202476 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
10:10:09.205293 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
10:10:09.206825 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
10:10:09.206911 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.hub_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
10:10:09.206980 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:10:11.816576 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 5.75 seconds
10:10:11.821161 [debug] [Thread-3  ]: finished collecting timing info
10:10:11.822029 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
10:10:12.068042 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103576a0>]}
10:10:12.068724 [info ] [Thread-3  ]: 18 of 31 OK created incremental model DBT_SPATEL.sat_order_lineitem_details .... [[32mSUCCESS 1[0m in 6.12s]
10:10:12.069257 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
10:10:12.069497 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
10:10:12.069815 [info ] [Thread-3  ]: 23 of 31 START incremental model DBT_SPATEL.hub_supplier ....................... [RUN]
10:10:12.070848 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
10:10:12.071096 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
10:10:12.071324 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_supplier
10:10:12.085123 [info ] [Thread-3  ]: 10:10:12 + Loading ANALYTICS.DBT_SPATEL.hub_supplier from 2 source(s)
10:10:12.098755 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
10:10:12.099479 [debug] [Thread-3  ]: finished collecting timing info
10:10:12.099654 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
10:10:12.103275 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
10:10:12.105595 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
10:10:12.105727 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.hub_supplier  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
10:10:12.105845 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
10:10:12.405898 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 6.01 seconds
10:10:12.407359 [debug] [Thread-2  ]: finished collecting timing info
10:10:12.407524 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_nation: Close
10:10:12.554154 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d8b790>]}
10:10:12.555337 [info ] [Thread-2  ]: 20 of 31 OK created incremental model DBT_SPATEL.hub_nation .................... [[32mSUCCESS 1[0m in 6.17s]
10:10:12.555954 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
10:10:12.556263 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_inventory
10:10:12.556543 [info ] [Thread-2  ]: 24 of 31 START incremental model DBT_SPATEL.link_inventory ..................... [RUN]
10:10:12.557106 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
10:10:12.557300 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory
10:10:12.557614 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.link_inventory
10:10:12.572007 [info ] [Thread-2  ]: 10:10:12 + Loading ANALYTICS.DBT_SPATEL.link_inventory from 1 source(s)
10:10:12.578927 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
10:10:12.579491 [debug] [Thread-2  ]: finished collecting timing info
10:10:12.579620 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory
10:10:12.582794 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory"
10:10:12.584448 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
10:10:12.584581 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.link_inventory  as
      (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
10:10:12.584694 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
10:10:14.582782 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 5.37 seconds
10:10:14.589586 [debug] [Thread-1  ]: finished collecting timing info
10:10:14.590468 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: Close
10:10:14.730746 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104651640>]}
10:10:14.734305 [info ] [Thread-1  ]: 22 of 31 OK created incremental model DBT_SPATEL.hub_region .................... [[32mSUCCESS 1[0m in 5.54s]
10:10:14.736889 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
10:10:14.737287 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_nation_region
10:10:14.737596 [info ] [Thread-1  ]: 25 of 31 START incremental model DBT_SPATEL.link_nation_region ................. [RUN]
10:10:14.738540 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
10:10:14.738842 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_nation_region
10:10:14.739049 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.link_nation_region
10:10:14.752758 [info ] [Thread-1  ]: 10:10:14 + Loading ANALYTICS.DBT_SPATEL.link_nation_region from 2 source(s)
10:10:14.768350 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
10:10:14.768982 [debug] [Thread-1  ]: finished collecting timing info
10:10:14.769136 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_nation_region
10:10:14.772308 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
10:10:14.774530 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
10:10:14.774643 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.link_nation_region  as
      (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
10:10:14.775795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:10:14.849512 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 5.94 seconds
10:10:14.851252 [debug] [Thread-4  ]: finished collecting timing info
10:10:14.851510 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_part: Close
10:10:15.022928 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e73a0>]}
10:10:15.023166 [info ] [Thread-4  ]: 21 of 31 OK created incremental model DBT_SPATEL.hub_part ...................... [[32mSUCCESS 1[0m in 6.14s]
10:10:15.023424 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
10:10:15.023549 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_supplier_nation
10:10:15.023668 [info ] [Thread-4  ]: 26 of 31 START incremental model DBT_SPATEL.link_supplier_nation ............... [RUN]
10:10:15.023965 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
10:10:15.024056 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
10:10:15.024134 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.link_supplier_nation
10:10:15.027282 [info ] [Thread-4  ]: 10:10:15 + Loading ANALYTICS.DBT_SPATEL.link_supplier_nation from 1 source(s)
10:10:15.032147 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
10:10:15.032520 [debug] [Thread-4  ]: finished collecting timing info
10:10:15.032597 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
10:10:15.034327 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
10:10:15.035179 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
10:10:15.035248 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.link_supplier_nation  as
      (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
10:10:15.035308 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
10:10:15.862076 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.28 seconds
10:10:15.864898 [debug] [Thread-2  ]: finished collecting timing info
10:10:15.865468 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory: Close
10:10:15.979597 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d73670>]}
10:10:15.982015 [info ] [Thread-2  ]: 24 of 31 OK created incremental model DBT_SPATEL.link_inventory ................ [[32mSUCCESS 1[0m in 3.42s]
10:10:15.982794 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory
10:10:15.983350 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
10:10:15.984627 [info ] [Thread-2  ]: 27 of 31 START incremental model DBT_SPATEL.sat_inv_inventory_details .......... [RUN]
10:10:15.985614 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
10:10:15.985886 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
10:10:15.986131 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_inventory_details
10:10:16.019731 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
10:10:16.020289 [debug] [Thread-2  ]: finished collecting timing info
10:10:16.020418 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
10:10:16.023131 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
10:10:16.024406 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
10:10:16.024517 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.sat_inv_inventory_details  as
      (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
10:10:16.024618 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
10:10:16.832306 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.73 seconds
10:10:16.837825 [debug] [Thread-3  ]: finished collecting timing info
10:10:16.838470 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: Close
10:10:16.981260 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042edd30>]}
10:10:17.713410 [info ] [Thread-3  ]: 23 of 31 OK created incremental model DBT_SPATEL.hub_supplier .................. [[32mSUCCESS 1[0m in 4.91s]
10:10:17.714188 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
10:10:17.714848 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
10:10:17.715142 [info ] [Thread-3  ]: 28 of 31 START incremental model DBT_SPATEL.sat_inv_part_details ............... [RUN]
10:10:17.716219 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
10:10:17.716465 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
10:10:17.716972 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_part_details
10:10:17.762473 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
10:10:17.763061 [debug] [Thread-3  ]: finished collecting timing info
10:10:17.763200 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
10:10:17.766350 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
10:10:17.767836 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
10:10:17.768004 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.sat_inv_part_details  as
      (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS a
    WHERE a.PART_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
10:10:17.768116 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
10:10:18.065262 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.03 seconds
10:10:18.066911 [debug] [Thread-4  ]: finished collecting timing info
10:10:18.067091 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: Close
10:10:18.174672 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104672940>]}
10:10:18.175486 [info ] [Thread-4  ]: 26 of 31 OK created incremental model DBT_SPATEL.link_supplier_nation .......... [[32mSUCCESS 1[0m in 3.15s]
10:10:18.177085 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
10:10:18.177866 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
10:10:18.179494 [info ] [Thread-4  ]: 29 of 31 START incremental model DBT_SPATEL.sat_inv_supp_nation_details ........ [RUN]
10:10:18.180925 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
10:10:18.181289 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
10:10:18.181596 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
10:10:18.209689 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
10:10:18.210273 [debug] [Thread-4  ]: finished collecting timing info
10:10:18.210398 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
10:10:18.214253 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
10:10:18.215696 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
10:10:18.215843 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.sat_inv_supp_nation_details  as
      (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
10:10:18.215952 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
10:10:20.374534 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.35 seconds
10:10:20.377915 [debug] [Thread-2  ]: finished collecting timing info
10:10:20.378503 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: Close
10:10:20.475249 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 5.7 seconds
10:10:20.478034 [debug] [Thread-1  ]: finished collecting timing info
10:10:20.478456 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_nation_region: Close
10:10:20.492985 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad2340>]}
10:10:20.493576 [info ] [Thread-2  ]: 27 of 31 OK created incremental model DBT_SPATEL.sat_inv_inventory_details ..... [[32mSUCCESS 1[0m in 4.51s]
10:10:20.494103 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
10:10:20.494341 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
10:10:20.494589 [info ] [Thread-2  ]: 30 of 31 START incremental model DBT_SPATEL.sat_inv_supp_region_details ........ [RUN]
10:10:20.495097 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
10:10:20.495295 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
10:10:20.495573 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supp_region_details
10:10:20.520948 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
10:10:20.521585 [debug] [Thread-2  ]: finished collecting timing info
10:10:20.521756 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
10:10:20.525743 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
10:10:20.526767 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
10:10:20.526854 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.sat_inv_supp_region_details  as
      (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
10:10:20.526932 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
10:10:20.595547 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10438b2e0>]}
10:10:20.595925 [info ] [Thread-1  ]: 25 of 31 OK created incremental model DBT_SPATEL.link_nation_region ............ [[32mSUCCESS 1[0m in 5.86s]
10:10:20.596442 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_nation_region
10:10:20.596663 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
10:10:20.597092 [info ] [Thread-1  ]: 31 of 31 START incremental model DBT_SPATEL.sat_inv_supplier_details ........... [RUN]
10:10:20.597776 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
10:10:20.598006 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
10:10:20.603459 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supplier_details
10:10:20.683899 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
10:10:20.700989 [debug] [Thread-1  ]: finished collecting timing info
10:10:20.701085 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
10:10:20.702829 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
10:10:20.703643 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
10:10:20.703708 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */


      create or replace transient table ANALYTICS.DBT_SPATEL.sat_inv_supplier_details  as
      (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
10:10:20.703763 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:10:22.155530 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.94 seconds
10:10:22.160016 [debug] [Thread-4  ]: finished collecting timing info
10:10:22.160414 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: Close
10:10:22.410756 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aceb50>]}
10:10:22.411437 [info ] [Thread-4  ]: 29 of 31 OK created incremental model DBT_SPATEL.sat_inv_supp_nation_details ... [[32mSUCCESS 1[0m in 4.23s]
10:10:22.412042 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
10:10:22.505909 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.74 seconds
10:10:22.509531 [debug] [Thread-3  ]: finished collecting timing info
10:10:22.509878 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: Close
10:10:22.635940 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049dbe80>]}
10:10:22.636571 [info ] [Thread-3  ]: 28 of 31 OK created incremental model DBT_SPATEL.sat_inv_part_details .......... [[32mSUCCESS 1[0m in 4.92s]
10:10:22.637142 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
10:10:24.101079 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.57 seconds
10:10:24.103353 [debug] [Thread-2  ]: finished collecting timing info
10:10:24.103577 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: Close
10:10:24.822866 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa4550>]}
10:10:24.823672 [info ] [Thread-2  ]: 30 of 31 OK created incremental model DBT_SPATEL.sat_inv_supp_region_details ... [[32mSUCCESS 1[0m in 4.33s]
10:10:24.824373 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
10:10:25.844420 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 5.14 seconds
10:10:25.847772 [debug] [Thread-1  ]: finished collecting timing info
10:10:25.848321 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: Close
10:10:26.040402 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423326f5-1243-4cce-ba3f-1b37e183e6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d1ddc0>]}
10:10:26.041038 [info ] [Thread-1  ]: 31 of 31 OK created incremental model DBT_SPATEL.sat_inv_supplier_details ...... [[32mSUCCESS 1[0m in 5.44s]
10:10:26.041558 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
10:10:26.044170 [debug] [MainThread]: Acquiring new snowflake connection "master"
10:10:26.044799 [info ] [MainThread]: 
10:10:26.045107 [info ] [MainThread]: Finished running 6 view models, 25 incremental models in 34.14s.
10:10:26.045400 [debug] [MainThread]: Connection 'master' was properly closed.
10:10:26.045556 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
10:10:26.045705 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
10:10:26.045854 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details' was properly closed.
10:10:26.046002 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_part_details' was properly closed.
10:10:26.063970 [info ] [MainThread]: 
10:10:26.064166 [info ] [MainThread]: [32mCompleted successfully[0m
10:10:26.064325 [info ] [MainThread]: 
10:10:26.064427 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=0 SKIP=0 TOTAL=31
10:10:26.064586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103313d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104647c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10432fa90>]}


============================== 2023-02-17 14:27:40.290207 | 841c6b77-b5b5-4e63-af85-99f477e88d70 ==============================
14:27:40.290219 [info ] [MainThread]: Running with dbt=1.1.1
14:27:40.290692 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
14:27:40.290776 [debug] [MainThread]: Tracking: tracking
14:27:40.290991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110300880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103008e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110300940>]}
14:27:40.301791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110315670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110315040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103156a0>]}


============================== 2023-02-17 14:32:46.601890 | ae693b4f-e5ef-4a67-8fdb-039529af45dc ==============================
14:32:46.601894 [info ] [MainThread]: Running with dbt=1.1.1
14:32:46.602257 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
14:32:46.602328 [debug] [MainThread]: Tracking: tracking
14:32:46.613858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637a820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106487820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a9610>]}
14:32:46.615017 [debug] [MainThread]: Set downloads directory='/var/folders/ft/vyzwzhsj5pz7mw7_yvfwm3y80000gq/T/dbt-downloads-fgsh8wws'
14:32:46.615409 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
14:32:46.750415 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
14:32:46.750674 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
14:32:46.813091 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
14:32:46.817043 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
14:32:46.905439 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
14:32:46.950378 [info ] [MainThread]: Installing Datavault-UK/dbtvault
14:32:47.563908 [info ] [MainThread]:   Installed from version 0.9.4
14:32:47.564137 [info ] [MainThread]:   Up to date!
14:32:47.564330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ae693b4f-e5ef-4a67-8fdb-039529af45dc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106490d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a97f0>]}
14:32:47.564477 [info ] [MainThread]: Installing dbt-labs/dbt_utils
14:32:47.926542 [info ] [MainThread]:   Installed from version 1.0.0
14:32:47.926746 [info ] [MainThread]:   Up to date!
14:32:47.926893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ae693b4f-e5ef-4a67-8fdb-039529af45dc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065928e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106592a90>]}
14:32:47.929260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106490640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a98b0>]}


============================== 2023-02-17 14:46:30.159595 | 2b85d907-5665-4103-9e40-1e563fc53fe4 ==============================
[0m14:46:30.159595 [info ] [MainThread]: Running with dbt=1.4.0
[0m14:46:30.160325 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m14:46:30.160426 [debug] [MainThread]: Tracking: tracking
[0m14:46:30.171432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f9adf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104022fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104022580>]}
[0m14:46:30.172555 [debug] [MainThread]: Set downloads directory='/var/folders/ft/vyzwzhsj5pz7mw7_yvfwm3y80000gq/T/dbt-downloads-cp3n3_p_'
[0m14:46:30.173048 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:46:30.313565 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:46:30.313928 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
[0m14:46:30.379791 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
[0m14:46:30.386028 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:46:30.453401 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:46:30.531260 [info ] [MainThread]: Installing Datavault-UK/dbtvault
[0m14:46:30.895185 [info ] [MainThread]:   Installed from version 0.9.4
[0m14:46:30.895435 [info ] [MainThread]:   Up to date!
[0m14:46:30.895645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2b85d907-5665-4103-9e40-1e563fc53fe4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a98730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fcd760>]}
[0m14:46:30.895829 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:46:31.293095 [info ] [MainThread]:   Installed from version 1.0.0
[0m14:46:31.293334 [info ] [MainThread]:   Up to date!
[0m14:46:31.293550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2b85d907-5665-4103-9e40-1e563fc53fe4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a98730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104113eb0>]}
[0m14:46:31.295806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b92910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f9adf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104022580>]}
[0m14:46:31.295968 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:46:43.307869 | 411edd7b-cb06-498f-b6af-06b1696a61ce ==============================
[0m14:46:43.307869 [info ] [MainThread]: Running with dbt=1.4.0
[0m14:46:43.309281 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m14:46:43.309445 [debug] [MainThread]: Tracking: tracking
[0m14:46:43.309677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911deb0>]}
[0m14:46:43.336928 [debug] [MainThread]: Failed to load parsed file from disk at /Users/shrut.patel/Source/dbtvault/target/partial_parse.msgpack: Field "docs" of type MutableMapping[str, Documentation] in Manifest has invalid value {'dbt.__overview__': {'unique_id': 'dbt.__overview__', 'package_name': 'dbt', 'root_path': '/Users/shrut.patel/.pyenv/versions/3.8.10/lib/python3.8/site-packages/dbt/include/global_project', 'path': 'overview.md', 'original_file_path': 'docs/overview.md', 'name': '__overview__', 'block_contents': "### Welcome!\n\nWelcome to the auto-generated documentation for your dbt project!\n\n### Navigation\n\nYou can use the `Project` and `Database` navigation tabs on the left side of the window to explore the models\nin your project.\n\n#### Project Tab\nThe `Project` tab mirrors the directory structure of your dbt project. In this tab, you can see all of the\nmodels defined in your dbt project, as well as models imported from dbt packages.\n\n#### Database Tab\nThe `Database` tab also exposes your models, but in a format that looks more like a database explorer. This view\nshows relations (tables and views) grouped into database schemas. Note that ephemeral models are _not_ shown\nin this interface, as they do not exist in the database.\n\n### Graph Exploration\nYou can click the blue icon on the bottom-right corner of the page to view the lineage graph of your models.\n\nOn model pages, you'll see the immediate parents and children of the model you're exploring. By clicking the `Expand`\nbutton at the top-right of this lineage pane, you'll be able to see all of the models that are used to build,\nor are built from, the model you're exploring.\n\nOnce expanded, you'll be able to use the `--select` and `--exclude` model selection syntax to filter the\nmodels in the graph. For more information on model selection, check out the [dbt docs](https://docs.getdbt.com/docs/model-selection-syntax).\n\nNote that you can also right-click on models to interactively filter and explore the graph.\n\n---\n\n### More information\n\n- [What is dbt](https://docs.getdbt.com/docs/introduction)?\n- Read the [dbt viewpoint](https://docs.getdbt.com/docs/viewpoint)\n- [Installation](https://docs.getdbt.com/docs/installation)\n- Join the [dbt Community](https://www.getdbt.com/community/) for questions and discussion"}}
[0m14:46:43.337611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '411edd7b-cb06-498f-b6af-06b1696a61ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10931cfa0>]}
[0m14:46:44.378580 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_customer_order.sql
[0m14:46:44.425034 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
[0m14:46:44.425770 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_customer_nation.sql
[0m14:46:44.430709 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
[0m14:46:44.431363 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_inventory.sql
[0m14:46:44.435882 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
[0m14:46:44.436524 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_nation_region.sql
[0m14:46:44.441937 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
[0m14:46:44.442587 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
[0m14:46:44.447191 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
[0m14:46:44.448424 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_lineitem.sql
[0m14:46:44.452888 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
[0m14:46:44.453534 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_supplier_nation.sql
[0m14:46:44.458030 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
[0m14:46:44.458678 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_order.sql
[0m14:46:44.471836 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
[0m14:46:44.472497 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_nation.sql
[0m14:46:44.478440 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
[0m14:46:44.479099 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_part.sql
[0m14:46:44.484404 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
[0m14:46:44.485047 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
[0m14:46:44.489282 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
[0m14:46:44.489929 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_customer.sql
[0m14:46:44.494049 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
[0m14:46:44.494687 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_supplier.sql
[0m14:46:44.500487 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
[0m14:46:44.501131 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_region.sql
[0m14:46:44.506571 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
[0m14:46:44.507231 [debug] [MainThread]: 1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
[0m14:46:44.516793 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
[0m14:46:44.517488 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
[0m14:46:44.543590 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
[0m14:46:44.544285 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
[0m14:46:44.551422 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
[0m14:46:44.552098 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
[0m14:46:44.561128 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
[0m14:46:44.561795 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
[0m14:46:44.569631 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
[0m14:46:44.570297 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
[0m14:46:44.576511 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
[0m14:46:44.577176 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
[0m14:46:44.583391 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
[0m14:46:44.584067 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
[0m14:46:44.590778 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
[0m14:46:44.591628 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
[0m14:46:44.599178 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
[0m14:46:44.599841 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
[0m14:46:44.606036 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
[0m14:46:44.606695 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
[0m14:46:44.615020 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
[0m14:46:44.616478 [debug] [MainThread]: 1603: static parser failed on raw_stage/raw_transactions.sql
[0m14:46:44.619041 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
[0m14:46:44.619937 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage/raw_inventory.sql
[0m14:46:44.621504 [debug] [MainThread]: 1603: static parser failed on raw_stage/raw_orders.sql
[0m14:46:44.624983 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
[0m14:46:44.625671 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_orders.sql
[0m14:46:44.747732 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
[0m14:46:44.748525 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_inventory.sql
[0m14:46:44.787055 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
[0m14:46:44.787725 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_transactions.sql
[0m14:46:44.797739 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
[0m14:46:44.870027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '411edd7b-cb06-498f-b6af-06b1696a61ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093b3c40>]}
[0m14:46:44.878561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '411edd7b-cb06-498f-b6af-06b1696a61ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093b3c40>]}
[0m14:46:44.878742 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 630 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m14:46:44.878882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '411edd7b-cb06-498f-b6af-06b1696a61ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090eeaf0>]}
[0m14:46:44.880066 [info ] [MainThread]: 
[0m14:46:44.880808 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:46:44.881968 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_SPATEL'
[0m14:46:44.890005 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_SPATEL"
[0m14:46:44.890195 [debug] [ThreadPool]: On list_ANALYTICS_DBT_SPATEL: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_SPATEL"} */
show terse objects in ANALYTICS.DBT_SPATEL
[0m14:46:44.890298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:45.994226 [debug] [ThreadPool]: SQL status: SUCCESS 33 in 1 seconds
[0m14:46:45.997002 [debug] [ThreadPool]: On list_ANALYTICS_DBT_SPATEL: Close
[0m14:46:46.129131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '411edd7b-cb06-498f-b6af-06b1696a61ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c98b0>]}
[0m14:46:46.130118 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:46:46.130481 [info ] [MainThread]: 
[0m14:46:46.136871 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.raw_orders
[0m14:46:46.137214 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_transactions
[0m14:46:46.137863 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_orders'
[0m14:46:46.138417 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_transactions'
[0m14:46:46.138667 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.raw_orders
[0m14:46:46.138905 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_transactions
[0m14:46:46.148766 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
[0m14:46:46.149005 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
[0m14:46:46.150209 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.raw_orders (compile): 2023-02-17 14:46:46.139090 => 2023-02-17 14:46:46.150154
[0m14:46:46.150384 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_transactions (compile): 2023-02-17 14:46:46.145478 => 2023-02-17 14:46:46.150339
[0m14:46:46.150571 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.raw_orders
[0m14:46:46.150749 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_transactions
[0m14:46:46.150906 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.raw_orders (execute): 2023-02-17 14:46:46.150868 => 2023-02-17 14:46:46.150879
[0m14:46:46.151050 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_transactions (execute): 2023-02-17 14:46:46.151022 => 2023-02-17 14:46:46.151026
[0m14:46:46.152243 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.raw_orders
[0m14:46:46.152687 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_transactions
[0m14:46:46.153070 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_inventory
[0m14:46:46.153303 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.v_stg_orders
[0m14:46:46.153673 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_inventory'
[0m14:46:46.153862 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.v_stg_transactions
[0m14:46:46.154224 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_orders'
[0m14:46:46.154386 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_inventory
[0m14:46:46.154725 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_transactions'
[0m14:46:46.154889 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
[0m14:46:46.158445 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
[0m14:46:46.158639 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
[0m14:46:46.174117 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m14:46:46.179432 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m14:46:46.179586 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
describe table ANALYTICS.DBT_SPATEL.raw_orders
[0m14:46:46.179698 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
describe table ANALYTICS.DBT_SPATEL.raw_transactions
[0m14:46:46.179822 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_inventory (compile): 2023-02-17 14:46:46.155008 => 2023-02-17 14:46:46.179790
[0m14:46:46.179920 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:46:46.180038 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:46:46.180168 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_inventory
[0m14:46:46.181294 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_inventory (execute): 2023-02-17 14:46:46.181262 => 2023-02-17 14:46:46.181269
[0m14:46:46.181946 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_inventory
[0m14:46:46.182273 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.v_stg_inventory
[0m14:46:46.182559 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_inventory'
[0m14:46:46.182679 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
[0m14:46:46.191069 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m14:46:46.191375 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
describe table ANALYTICS.DBT_SPATEL.raw_inventory
[0m14:46:46.191474 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:46:46.658274 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m14:46:46.667947 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m14:46:46.668172 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
describe table ANALYTICS.DBT_SPATEL.raw_transactions
[0m14:46:46.713528 [debug] [Thread-3  ]: SQL status: SUCCESS 24 in 1 seconds
[0m14:46:46.726236 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m14:46:46.726469 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
describe table ANALYTICS.DBT_SPATEL.raw_inventory
[0m14:46:46.814826 [debug] [Thread-3  ]: SQL status: SUCCESS 24 in 0 seconds
[0m14:46:46.821138 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m14:46:46.840753 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m14:46:46.886140 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m14:46:46.886363 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_transactions (compile): 2023-02-17 14:46:46.174286 => 2023-02-17 14:46:46.886328
[0m14:46:46.886493 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
[0m14:46:46.886592 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_transactions (execute): 2023-02-17 14:46:46.886569 => 2023-02-17 14:46:46.886575
[0m14:46:46.886693 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: Close
[0m14:46:46.887459 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_inventory (compile): 2023-02-17 14:46:46.182762 => 2023-02-17 14:46:46.887434
[0m14:46:46.887584 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
[0m14:46:46.887675 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_inventory (execute): 2023-02-17 14:46:46.887656 => 2023-02-17 14:46:46.887659
[0m14:46:46.887759 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: Close
[0m14:46:46.907869 [debug] [Thread-4  ]: SQL status: SUCCESS 36 in 1 seconds
[0m14:46:46.915618 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m14:46:46.915731 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
describe table ANALYTICS.DBT_SPATEL.raw_orders
[0m14:46:47.023163 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
[0m14:46:47.023702 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_inventory
[0m14:46:47.023936 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_supplier_nation
[0m14:46:47.024329 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_inventory'
[0m14:46:47.024701 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_supplier_nation'
[0m14:46:47.025152 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
[0m14:46:47.025310 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory
[0m14:46:47.025481 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
[0m14:46:47.025681 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m14:46:47.040682 [info ] [Thread-2  ]: 14:46:47 + Loading ANALYTICS.DBT_SPATEL.link_inventory from 1 source(s)
[0m14:46:47.041022 [info ] [Thread-3  ]: 14:46:47 + Loading ANALYTICS.DBT_SPATEL.link_supplier_nation from 1 source(s)
[0m14:46:47.041386 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_inventory_details'
[0m14:46:47.047643 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
[0m14:46:47.051772 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m14:46:47.052210 [debug] [Thread-4  ]: SQL status: SUCCESS 36 in 0 seconds
[0m14:46:47.052396 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m14:46:47.083987 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory (compile): 2023-02-17 14:46:47.025799 => 2023-02-17 14:46:47.083936
[0m14:46:47.088609 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m14:46:47.096496 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory
[0m14:46:47.109203 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_supplier_nation (compile): 2023-02-17 14:46:47.032173 => 2023-02-17 14:46:47.109161
[0m14:46:47.116725 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
[0m14:46:47.116881 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory (execute): 2023-02-17 14:46:47.116851 => 2023-02-17 14:46:47.116858
[0m14:46:47.117007 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
[0m14:46:47.117375 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory
[0m14:46:47.117483 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_supplier_nation (execute): 2023-02-17 14:46:47.117462 => 2023-02-17 14:46:47.117465
[0m14:46:47.117737 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m14:46:47.117826 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_inventory_details (compile): 2023-02-17 14:46:47.065246 => 2023-02-17 14:46:47.117808
[0m14:46:47.118115 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
[0m14:46:47.118199 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_orders (compile): 2023-02-17 14:46:46.158760 => 2023-02-17 14:46:47.118184
[0m14:46:47.118479 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_part_details'
[0m14:46:47.118604 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m14:46:47.118742 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m14:46:47.118867 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_orders
[0m14:46:47.118971 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m14:46:47.119084 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_inventory_details (execute): 2023-02-17 14:46:47.119065 => 2023-02-17 14:46:47.119068
[0m14:46:47.119297 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details'
[0m14:46:47.119387 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_orders (execute): 2023-02-17 14:46:47.119371 => 2023-02-17 14:46:47.119374
[0m14:46:47.130747 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m14:46:47.131031 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m14:46:47.131142 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m14:46:47.131235 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_orders: Close
[0m14:46:47.131403 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m14:46:47.141326 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m14:46:47.141583 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details'
[0m14:46:47.141842 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m14:46:47.151194 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m14:46:47.151341 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_part_details (compile): 2023-02-17 14:46:47.119458 => 2023-02-17 14:46:47.151315
[0m14:46:47.151458 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m14:46:47.151733 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_part_details (execute): 2023-02-17 14:46:47.151701 => 2023-02-17 14:46:47.151707
[0m14:46:47.151854 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_nation_details (compile): 2023-02-17 14:46:47.131478 => 2023-02-17 14:46:47.151836
[0m14:46:47.151938 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_region_details (compile): 2023-02-17 14:46:47.141919 => 2023-02-17 14:46:47.151917
[0m14:46:47.152226 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m14:46:47.152425 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m14:46:47.152555 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m14:46:47.152698 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m14:46:47.152914 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_nation_details (execute): 2023-02-17 14:46:47.152886 => 2023-02-17 14:46:47.152891
[0m14:46:47.153111 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_region_details (execute): 2023-02-17 14:46:47.153090 => 2023-02-17 14:46:47.153093
[0m14:46:47.153348 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details'
[0m14:46:47.153729 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m14:46:47.154069 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m14:46:47.154200 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m14:46:47.154356 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.t_link_transactions
[0m14:46:47.164944 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m14:46:47.165197 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.t_link_transactions'
[0m14:46:47.165372 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
[0m14:46:47.170378 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
[0m14:46:47.170605 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supplier_details (compile): 2023-02-17 14:46:47.154534 => 2023-02-17 14:46:47.170580
[0m14:46:47.170719 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m14:46:47.170808 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supplier_details (execute): 2023-02-17 14:46:47.170789 => 2023-02-17 14:46:47.170793
[0m14:46:47.171063 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m14:46:47.171172 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.t_link_transactions (compile): 2023-02-17 14:46:47.165449 => 2023-02-17 14:46:47.171156
[0m14:46:47.171272 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.t_link_transactions
[0m14:46:47.171356 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.t_link_transactions (execute): 2023-02-17 14:46:47.171339 => 2023-02-17 14:46:47.171342
[0m14:46:47.171603 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.t_link_transactions
[0m14:46:47.266375 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_orders
[0m14:46:47.267198 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
[0m14:46:47.267387 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
[0m14:46:47.267705 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_customer'
[0m14:46:47.267865 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_order
[0m14:46:47.268025 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_customer_nation
[0m14:46:47.268324 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_lineitem'
[0m14:46:47.268471 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
[0m14:46:47.268763 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_order'
[0m14:46:47.269045 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_customer_nation'
[0m14:46:47.269188 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
[0m14:46:47.273411 [info ] [Thread-1  ]: 14:46:47 + Loading ANALYTICS.DBT_SPATEL.hub_customer from 1 source(s)
[0m14:46:47.273633 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
[0m14:46:47.273763 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
[0m14:46:47.277246 [info ] [Thread-2  ]: 14:46:47 + Loading ANALYTICS.DBT_SPATEL.hub_lineitem from 1 source(s)
[0m14:46:47.280788 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
[0m14:46:47.284631 [info ] [Thread-3  ]: 14:46:47 + Loading ANALYTICS.DBT_SPATEL.hub_order from 1 source(s)
[0m14:46:47.288130 [info ] [Thread-4  ]: 14:46:47 + Loading ANALYTICS.DBT_SPATEL.link_customer_nation from 1 source(s)
[0m14:46:47.291134 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
[0m14:46:47.294632 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
[0m14:46:47.298048 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
[0m14:46:47.298389 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (compile): 2023-02-17 14:46:47.269295 => 2023-02-17 14:46:47.298343
[0m14:46:47.298682 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
[0m14:46:47.298880 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (execute): 2023-02-17 14:46:47.298836 => 2023-02-17 14:46:47.298845
[0m14:46:47.299265 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
[0m14:46:47.299378 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (compile): 2023-02-17 14:46:47.273853 => 2023-02-17 14:46:47.299359
[0m14:46:47.299590 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_customer_order
[0m14:46:47.299769 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
[0m14:46:47.299883 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (compile): 2023-02-17 14:46:47.280947 => 2023-02-17 14:46:47.299863
[0m14:46:47.300089 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_nation (compile): 2023-02-17 14:46:47.284897 => 2023-02-17 14:46:47.300065
[0m14:46:47.300339 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_customer_order'
[0m14:46:47.300449 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (execute): 2023-02-17 14:46:47.300427 => 2023-02-17 14:46:47.300431
[0m14:46:47.300556 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
[0m14:46:47.300654 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_nation
[0m14:46:47.300755 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_order
[0m14:46:47.301041 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
[0m14:46:47.301140 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (execute): 2023-02-17 14:46:47.301122 => 2023-02-17 14:46:47.301125
[0m14:46:47.301241 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_nation (execute): 2023-02-17 14:46:47.301221 => 2023-02-17 14:46:47.301224
[0m14:46:47.304552 [info ] [Thread-1  ]: 14:46:47 + Loading ANALYTICS.DBT_SPATEL.link_customer_order from 1 source(s)
[0m14:46:47.304775 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m14:46:47.305142 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
[0m14:46:47.305433 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_nation
[0m14:46:47.308835 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
[0m14:46:47.309143 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_inventory_allocation'
[0m14:46:47.309320 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_order_lineitem
[0m14:46:47.309553 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m14:46:47.309747 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m14:46:47.310013 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_order_lineitem'
[0m14:46:47.310234 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_cust_nation_details'
[0m14:46:47.313435 [info ] [Thread-2  ]: 14:46:47 + Loading ANALYTICS.DBT_SPATEL.link_inventory_allocation from 1 source(s)
[0m14:46:47.313694 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
[0m14:46:47.313848 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_order (compile): 2023-02-17 14:46:47.301317 => 2023-02-17 14:46:47.313811
[0m14:46:47.313979 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m14:46:47.318444 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m14:46:47.321828 [info ] [Thread-3  ]: 14:46:47 + Loading ANALYTICS.DBT_SPATEL.link_order_lineitem from 1 source(s)
[0m14:46:47.322076 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_order
[0m14:46:47.332439 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m14:46:47.336084 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m14:46:47.336348 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_order (execute): 2023-02-17 14:46:47.336298 => 2023-02-17 14:46:47.336308
[0m14:46:47.336947 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_order
[0m14:46:47.337150 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m14:46:47.337389 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_cust_region_details'
[0m14:46:47.337501 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m14:46:47.343819 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory_allocation (compile): 2023-02-17 14:46:47.310384 => 2023-02-17 14:46:47.343759
[0m14:46:47.348622 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m14:46:47.348774 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_nation_details (compile): 2023-02-17 14:46:47.322182 => 2023-02-17 14:46:47.348743
[0m14:46:47.348952 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m14:46:47.349169 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_order_lineitem (compile): 2023-02-17 14:46:47.318633 => 2023-02-17 14:46:47.349140
[0m14:46:47.349357 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m14:46:47.349486 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory_allocation (execute): 2023-02-17 14:46:47.349453 => 2023-02-17 14:46:47.349460
[0m14:46:47.349622 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
[0m14:46:47.349796 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_nation_details (execute): 2023-02-17 14:46:47.349767 => 2023-02-17 14:46:47.349772
[0m14:46:47.350238 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m14:46:47.350355 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_region_details (compile): 2023-02-17 14:46:47.337579 => 2023-02-17 14:46:47.350336
[0m14:46:47.350451 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_order_lineitem (execute): 2023-02-17 14:46:47.350426 => 2023-02-17 14:46:47.350430
[0m14:46:47.350775 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m14:46:47.350955 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m14:46:47.351117 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m14:46:47.351422 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
[0m14:46:47.351861 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m14:46:47.352129 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_customer_details'
[0m14:46:47.352235 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_region_details (execute): 2023-02-17 14:46:47.352214 => 2023-02-17 14:46:47.352217
[0m14:46:47.352376 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_order_details
[0m14:46:47.352613 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_lineitem_details'
[0m14:46:47.352724 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m14:46:47.352985 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m14:46:47.353199 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_order_details'
[0m14:46:47.353301 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m14:46:47.364667 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m14:46:47.364927 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
[0m14:46:47.365046 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
[0m14:46:47.377982 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m14:46:47.378307 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_nation'
[0m14:46:47.389988 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m14:46:47.390206 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
[0m14:46:47.390395 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_customer_details (compile): 2023-02-17 14:46:47.353376 => 2023-02-17 14:46:47.390361
[0m14:46:47.393441 [info ] [Thread-1  ]: 14:46:47 + Loading ANALYTICS.DBT_SPATEL.hub_nation from 2 source(s)
[0m14:46:47.393594 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_lineitem_details (compile): 2023-02-17 14:46:47.365172 => 2023-02-17 14:46:47.393567
[0m14:46:47.393737 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m14:46:47.397868 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
[0m14:46:47.398031 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m14:46:47.398142 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_order_details (compile): 2023-02-17 14:46:47.378395 => 2023-02-17 14:46:47.398119
[0m14:46:47.398233 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_customer_details (execute): 2023-02-17 14:46:47.398211 => 2023-02-17 14:46:47.398218
[0m14:46:47.398371 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_lineitem_details (execute): 2023-02-17 14:46:47.398352 => 2023-02-17 14:46:47.398355
[0m14:46:47.398501 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
[0m14:46:47.398841 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m14:46:47.398958 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (compile): 2023-02-17 14:46:47.390507 => 2023-02-17 14:46:47.398940
[0m14:46:47.399266 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m14:46:47.399404 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_order_details (execute): 2023-02-17 14:46:47.399371 => 2023-02-17 14:46:47.399376
[0m14:46:47.399578 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_part
[0m14:46:47.399736 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
[0m14:46:47.399869 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_region
[0m14:46:47.400166 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
[0m14:46:47.400397 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_part'
[0m14:46:47.400509 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (execute): 2023-02-17 14:46:47.400488 => 2023-02-17 14:46:47.400491
[0m14:46:47.400728 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_region'
[0m14:46:47.400895 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
[0m14:46:47.401049 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
[0m14:46:47.401353 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
[0m14:46:47.401468 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
[0m14:46:47.401702 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_supplier'
[0m14:46:47.405077 [info ] [Thread-2  ]: 14:46:47 + Loading ANALYTICS.DBT_SPATEL.hub_part from 2 source(s)
[0m14:46:47.405349 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_nation_region
[0m14:46:47.409061 [info ] [Thread-4  ]: 14:46:47 + Loading ANALYTICS.DBT_SPATEL.hub_region from 2 source(s)
[0m14:46:47.409320 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
[0m14:46:47.413573 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
[0m14:46:47.413882 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_nation_region'
[0m14:46:47.418427 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
[0m14:46:47.421498 [info ] [Thread-3  ]: 14:46:47 + Loading ANALYTICS.DBT_SPATEL.hub_supplier from 2 source(s)
[0m14:46:47.421819 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_nation_region
[0m14:46:47.422170 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (compile): 2023-02-17 14:46:47.401790 => 2023-02-17 14:46:47.422124
[0m14:46:47.426567 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
[0m14:46:47.426741 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (compile): 2023-02-17 14:46:47.405494 => 2023-02-17 14:46:47.426698
[0m14:46:47.430214 [info ] [Thread-1  ]: 14:46:47 + Loading ANALYTICS.DBT_SPATEL.link_nation_region from 2 source(s)
[0m14:46:47.430441 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
[0m14:46:47.430669 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
[0m14:46:47.435106 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
[0m14:46:47.435354 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (execute): 2023-02-17 14:46:47.435304 => 2023-02-17 14:46:47.435314
[0m14:46:47.435564 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (compile): 2023-02-17 14:46:47.418636 => 2023-02-17 14:46:47.435534
[0m14:46:47.435688 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (execute): 2023-02-17 14:46:47.435670 => 2023-02-17 14:46:47.435673
[0m14:46:47.436145 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
[0m14:46:47.436278 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
[0m14:46:47.436602 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
[0m14:46:47.436813 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (execute): 2023-02-17 14:46:47.436789 => 2023-02-17 14:46:47.436793
[0m14:46:47.436900 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_nation_region (compile): 2023-02-17 14:46:47.426893 => 2023-02-17 14:46:47.436883
[0m14:46:47.437221 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
[0m14:46:47.437342 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_nation_region
[0m14:46:47.437496 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_nation_region (execute): 2023-02-17 14:46:47.437473 => 2023-02-17 14:46:47.437476
[0m14:46:47.437760 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_nation_region
[0m14:46:47.438394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:46:47.438531 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.link_nation_region' was properly closed.
[0m14:46:47.438616 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.hub_part' was properly closed.
[0m14:46:47.438689 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.hub_region' was properly closed.
[0m14:46:47.438756 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.hub_supplier' was properly closed.
[0m14:46:47.439424 [debug] [MainThread]: Command end result
[0m14:46:47.447640 [info ] [MainThread]: Done.
[0m14:46:47.449454 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m14:46:47.449622 [info ] [MainThread]: Building catalog
[0m14:46:47.452378 [debug] [ThreadPool]: Acquiring new snowflake connection 'ANALYTICS.information_schema'
[0m14:46:47.456957 [debug] [ThreadPool]: Using snowflake connection "ANALYTICS.information_schema"
[0m14:46:47.457095 [debug] [ThreadPool]: On ANALYTICS.information_schema: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "ANALYTICS.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from ANALYTICS.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from ANALYTICS.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_spatel'))
      order by "column_index"
[0m14:46:47.457490 [debug] [ThreadPool]: Acquiring new snowflake connection 'SNOWFLAKE_SAMPLE_DATA.information_schema'
[0m14:46:47.457667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:47.460072 [debug] [ThreadPool]: Using snowflake connection "SNOWFLAKE_SAMPLE_DATA.information_schema"
[0m14:46:47.461130 [debug] [ThreadPool]: On SNOWFLAKE_SAMPLE_DATA.information_schema: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "SNOWFLAKE_SAMPLE_DATA.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from SNOWFLAKE_SAMPLE_DATA.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from SNOWFLAKE_SAMPLE_DATA.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('tpch_sf10'))
      order by "column_index"
[0m14:46:47.461293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:50.474836 [debug] [ThreadPool]: SQL status: SUCCESS 61 in 3 seconds
[0m14:46:50.495790 [debug] [ThreadPool]: On SNOWFLAKE_SAMPLE_DATA.information_schema: Close
[0m14:46:50.976335 [debug] [ThreadPool]: SQL status: SUCCESS 360 in 4 seconds
[0m14:46:51.804814 [debug] [ThreadPool]: On ANALYTICS.information_schema: Close
[0m14:46:51.947731 [info ] [MainThread]: Catalog written to /Users/shrut.patel/Source/dbtvault/target/catalog.json
[0m14:46:51.948070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111398b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113981f0>]}
[0m14:46:51.948237 [debug] [MainThread]: Flushing usage events
[0m14:46:52.354010 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:46:52.354590 [debug] [MainThread]: Connection 'ANALYTICS.information_schema' was properly closed.
[0m14:46:52.354833 [debug] [MainThread]: Connection 'SNOWFLAKE_SAMPLE_DATA.information_schema' was properly closed.


============================== 2023-02-17 14:48:01.194697 | 097d3657-869d-4f69-805c-014353be8e2d ==============================
[0m14:48:01.194697 [info ] [MainThread]: Running with dbt=1.4.0
[0m14:48:01.195827 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m14:48:01.196006 [debug] [MainThread]: Tracking: tracking
[0m14:48:01.196248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728df10>]}
[0m14:48:01.197778 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m14:48:01.197998 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m14:48:01.198152 [info ] [MainThread]: 
[0m14:48:01.198269 [info ] [MainThread]: 
[0m14:48:01.198373 [info ] [MainThread]: Press Ctrl+C to exit.
[0m14:49:22.447902 [debug] [MainThread]: Flushing usage events
[0m14:49:22.998164 [info ] [MainThread]: ctrl-c


============================== 2023-02-17 16:42:46.337182 | bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d ==============================
[0m16:42:46.337182 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:42:46.338340 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:42:46.338509 [debug] [MainThread]: Tracking: tracking
[0m16:42:46.338774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f73af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f73e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f73d60>]}
[0m16:42:46.403370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:42:46.403558 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:42:46.408227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106354640>]}
[0m16:42:46.416551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f62610>]}
[0m16:42:46.416745 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 630 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m16:42:46.416893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633af70>]}
[0m16:42:46.418167 [info ] [MainThread]: 
[0m16:42:46.418933 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:42:46.420182 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m16:42:46.428796 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m16:42:46.428983 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m16:42:46.429097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:47.202824 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m16:42:47.206440 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m16:42:47.328146 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_SPATEL'
[0m16:42:47.337693 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_SPATEL"
[0m16:42:47.337967 [debug] [ThreadPool]: On list_ANALYTICS_DBT_SPATEL: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_SPATEL"} */
show terse objects in ANALYTICS.DBT_SPATEL
[0m16:42:47.338198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:47.914452 [debug] [ThreadPool]: SQL status: SUCCESS 33 in 1 seconds
[0m16:42:47.921085 [debug] [ThreadPool]: On list_ANALYTICS_DBT_SPATEL: Close
[0m16:42:48.035220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f62700>]}
[0m16:42:48.035952 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:42:48.036253 [info ] [MainThread]: 
[0m16:42:48.041661 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.raw_orders
[0m16:42:48.042008 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_transactions
[0m16:42:48.042355 [info ] [Thread-1  ]: 1 of 31 START sql view model DBT_SPATEL.raw_orders ............................. [RUN]
[0m16:42:48.042716 [info ] [Thread-2  ]: 2 of 31 START sql view model DBT_SPATEL.raw_transactions ....................... [RUN]
[0m16:42:48.043430 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_orders'
[0m16:42:48.044040 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_transactions'
[0m16:42:48.044483 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.raw_orders
[0m16:42:48.044720 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_transactions
[0m16:42:48.050950 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
[0m16:42:48.053831 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
[0m16:42:48.054908 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_transactions (compile): 2023-02-17 16:42:48.051121 => 2023-02-17 16:42:48.054847
[0m16:42:48.055107 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_transactions
[0m16:42:48.055281 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.raw_orders (compile): 2023-02-17 16:42:48.044907 => 2023-02-17 16:42:48.055229
[0m16:42:48.074392 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.raw_orders
[0m16:42:48.077137 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.raw_transactions"
[0m16:42:48.079573 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.raw_orders"
[0m16:42:48.082503 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
[0m16:42:48.083152 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
[0m16:42:48.083254 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */
create or replace   view ANALYTICS.DBT_SPATEL.raw_orders
  
   as (
    SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
[0m16:42:48.083353 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */
create or replace   view ANALYTICS.DBT_SPATEL.raw_transactions
  
   as (
    SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS  AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
[0m16:42:48.083464 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:42:48.083559 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:42:48.842616 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:42:48.843411 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:42:48.874144 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.raw_orders (execute): 2023-02-17 16:42:48.077248 => 2023-02-17 16:42:48.874090
[0m16:42:48.876532 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_transactions (execute): 2023-02-17 16:42:48.055424 => 2023-02-17 16:42:48.876503
[0m16:42:48.876693 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: Close
[0m16:42:48.876832 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: Close
[0m16:42:48.976699 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072aeac0>]}
[0m16:42:48.977244 [info ] [Thread-2  ]: 2 of 31 OK created sql view model DBT_SPATEL.raw_transactions .................. [[32mSUCCESS 1[0m in 0.93s]
[0m16:42:48.978748 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_transactions
[0m16:42:48.979325 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.v_stg_transactions
[0m16:42:48.979669 [info ] [Thread-4  ]: 3 of 31 START sql view model DBT_SPATEL.v_stg_transactions ..................... [RUN]
[0m16:42:48.980347 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_transactions'
[0m16:42:48.980606 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
[0m16:42:49.017158 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m16:42:49.017699 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106685a90>]}
[0m16:42:49.017833 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
describe table ANALYTICS.DBT_SPATEL.raw_transactions
[0m16:42:49.018129 [info ] [Thread-1  ]: 1 of 31 OK created sql view model DBT_SPATEL.raw_orders ........................ [[32mSUCCESS 1[0m in 0.97s]
[0m16:42:49.018330 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:42:49.018553 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.raw_orders
[0m16:42:49.019777 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_inventory
[0m16:42:49.019957 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.v_stg_orders
[0m16:42:49.020145 [info ] [Thread-2  ]: 4 of 31 START sql view model DBT_SPATEL.raw_inventory .......................... [RUN]
[0m16:42:49.020490 [info ] [Thread-3  ]: 5 of 31 START sql view model DBT_SPATEL.v_stg_orders ........................... [RUN]
[0m16:42:49.021052 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_inventory'
[0m16:42:49.021341 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_orders'
[0m16:42:49.021781 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_inventory
[0m16:42:49.021927 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
[0m16:42:49.025419 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
[0m16:42:49.035133 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m16:42:49.035644 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
describe table ANALYTICS.DBT_SPATEL.raw_orders
[0m16:42:49.035765 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:42:49.037089 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_inventory (compile): 2023-02-17 16:42:49.022053 => 2023-02-17 16:42:49.037031
[0m16:42:49.037265 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_inventory
[0m16:42:49.039607 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.raw_inventory"
[0m16:42:49.041710 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
[0m16:42:49.041915 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */
create or replace   view ANALYTICS.DBT_SPATEL.raw_inventory
  
   as (
    SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PARTSUPP AS a
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN ANALYTICS.DBT_SPATEL.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
  );
[0m16:42:49.042033 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:42:49.484842 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0 seconds
[0m16:42:49.529879 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m16:42:49.530033 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
describe table ANALYTICS.DBT_SPATEL.raw_transactions
[0m16:42:49.598869 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0 seconds
[0m16:42:49.646352 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m16:42:49.647061 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_transactions (compile): 2023-02-17 16:42:48.980784 => 2023-02-17 16:42:49.647022
[0m16:42:49.647204 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
[0m16:42:49.649231 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m16:42:49.650808 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m16:42:49.650981 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
create or replace   view ANALYTICS.DBT_SPATEL.v_stg_transactions
  
   as (
    







-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM ANALYTICS.DBT_SPATEL.raw_transactions
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATEADD(DAY, 1, TRANSACTION_DATE) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS TRANSACTION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS VARCHAR))), '')) AS BINARY(16)) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
[0m16:42:49.727521 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 1 seconds
[0m16:42:49.737721 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m16:42:49.737870 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
describe table ANALYTICS.DBT_SPATEL.raw_orders
[0m16:42:49.807617 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0 seconds
[0m16:42:49.869429 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
[0m16:42:49.871204 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_orders (compile): 2023-02-17 16:42:49.025666 => 2023-02-17 16:42:49.871171
[0m16:42:49.871329 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_orders
[0m16:42:49.873232 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.v_stg_orders"
[0m16:42:49.879854 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m16:42:49.879945 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
create or replace   view ANALYTICS.DBT_SPATEL.v_stg_orders
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM ANALYTICS.DBT_SPATEL.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMERKEY AS CUSTOMER_KEY,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS REGION_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '')) AS BINARY(16)) AS ORDER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '')) AS BINARY(16)) AS PART_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
  );
[0m16:42:49.941013 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:49.942381 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_transactions (execute): 2023-02-17 16:42:49.647284 => 2023-02-17 16:42:49.942352
[0m16:42:49.942522 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: Close
[0m16:42:49.997028 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:42:49.998678 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_inventory (execute): 2023-02-17 16:42:49.037348 => 2023-02-17 16:42:49.998643
[0m16:42:49.998851 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_inventory: Close
[0m16:42:50.037392 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075255b0>]}
[0m16:42:50.037838 [info ] [Thread-4  ]: 3 of 31 OK created sql view model DBT_SPATEL.v_stg_transactions ................ [[32mSUCCESS 1[0m in 1.06s]
[0m16:42:50.038180 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
[0m16:42:50.038724 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.t_link_transactions
[0m16:42:50.039048 [info ] [Thread-1  ]: 6 of 31 START sql incremental model DBT_SPATEL.t_link_transactions ............. [RUN]
[0m16:42:50.039582 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.t_link_transactions'
[0m16:42:50.039789 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
[0m16:42:50.089320 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
[0m16:42:50.089804 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.t_link_transactions (compile): 2023-02-17 16:42:50.039929 => 2023-02-17 16:42:50.089767
[0m16:42:50.089940 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.t_link_transactions
[0m16:42:50.110184 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m16:42:50.110364 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.t_link_transactions__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_transactions
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    LEFT JOIN ANALYTICS.DBT_SPATEL.t_link_transactions AS tgt
    ON stg.TRANSACTION_PK = tgt.TRANSACTION_PK
    WHERE tgt.TRANSACTION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:42:50.110462 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:42:50.111383 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107525e20>]}
[0m16:42:50.111604 [info ] [Thread-2  ]: 4 of 31 OK created sql view model DBT_SPATEL.raw_inventory ..................... [[32mSUCCESS 1[0m in 1.09s]
[0m16:42:50.111793 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_inventory
[0m16:42:50.112104 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.v_stg_inventory
[0m16:42:50.112246 [info ] [Thread-4  ]: 7 of 31 START sql view model DBT_SPATEL.v_stg_inventory ........................ [RUN]
[0m16:42:50.112526 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_inventory'
[0m16:42:50.112631 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
[0m16:42:50.120403 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m16:42:50.120815 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
describe table ANALYTICS.DBT_SPATEL.raw_inventory
[0m16:42:50.121047 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:42:50.379212 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:50.380511 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_orders (execute): 2023-02-17 16:42:49.871402 => 2023-02-17 16:42:50.380478
[0m16:42:50.380640 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: Close
[0m16:42:50.470902 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106685430>]}
[0m16:42:50.471279 [info ] [Thread-3  ]: 5 of 31 OK created sql view model DBT_SPATEL.v_stg_orders ...................... [[32mSUCCESS 1[0m in 1.45s]
[0m16:42:50.471572 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_orders
[0m16:42:50.472092 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
[0m16:42:50.472299 [info ] [Thread-2  ]: 8 of 31 START sql incremental model DBT_SPATEL.hub_customer .................... [RUN]
[0m16:42:50.472680 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_customer'
[0m16:42:50.472873 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
[0m16:42:50.473023 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
[0m16:42:50.473218 [info ] [Thread-3  ]: 9 of 31 START sql incremental model DBT_SPATEL.hub_lineitem .................... [RUN]
[0m16:42:50.486790 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_lineitem'
[0m16:42:50.488289 [info ] [Thread-2  ]: 16:42:50 + Loading ANALYTICS.DBT_SPATEL.hub_customer from 1 source(s)
[0m16:42:50.488494 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
[0m16:42:50.500581 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
[0m16:42:50.504239 [info ] [Thread-3  ]: 16:42:50 + Loading ANALYTICS.DBT_SPATEL.hub_lineitem from 1 source(s)
[0m16:42:50.507645 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:42:50.507977 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (compile): 2023-02-17 16:42:50.500814 => 2023-02-17 16:42:50.507938
[0m16:42:50.508117 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
[0m16:42:50.511301 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:42:50.511486 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (compile): 2023-02-17 16:42:50.473383 => 2023-02-17 16:42:50.511443
[0m16:42:50.511593 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.hub_lineitem__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN ANALYTICS.DBT_SPATEL.hub_lineitem AS d
    ON a.LINEITEM_PK = d.LINEITEM_PK
    WHERE d.LINEITEM_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:42:50.511736 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
[0m16:42:50.511841 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:42:50.514640 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m16:42:50.515404 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.hub_customer__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN ANALYTICS.DBT_SPATEL.hub_customer AS d
    ON a.CUSTOMER_PK = d.CUSTOMER_PK
    WHERE d.CUSTOMER_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:42:50.516022 [debug] [Thread-4  ]: SQL status: SUCCESS 24 in 0 seconds
[0m16:42:50.516150 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:42:50.522397 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m16:42:50.523327 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
describe table ANALYTICS.DBT_SPATEL.raw_inventory
[0m16:42:50.641573 [debug] [Thread-4  ]: SQL status: SUCCESS 24 in 0 seconds
[0m16:42:50.747172 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:42:50.767860 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m16:42:50.774269 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
describe table ANALYTICS.DBT_SPATEL.t_link_transactions__dbt_tmp
[0m16:42:50.782516 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m16:42:50.822253 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_inventory (compile): 2023-02-17 16:42:50.112704 => 2023-02-17 16:42:50.822210
[0m16:42:50.822408 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
[0m16:42:50.824291 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m16:42:50.831152 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m16:42:50.831268 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
create or replace   view ANALYTICS.DBT_SPATEL.v_stg_inventory
  
   as (
    








WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM ANALYTICS.DBT_SPATEL.raw_inventory
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS NATION_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_SUPPLIER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '')) AS BINARY(16)) AS PART_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS PART_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_REGION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_NATION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging
  );
[0m16:42:50.924320 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0 seconds
[0m16:42:50.927330 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m16:42:50.927470 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
describe table ANALYTICS.DBT_SPATEL.t_link_transactions
[0m16:42:51.009159 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0 seconds
[0m16:42:51.017607 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m16:42:51.017782 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
describe table "ANALYTICS"."DBT_SPATEL"."T_LINK_TRANSACTIONS"
[0m16:42:51.097006 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0 seconds
[0m16:42:51.117447 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.t_link_transactions"
[0m16:42:51.118693 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m16:42:51.118877 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
-- back compat for old kwarg name
  
  begin;
[0m16:42:51.201692 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:51.202196 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m16:42:51.202458 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
insert into ANALYTICS.DBT_SPATEL.t_link_transactions ("TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.t_link_transactions__dbt_tmp
        );
[0m16:42:51.306357 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:42:51.314010 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m16:42:51.314225 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
describe table ANALYTICS.DBT_SPATEL.hub_customer__dbt_tmp
[0m16:42:51.333051 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:42:51.336097 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:42:51.336286 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
describe table ANALYTICS.DBT_SPATEL.hub_lineitem__dbt_tmp
[0m16:42:51.395652 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:42:51.400387 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m16:42:51.400667 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
describe table ANALYTICS.DBT_SPATEL.hub_customer
[0m16:42:51.401960 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:42:51.404910 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_inventory (execute): 2023-02-17 16:42:50.822489 => 2023-02-17 16:42:51.404836
[0m16:42:51.405177 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: Close
[0m16:42:51.419169 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:42:51.423317 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:42:51.423525 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
describe table ANALYTICS.DBT_SPATEL.hub_lineitem
[0m16:42:51.497873 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:42:51.505782 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m16:42:51.506853 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
describe table "ANALYTICS"."DBT_SPATEL"."HUB_CUSTOMER"
[0m16:42:51.508402 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:42:51.515130 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:42:51.515939 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075dc070>]}
[0m16:42:51.516124 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
describe table "ANALYTICS"."DBT_SPATEL"."HUB_LINEITEM"
[0m16:42:51.516591 [info ] [Thread-4  ]: 7 of 31 OK created sql view model DBT_SPATEL.v_stg_inventory ................... [[32mSUCCESS 1[0m in 1.40s]
[0m16:42:51.518382 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
[0m16:42:51.518850 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_order
[0m16:42:51.519305 [info ] [Thread-4  ]: 10 of 31 START sql incremental model DBT_SPATEL.hub_order ...................... [RUN]
[0m16:42:51.520599 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_order'
[0m16:42:51.521113 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
[0m16:42:51.526642 [info ] [Thread-4  ]: 16:42:51 + Loading ANALYTICS.DBT_SPATEL.hub_order from 1 source(s)
[0m16:42:51.531799 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
[0m16:42:51.533137 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (compile): 2023-02-17 16:42:51.521269 => 2023-02-17 16:42:51.533079
[0m16:42:51.533362 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
[0m16:42:51.537125 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m16:42:51.537425 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.hub_order__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN ANALYTICS.DBT_SPATEL.hub_order AS d
    ON a.ORDER_PK = d.ORDER_PK
    WHERE d.ORDER_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:42:51.537559 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:42:51.596792 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:42:51.599093 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_customer"
[0m16:42:51.599782 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m16:42:51.599923 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
-- back compat for old kwarg name
  
  begin;
[0m16:42:51.635653 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:42:51.643388 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:42:51.668371 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:42:51.668469 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
-- back compat for old kwarg name
  
  begin;
[0m16:42:51.698613 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:51.698766 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m16:42:51.698856 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
insert into ANALYTICS.DBT_SPATEL.hub_customer ("CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.hub_customer__dbt_tmp
        );
[0m16:42:51.762101 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:51.762310 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:42:51.762421 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
insert into ANALYTICS.DBT_SPATEL.hub_lineitem ("LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.hub_lineitem__dbt_tmp
        );
[0m16:42:52.117925 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:42:52.127218 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m16:42:52.127476 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
describe table ANALYTICS.DBT_SPATEL.hub_order__dbt_tmp
[0m16:42:52.204584 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:42:52.210114 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m16:42:52.210360 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
describe table ANALYTICS.DBT_SPATEL.hub_order
[0m16:42:52.291671 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:42:52.302285 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m16:42:52.302682 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
describe table "ANALYTICS"."DBT_SPATEL"."HUB_ORDER"
[0m16:42:52.391707 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:42:52.397377 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_order"
[0m16:42:52.399407 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m16:42:52.399733 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
-- back compat for old kwarg name
  
  begin;
[0m16:42:52.494989 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:52.496463 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m16:42:52.497005 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
insert into ANALYTICS.DBT_SPATEL.hub_order ("ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.hub_order__dbt_tmp
        );
[0m16:42:54.067934 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 3 seconds
[0m16:42:54.069378 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m16:42:54.069852 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
COMMIT
[0m16:42:54.291081 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:54.307113 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m16:42:54.307426 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
drop view if exists ANALYTICS.DBT_SPATEL.t_link_transactions__dbt_tmp cascade
[0m16:42:54.408460 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:54.422003 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.t_link_transactions (execute): 2023-02-17 16:42:50.090023 => 2023-02-17 16:42:54.421900
[0m16:42:54.422359 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.t_link_transactions: Close
[0m16:42:54.534695 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072bd8b0>]}
[0m16:42:54.535430 [info ] [Thread-1  ]: 6 of 31 OK created sql incremental model DBT_SPATEL.t_link_transactions ........ [[32mSUCCESS 0[0m in 4.50s]
[0m16:42:54.535971 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.t_link_transactions
[0m16:42:54.536434 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_customer_nation
[0m16:42:54.537012 [info ] [Thread-1  ]: 11 of 31 START sql incremental model DBT_SPATEL.link_customer_nation ........... [RUN]
[0m16:42:54.537948 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_customer_nation'
[0m16:42:54.538291 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
[0m16:42:54.550363 [info ] [Thread-1  ]: 16:42:54 + Loading ANALYTICS.DBT_SPATEL.link_customer_nation from 1 source(s)
[0m16:42:54.571879 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
[0m16:42:54.572906 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_nation (compile): 2023-02-17 16:42:54.538522 => 2023-02-17 16:42:54.572845
[0m16:42:54.573110 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_nation
[0m16:42:54.577107 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m16:42:54.577312 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.link_customer_nation__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN ANALYTICS.DBT_SPATEL.link_customer_nation AS d
    ON a.LINK_CUSTOMER_NATION_PK = d.LINK_CUSTOMER_NATION_PK
    WHERE d.LINK_CUSTOMER_NATION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:42:54.577433 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:42:55.189282 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:42:55.194396 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m16:42:55.194612 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
describe table ANALYTICS.DBT_SPATEL.link_customer_nation__dbt_tmp
[0m16:42:55.267444 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:42:55.274046 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m16:42:55.274274 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
describe table ANALYTICS.DBT_SPATEL.link_customer_nation
[0m16:42:55.399462 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:42:55.408716 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m16:42:55.409094 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
describe table "ANALYTICS"."DBT_SPATEL"."LINK_CUSTOMER_NATION"
[0m16:42:55.503111 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:42:55.510786 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_customer_nation"
[0m16:42:55.512583 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m16:42:55.512809 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
-- back compat for old kwarg name
  
  begin;
[0m16:42:55.613088 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:55.614399 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m16:42:55.614934 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
insert into ANALYTICS.DBT_SPATEL.link_customer_nation ("LINK_CUSTOMER_NATION_PK", "CUSTOMER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_CUSTOMER_NATION_PK", "CUSTOMER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.link_customer_nation__dbt_tmp
        );
[0m16:42:56.320174 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 5 seconds
[0m16:42:56.321953 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m16:42:56.322606 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 5 seconds
[0m16:42:56.322838 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
COMMIT
[0m16:42:56.323816 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 4 seconds
[0m16:42:56.324082 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:42:56.325314 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m16:42:56.325626 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
COMMIT
[0m16:42:56.325837 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
COMMIT
[0m16:42:56.626472 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:56.627364 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:56.634536 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:56.636350 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:42:56.639907 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m16:42:56.643288 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m16:42:56.643506 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
drop view if exists ANALYTICS.DBT_SPATEL.hub_lineitem__dbt_tmp cascade
[0m16:42:56.643677 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
drop view if exists ANALYTICS.DBT_SPATEL.hub_order__dbt_tmp cascade
[0m16:42:56.643858 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
drop view if exists ANALYTICS.DBT_SPATEL.hub_customer__dbt_tmp cascade
[0m16:42:56.789026 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:56.792897 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (execute): 2023-02-17 16:42:51.533548 => 2023-02-17 16:42:56.792790
[0m16:42:56.793290 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: Close
[0m16:42:56.797669 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:56.800734 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (execute): 2023-02-17 16:42:50.508194 => 2023-02-17 16:42:56.800682
[0m16:42:56.801207 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: Close
[0m16:42:56.806437 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:56.809063 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (execute): 2023-02-17 16:42:50.511925 => 2023-02-17 16:42:56.809016
[0m16:42:56.809548 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: Close
[0m16:42:56.924774 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fc1760>]}
[0m16:42:56.925606 [info ] [Thread-3  ]: 9 of 31 OK created sql incremental model DBT_SPATEL.hub_lineitem ............... [[32mSUCCESS 0[0m in 6.44s]
[0m16:42:56.926020 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
[0m16:42:56.926370 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_customer_order
[0m16:42:56.926833 [info ] [Thread-3  ]: 12 of 31 START sql incremental model DBT_SPATEL.link_customer_order ............ [RUN]
[0m16:42:56.927579 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_customer_order'
[0m16:42:56.927848 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_order
[0m16:42:56.928535 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fc1340>]}
[0m16:42:56.934745 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11305e6a0>]}
[0m16:42:56.935394 [info ] [Thread-3  ]: 16:42:56 + Loading ANALYTICS.DBT_SPATEL.link_customer_order from 1 source(s)
[0m16:42:56.935913 [info ] [Thread-4  ]: 10 of 31 OK created sql incremental model DBT_SPATEL.hub_order ................. [[32mSUCCESS 0[0m in 5.41s]
[0m16:42:56.942138 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
[0m16:42:56.936355 [info ] [Thread-2  ]: 8 of 31 OK created sql incremental model DBT_SPATEL.hub_customer ............... [[32mSUCCESS 0[0m in 6.46s]
[0m16:42:56.942686 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
[0m16:42:56.943003 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
[0m16:42:56.943284 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m16:42:56.943621 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_order_lineitem
[0m16:42:56.943942 [info ] [Thread-4  ]: 13 of 31 START sql incremental model DBT_SPATEL.link_inventory_allocation ...... [RUN]
[0m16:42:56.944243 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_order (compile): 2023-02-17 16:42:56.928755 => 2023-02-17 16:42:56.944193
[0m16:42:56.944455 [info ] [Thread-2  ]: 14 of 31 START sql incremental model DBT_SPATEL.link_order_lineitem ............ [RUN]
[0m16:42:56.944921 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_inventory_allocation'
[0m16:42:56.945100 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_order
[0m16:42:56.945434 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_order_lineitem'
[0m16:42:56.945601 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m16:42:56.949866 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m16:42:56.950093 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
[0m16:42:56.955279 [info ] [Thread-4  ]: 16:42:56 + Loading ANALYTICS.DBT_SPATEL.link_inventory_allocation from 1 source(s)
[0m16:42:56.955514 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.link_customer_order__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN ANALYTICS.DBT_SPATEL.link_customer_order AS d
    ON a.ORDER_CUSTOMER_PK = d.ORDER_CUSTOMER_PK
    WHERE d.ORDER_CUSTOMER_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:42:56.959040 [info ] [Thread-2  ]: 16:42:56 + Loading ANALYTICS.DBT_SPATEL.link_order_lineitem from 1 source(s)
[0m16:42:56.963207 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m16:42:56.963353 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:42:56.967223 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m16:42:56.968606 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory_allocation (compile): 2023-02-17 16:42:56.950223 => 2023-02-17 16:42:56.968540
[0m16:42:56.968803 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m16:42:56.972357 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m16:42:56.972766 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_order_lineitem (compile): 2023-02-17 16:42:56.955629 => 2023-02-17 16:42:56.972715
[0m16:42:56.972890 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.link_inventory_allocation__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN ANALYTICS.DBT_SPATEL.link_inventory_allocation AS d
    ON a.INVENTORY_ALLOCATION_PK = d.INVENTORY_ALLOCATION_PK
    WHERE d.INVENTORY_ALLOCATION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:42:56.973186 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
[0m16:42:56.973351 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:42:56.976678 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m16:42:56.977431 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.link_order_lineitem__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN ANALYTICS.DBT_SPATEL.link_order_lineitem AS d
    ON a.LINK_LINEITEM_ORDER_PK = d.LINK_LINEITEM_ORDER_PK
    WHERE d.LINK_LINEITEM_ORDER_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:42:56.977811 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:42:57.303774 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 2 seconds
[0m16:42:57.303990 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m16:42:57.304084 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
COMMIT
[0m16:42:57.554561 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:57.560321 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m16:42:57.560591 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
drop view if exists ANALYTICS.DBT_SPATEL.link_customer_nation__dbt_tmp cascade
[0m16:42:57.654101 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:57.657389 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_nation (execute): 2023-02-17 16:42:54.573221 => 2023-02-17 16:42:57.657296
[0m16:42:57.657706 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_nation: Close
[0m16:42:57.676775 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:42:57.681308 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m16:42:57.681522 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
describe table ANALYTICS.DBT_SPATEL.link_inventory_allocation__dbt_tmp
[0m16:42:57.772146 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0 seconds
[0m16:42:57.780274 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m16:42:57.781205 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
describe table ANALYTICS.DBT_SPATEL.link_inventory_allocation
[0m16:42:57.784608 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fd7f40>]}
[0m16:42:57.785528 [info ] [Thread-1  ]: 11 of 31 OK created sql incremental model DBT_SPATEL.link_customer_nation ...... [[32mSUCCESS 0[0m in 3.25s]
[0m16:42:57.786127 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_nation
[0m16:42:57.786913 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m16:42:57.787504 [info ] [Thread-1  ]: 15 of 31 START sql incremental model DBT_SPATEL.sat_order_cust_nation_details .. [RUN]
[0m16:42:57.788192 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_cust_nation_details'
[0m16:42:57.788452 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m16:42:57.833297 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m16:42:57.833913 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_nation_details (compile): 2023-02-17 16:42:57.788606 => 2023-02-17 16:42:57.833871
[0m16:42:57.834090 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m16:42:57.837754 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m16:42:57.837859 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.sat_order_cust_nation_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.CUSTOMER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM ANALYTICS.DBT_SPATEL.sat_order_cust_nation_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
        AND latest_records.CUSTOMER_NATION_HASHDIFF = stage.CUSTOMER_NATION_HASHDIFF
    WHERE latest_records.CUSTOMER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:42:57.837955 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:42:57.920561 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:42:57.923690 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m16:42:57.923880 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
describe table ANALYTICS.DBT_SPATEL.link_order_lineitem__dbt_tmp
[0m16:42:57.930923 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0 seconds
[0m16:42:57.933391 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m16:42:57.938889 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
describe table "ANALYTICS"."DBT_SPATEL"."LINK_INVENTORY_ALLOCATION"
[0m16:42:57.946039 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:42:57.953148 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m16:42:57.966015 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
describe table ANALYTICS.DBT_SPATEL.link_customer_order__dbt_tmp
[0m16:42:58.069500 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:42:58.072212 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m16:42:58.072338 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
describe table ANALYTICS.DBT_SPATEL.link_order_lineitem
[0m16:42:58.104024 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0 seconds
[0m16:42:58.106072 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m16:42:58.106399 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:42:58.108976 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m16:42:58.109105 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
describe table ANALYTICS.DBT_SPATEL.link_customer_order
[0m16:42:58.110169 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m16:42:58.110444 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
-- back compat for old kwarg name
  
  begin;
[0m16:42:58.188772 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:42:58.193563 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m16:42:58.193735 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
describe table "ANALYTICS"."DBT_SPATEL"."LINK_CUSTOMER_ORDER"
[0m16:42:58.199863 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:58.200071 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m16:42:58.200208 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
insert into ANALYTICS.DBT_SPATEL.link_inventory_allocation ("INVENTORY_ALLOCATION_PK", "PART_PK", "SUPPLIER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_ALLOCATION_PK", "PART_PK", "SUPPLIER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.link_inventory_allocation__dbt_tmp
        );
[0m16:42:58.270644 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:42:58.274097 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_customer_order"
[0m16:42:58.275321 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m16:42:58.275545 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
-- back compat for old kwarg name
  
  begin;
[0m16:42:58.313290 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:42:58.320223 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m16:42:58.320526 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
describe table "ANALYTICS"."DBT_SPATEL"."LINK_ORDER_LINEITEM"
[0m16:42:58.365139 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:58.365974 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m16:42:58.366297 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
insert into ANALYTICS.DBT_SPATEL.link_customer_order ("ORDER_CUSTOMER_PK", "CUSTOMER_PK", "ORDER_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_CUSTOMER_PK", "CUSTOMER_PK", "ORDER_PK", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.link_customer_order__dbt_tmp
        );
[0m16:42:58.404947 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:42:58.412653 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m16:42:58.414387 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m16:42:58.414671 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
-- back compat for old kwarg name
  
  begin;
[0m16:42:58.515681 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:58.516985 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m16:42:58.517521 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
insert into ANALYTICS.DBT_SPATEL.link_order_lineitem ("LINK_LINEITEM_ORDER_PK", "ORDER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_LINEITEM_ORDER_PK", "ORDER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.link_order_lineitem__dbt_tmp
        );
[0m16:42:58.676475 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:42:58.685755 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m16:42:58.685933 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_order_cust_nation_details__dbt_tmp
[0m16:42:58.769622 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m16:42:58.773503 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m16:42:58.773683 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_order_cust_nation_details
[0m16:42:58.850936 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m16:42:58.855882 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m16:42:58.856119 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
describe table "ANALYTICS"."DBT_SPATEL"."SAT_ORDER_CUST_NATION_DETAILS"
[0m16:42:58.925840 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m16:42:58.932770 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m16:42:58.934511 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m16:42:58.934756 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
-- back compat for old kwarg name
  
  begin;
[0m16:42:59.026773 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:42:59.028209 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m16:42:59.028759 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
insert into ANALYTICS.DBT_SPATEL.sat_order_cust_nation_details ("CUSTOMER_PK", "CUSTOMER_NATION_HASHDIFF", "CUSTOMER_NATION_NAME", "CUSTOMER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_NATION_HASHDIFF", "CUSTOMER_NATION_NAME", "CUSTOMER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.sat_order_cust_nation_details__dbt_tmp
        );
[0m16:43:00.022156 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 2 seconds
[0m16:43:00.023796 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m16:43:00.024087 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
COMMIT
[0m16:43:00.267247 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:00.274965 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m16:43:00.275255 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
drop view if exists ANALYTICS.DBT_SPATEL.link_customer_order__dbt_tmp cascade
[0m16:43:00.388619 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:00.392440 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_order (execute): 2023-02-17 16:42:56.945769 => 2023-02-17 16:43:00.392332
[0m16:43:00.392766 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_order: Close
[0m16:43:00.397879 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 2 seconds
[0m16:43:00.398387 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m16:43:00.398792 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
COMMIT
[0m16:43:00.514250 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f759d0>]}
[0m16:43:00.515001 [info ] [Thread-3  ]: 12 of 31 OK created sql incremental model DBT_SPATEL.link_customer_order ....... [[32mSUCCESS 0[0m in 3.59s]
[0m16:43:00.515567 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_order
[0m16:43:00.516015 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m16:43:00.516415 [info ] [Thread-3  ]: 16 of 31 START sql incremental model DBT_SPATEL.sat_order_cust_region_details .. [RUN]
[0m16:43:00.517471 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_cust_region_details'
[0m16:43:00.517822 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m16:43:00.536942 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m16:43:00.537511 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_region_details (compile): 2023-02-17 16:43:00.518019 => 2023-02-17 16:43:00.537461
[0m16:43:00.537700 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m16:43:00.542736 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m16:43:00.542943 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.sat_order_cust_region_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_REGION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.CUSTOMER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM ANALYTICS.DBT_SPATEL.sat_order_cust_region_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
        AND latest_records.CUSTOMER_REGION_HASHDIFF = stage.CUSTOMER_REGION_HASHDIFF
    WHERE latest_records.CUSTOMER_REGION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:43:00.543089 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:43:00.650456 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:00.658869 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m16:43:00.665259 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
drop view if exists ANALYTICS.DBT_SPATEL.link_order_lineitem__dbt_tmp cascade
[0m16:43:00.867451 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:00.869816 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_order_lineitem (execute): 2023-02-17 16:42:56.973445 => 2023-02-17 16:43:00.869750
[0m16:43:00.870047 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: Close
[0m16:43:00.999142 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130d4700>]}
[0m16:43:00.999720 [info ] [Thread-2  ]: 14 of 31 OK created sql incremental model DBT_SPATEL.link_order_lineitem ....... [[32mSUCCESS 0[0m in 4.05s]
[0m16:43:01.000163 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
[0m16:43:01.000527 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m16:43:01.000862 [info ] [Thread-2  ]: 17 of 31 START sql incremental model DBT_SPATEL.sat_order_customer_details ..... [RUN]
[0m16:43:01.001658 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_customer_details'
[0m16:43:01.001936 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m16:43:01.021957 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m16:43:01.022613 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_customer_details (compile): 2023-02-17 16:43:01.002096 => 2023-02-17 16:43:01.022562
[0m16:43:01.022796 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m16:43:01.027337 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m16:43:01.027484 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.sat_order_customer_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.CUSTOMER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM ANALYTICS.DBT_SPATEL.sat_order_customer_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
        AND latest_records.CUSTOMER_HASHDIFF = stage.CUSTOMER_HASHDIFF
    WHERE latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:43:01.027609 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:43:01.273240 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 3 seconds
[0m16:43:01.273504 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m16:43:01.273631 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
COMMIT
[0m16:43:01.540213 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:43:01.541870 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 3 seconds
[0m16:43:01.549538 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:01.548916 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m16:43:01.549941 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m16:43:01.553865 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m16:43:01.554080 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_order_cust_region_details__dbt_tmp
[0m16:43:01.554249 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
COMMIT
[0m16:43:01.554406 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
drop view if exists ANALYTICS.DBT_SPATEL.link_inventory_allocation__dbt_tmp cascade
[0m16:43:01.618141 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:43:01.622990 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m16:43:01.623282 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_order_customer_details__dbt_tmp
[0m16:43:01.645750 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 0 seconds
[0m16:43:01.652004 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m16:43:01.652259 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_order_cust_region_details
[0m16:43:01.709054 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0 seconds
[0m16:43:01.716737 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m16:43:01.717030 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_order_customer_details
[0m16:43:01.738860 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 0 seconds
[0m16:43:01.746783 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m16:43:01.747039 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
describe table "ANALYTICS"."DBT_SPATEL"."SAT_ORDER_CUST_REGION_DETAILS"
[0m16:43:01.769059 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:01.771738 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory_allocation (execute): 2023-02-17 16:42:56.968903 => 2023-02-17 16:43:01.771647
[0m16:43:01.772026 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
[0m16:43:01.825181 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 0 seconds
[0m16:43:01.831606 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m16:43:01.833247 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m16:43:01.833497 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
-- back compat for old kwarg name
  
  begin;
[0m16:43:01.922065 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:01.922438 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m16:43:01.922646 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
insert into ANALYTICS.DBT_SPATEL.sat_order_cust_region_details ("CUSTOMER_PK", "CUSTOMER_REGION_HASHDIFF", "CUSTOMER_REGION_NAME", "CUSTOMER_REGION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_REGION_HASHDIFF", "CUSTOMER_REGION_NAME", "CUSTOMER_REGION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.sat_order_cust_region_details__dbt_tmp
        );
[0m16:43:01.926049 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0 seconds
[0m16:43:01.932056 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m16:43:01.932327 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
describe table "ANALYTICS"."DBT_SPATEL"."SAT_ORDER_CUSTOMER_DETAILS"
[0m16:43:01.943349 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130851f0>]}
[0m16:43:01.943888 [info ] [Thread-4  ]: 13 of 31 OK created sql incremental model DBT_SPATEL.link_inventory_allocation . [[32mSUCCESS 0[0m in 5.00s]
[0m16:43:01.944286 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m16:43:01.944614 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m16:43:01.944887 [info ] [Thread-4  ]: 18 of 31 START sql incremental model DBT_SPATEL.sat_order_lineitem_details ..... [RUN]
[0m16:43:01.945596 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_lineitem_details'
[0m16:43:01.945864 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m16:43:01.966475 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m16:43:01.967133 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_lineitem_details (compile): 2023-02-17 16:43:01.946023 => 2023-02-17 16:43:01.967083
[0m16:43:01.967302 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m16:43:01.972172 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m16:43:01.972383 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.sat_order_lineitem_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

latest_records AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.LINEITEM_PK, current_records.LINEITEM_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.LINEITEM_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM ANALYTICS.DBT_SPATEL.sat_order_lineitem_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.LINEITEM_PK
                FROM source_data
            ) AS source_records
                ON current_records.LINEITEM_PK = source_records.LINEITEM_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.LINEITEM_PK = stage.LINEITEM_PK
        AND latest_records.LINEITEM_HASHDIFF = stage.LINEITEM_HASHDIFF
    WHERE latest_records.LINEITEM_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:43:01.972494 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:43:02.005791 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0 seconds
[0m16:43:02.007933 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m16:43:02.008625 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m16:43:02.008738 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
-- back compat for old kwarg name
  
  begin;
[0m16:43:02.075431 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:43:02.083337 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m16:43:02.083462 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
drop view if exists ANALYTICS.DBT_SPATEL.sat_order_cust_nation_details__dbt_tmp cascade
[0m16:43:02.096949 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:02.097100 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m16:43:02.097198 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
insert into ANALYTICS.DBT_SPATEL.sat_order_customer_details ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.sat_order_customer_details__dbt_tmp
        );
[0m16:43:02.200477 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:02.201931 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_nation_details (execute): 2023-02-17 16:42:57.834186 => 2023-02-17 16:43:02.201895
[0m16:43:02.202113 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
[0m16:43:02.305486 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107230f10>]}
[0m16:43:02.305988 [info ] [Thread-1  ]: 15 of 31 OK created sql incremental model DBT_SPATEL.sat_order_cust_nation_details  [[32mSUCCESS 0[0m in 4.52s]
[0m16:43:02.307300 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m16:43:02.307649 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_order_details
[0m16:43:02.308391 [info ] [Thread-1  ]: 19 of 31 START sql incremental model DBT_SPATEL.sat_order_order_details ........ [RUN]
[0m16:43:02.309161 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_order_details'
[0m16:43:02.309599 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
[0m16:43:02.329277 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m16:43:02.330018 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_order_details (compile): 2023-02-17 16:43:02.309762 => 2023-02-17 16:43:02.329968
[0m16:43:02.330201 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
[0m16:43:02.334694 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m16:43:02.335047 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.sat_order_order_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS a
    WHERE a.ORDER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.ORDER_PK, current_records.ORDER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.ORDER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM ANALYTICS.DBT_SPATEL.sat_order_order_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.ORDER_PK
                FROM source_data
            ) AS source_records
                ON current_records.ORDER_PK = source_records.ORDER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.ORDER_PK = stage.ORDER_PK
        AND latest_records.ORDER_HASHDIFF = stage.ORDER_HASHDIFF
    WHERE latest_records.ORDER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:43:02.335379 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:43:02.674505 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:43:02.679659 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m16:43:02.679917 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_order_lineitem_details__dbt_tmp
[0m16:43:02.759830 [debug] [Thread-4  ]: SQL status: SUCCESS 16 in 0 seconds
[0m16:43:02.769186 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m16:43:02.769412 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_order_lineitem_details
[0m16:43:02.928675 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:43:02.937912 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m16:43:02.938166 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_order_order_details__dbt_tmp
[0m16:43:02.981788 [debug] [Thread-4  ]: SQL status: SUCCESS 16 in 0 seconds
[0m16:43:02.987992 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m16:43:02.988235 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
describe table "ANALYTICS"."DBT_SPATEL"."SAT_ORDER_LINEITEM_DETAILS"
[0m16:43:03.076117 [debug] [Thread-4  ]: SQL status: SUCCESS 16 in 0 seconds
[0m16:43:03.084733 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m16:43:03.087262 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m16:43:03.087497 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
-- back compat for old kwarg name
  
  begin;
[0m16:43:03.167962 [debug] [Thread-1  ]: SQL status: SUCCESS 12 in 0 seconds
[0m16:43:03.178263 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m16:43:03.178611 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_order_order_details
[0m16:43:03.221541 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:03.222325 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m16:43:03.222590 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
insert into ANALYTICS.DBT_SPATEL.sat_order_lineitem_details ("LINEITEM_PK", "LINEITEM_HASHDIFF", "COMMITDATE", "DISCOUNT", "EXTENDEDPRICE", "LINE_COMMENT", "QUANTITY", "RECEIPTDATE", "RETURNFLAG", "SHIPDATE", "SHIPINSTRUCT", "SHIPMODE", "TAX", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINEITEM_HASHDIFF", "COMMITDATE", "DISCOUNT", "EXTENDEDPRICE", "LINE_COMMENT", "QUANTITY", "RECEIPTDATE", "RETURNFLAG", "SHIPDATE", "SHIPINSTRUCT", "SHIPMODE", "TAX", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.sat_order_lineitem_details__dbt_tmp
        );
[0m16:43:03.266628 [debug] [Thread-1  ]: SQL status: SUCCESS 12 in 0 seconds
[0m16:43:03.271410 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m16:43:03.271637 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
describe table "ANALYTICS"."DBT_SPATEL"."SAT_ORDER_ORDER_DETAILS"
[0m16:43:03.361752 [debug] [Thread-1  ]: SQL status: SUCCESS 12 in 0 seconds
[0m16:43:03.365028 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m16:43:03.366077 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m16:43:03.366247 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m16:43:03.570103 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:03.571225 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m16:43:03.571856 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
insert into ANALYTICS.DBT_SPATEL.sat_order_order_details ("ORDER_PK", "ORDER_HASHDIFF", "ORDERSTATUS", "TOTALPRICE", "ORDERDATE", "ORDERPRIORITY", "CLERK", "SHIPPRIORITY", "ORDER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDER_HASHDIFF", "ORDERSTATUS", "TOTALPRICE", "ORDERDATE", "ORDERPRIORITY", "CLERK", "SHIPPRIORITY", "ORDER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.sat_order_order_details__dbt_tmp
        );
[0m16:43:04.307474 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 2 seconds
[0m16:43:04.309502 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m16:43:04.309993 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
COMMIT
[0m16:43:04.715963 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:04.725998 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m16:43:04.726402 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
drop view if exists ANALYTICS.DBT_SPATEL.sat_order_cust_region_details__dbt_tmp cascade
[0m16:43:04.833483 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:04.839812 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_region_details (execute): 2023-02-17 16:43:00.537826 => 2023-02-17 16:43:04.839713
[0m16:43:04.840158 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
[0m16:43:04.949091 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eb8700>]}
[0m16:43:04.949829 [info ] [Thread-3  ]: 16 of 31 OK created sql incremental model DBT_SPATEL.sat_order_cust_region_details  [[32mSUCCESS 0[0m in 4.43s]
[0m16:43:04.950390 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m16:43:04.950867 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
[0m16:43:04.951436 [info ] [Thread-3  ]: 20 of 31 START sql incremental model DBT_SPATEL.hub_nation ..................... [RUN]
[0m16:43:04.952356 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_nation'
[0m16:43:04.952702 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
[0m16:43:04.960447 [info ] [Thread-3  ]: 16:43:04 + Loading ANALYTICS.DBT_SPATEL.hub_nation from 2 source(s)
[0m16:43:04.969081 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
[0m16:43:04.969746 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (compile): 2023-02-17 16:43:04.952888 => 2023-02-17 16:43:04.969686
[0m16:43:04.969955 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
[0m16:43:04.974578 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m16:43:04.974761 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.hub_nation__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN ANALYTICS.DBT_SPATEL.hub_nation AS d
    ON a.NATION_PK = d.NATION_PK
    WHERE d.NATION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:43:04.974871 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:43:05.117457 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 3 seconds
[0m16:43:05.117678 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m16:43:05.117767 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
COMMIT
[0m16:43:05.532701 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:05.543307 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m16:43:05.543654 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
drop view if exists ANALYTICS.DBT_SPATEL.sat_order_customer_details__dbt_tmp cascade
[0m16:43:05.640772 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:05.645436 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_customer_details (execute): 2023-02-17 16:43:01.022910 => 2023-02-17 16:43:05.645319
[0m16:43:05.645835 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
[0m16:43:05.757287 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130d4190>]}
[0m16:43:05.757893 [info ] [Thread-2  ]: 17 of 31 OK created sql incremental model DBT_SPATEL.sat_order_customer_details  [[32mSUCCESS 0[0m in 4.76s]
[0m16:43:05.758349 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m16:43:05.758733 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_part
[0m16:43:05.759070 [info ] [Thread-2  ]: 21 of 31 START sql incremental model DBT_SPATEL.hub_part ....................... [RUN]
[0m16:43:05.759934 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_part'
[0m16:43:05.760273 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
[0m16:43:05.767647 [info ] [Thread-2  ]: 16:43:05 + Loading ANALYTICS.DBT_SPATEL.hub_part from 2 source(s)
[0m16:43:05.775459 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
[0m16:43:05.776571 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (compile): 2023-02-17 16:43:05.760479 => 2023-02-17 16:43:05.776508
[0m16:43:05.776800 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
[0m16:43:05.781803 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m16:43:05.782037 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.hub_part__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN ANALYTICS.DBT_SPATEL.hub_part AS d
    ON a.PART_PK = d.PART_PK
    WHERE d.PART_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:43:05.782174 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:43:05.947788 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:43:05.949611 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m16:43:05.949712 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
describe table ANALYTICS.DBT_SPATEL.hub_nation__dbt_tmp
[0m16:43:06.028860 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:43:06.031592 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m16:43:06.031731 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
describe table ANALYTICS.DBT_SPATEL.hub_nation
[0m16:43:06.105617 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:43:06.109574 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m16:43:06.109779 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
describe table "ANALYTICS"."DBT_SPATEL"."HUB_NATION"
[0m16:43:06.192524 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:43:06.201061 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_nation"
[0m16:43:06.203400 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m16:43:06.203688 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
-- back compat for old kwarg name
  
  begin;
[0m16:43:06.317381 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:06.318788 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m16:43:06.319327 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
insert into ANALYTICS.DBT_SPATEL.hub_nation ("NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.hub_nation__dbt_tmp
        );
[0m16:43:06.858809 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:43:06.868802 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m16:43:06.869197 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
describe table ANALYTICS.DBT_SPATEL.hub_part__dbt_tmp
[0m16:43:06.950471 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:43:06.956375 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m16:43:06.956644 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
describe table ANALYTICS.DBT_SPATEL.hub_part
[0m16:43:07.100692 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 4 seconds
[0m16:43:07.103087 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:43:07.103554 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m16:43:07.110264 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
COMMIT
[0m16:43:07.111963 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m16:43:07.112612 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
describe table "ANALYTICS"."DBT_SPATEL"."HUB_PART"
[0m16:43:07.191499 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:43:07.199512 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_part"
[0m16:43:07.200708 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m16:43:07.200849 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
-- back compat for old kwarg name
  
  begin;
[0m16:43:07.283196 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:07.283548 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m16:43:07.283734 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
insert into ANALYTICS.DBT_SPATEL.hub_part ("PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.hub_part__dbt_tmp
        );
[0m16:43:07.358020 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:07.367086 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m16:43:07.367354 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
drop view if exists ANALYTICS.DBT_SPATEL.sat_order_order_details__dbt_tmp cascade
[0m16:43:07.466309 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:07.472734 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_order_details (execute): 2023-02-17 16:43:02.330306 => 2023-02-17 16:43:07.472636
[0m16:43:07.473081 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: Close
[0m16:43:07.619630 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134081c0>]}
[0m16:43:07.620701 [info ] [Thread-1  ]: 19 of 31 OK created sql incremental model DBT_SPATEL.sat_order_order_details ... [[32mSUCCESS 0[0m in 5.31s]
[0m16:43:07.621299 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
[0m16:43:07.621803 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_region
[0m16:43:07.622406 [info ] [Thread-1  ]: 22 of 31 START sql incremental model DBT_SPATEL.hub_region ..................... [RUN]
[0m16:43:07.623386 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_region'
[0m16:43:07.623710 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
[0m16:43:07.631413 [info ] [Thread-1  ]: 16:43:07 + Loading ANALYTICS.DBT_SPATEL.hub_region from 2 source(s)
[0m16:43:07.639665 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
[0m16:43:07.640316 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (compile): 2023-02-17 16:43:07.623899 => 2023-02-17 16:43:07.640259
[0m16:43:07.640528 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
[0m16:43:07.645934 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m16:43:07.646167 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.hub_region__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN ANALYTICS.DBT_SPATEL.hub_region AS d
    ON a.REGION_PK = d.REGION_PK
    WHERE d.REGION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:43:07.646303 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:43:08.505927 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 5 seconds
[0m16:43:08.506772 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m16:43:08.507064 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
COMMIT
[0m16:43:08.726384 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:43:08.733355 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m16:43:08.733685 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
describe table ANALYTICS.DBT_SPATEL.hub_region__dbt_tmp
[0m16:43:08.762436 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:08.767623 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m16:43:08.767932 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
drop view if exists ANALYTICS.DBT_SPATEL.sat_order_lineitem_details__dbt_tmp cascade
[0m16:43:08.836553 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:43:08.844415 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m16:43:08.844717 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
describe table ANALYTICS.DBT_SPATEL.hub_region
[0m16:43:08.861949 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:08.865273 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_lineitem_details (execute): 2023-02-17 16:43:01.967411 => 2023-02-17 16:43:08.865175
[0m16:43:08.865610 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
[0m16:43:08.937802 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:43:08.946857 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m16:43:08.947163 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
describe table "ANALYTICS"."DBT_SPATEL"."HUB_REGION"
[0m16:43:08.975238 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11300daf0>]}
[0m16:43:08.975886 [info ] [Thread-4  ]: 18 of 31 OK created sql incremental model DBT_SPATEL.sat_order_lineitem_details  [[32mSUCCESS 0[0m in 7.03s]
[0m16:43:08.976411 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m16:43:08.976852 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
[0m16:43:08.977393 [info ] [Thread-4  ]: 23 of 31 START sql incremental model DBT_SPATEL.hub_supplier ................... [RUN]
[0m16:43:08.978314 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_supplier'
[0m16:43:08.978670 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
[0m16:43:08.986728 [info ] [Thread-4  ]: 16:43:08 + Loading ANALYTICS.DBT_SPATEL.hub_supplier from 2 source(s)
[0m16:43:08.996055 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:43:08.996739 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (compile): 2023-02-17 16:43:08.978901 => 2023-02-17 16:43:08.996684
[0m16:43:08.996967 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
[0m16:43:09.002107 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:43:09.002266 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.hub_supplier__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN ANALYTICS.DBT_SPATEL.hub_supplier AS d
    ON a.SUPPLIER_PK = d.SUPPLIER_PK
    WHERE d.SUPPLIER_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:43:09.002401 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:43:09.037854 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:43:09.039958 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_region"
[0m16:43:09.040709 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m16:43:09.040846 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
-- back compat for old kwarg name
  
  begin;
[0m16:43:09.141353 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:09.141558 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m16:43:09.141646 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
insert into ANALYTICS.DBT_SPATEL.hub_region ("REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.hub_region__dbt_tmp
        );
[0m16:43:09.937354 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:43:09.944375 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:43:09.944763 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
describe table ANALYTICS.DBT_SPATEL.hub_supplier__dbt_tmp
[0m16:43:10.040921 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:43:10.050121 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:43:10.050350 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
describe table ANALYTICS.DBT_SPATEL.hub_supplier
[0m16:43:10.136511 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:43:10.142889 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:43:10.143134 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
describe table "ANALYTICS"."DBT_SPATEL"."HUB_SUPPLIER"
[0m16:43:10.216431 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:43:10.224446 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:43:10.225594 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:43:10.225779 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
-- back compat for old kwarg name
  
  begin;
[0m16:43:10.323678 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:10.324659 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:43:10.324979 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
insert into ANALYTICS.DBT_SPATEL.hub_supplier ("SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.hub_supplier__dbt_tmp
        );
[0m16:43:11.884365 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 6 seconds
[0m16:43:11.885616 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m16:43:11.885997 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
COMMIT
[0m16:43:12.123558 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:12.132107 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m16:43:12.132431 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
drop view if exists ANALYTICS.DBT_SPATEL.hub_nation__dbt_tmp cascade
[0m16:43:12.243142 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:12.246712 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (execute): 2023-02-17 16:43:04.970082 => 2023-02-17 16:43:12.246612
[0m16:43:12.247077 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: Close
[0m16:43:12.312201 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 5 seconds
[0m16:43:12.313527 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m16:43:12.314194 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
COMMIT
[0m16:43:12.363082 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107294d90>]}
[0m16:43:12.363764 [info ] [Thread-3  ]: 20 of 31 OK created sql incremental model DBT_SPATEL.hub_nation ................ [[32mSUCCESS 0[0m in 7.41s]
[0m16:43:12.364242 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
[0m16:43:12.364642 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_inventory
[0m16:43:12.365107 [info ] [Thread-3  ]: 24 of 31 START sql incremental model DBT_SPATEL.link_inventory ................. [RUN]
[0m16:43:12.365785 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_inventory'
[0m16:43:12.366049 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory
[0m16:43:12.372988 [info ] [Thread-3  ]: 16:43:12 + Loading ANALYTICS.DBT_SPATEL.link_inventory from 1 source(s)
[0m16:43:12.379035 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
[0m16:43:12.379640 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory (compile): 2023-02-17 16:43:12.366217 => 2023-02-17 16:43:12.379584
[0m16:43:12.379830 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory
[0m16:43:12.384093 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m16:43:12.384290 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.link_inventory__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN ANALYTICS.DBT_SPATEL.link_inventory AS d
    ON a.INVENTORY_PK = d.INVENTORY_PK
    WHERE d.INVENTORY_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:43:12.384425 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:43:12.587351 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:12.590337 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m16:43:12.590461 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
drop view if exists ANALYTICS.DBT_SPATEL.hub_part__dbt_tmp cascade
[0m16:43:12.686050 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:12.687993 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (execute): 2023-02-17 16:43:05.776931 => 2023-02-17 16:43:12.687946
[0m16:43:12.688196 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: Close
[0m16:43:12.792282 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130d4250>]}
[0m16:43:12.792821 [info ] [Thread-2  ]: 21 of 31 OK created sql incremental model DBT_SPATEL.hub_part .................. [[32mSUCCESS 0[0m in 7.03s]
[0m16:43:12.793161 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
[0m16:43:12.793471 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_nation_region
[0m16:43:12.793864 [info ] [Thread-2  ]: 25 of 31 START sql incremental model DBT_SPATEL.link_nation_region ............. [RUN]
[0m16:43:12.794484 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_nation_region'
[0m16:43:12.794711 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_nation_region
[0m16:43:12.800631 [info ] [Thread-2  ]: 16:43:12 + Loading ANALYTICS.DBT_SPATEL.link_nation_region from 2 source(s)
[0m16:43:12.807311 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
[0m16:43:12.807900 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_nation_region (compile): 2023-02-17 16:43:12.794860 => 2023-02-17 16:43:12.807849
[0m16:43:12.808088 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_nation_region
[0m16:43:12.812657 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m16:43:12.812842 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.link_nation_region__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN ANALYTICS.DBT_SPATEL.link_nation_region AS d
    ON a.NATION_REGION_PK = d.NATION_REGION_PK
    WHERE d.NATION_REGION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:43:12.812967 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:43:12.974924 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:43:12.976756 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m16:43:12.976868 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
describe table ANALYTICS.DBT_SPATEL.link_inventory__dbt_tmp
[0m16:43:13.057178 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:43:13.060940 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m16:43:13.061090 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
describe table ANALYTICS.DBT_SPATEL.link_inventory
[0m16:43:13.142489 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:43:13.146846 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m16:43:13.147074 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
describe table "ANALYTICS"."DBT_SPATEL"."LINK_INVENTORY"
[0m16:43:13.203511 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 4 seconds
[0m16:43:13.203912 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m16:43:13.204178 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
COMMIT
[0m16:43:13.232669 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:43:13.237473 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_inventory"
[0m16:43:13.238924 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m16:43:13.239157 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
-- back compat for old kwarg name
  
  begin;
[0m16:43:13.326529 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:13.326782 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m16:43:13.326895 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
insert into ANALYTICS.DBT_SPATEL.link_inventory ("INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.link_inventory__dbt_tmp
        );
[0m16:43:13.483668 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:13.496144 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m16:43:13.496743 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
drop view if exists ANALYTICS.DBT_SPATEL.hub_region__dbt_tmp cascade
[0m16:43:13.601035 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:13.608963 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (execute): 2023-02-17 16:43:07.640661 => 2023-02-17 16:43:13.608781
[0m16:43:13.609508 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: Close
[0m16:43:13.647967 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:43:13.653893 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m16:43:13.654411 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
describe table ANALYTICS.DBT_SPATEL.link_nation_region__dbt_tmp
[0m16:43:13.723550 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f68250>]}
[0m16:43:13.724269 [info ] [Thread-1  ]: 22 of 31 OK created sql incremental model DBT_SPATEL.hub_region ................ [[32mSUCCESS 0[0m in 6.10s]
[0m16:43:13.724830 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
[0m16:43:13.725309 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_supplier_nation
[0m16:43:13.725889 [info ] [Thread-1  ]: 26 of 31 START sql incremental model DBT_SPATEL.link_supplier_nation ........... [RUN]
[0m16:43:13.726765 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_supplier_nation'
[0m16:43:13.727068 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
[0m16:43:13.734448 [info ] [Thread-1  ]: 16:43:13 + Loading ANALYTICS.DBT_SPATEL.link_supplier_nation from 1 source(s)
[0m16:43:13.741029 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m16:43:13.741700 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_supplier_nation (compile): 2023-02-17 16:43:13.727263 => 2023-02-17 16:43:13.741641
[0m16:43:13.741907 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
[0m16:43:13.783336 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m16:43:13.783996 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:43:13.784100 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.link_supplier_nation__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN ANALYTICS.DBT_SPATEL.link_supplier_nation AS d
    ON a.LINK_SUPPLIER_NATION_PK = d.LINK_SUPPLIER_NATION_PK
    WHERE d.LINK_SUPPLIER_NATION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:43:13.786243 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m16:43:13.786365 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:43:13.786463 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
describe table ANALYTICS.DBT_SPATEL.link_nation_region
[0m16:43:13.943683 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:43:13.945774 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m16:43:13.945886 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
describe table "ANALYTICS"."DBT_SPATEL"."LINK_NATION_REGION"
[0m16:43:14.005070 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:43:14.006824 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_nation_region"
[0m16:43:14.007435 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m16:43:14.007559 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
-- back compat for old kwarg name
  
  begin;
[0m16:43:14.112952 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:14.113296 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m16:43:14.113482 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
insert into ANALYTICS.DBT_SPATEL.link_nation_region ("NATION_REGION_PK", "NATION_PK", "REGION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_REGION_PK", "NATION_PK", "REGION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.link_nation_region__dbt_tmp
        );
[0m16:43:14.201497 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 4 seconds
[0m16:43:14.202743 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:43:14.203276 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
COMMIT
[0m16:43:14.356749 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:43:14.366314 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m16:43:14.366584 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
describe table ANALYTICS.DBT_SPATEL.link_supplier_nation__dbt_tmp
[0m16:43:14.462479 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:43:14.469929 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:14.472880 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m16:43:14.477027 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:43:14.477257 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
describe table ANALYTICS.DBT_SPATEL.link_supplier_nation
[0m16:43:14.477430 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
drop view if exists ANALYTICS.DBT_SPATEL.hub_supplier__dbt_tmp cascade
[0m16:43:14.561452 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:43:14.570364 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m16:43:14.570569 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
describe table "ANALYTICS"."DBT_SPATEL"."LINK_SUPPLIER_NATION"
[0m16:43:14.571387 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:14.573352 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (execute): 2023-02-17 16:43:08.997097 => 2023-02-17 16:43:14.573286
[0m16:43:14.573559 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: Close
[0m16:43:14.636427 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:43:14.638560 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m16:43:14.639380 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m16:43:14.639539 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
-- back compat for old kwarg name
  
  begin;
[0m16:43:14.677943 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10754e4c0>]}
[0m16:43:14.678355 [info ] [Thread-4  ]: 23 of 31 OK created sql incremental model DBT_SPATEL.hub_supplier .............. [[32mSUCCESS 0[0m in 5.70s]
[0m16:43:14.678667 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
[0m16:43:14.678927 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m16:43:14.679254 [info ] [Thread-4  ]: 27 of 31 START sql incremental model DBT_SPATEL.sat_inv_inventory_details ...... [RUN]
[0m16:43:14.679788 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_inventory_details'
[0m16:43:14.679989 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m16:43:14.695456 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m16:43:14.696055 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_inventory_details (compile): 2023-02-17 16:43:14.680122 => 2023-02-17 16:43:14.696003
[0m16:43:14.696240 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m16:43:14.701345 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m16:43:14.701487 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.sat_inv_inventory_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

latest_records AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.INVENTORY_PK, current_records.INVENTORY_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.INVENTORY_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM ANALYTICS.DBT_SPATEL.sat_inv_inventory_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.INVENTORY_PK
                FROM source_data
            ) AS source_records
                ON current_records.INVENTORY_PK = source_records.INVENTORY_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.INVENTORY_PK = stage.INVENTORY_PK
        AND latest_records.INVENTORY_HASHDIFF = stage.INVENTORY_HASHDIFF
    WHERE latest_records.INVENTORY_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:43:14.701613 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:43:14.745898 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:14.746124 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m16:43:14.746238 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
insert into ANALYTICS.DBT_SPATEL.link_supplier_nation ("LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.link_supplier_nation__dbt_tmp
        );
[0m16:43:15.670578 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:43:15.677992 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m16:43:15.678294 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_inv_inventory_details__dbt_tmp
[0m16:43:15.763537 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 0 seconds
[0m16:43:15.768552 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m16:43:15.768766 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_inv_inventory_details
[0m16:43:15.862424 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 0 seconds
[0m16:43:15.869207 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m16:43:15.869493 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
describe table "ANALYTICS"."DBT_SPATEL"."SAT_INV_INVENTORY_DETAILS"
[0m16:43:15.953757 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 0 seconds
[0m16:43:15.962720 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m16:43:15.964430 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m16:43:15.964659 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
-- back compat for old kwarg name
  
  begin;
[0m16:43:16.076857 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:16.078300 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m16:43:16.078835 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
insert into ANALYTICS.DBT_SPATEL.sat_inv_inventory_details ("INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.sat_inv_inventory_details__dbt_tmp
        );
[0m16:43:16.489609 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 3 seconds
[0m16:43:16.490866 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m16:43:16.491375 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
COMMIT
[0m16:43:16.899810 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:16.906407 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m16:43:16.906692 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
drop view if exists ANALYTICS.DBT_SPATEL.link_inventory__dbt_tmp cascade
[0m16:43:17.022606 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:17.027217 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory (execute): 2023-02-17 16:43:12.379957 => 2023-02-17 16:43:17.027120
[0m16:43:17.027580 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: Close
[0m16:43:17.132172 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130ac610>]}
[0m16:43:17.132725 [info ] [Thread-3  ]: 24 of 31 OK created sql incremental model DBT_SPATEL.link_inventory ............ [[32mSUCCESS 0[0m in 4.77s]
[0m16:43:17.133102 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory
[0m16:43:17.133419 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m16:43:17.133668 [info ] [Thread-3  ]: 28 of 31 START sql incremental model DBT_SPATEL.sat_inv_part_details ........... [RUN]
[0m16:43:17.134217 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_part_details'
[0m16:43:17.134544 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m16:43:17.154617 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m16:43:17.155158 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_part_details (compile): 2023-02-17 16:43:17.134727 => 2023-02-17 16:43:17.155116
[0m16:43:17.155307 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m16:43:17.159325 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m16:43:17.159450 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.sat_inv_part_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS a
    WHERE a.PART_PK IS NOT NULL
),

latest_records AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.PART_PK, current_records.PART_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.PART_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM ANALYTICS.DBT_SPATEL.sat_inv_part_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.PART_PK
                FROM source_data
            ) AS source_records
                ON current_records.PART_PK = source_records.PART_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.PART_PK = stage.PART_PK
        AND latest_records.PART_HASHDIFF = stage.PART_HASHDIFF
    WHERE latest_records.PART_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:43:17.159559 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:43:17.540653 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 3 seconds
[0m16:43:17.542173 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m16:43:17.542612 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
COMMIT
[0m16:43:17.792763 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:17.801044 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m16:43:17.801321 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
drop view if exists ANALYTICS.DBT_SPATEL.link_supplier_nation__dbt_tmp cascade
[0m16:43:17.907401 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:17.910183 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_supplier_nation (execute): 2023-02-17 16:43:13.742035 => 2023-02-17 16:43:17.910098
[0m16:43:17.910463 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: Close
[0m16:43:17.975710 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:43:17.983289 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m16:43:17.983633 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_inv_part_details__dbt_tmp
[0m16:43:18.021154 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106662160>]}
[0m16:43:18.077690 [debug] [Thread-3  ]: SQL status: SUCCESS 13 in 0 seconds
[0m16:43:18.083654 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m16:43:18.083902 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_inv_part_details
[0m16:43:18.181513 [debug] [Thread-3  ]: SQL status: SUCCESS 13 in 0 seconds
[0m16:43:18.191994 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m16:43:18.192423 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
describe table "ANALYTICS"."DBT_SPATEL"."SAT_INV_PART_DETAILS"
[0m16:43:18.269758 [debug] [Thread-3  ]: SQL status: SUCCESS 13 in 0 seconds
[0m16:43:18.273126 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m16:43:18.274028 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m16:43:18.274172 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
-- back compat for old kwarg name
  
  begin;
[0m16:43:18.375734 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:18.376089 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m16:43:18.376247 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
insert into ANALYTICS.DBT_SPATEL.sat_inv_part_details ("PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.sat_inv_part_details__dbt_tmp
        );
[0m16:43:18.623213 [info ] [Thread-1  ]: 26 of 31 OK created sql incremental model DBT_SPATEL.link_supplier_nation ...... [[32mSUCCESS 0[0m in 4.29s]
[0m16:43:18.623813 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
[0m16:43:18.624248 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m16:43:18.624739 [info ] [Thread-1  ]: 29 of 31 START sql incremental model DBT_SPATEL.sat_inv_supp_nation_details .... [RUN]
[0m16:43:18.625591 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details'
[0m16:43:18.625883 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m16:43:18.645486 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m16:43:18.646138 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_nation_details (compile): 2023-02-17 16:43:18.626069 => 2023-02-17 16:43:18.646065
[0m16:43:18.646330 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m16:43:18.652265 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m16:43:18.652421 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.sat_inv_supp_nation_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.SUPPLIER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM ANALYTICS.DBT_SPATEL.sat_inv_supp_nation_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
        AND latest_records.SUPPLIER_NATION_HASHDIFF = stage.SUPPLIER_NATION_HASHDIFF
    WHERE latest_records.SUPPLIER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:43:18.652545 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:43:18.794827 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 5 seconds
[0m16:43:18.795003 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m16:43:18.795086 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
COMMIT
[0m16:43:19.051026 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:19.059142 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m16:43:19.059418 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
drop view if exists ANALYTICS.DBT_SPATEL.link_nation_region__dbt_tmp cascade
[0m16:43:19.157800 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:19.162907 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_nation_region (execute): 2023-02-17 16:43:12.808202 => 2023-02-17 16:43:19.162754
[0m16:43:19.163389 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: Close
[0m16:43:19.202078 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:43:19.207538 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m16:43:19.208011 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_inv_supp_nation_details__dbt_tmp
[0m16:43:19.274492 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a9370>]}
[0m16:43:19.275117 [info ] [Thread-2  ]: 25 of 31 OK created sql incremental model DBT_SPATEL.link_nation_region ........ [[32mSUCCESS 0[0m in 6.48s]
[0m16:43:19.275547 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_nation_region
[0m16:43:19.275886 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m16:43:19.276335 [info ] [Thread-2  ]: 30 of 31 START sql incremental model DBT_SPATEL.sat_inv_supp_region_details .... [RUN]
[0m16:43:19.277013 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details'
[0m16:43:19.277260 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m16:43:19.296390 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m16:43:19.297365 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m16:43:19.300579 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m16:43:19.300769 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_inv_supp_nation_details
[0m16:43:19.301575 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_region_details (compile): 2023-02-17 16:43:19.277426 => 2023-02-17 16:43:19.301532
[0m16:43:19.301795 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m16:43:19.306409 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m16:43:19.306796 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.sat_inv_supp_region_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.SUPPLIER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM ANALYTICS.DBT_SPATEL.sat_inv_supp_region_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
        AND latest_records.SUPPLIER_NATION_HASHDIFF = stage.SUPPLIER_NATION_HASHDIFF
    WHERE latest_records.SUPPLIER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:43:19.307113 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:43:19.403697 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m16:43:19.407754 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m16:43:19.407946 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
describe table "ANALYTICS"."DBT_SPATEL"."SAT_INV_SUPP_NATION_DETAILS"
[0m16:43:19.477836 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m16:43:19.482073 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m16:43:19.483567 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m16:43:19.483787 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
-- back compat for old kwarg name
  
  begin;
[0m16:43:19.600310 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:19.606889 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m16:43:19.613100 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
insert into ANALYTICS.DBT_SPATEL.sat_inv_supp_nation_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.sat_inv_supp_nation_details__dbt_tmp
        );
[0m16:43:20.107793 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 4 seconds
[0m16:43:20.109517 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m16:43:20.110074 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
COMMIT
[0m16:43:20.343671 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:20.352070 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m16:43:20.352340 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
drop view if exists ANALYTICS.DBT_SPATEL.sat_inv_inventory_details__dbt_tmp cascade
[0m16:43:20.425210 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:43:20.433702 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m16:43:20.433888 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_inv_supp_region_details__dbt_tmp
[0m16:43:20.454216 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:20.455820 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_inventory_details (execute): 2023-02-17 16:43:14.696349 => 2023-02-17 16:43:20.455745
[0m16:43:20.455990 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: Close
[0m16:43:20.527897 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0 seconds
[0m16:43:20.531426 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m16:43:20.531583 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_inv_supp_region_details
[0m16:43:20.562444 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11304d820>]}
[0m16:43:20.562926 [info ] [Thread-4  ]: 27 of 31 OK created sql incremental model DBT_SPATEL.sat_inv_inventory_details . [[32mSUCCESS 0[0m in 5.88s]
[0m16:43:20.563273 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m16:43:20.563565 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m16:43:20.563803 [info ] [Thread-4  ]: 31 of 31 START sql incremental model DBT_SPATEL.sat_inv_supplier_details ....... [RUN]
[0m16:43:20.564486 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details'
[0m16:43:20.564707 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m16:43:20.581194 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m16:43:20.581830 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supplier_details (compile): 2023-02-17 16:43:20.564845 => 2023-02-17 16:43:20.581777
[0m16:43:20.581991 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m16:43:20.586047 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m16:43:20.586187 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
create or replace  temporary view ANALYTICS.DBT_SPATEL.sat_inv_supplier_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM ANALYTICS.DBT_SPATEL.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.SUPPLIER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM ANALYTICS.DBT_SPATEL.sat_inv_supplier_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
        AND latest_records.SUPPLIER_HASHDIFF = stage.SUPPLIER_HASHDIFF
    WHERE latest_records.SUPPLIER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:43:20.586295 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:43:20.615968 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0 seconds
[0m16:43:20.618787 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m16:43:20.618950 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
describe table "ANALYTICS"."DBT_SPATEL"."SAT_INV_SUPP_REGION_DETAILS"
[0m16:43:20.700262 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0 seconds
[0m16:43:20.708002 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m16:43:20.720048 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m16:43:20.720146 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
-- back compat for old kwarg name
  
  begin;
[0m16:43:20.824573 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:20.824800 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m16:43:20.824925 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
insert into ANALYTICS.DBT_SPATEL.sat_inv_supp_region_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.sat_inv_supp_region_details__dbt_tmp
        );
[0m16:43:21.374197 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:43:21.382356 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m16:43:21.382673 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_inv_supplier_details__dbt_tmp
[0m16:43:21.493344 [debug] [Thread-4  ]: SQL status: SUCCESS 10 in 0 seconds
[0m16:43:21.500582 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m16:43:21.500864 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
describe table ANALYTICS.DBT_SPATEL.sat_inv_supplier_details
[0m16:43:21.589090 [debug] [Thread-4  ]: SQL status: SUCCESS 10 in 0 seconds
[0m16:43:21.598794 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m16:43:21.599055 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
describe table "ANALYTICS"."DBT_SPATEL"."SAT_INV_SUPPLIER_DETAILS"
[0m16:43:21.679122 [debug] [Thread-4  ]: SQL status: SUCCESS 10 in 0 seconds
[0m16:43:21.688256 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m16:43:21.689921 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m16:43:21.690151 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
-- back compat for old kwarg name
  
  begin;
[0m16:43:21.807780 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:21.809088 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m16:43:21.809608 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
insert into ANALYTICS.DBT_SPATEL.sat_inv_supplier_details ("SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from ANALYTICS.DBT_SPATEL.sat_inv_supplier_details__dbt_tmp
        );
[0m16:43:22.430576 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 4 seconds
[0m16:43:22.432274 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m16:43:22.432822 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
COMMIT
[0m16:43:22.563407 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 3 seconds
[0m16:43:22.564629 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m16:43:22.565203 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
COMMIT
[0m16:43:22.668807 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:22.679138 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m16:43:22.679443 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
drop view if exists ANALYTICS.DBT_SPATEL.sat_inv_part_details__dbt_tmp cascade
[0m16:43:22.796763 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:22.800798 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_part_details (execute): 2023-02-17 16:43:17.155398 => 2023-02-17 16:43:22.800690
[0m16:43:22.801162 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: Close
[0m16:43:22.803212 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:22.807133 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m16:43:22.807811 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
drop view if exists ANALYTICS.DBT_SPATEL.sat_inv_supp_nation_details__dbt_tmp cascade
[0m16:43:22.915052 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:22.919126 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_nation_details (execute): 2023-02-17 16:43:18.646444 => 2023-02-17 16:43:22.919043
[0m16:43:22.919499 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: Close
[0m16:43:22.922161 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c6d90>]}
[0m16:43:22.922714 [info ] [Thread-3  ]: 28 of 31 OK created sql incremental model DBT_SPATEL.sat_inv_part_details ...... [[32mSUCCESS 0[0m in 5.79s]
[0m16:43:22.923629 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m16:43:23.044691 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fe6b20>]}
[0m16:43:23.045358 [info ] [Thread-1  ]: 29 of 31 OK created sql incremental model DBT_SPATEL.sat_inv_supp_nation_details  [[32mSUCCESS 0[0m in 4.42s]
[0m16:43:23.045736 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m16:43:23.504372 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 3 seconds
[0m16:43:23.505955 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m16:43:23.506508 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
COMMIT
[0m16:43:23.761709 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:23.772953 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m16:43:23.773400 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
drop view if exists ANALYTICS.DBT_SPATEL.sat_inv_supp_region_details__dbt_tmp cascade
[0m16:43:23.869099 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:23.874844 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_region_details (execute): 2023-02-17 16:43:19.301922 => 2023-02-17 16:43:23.874772
[0m16:43:23.875110 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: Close
[0m16:43:23.978634 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f46910>]}
[0m16:43:23.979295 [info ] [Thread-2  ]: 30 of 31 OK created sql incremental model DBT_SPATEL.sat_inv_supp_region_details  [[32mSUCCESS 0[0m in 4.70s]
[0m16:43:23.979751 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m16:43:24.990613 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 3 seconds
[0m16:43:24.992353 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m16:43:24.992908 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
COMMIT
[0m16:43:25.295575 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:25.302600 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m16:43:25.303033 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
drop view if exists ANALYTICS.DBT_SPATEL.sat_inv_supplier_details__dbt_tmp cascade
[0m16:43:25.427801 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:43:25.435516 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supplier_details (execute): 2023-02-17 16:43:20.582101 => 2023-02-17 16:43:25.435290
[0m16:43:25.436324 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: Close
[0m16:43:25.556331 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8281b6-1dc7-4ed8-895c-a8f8a13b6f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fd7070>]}
[0m16:43:25.556961 [info ] [Thread-4  ]: 31 of 31 OK created sql incremental model DBT_SPATEL.sat_inv_supplier_details .. [[32mSUCCESS 0[0m in 4.99s]
[0m16:43:25.557425 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m16:43:25.559409 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:43:25.559919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:25.560103 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details' was properly closed.
[0m16:43:25.560258 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
[0m16:43:25.560397 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
[0m16:43:25.560538 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_part_details' was properly closed.
[0m16:43:25.560880 [info ] [MainThread]: 
[0m16:43:25.561155 [info ] [MainThread]: Finished running 6 view models, 25 incremental models in 0 hours 0 minutes and 39.14 seconds (39.14s).
[0m16:43:25.562809 [debug] [MainThread]: Command end result
[0m16:43:25.577864 [info ] [MainThread]: 
[0m16:43:25.578220 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:43:25.578457 [info ] [MainThread]: 
[0m16:43:25.578636 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=0 SKIP=0 TOTAL=31
[0m16:43:25.578955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f86b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107525490>]}
[0m16:43:25.579167 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 16:43:30.876492 | 9961fe13-7aa4-41a7-bc7d-2dd3ed7fda6d ==============================
[0m16:43:30.876492 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:43:30.877160 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m16:43:30.877257 [debug] [MainThread]: Tracking: tracking
[0m16:43:30.887471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108472be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10848d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a0070>]}
[0m16:43:31.068649 [debug] [MainThread]: Executing "git --help"
[0m16:43:31.108818 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:43:31.109214 [debug] [MainThread]: STDERR: "b''"
[0m16:43:31.113181 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:43:31.113805 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:43:31.113940 [debug] [MainThread]: On debug: select 1 as id
[0m16:43:31.114082 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:43:31.734914 [debug] [MainThread]: SQL status: SUCCESS 1 in 1 seconds
[0m16:43:31.739196 [debug] [MainThread]: On debug: Close
[0m16:43:31.912797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10956cf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b276d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b276ca0>]}
[0m16:43:31.913267 [debug] [MainThread]: Flushing usage events
[0m16:43:32.324447 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-02-20 16:21:18.205763 | c5d59f7e-b6ad-4780-b62f-0d243ef2e981 ==============================
[0m16:21:18.205763 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:21:18.208956 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:raw'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:21:18.209110 [debug] [MainThread]: Tracking: tracking
[0m16:21:18.209337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d4c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d4fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d4eb0>]}
[0m16:21:18.237783 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:21:18.238023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c5d59f7e-b6ad-4780-b62f-0d243ef2e981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101b94520>]}
[0m16:21:19.307206 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_customer_order.sql
[0m16:21:19.355856 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
[0m16:21:19.356654 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_customer_nation.sql
[0m16:21:19.361507 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
[0m16:21:19.362206 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_inventory.sql
[0m16:21:19.367436 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
[0m16:21:19.368164 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_nation_region.sql
[0m16:21:19.373839 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
[0m16:21:19.374563 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
[0m16:21:19.379417 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
[0m16:21:19.380247 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_lineitem.sql
[0m16:21:19.384911 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
[0m16:21:19.385582 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_supplier_nation.sql
[0m16:21:19.390870 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
[0m16:21:19.391617 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_order.sql
[0m16:21:19.405577 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
[0m16:21:19.406318 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_nation.sql
[0m16:21:19.412411 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
[0m16:21:19.413164 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_part.sql
[0m16:21:19.419796 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
[0m16:21:19.420557 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
[0m16:21:19.425576 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
[0m16:21:19.426296 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_customer.sql
[0m16:21:19.431090 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
[0m16:21:19.431870 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_supplier.sql
[0m16:21:19.437829 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
[0m16:21:19.438622 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_region.sql
[0m16:21:19.445003 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
[0m16:21:19.445736 [debug] [MainThread]: 1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
[0m16:21:19.455942 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
[0m16:21:19.456700 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
[0m16:21:19.483588 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
[0m16:21:19.484362 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
[0m16:21:19.492341 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
[0m16:21:19.493049 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
[0m16:21:19.502467 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
[0m16:21:19.503164 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
[0m16:21:19.510846 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
[0m16:21:19.511539 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
[0m16:21:19.518543 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
[0m16:21:19.519256 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
[0m16:21:19.525760 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
[0m16:21:19.526457 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
[0m16:21:19.533295 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
[0m16:21:19.533999 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
[0m16:21:19.542406 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
[0m16:21:19.543114 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
[0m16:21:19.549618 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
[0m16:21:19.550305 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
[0m16:21:19.558523 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
[0m16:21:19.559475 [debug] [MainThread]: 1603: static parser failed on raw_stage/raw_transactions.sql
[0m16:21:19.562851 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
[0m16:21:19.563777 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage/raw_inventory.sql
[0m16:21:19.565713 [debug] [MainThread]: 1603: static parser failed on raw_stage/raw_orders.sql
[0m16:21:19.569554 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
[0m16:21:19.570280 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_orders.sql
[0m16:21:19.696455 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
[0m16:21:19.697305 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_inventory.sql
[0m16:21:19.736964 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
[0m16:21:19.737830 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_transactions.sql
[0m16:21:19.750309 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
[0m16:21:19.831506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5d59f7e-b6ad-4780-b62f-0d243ef2e981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b5af0>]}
[0m16:21:19.840461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5d59f7e-b6ad-4780-b62f-0d243ef2e981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b5490>]}
[0m16:21:19.840688 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 630 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m16:21:19.840824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5d59f7e-b6ad-4780-b62f-0d243ef2e981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105952550>]}
[0m16:21:19.841709 [info ] [MainThread]: 
[0m16:21:19.842461 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:21:19.842998 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST'
[0m16:21:19.851154 [debug] [ThreadPool]: Using snowflake connection "list_TEST"
[0m16:21:19.851393 [debug] [ThreadPool]: On list_TEST: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_TEST"} */
show terse schemas in database TEST
    limit 10000
[0m16:21:19.851509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:20.940562 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m16:21:20.943615 [debug] [ThreadPool]: On list_TEST: Close
[0m16:21:21.048971 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST_DBT'
[0m16:21:21.062773 [debug] [ThreadPool]: Using snowflake connection "list_TEST_DBT"
[0m16:21:21.063059 [debug] [ThreadPool]: On list_TEST_DBT: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_TEST_DBT"} */
show terse objects in TEST.DBT
[0m16:21:21.063195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:21.580582 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1 seconds
[0m16:21:21.582851 [debug] [ThreadPool]: On list_TEST_DBT: Close
[0m16:21:21.671655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5d59f7e-b6ad-4780-b62f-0d243ef2e981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b5f70>]}
[0m16:21:21.675365 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:21:21.676178 [info ] [MainThread]: 
[0m16:21:21.690185 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.raw_orders
[0m16:21:21.692107 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_transactions
[0m16:21:21.691899 [info ] [Thread-1  ]: 1 of 3 START sql view model DBT.raw_orders ..................................... [RUN]
[0m16:21:21.692448 [info ] [Thread-2  ]: 2 of 3 START sql view model DBT.raw_transactions ............................... [RUN]
[0m16:21:21.692879 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_orders'
[0m16:21:21.693175 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_transactions'
[0m16:21:21.693313 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.raw_orders
[0m16:21:21.693427 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_transactions
[0m16:21:21.697438 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
[0m16:21:21.699803 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
[0m16:21:21.701081 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_transactions (compile): 2023-02-20 16:21:21.697625 => 2023-02-20 16:21:21.700970
[0m16:21:21.701391 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.raw_orders (compile): 2023-02-20 16:21:21.693506 => 2023-02-20 16:21:21.701332
[0m16:21:21.701682 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_transactions
[0m16:21:21.701968 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.raw_orders
[0m16:21:21.719567 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.raw_transactions"
[0m16:21:21.721624 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.raw_orders"
[0m16:21:21.723144 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
[0m16:21:21.723251 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */
create or replace   view TEST.DBT.raw_transactions
  
   as (
    SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS  AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
[0m16:21:21.723344 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:21:21.724933 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
[0m16:21:21.725483 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */
create or replace   view TEST.DBT.raw_orders
  
   as (
    SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
[0m16:21:21.725891 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:21:22.289898 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:21:22.313380 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_transactions (execute): 2023-02-20 16:21:21.702152 => 2023-02-20 16:21:22.313328
[0m16:21:22.313588 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: Close
[0m16:21:22.418975 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d59f7e-b6ad-4780-b62f-0d243ef2e981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce2ca0>]}
[0m16:21:22.421362 [info ] [Thread-2  ]: 2 of 3 OK created sql view model DBT.raw_transactions .......................... [[32mSUCCESS 1[0m in 0.72s]
[0m16:21:22.425747 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_transactions
[0m16:21:22.577574 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:21:22.583225 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.raw_orders (execute): 2023-02-20 16:21:21.719704 => 2023-02-20 16:21:22.583127
[0m16:21:22.583691 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: Close
[0m16:21:22.675369 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d59f7e-b6ad-4780-b62f-0d243ef2e981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b78520>]}
[0m16:21:22.675679 [info ] [Thread-1  ]: 1 of 3 OK created sql view model DBT.raw_orders ................................ [[32mSUCCESS 1[0m in 0.98s]
[0m16:21:22.675870 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.raw_orders
[0m16:21:22.676342 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.raw_inventory
[0m16:21:22.676744 [info ] [Thread-4  ]: 3 of 3 START sql view model DBT.raw_inventory .................................. [RUN]
[0m16:21:22.677468 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_inventory'
[0m16:21:22.677809 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.raw_inventory
[0m16:21:22.684642 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
[0m16:21:22.686403 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.raw_inventory (compile): 2023-02-20 16:21:22.677958 => 2023-02-20 16:21:22.686333
[0m16:21:22.686616 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.raw_inventory
[0m16:21:22.688804 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.raw_inventory"
[0m16:21:22.690340 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
[0m16:21:22.690446 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */
create or replace   view TEST.DBT.raw_inventory
  
   as (
    SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PARTSUPP AS a
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN TEST.DBT.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
  );
[0m16:21:22.690531 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:21:23.695340 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:21:23.698522 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.raw_inventory (execute): 2023-02-20 16:21:22.686701 => 2023-02-20 16:21:23.698440
[0m16:21:23.699255 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.raw_inventory: Close
[0m16:21:23.803338 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d59f7e-b6ad-4780-b62f-0d243ef2e981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bcdb50>]}
[0m16:21:23.805571 [info ] [Thread-4  ]: 3 of 3 OK created sql view model DBT.raw_inventory ............................. [[32mSUCCESS 1[0m in 1.13s]
[0m16:21:23.806602 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.raw_inventory
[0m16:21:23.810491 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:21:23.811751 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:23.812032 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.raw_orders' was properly closed.
[0m16:21:23.812245 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.raw_transactions' was properly closed.
[0m16:21:23.812733 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.raw_inventory' was properly closed.
[0m16:21:23.813382 [info ] [MainThread]: 
[0m16:21:23.813795 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.97 seconds (3.97s).
[0m16:21:23.814507 [debug] [MainThread]: Command end result
[0m16:21:23.826511 [info ] [MainThread]: 
[0m16:21:23.826940 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:21:23.827229 [info ] [MainThread]: 
[0m16:21:23.827491 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:21:23.827828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bee340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc6e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c485b0>]}
[0m16:21:23.828116 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 16:25:48.227239 | bd1c6442-da4b-43f6-8a7e-4cbf9931d991 ==============================
[0m16:25:48.227239 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:25:48.228129 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:stage'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:25:48.228241 [debug] [MainThread]: Tracking: tracking
[0m16:25:48.228459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4dd30>]}
[0m16:25:48.286306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:25:48.286509 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:25:48.291642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd1c6442-da4b-43f6-8a7e-4cbf9931d991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105915610>]}
[0m16:25:48.300334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd1c6442-da4b-43f6-8a7e-4cbf9931d991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef9c70>]}
[0m16:25:48.300541 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 630 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m16:25:48.300689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd1c6442-da4b-43f6-8a7e-4cbf9931d991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef9f10>]}
[0m16:25:48.301656 [info ] [MainThread]: 
[0m16:25:48.302412 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:25:48.302975 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST'
[0m16:25:48.311557 [debug] [ThreadPool]: Using snowflake connection "list_TEST"
[0m16:25:48.311757 [debug] [ThreadPool]: On list_TEST: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_TEST"} */
show terse schemas in database TEST
    limit 10000
[0m16:25:48.311885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:48.975168 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m16:25:48.976340 [debug] [ThreadPool]: On list_TEST: Close
[0m16:25:49.058084 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST_DBT'
[0m16:25:49.062544 [debug] [ThreadPool]: Using snowflake connection "list_TEST_DBT"
[0m16:25:49.062681 [debug] [ThreadPool]: On list_TEST_DBT: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_TEST_DBT"} */
show terse objects in TEST.DBT
[0m16:25:49.062784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:49.731917 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m16:25:49.733686 [debug] [ThreadPool]: On list_TEST_DBT: Close
[0m16:25:49.856004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd1c6442-da4b-43f6-8a7e-4cbf9931d991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef9670>]}
[0m16:25:49.856487 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:25:49.856655 [info ] [MainThread]: 
[0m16:25:49.860774 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.v_stg_orders
[0m16:25:49.861236 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.v_stg_inventory
[0m16:25:49.861608 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.v_stg_transactions
[0m16:25:49.861966 [info ] [Thread-2  ]: 2 of 3 START sql view model DBT.v_stg_orders ................................... [RUN]
[0m16:25:49.862451 [info ] [Thread-1  ]: 1 of 3 START sql view model DBT.v_stg_inventory ................................ [RUN]
[0m16:25:49.862890 [info ] [Thread-3  ]: 3 of 3 START sql view model DBT.v_stg_transactions ............................. [RUN]
[0m16:25:49.863288 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_orders'
[0m16:25:49.863584 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_inventory'
[0m16:25:49.864216 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_transactions'
[0m16:25:49.864512 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
[0m16:25:49.864661 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
[0m16:25:49.864859 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
[0m16:25:49.898913 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m16:25:49.901078 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m16:25:49.905831 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m16:25:49.905964 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
describe table TEST.DBT.raw_inventory
[0m16:25:49.906062 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
describe table TEST.DBT.raw_orders
[0m16:25:49.906144 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
describe table TEST.DBT.raw_transactions
[0m16:25:49.906232 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:25:49.906313 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:25:49.906393 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:25:50.338395 [debug] [Thread-1  ]: SQL status: SUCCESS 24 in 0 seconds
[0m16:25:50.371130 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m16:25:50.371266 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
describe table TEST.DBT.raw_inventory
[0m16:25:50.473465 [debug] [Thread-1  ]: SQL status: SUCCESS 24 in 0 seconds
[0m16:25:50.505872 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 1 seconds
[0m16:25:50.510100 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m16:25:50.510220 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
describe table TEST.DBT.raw_transactions
[0m16:25:50.537246 [debug] [Thread-2  ]: SQL status: SUCCESS 36 in 1 seconds
[0m16:25:50.551433 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m16:25:50.552973 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m16:25:50.553106 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
describe table TEST.DBT.raw_orders
[0m16:25:50.553970 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_inventory (compile): 2023-02-20 16:25:49.883261 => 2023-02-20 16:25:50.553929
[0m16:25:50.554114 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
[0m16:25:50.569910 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m16:25:50.575246 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m16:25:50.575355 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
create or replace   view TEST.DBT.v_stg_inventory
  
   as (
    








WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM TEST.DBT.raw_inventory
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS NATION_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_SUPPLIER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '')) AS BINARY(16)) AS PART_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS PART_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_REGION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_NATION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging
  );
[0m16:25:50.640017 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 0 seconds
[0m16:25:50.646334 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m16:25:50.646780 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_transactions (compile): 2023-02-20 16:25:49.901163 => 2023-02-20 16:25:50.646746
[0m16:25:50.646909 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
[0m16:25:50.649105 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m16:25:50.650479 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m16:25:50.650571 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
create or replace   view TEST.DBT.v_stg_transactions
  
   as (
    







-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM TEST.DBT.raw_transactions
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATEADD(DAY, 1, TRANSACTION_DATE) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS TRANSACTION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS VARCHAR))), '')) AS BINARY(16)) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
[0m16:25:50.657669 [debug] [Thread-2  ]: SQL status: SUCCESS 36 in 0 seconds
[0m16:25:50.707709 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
[0m16:25:50.709344 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_orders (compile): 2023-02-20 16:25:49.865027 => 2023-02-20 16:25:50.709311
[0m16:25:50.709466 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_orders
[0m16:25:50.711286 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.v_stg_orders"
[0m16:25:50.718128 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m16:25:50.718223 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
create or replace   view TEST.DBT.v_stg_orders
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM TEST.DBT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMERKEY AS CUSTOMER_KEY,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS REGION_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '')) AS BINARY(16)) AS ORDER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '')) AS BINARY(16)) AS PART_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
  );
[0m16:25:50.838680 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:25:50.848134 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_transactions (execute): 2023-02-20 16:25:50.646983 => 2023-02-20 16:25:50.848104
[0m16:25:50.848270 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: Close
[0m16:25:50.873945 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:25:50.874846 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_inventory (execute): 2023-02-20 16:25:50.554199 => 2023-02-20 16:25:50.874824
[0m16:25:50.874952 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: Close
[0m16:25:50.952559 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd1c6442-da4b-43f6-8a7e-4cbf9931d991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f79c10>]}
[0m16:25:50.952834 [info ] [Thread-3  ]: 3 of 3 OK created sql view model DBT.v_stg_transactions ........................ [[32mSUCCESS 1[0m in 1.09s]
[0m16:25:50.953559 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
[0m16:25:50.953964 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd1c6442-da4b-43f6-8a7e-4cbf9931d991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef9670>]}
[0m16:25:50.954136 [info ] [Thread-1  ]: 1 of 3 OK created sql view model DBT.v_stg_inventory ........................... [[32mSUCCESS 1[0m in 1.09s]
[0m16:25:50.954296 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
[0m16:25:51.197126 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:25:51.201132 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_orders (execute): 2023-02-20 16:25:50.709541 => 2023-02-20 16:25:51.201044
[0m16:25:51.201432 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_orders: Close
[0m16:25:51.311462 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd1c6442-da4b-43f6-8a7e-4cbf9931d991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f7a8e0>]}
[0m16:25:51.311828 [info ] [Thread-2  ]: 2 of 3 OK created sql view model DBT.v_stg_orders .............................. [[32mSUCCESS 1[0m in 1.45s]
[0m16:25:51.312055 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_orders
[0m16:25:51.313351 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:25:51.313694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:51.313800 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.v_stg_inventory' was properly closed.
[0m16:25:51.313878 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.v_stg_orders' was properly closed.
[0m16:25:51.313953 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.v_stg_transactions' was properly closed.
[0m16:25:51.314096 [info ] [MainThread]: 
[0m16:25:51.314240 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m16:25:51.314488 [debug] [MainThread]: Command end result
[0m16:25:51.322296 [info ] [MainThread]: 
[0m16:25:51.322528 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:25:51.322661 [info ] [MainThread]: 
[0m16:25:51.322777 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:25:51.322958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc2a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f318b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059412e0>]}
[0m16:25:51.323101 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 16:28:05.500569 | e34bbc64-3c98-47c3-966e-a6e7097991b0 ==============================
[0m16:28:05.500569 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:28:05.501780 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:hub'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:28:05.501930 [debug] [MainThread]: Tracking: tracking
[0m16:28:05.502178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106971be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106971f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106971e50>]}
[0m16:28:05.568971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:28:05.569191 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:28:05.574709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e34bbc64-3c98-47c3-966e-a6e7097991b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f55730>]}
[0m16:28:05.583177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e34bbc64-3c98-47c3-966e-a6e7097991b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106963670>]}
[0m16:28:05.583382 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 630 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m16:28:05.583528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e34bbc64-3c98-47c3-966e-a6e7097991b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d1e070>]}
[0m16:28:05.584596 [info ] [MainThread]: 
[0m16:28:05.585533 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:28:05.586215 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST'
[0m16:28:05.594852 [debug] [ThreadPool]: Using snowflake connection "list_TEST"
[0m16:28:05.595071 [debug] [ThreadPool]: On list_TEST: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_TEST"} */
show terse schemas in database TEST
    limit 10000
[0m16:28:05.595207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:06.222215 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m16:28:06.224321 [debug] [ThreadPool]: On list_TEST: Close
[0m16:28:06.353281 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST_DBT'
[0m16:28:06.358020 [debug] [ThreadPool]: Using snowflake connection "list_TEST_DBT"
[0m16:28:06.358157 [debug] [ThreadPool]: On list_TEST_DBT: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_TEST_DBT"} */
show terse objects in TEST.DBT
[0m16:28:06.358261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:28:06.864067 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m16:28:06.867353 [debug] [ThreadPool]: On list_TEST_DBT: Close
[0m16:28:06.974079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e34bbc64-3c98-47c3-966e-a6e7097991b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069861c0>]}
[0m16:28:06.974568 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:28:06.974725 [info ] [MainThread]: 
[0m16:28:06.978737 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
[0m16:28:06.979072 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
[0m16:28:06.979275 [info ] [Thread-1  ]: 1 of 7 START sql incremental model DBT.hub_customer ............................ [RUN]
[0m16:28:06.979666 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
[0m16:28:06.980130 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_order
[0m16:28:06.980455 [info ] [Thread-2  ]: 2 of 7 START sql incremental model DBT.hub_lineitem ............................ [RUN]
[0m16:28:06.981127 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_customer'
[0m16:28:06.981535 [info ] [Thread-4  ]: 3 of 7 START sql incremental model DBT.hub_nation .............................. [RUN]
[0m16:28:06.981954 [info ] [Thread-3  ]: 4 of 7 START sql incremental model DBT.hub_order ............................... [RUN]
[0m16:28:06.982439 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_lineitem'
[0m16:28:06.982591 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
[0m16:28:06.982866 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_nation'
[0m16:28:06.983108 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_order'
[0m16:28:06.983226 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
[0m16:28:06.996050 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
[0m16:28:06.999916 [info ] [Thread-1  ]: 16:28:06 + Loading TEST.DBT.hub_customer from 1 source(s)
[0m16:28:07.000177 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
[0m16:28:07.003426 [info ] [Thread-2  ]: 16:28:07 + Loading TEST.DBT.hub_lineitem from 1 source(s)
[0m16:28:07.007391 [info ] [Thread-4  ]: 16:28:07 + Loading TEST.DBT.hub_nation from 2 source(s)
[0m16:28:07.022940 [info ] [Thread-3  ]: 16:28:07 + Loading TEST.DBT.hub_order from 1 source(s)
[0m16:28:07.065115 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:28:07.065638 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
[0m16:28:07.066546 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
[0m16:28:07.068254 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
[0m16:28:07.068878 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (compile): 2023-02-20 16:28:06.983312 => 2023-02-20 16:28:07.068840
[0m16:28:07.069023 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
[0m16:28:07.075097 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (compile): 2023-02-20 16:28:07.003631 => 2023-02-20 16:28:07.075064
[0m16:28:07.075214 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (compile): 2023-02-20 16:28:07.000313 => 2023-02-20 16:28:07.075183
[0m16:28:07.075312 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (compile): 2023-02-20 16:28:07.019687 => 2023-02-20 16:28:07.075295
[0m16:28:07.087539 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
[0m16:28:07.100388 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_customer"
[0m16:28:07.100511 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
[0m16:28:07.100629 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
[0m16:28:07.102671 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_nation"
[0m16:28:07.105051 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:28:07.106935 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_order"
[0m16:28:07.107733 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m16:28:07.107842 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
create or replace transient table TEST.DBT.hub_customer  as
        (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_orders AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
        );
[0m16:28:07.107935 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:28:07.109342 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:28:07.109469 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
create or replace transient table TEST.DBT.hub_lineitem  as
        (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_orders AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
        );
[0m16:28:07.110421 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m16:28:07.110506 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:28:07.111021 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m16:28:07.111108 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
create or replace transient table TEST.DBT.hub_nation  as
        (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_orders AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_inventory AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
        );
[0m16:28:07.111574 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
create or replace transient table TEST.DBT.hub_order  as
        (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_orders AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
        );
[0m16:28:07.111984 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:28:07.112126 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:28:09.588900 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m16:28:09.596139 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m16:28:09.596278 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
drop view if exists TEST.DBT.hub_customer__dbt_tmp cascade
[0m16:28:09.648431 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:28:09.662078 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (execute): 2023-02-20 16:28:07.069100 => 2023-02-20 16:28:09.662026
[0m16:28:09.662241 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: Close
[0m16:28:09.743606 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e34bbc64-3c98-47c3-966e-a6e7097991b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c953a0>]}
[0m16:28:09.744090 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model DBT.hub_customer ....................... [[32mSUCCESS 1[0m in 2.76s]
[0m16:28:09.745010 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
[0m16:28:09.745266 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_part
[0m16:28:09.745430 [info ] [Thread-1  ]: 5 of 7 START sql incremental model DBT.hub_part ................................ [RUN]
[0m16:28:09.745900 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_part'
[0m16:28:09.746062 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
[0m16:28:09.749677 [info ] [Thread-1  ]: 16:28:09 + Loading TEST.DBT.hub_part from 2 source(s)
[0m16:28:09.752805 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
[0m16:28:09.753266 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (compile): 2023-02-20 16:28:09.746151 => 2023-02-20 16:28:09.753228
[0m16:28:09.753395 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
[0m16:28:09.756269 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_part"
[0m16:28:09.757639 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m16:28:09.757777 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
create or replace transient table TEST.DBT.hub_part  as
        (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_orders AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_inventory AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
        );
[0m16:28:09.757878 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:28:11.262587 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4 seconds
[0m16:28:11.268278 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m16:28:11.268484 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
drop view if exists TEST.DBT.hub_order__dbt_tmp cascade
[0m16:28:11.329593 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:28:11.334799 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (execute): 2023-02-20 16:28:07.105154 => 2023-02-20 16:28:11.334730
[0m16:28:11.335003 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_order: Close
[0m16:28:11.422535 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e34bbc64-3c98-47c3-966e-a6e7097991b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c95bb0>]}
[0m16:28:11.422894 [info ] [Thread-3  ]: 4 of 7 OK created sql incremental model DBT.hub_order .......................... [[32mSUCCESS 1[0m in 4.44s]
[0m16:28:11.423124 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
[0m16:28:11.423327 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_region
[0m16:28:11.423476 [info ] [Thread-3  ]: 6 of 7 START sql incremental model DBT.hub_region .............................. [RUN]
[0m16:28:11.423946 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_region'
[0m16:28:11.424109 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
[0m16:28:11.427779 [info ] [Thread-3  ]: 16:28:11 + Loading TEST.DBT.hub_region from 2 source(s)
[0m16:28:11.431282 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
[0m16:28:11.431784 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (compile): 2023-02-20 16:28:11.424211 => 2023-02-20 16:28:11.431740
[0m16:28:11.431921 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
[0m16:28:11.434134 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_region"
[0m16:28:11.435426 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m16:28:11.435556 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
create or replace transient table TEST.DBT.hub_region  as
        (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_orders AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_inventory AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
        );
[0m16:28:11.435653 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:28:11.712961 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 5 seconds
[0m16:28:11.715394 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m16:28:11.715513 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
drop view if exists TEST.DBT.hub_nation__dbt_tmp cascade
[0m16:28:11.768240 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:28:11.769999 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (execute): 2023-02-20 16:28:07.100708 => 2023-02-20 16:28:11.769958
[0m16:28:11.770179 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_nation: Close
[0m16:28:11.799630 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 5 seconds
[0m16:28:11.803039 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:28:11.803312 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
drop view if exists TEST.DBT.hub_lineitem__dbt_tmp cascade
[0m16:28:11.857963 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:28:11.861404 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (execute): 2023-02-20 16:28:07.102841 => 2023-02-20 16:28:11.861327
[0m16:28:11.861765 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: Close
[0m16:28:11.863554 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e34bbc64-3c98-47c3-966e-a6e7097991b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c95df0>]}
[0m16:28:11.863980 [info ] [Thread-4  ]: 3 of 7 OK created sql incremental model DBT.hub_nation ......................... [[32mSUCCESS 1[0m in 4.88s]
[0m16:28:11.864392 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
[0m16:28:11.864653 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
[0m16:28:11.865014 [info ] [Thread-4  ]: 7 of 7 START sql incremental model DBT.hub_supplier ............................ [RUN]
[0m16:28:11.865415 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_supplier'
[0m16:28:11.865548 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
[0m16:28:11.868918 [info ] [Thread-4  ]: 16:28:11 + Loading TEST.DBT.hub_supplier from 2 source(s)
[0m16:28:11.872529 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:28:11.873304 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (compile): 2023-02-20 16:28:11.865714 => 2023-02-20 16:28:11.873263
[0m16:28:11.873447 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
[0m16:28:11.875810 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:28:11.877546 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:28:11.877691 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
create or replace transient table TEST.DBT.hub_supplier  as
        (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_orders AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_inventory AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
        );
[0m16:28:11.877789 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:28:11.974101 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e34bbc64-3c98-47c3-966e-a6e7097991b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c98940>]}
[0m16:28:11.980513 [info ] [Thread-2  ]: 2 of 7 OK created sql incremental model DBT.hub_lineitem ....................... [[32mSUCCESS 1[0m in 4.99s]
[0m16:28:11.980719 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
[0m16:28:16.062850 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 5 seconds
[0m16:28:16.066432 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m16:28:16.066570 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
drop view if exists TEST.DBT.hub_region__dbt_tmp cascade
[0m16:28:16.122202 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:28:16.124905 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (execute): 2023-02-20 16:28:11.432001 => 2023-02-20 16:28:16.124832
[0m16:28:16.125120 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: Close
[0m16:28:16.205654 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e34bbc64-3c98-47c3-966e-a6e7097991b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c95e50>]}
[0m16:28:16.206049 [info ] [Thread-3  ]: 6 of 7 OK created sql incremental model DBT.hub_region ......................... [[32mSUCCESS 1[0m in 4.78s]
[0m16:28:16.206280 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
[0m16:28:16.695217 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 7 seconds
[0m16:28:16.699474 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m16:28:16.699657 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
drop view if exists TEST.DBT.hub_part__dbt_tmp cascade
[0m16:28:16.756637 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:28:16.759716 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (execute): 2023-02-20 16:28:09.753473 => 2023-02-20 16:28:16.759647
[0m16:28:16.759919 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: Close
[0m16:28:16.848230 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e34bbc64-3c98-47c3-966e-a6e7097991b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c954f0>]}
[0m16:28:16.848798 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model DBT.hub_part ........................... [[32mSUCCESS 1[0m in 7.10s]
[0m16:28:16.849050 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
[0m16:28:17.208915 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 5 seconds
[0m16:28:17.213721 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:28:17.213963 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
drop view if exists TEST.DBT.hub_supplier__dbt_tmp cascade
[0m16:28:17.267427 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:28:17.270420 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (execute): 2023-02-20 16:28:11.873535 => 2023-02-20 16:28:17.270351
[0m16:28:17.270667 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: Close
[0m16:28:17.365472 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e34bbc64-3c98-47c3-966e-a6e7097991b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c950a0>]}
[0m16:28:17.365830 [info ] [Thread-4  ]: 7 of 7 OK created sql incremental model DBT.hub_supplier ....................... [[32mSUCCESS 1[0m in 5.50s]
[0m16:28:17.366060 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
[0m16:28:17.367303 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:28:17.367622 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:17.367725 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.hub_part' was properly closed.
[0m16:28:17.367803 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.hub_lineitem' was properly closed.
[0m16:28:17.367876 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.hub_supplier' was properly closed.
[0m16:28:17.367946 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.hub_region' was properly closed.
[0m16:28:17.368081 [info ] [MainThread]: 
[0m16:28:17.368248 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 11.78 seconds (11.78s).
[0m16:28:17.368606 [debug] [MainThread]: Command end result
[0m16:28:17.377436 [info ] [MainThread]: 
[0m16:28:17.377668 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:28:17.377804 [info ] [MainThread]: 
[0m16:28:17.377926 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m16:28:17.378110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff3c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106960d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a5a0a0>]}
[0m16:28:17.378254 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 16:29:25.454477 | 86a0605d-8877-4b00-8abc-16489b399ba2 ==============================
[0m16:29:25.454477 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:29:25.455402 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:raw_vault'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:29:25.455523 [debug] [MainThread]: Tracking: tracking
[0m16:29:25.455731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068beb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068bef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068bedf0>]}
[0m16:29:25.509988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:29:25.510182 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:29:25.515168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c946d0>]}
[0m16:29:25.523601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a4610>]}
[0m16:29:25.523800 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 630 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m16:29:25.523955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b62040>]}
[0m16:29:25.525422 [info ] [MainThread]: 
[0m16:29:25.526226 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:29:25.527341 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST'
[0m16:29:25.536349 [debug] [ThreadPool]: Using snowflake connection "list_TEST"
[0m16:29:25.536587 [debug] [ThreadPool]: On list_TEST: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_TEST"} */
show terse schemas in database TEST
    limit 10000
[0m16:29:25.536707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:26.337442 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m16:29:26.338793 [debug] [ThreadPool]: On list_TEST: Close
[0m16:29:26.439279 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST_DBT'
[0m16:29:26.444026 [debug] [ThreadPool]: Using snowflake connection "list_TEST_DBT"
[0m16:29:26.444157 [debug] [ThreadPool]: On list_TEST_DBT: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_TEST_DBT"} */
show terse objects in TEST.DBT
[0m16:29:26.444260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:26.974180 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m16:29:26.976750 [debug] [ThreadPool]: On list_TEST_DBT: Close
[0m16:29:27.110417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d2a60>]}
[0m16:29:27.110910 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:29:27.111089 [info ] [MainThread]: 
[0m16:29:27.113984 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
[0m16:29:27.114178 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
[0m16:29:27.114351 [info ] [Thread-1  ]: 1 of 25 START sql incremental model DBT.hub_customer ........................... [RUN]
[0m16:29:27.114535 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
[0m16:29:27.114697 [info ] [Thread-2  ]: 2 of 25 START sql incremental model DBT.hub_lineitem ........................... [RUN]
[0m16:29:27.115032 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_customer'
[0m16:29:27.115150 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_order
[0m16:29:27.115288 [info ] [Thread-3  ]: 3 of 25 START sql incremental model DBT.hub_nation ............................. [RUN]
[0m16:29:27.115690 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_lineitem'
[0m16:29:27.115836 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
[0m16:29:27.115985 [info ] [Thread-4  ]: 4 of 25 START sql incremental model DBT.hub_order .............................. [RUN]
[0m16:29:27.116271 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_nation'
[0m16:29:27.116374 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
[0m16:29:27.129250 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_order'
[0m16:29:27.133678 [info ] [Thread-1  ]: 16:29:27 + Loading TEST.DBT.hub_customer from 1 source(s)
[0m16:29:27.134019 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
[0m16:29:27.137309 [info ] [Thread-2  ]: 16:29:27 + Loading TEST.DBT.hub_lineitem from 1 source(s)
[0m16:29:27.137597 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
[0m16:29:27.153893 [info ] [Thread-3  ]: 16:29:27 + Loading TEST.DBT.hub_nation from 2 source(s)
[0m16:29:27.193887 [info ] [Thread-4  ]: 16:29:27 + Loading TEST.DBT.hub_order from 1 source(s)
[0m16:29:27.195609 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
[0m16:29:27.196820 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:29:27.201094 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
[0m16:29:27.203855 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
[0m16:29:27.204467 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (compile): 2023-02-20 16:29:27.150228 => 2023-02-20 16:29:27.204409
[0m16:29:27.204647 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
[0m16:29:27.211077 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (compile): 2023-02-20 16:29:27.116451 => 2023-02-20 16:29:27.211021
[0m16:29:27.211292 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (compile): 2023-02-20 16:29:27.134139 => 2023-02-20 16:29:27.211235
[0m16:29:27.211446 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (compile): 2023-02-20 16:29:27.191102 => 2023-02-20 16:29:27.211425
[0m16:29:27.223912 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
[0m16:29:27.232809 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m16:29:27.233005 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
[0m16:29:27.233121 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
[0m16:29:27.236051 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m16:29:27.236168 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
create or replace  temporary view TEST.DBT.hub_nation__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_orders AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_inventory AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN TEST.DBT.hub_nation AS d
    ON a.NATION_PK = d.NATION_PK
    WHERE d.NATION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:29:27.238453 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:29:27.240714 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m16:29:27.240815 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
create or replace  temporary view TEST.DBT.hub_customer__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_orders AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DBT.hub_customer AS d
    ON a.CUSTOMER_PK = d.CUSTOMER_PK
    WHERE d.CUSTOMER_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:29:27.240908 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:29:27.240991 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
create or replace  temporary view TEST.DBT.hub_lineitem__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_orders AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DBT.hub_lineitem AS d
    ON a.LINEITEM_PK = d.LINEITEM_PK
    WHERE d.LINEITEM_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:29:27.241074 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
create or replace  temporary view TEST.DBT.hub_order__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_orders AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DBT.hub_order AS d
    ON a.ORDER_PK = d.ORDER_PK
    WHERE d.ORDER_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:29:27.241154 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:29:27.242033 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:29:27.242148 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:29:28.237138 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:29:28.245575 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m16:29:28.245759 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
describe table TEST.DBT.hub_order__dbt_tmp
[0m16:29:28.282265 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:29:28.284224 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m16:29:28.284350 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
describe table TEST.DBT.hub_customer__dbt_tmp
[0m16:29:28.453538 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:29:28.455484 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:29:28.459028 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m16:29:28.461485 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m16:29:28.461601 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
describe table TEST.DBT.hub_order
[0m16:29:28.461696 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
describe table TEST.DBT.hub_customer
[0m16:29:28.487596 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:29:28.489304 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:29:28.489402 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
describe table TEST.DBT.hub_lineitem__dbt_tmp
[0m16:29:28.509080 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:29:28.512578 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m16:29:28.512685 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
describe table TEST.DBT.hub_nation__dbt_tmp
[0m16:29:28.602288 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:29:28.603569 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:29:28.603979 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:29:28.604670 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:29:28.607862 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:29:28.612564 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m16:29:28.615013 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m16:29:28.616867 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m16:29:28.616975 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
describe table TEST.DBT.hub_lineitem
[0m16:29:28.617063 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
describe table "TEST"."DBT"."HUB_CUSTOMER"
[0m16:29:28.617145 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
describe table "TEST"."DBT"."HUB_ORDER"
[0m16:29:28.617225 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
describe table TEST.DBT.hub_nation
[0m16:29:28.699799 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:29:28.700637 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:29:28.709358 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m16:29:28.709506 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
describe table "TEST"."DBT"."HUB_NATION"
[0m16:29:28.713417 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_customer"
[0m16:29:28.714020 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m16:29:28.714117 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
-- back compat for old kwarg name
  
  begin;
[0m16:29:28.731610 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:29:28.733821 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:29:28.733935 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
describe table "TEST"."DBT"."HUB_LINEITEM"
[0m16:29:28.753367 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:29:28.754830 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_order"
[0m16:29:28.755293 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m16:29:28.755387 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
-- back compat for old kwarg name
  
  begin;
[0m16:29:28.792856 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:29:28.796206 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_nation"
[0m16:29:28.796636 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m16:29:28.796737 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
-- back compat for old kwarg name
  
  begin;
[0m16:29:28.806984 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m16:29:28.810255 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:29:28.810720 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:29:28.810823 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
-- back compat for old kwarg name
  
  begin;
[0m16:29:28.831575 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:28.832351 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m16:29:28.832853 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
insert into TEST.DBT.hub_customer ("CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DBT.hub_customer__dbt_tmp
        );
[0m16:29:28.836674 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:28.837543 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m16:29:28.837827 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
insert into TEST.DBT.hub_order ("ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DBT.hub_order__dbt_tmp
        );
[0m16:29:28.868120 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:28.869175 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m16:29:28.869578 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
insert into TEST.DBT.hub_nation ("NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DBT.hub_nation__dbt_tmp
        );
[0m16:29:28.910025 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:28.910866 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:29:28.911172 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
insert into TEST.DBT.hub_lineitem ("LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DBT.hub_lineitem__dbt_tmp
        );
[0m16:29:31.160969 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 2 seconds
[0m16:29:31.162095 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 2 seconds
[0m16:29:31.162329 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m16:29:31.162483 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m16:29:31.162587 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
COMMIT
[0m16:29:31.162679 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
COMMIT
[0m16:29:31.339529 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 2 seconds
[0m16:29:31.340673 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:29:31.341049 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
COMMIT
[0m16:29:31.422054 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:31.430357 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m16:29:31.430522 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
drop view if exists TEST.DBT.hub_customer__dbt_tmp cascade
[0m16:29:31.446237 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:31.447960 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m16:29:31.448054 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
drop view if exists TEST.DBT.hub_order__dbt_tmp cascade
[0m16:29:31.523416 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:31.536885 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (execute): 2023-02-20 16:29:27.233196 => 2023-02-20 16:29:31.536843
[0m16:29:31.537059 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: Close
[0m16:29:31.546738 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:31.547822 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (execute): 2023-02-20 16:29:27.238546 => 2023-02-20 16:29:31.547802
[0m16:29:31.547931 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: Close
[0m16:29:31.571868 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:31.573742 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m16:29:31.573841 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
drop view if exists TEST.DBT.hub_lineitem__dbt_tmp cascade
[0m16:29:31.607522 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168d4e20>]}
[0m16:29:31.608253 [info ] [Thread-1  ]: 1 of 25 OK created sql incremental model DBT.hub_customer ...................... [[32mSUCCESS 0[0m in 4.49s]
[0m16:29:31.609185 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
[0m16:29:31.609396 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_part
[0m16:29:31.609572 [info ] [Thread-1  ]: 5 of 25 START sql incremental model DBT.hub_part ............................... [RUN]
[0m16:29:31.609901 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_part'
[0m16:29:31.610090 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
[0m16:29:31.613442 [info ] [Thread-1  ]: 16:29:31 + Loading TEST.DBT.hub_part from 2 source(s)
[0m16:29:31.617532 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
[0m16:29:31.618061 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (compile): 2023-02-20 16:29:31.610202 => 2023-02-20 16:29:31.618018
[0m16:29:31.618202 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
[0m16:29:31.621489 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m16:29:31.621684 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
create or replace  temporary view TEST.DBT.hub_part__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_orders AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_inventory AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN TEST.DBT.hub_part AS d
    ON a.PART_PK = d.PART_PK
    WHERE d.PART_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:29:31.621796 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:29:31.630868 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116de53a0>]}
[0m16:29:31.631157 [info ] [Thread-4  ]: 4 of 25 OK created sql incremental model DBT.hub_order ......................... [[32mSUCCESS 0[0m in 4.50s]
[0m16:29:31.631350 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
[0m16:29:31.631509 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_region
[0m16:29:31.631708 [info ] [Thread-4  ]: 6 of 25 START sql incremental model DBT.hub_region ............................. [RUN]
[0m16:29:31.632027 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_region'
[0m16:29:31.632141 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
[0m16:29:31.635604 [info ] [Thread-4  ]: 16:29:31 + Loading TEST.DBT.hub_region from 2 source(s)
[0m16:29:31.639522 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
[0m16:29:31.639874 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (compile): 2023-02-20 16:29:31.632216 => 2023-02-20 16:29:31.639839
[0m16:29:31.639991 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
[0m16:29:31.643010 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m16:29:31.643122 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
create or replace  temporary view TEST.DBT.hub_region__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_orders AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_inventory AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN TEST.DBT.hub_region AS d
    ON a.REGION_PK = d.REGION_PK
    WHERE d.REGION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:29:31.643213 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:29:31.666709 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:31.668076 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (execute): 2023-02-20 16:29:27.236250 => 2023-02-20 16:29:31.668041
[0m16:29:31.668206 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: Close
[0m16:29:31.853475 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168d4c40>]}
[0m16:29:31.853808 [info ] [Thread-2  ]: 2 of 25 OK created sql incremental model DBT.hub_lineitem ...................... [[32mSUCCESS 0[0m in 4.74s]
[0m16:29:31.854009 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
[0m16:29:31.854171 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
[0m16:29:31.854311 [info ] [Thread-2  ]: 7 of 25 START sql incremental model DBT.hub_supplier ........................... [RUN]
[0m16:29:31.854613 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_supplier'
[0m16:29:31.854731 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
[0m16:29:31.858627 [info ] [Thread-2  ]: 16:29:31 + Loading TEST.DBT.hub_supplier from 2 source(s)
[0m16:29:31.862748 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:29:31.863269 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (compile): 2023-02-20 16:29:31.854879 => 2023-02-20 16:29:31.863136
[0m16:29:31.863485 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
[0m16:29:31.867809 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:29:31.868024 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
create or replace  temporary view TEST.DBT.hub_supplier__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_orders AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_inventory AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN TEST.DBT.hub_supplier AS d
    ON a.SUPPLIER_PK = d.SUPPLIER_PK
    WHERE d.SUPPLIER_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m16:29:31.868126 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:29:32.621443 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:29:32.624892 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m16:29:32.625038 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
describe table TEST.DBT.hub_part__dbt_tmp
[0m16:29:32.670411 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:29:32.672378 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:29:32.675358 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m16:29:32.677937 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:29:32.678076 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
describe table TEST.DBT.hub_region__dbt_tmp
[0m16:29:32.678168 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
describe table TEST.DBT.hub_supplier__dbt_tmp
[0m16:29:32.702105 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:29:32.705095 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m16:29:32.705227 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
describe table TEST.DBT.hub_part
[0m16:29:32.745312 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:29:32.746731 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:29:32.750949 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m16:29:32.753119 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:29:32.753237 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
describe table TEST.DBT.hub_region
[0m16:29:32.753325 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
describe table TEST.DBT.hub_supplier
[0m16:29:32.770892 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:29:32.772875 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m16:29:32.772977 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
describe table "TEST"."DBT"."HUB_PART"
[0m16:29:32.816334 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:29:32.823219 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:29:32.823423 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
describe table "TEST"."DBT"."HUB_SUPPLIER"
[0m16:29:32.828953 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:29:32.859110 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_part"
[0m16:29:32.859686 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:29:32.861800 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m16:29:32.861915 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
describe table "TEST"."DBT"."HUB_REGION"
[0m16:29:32.862731 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m16:29:32.862826 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
-- back compat for old kwarg name
  
  begin;
[0m16:29:32.892593 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:29:32.894044 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:29:32.894452 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:29:32.894541 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
-- back compat for old kwarg name
  
  begin;
[0m16:29:32.936108 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:29:32.937401 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_region"
[0m16:29:32.937814 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m16:29:32.937902 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
-- back compat for old kwarg name
  
  begin;
[0m16:29:32.990603 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:32.991118 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m16:29:32.991364 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
insert into TEST.DBT.hub_part ("PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DBT.hub_part__dbt_tmp
        );
[0m16:29:32.997226 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:32.997367 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:29:32.997451 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
insert into TEST.DBT.hub_supplier ("SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DBT.hub_supplier__dbt_tmp
        );
[0m16:29:33.049097 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:33.049892 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m16:29:33.050227 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
insert into TEST.DBT.hub_region ("REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DBT.hub_region__dbt_tmp
        );
[0m16:29:34.817035 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 6 seconds
[0m16:29:34.818139 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m16:29:34.818356 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
COMMIT
[0m16:29:35.231601 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:35.236548 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m16:29:35.236749 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
drop view if exists TEST.DBT.hub_nation__dbt_tmp cascade
[0m16:29:35.326830 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:35.330324 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (execute): 2023-02-20 16:29:27.204742 => 2023-02-20 16:29:35.330250
[0m16:29:35.330531 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: Close
[0m16:29:35.576136 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1230fc2e0>]}
[0m16:29:35.577365 [info ] [Thread-3  ]: 3 of 25 OK created sql incremental model DBT.hub_nation ........................ [[32mSUCCESS 0[0m in 8.46s]
[0m16:29:35.577694 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
[0m16:29:35.577913 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_customer_nation
[0m16:29:35.578090 [info ] [Thread-3  ]: 8 of 25 START sql incremental model DBT.link_customer_nation ................... [RUN]
[0m16:29:35.578641 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_customer_nation'
[0m16:29:35.578796 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
[0m16:29:35.585117 [info ] [Thread-3  ]: 16:29:35 + Loading TEST.DBT.link_customer_nation from 1 source(s)
[0m16:29:35.596470 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
[0m16:29:35.596952 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_nation (compile): 2023-02-20 16:29:35.578882 => 2023-02-20 16:29:35.596916
[0m16:29:35.597074 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_nation
[0m16:29:35.608339 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_customer_nation"
[0m16:29:35.609418 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m16:29:35.609552 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
create or replace transient table TEST.DBT.link_customer_nation  as
        (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_orders AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
        );
[0m16:29:35.609649 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:29:37.848840 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 5 seconds
[0m16:29:37.850276 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m16:29:37.850567 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
COMMIT
[0m16:29:37.852605 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 5 seconds
[0m16:29:37.852960 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m16:29:37.853061 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
COMMIT
[0m16:29:38.053142 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m16:29:38.057866 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m16:29:38.058116 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
drop view if exists TEST.DBT.link_customer_nation__dbt_tmp cascade
[0m16:29:38.071844 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:38.073604 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m16:29:38.073699 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
drop view if exists TEST.DBT.hub_part__dbt_tmp cascade
[0m16:29:38.096119 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:38.101853 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m16:29:38.102003 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
drop view if exists TEST.DBT.hub_region__dbt_tmp cascade
[0m16:29:38.130813 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:38.136592 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_nation (execute): 2023-02-20 16:29:35.597146 => 2023-02-20 16:29:38.136524
[0m16:29:38.136800 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_nation: Close
[0m16:29:38.166163 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:38.169505 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (execute): 2023-02-20 16:29:31.618285 => 2023-02-20 16:29:38.169478
[0m16:29:38.169657 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: Close
[0m16:29:38.224914 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:38.227199 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (execute): 2023-02-20 16:29:31.640063 => 2023-02-20 16:29:38.227162
[0m16:29:38.227360 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: Close
[0m16:29:38.281254 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232f88e0>]}
[0m16:29:38.281702 [info ] [Thread-3  ]: 8 of 25 OK created sql incremental model DBT.link_customer_nation .............. [[32mSUCCESS 1[0m in 2.70s]
[0m16:29:38.282708 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_nation
[0m16:29:38.283235 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_customer_order
[0m16:29:38.283760 [info ] [Thread-3  ]: 9 of 25 START sql incremental model DBT.link_customer_order .................... [RUN]
[0m16:29:38.284314 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_customer_order'
[0m16:29:38.284463 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_order
[0m16:29:38.288369 [info ] [Thread-3  ]: 16:29:38 + Loading TEST.DBT.link_customer_order from 1 source(s)
[0m16:29:38.293431 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
[0m16:29:38.294625 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_order (compile): 2023-02-20 16:29:38.284556 => 2023-02-20 16:29:38.294543
[0m16:29:38.294938 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_order
[0m16:29:38.299067 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_customer_order"
[0m16:29:38.300533 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m16:29:38.300707 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
create or replace transient table TEST.DBT.link_customer_order  as
        (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_orders AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
        );
[0m16:29:38.300861 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:29:38.329330 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232af2b0>]}
[0m16:29:38.329665 [info ] [Thread-1  ]: 5 of 25 OK created sql incremental model DBT.hub_part .......................... [[32mSUCCESS 0[0m in 6.72s]
[0m16:29:38.329865 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
[0m16:29:38.330025 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_inventory
[0m16:29:38.330299 [info ] [Thread-1  ]: 10 of 25 START sql incremental model DBT.link_inventory ........................ [RUN]
[0m16:29:38.330781 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_inventory'
[0m16:29:38.330935 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory
[0m16:29:38.334959 [info ] [Thread-1  ]: 16:29:38 + Loading TEST.DBT.link_inventory from 1 source(s)
[0m16:29:38.337642 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
[0m16:29:38.338149 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory (compile): 2023-02-20 16:29:38.331037 => 2023-02-20 16:29:38.338107
[0m16:29:38.338286 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory
[0m16:29:38.340469 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_inventory"
[0m16:29:38.341279 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m16:29:38.341377 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
create or replace transient table TEST.DBT.link_inventory  as
        (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_inventory AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
        );
[0m16:29:38.341465 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:29:38.393154 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232a7fa0>]}
[0m16:29:38.393458 [info ] [Thread-4  ]: 6 of 25 OK created sql incremental model DBT.hub_region ........................ [[32mSUCCESS 0[0m in 6.76s]
[0m16:29:38.393650 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
[0m16:29:38.393803 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m16:29:38.393989 [info ] [Thread-4  ]: 11 of 25 START sql incremental model DBT.link_inventory_allocation ............. [RUN]
[0m16:29:38.394294 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_inventory_allocation'
[0m16:29:38.394413 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m16:29:38.397630 [info ] [Thread-4  ]: 16:29:38 + Loading TEST.DBT.link_inventory_allocation from 1 source(s)
[0m16:29:38.400882 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m16:29:38.402255 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory_allocation (compile): 2023-02-20 16:29:38.394487 => 2023-02-20 16:29:38.402209
[0m16:29:38.402407 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m16:29:38.404759 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m16:29:38.405756 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m16:29:38.405849 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
create or replace transient table TEST.DBT.link_inventory_allocation  as
        (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_orders AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
        );
[0m16:29:38.405936 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:29:38.608890 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 6 seconds
[0m16:29:38.609108 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:29:38.609200 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
COMMIT
[0m16:29:38.897536 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:38.899756 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m16:29:38.899864 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
drop view if exists TEST.DBT.hub_supplier__dbt_tmp cascade
[0m16:29:39.033349 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:39.037200 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (execute): 2023-02-20 16:29:31.863574 => 2023-02-20 16:29:39.037121
[0m16:29:39.037414 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: Close
[0m16:29:39.139305 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116dc8c40>]}
[0m16:29:39.139682 [info ] [Thread-2  ]: 7 of 25 OK created sql incremental model DBT.hub_supplier ...................... [[32mSUCCESS 0[0m in 7.28s]
[0m16:29:39.139911 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
[0m16:29:39.140110 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_nation_region
[0m16:29:39.140269 [info ] [Thread-2  ]: 12 of 25 START sql incremental model DBT.link_nation_region .................... [RUN]
[0m16:29:39.140701 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_nation_region'
[0m16:29:39.140860 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_nation_region
[0m16:29:39.145185 [info ] [Thread-2  ]: 16:29:39 + Loading TEST.DBT.link_nation_region from 2 source(s)
[0m16:29:39.148691 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
[0m16:29:39.149191 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_nation_region (compile): 2023-02-20 16:29:39.140947 => 2023-02-20 16:29:39.149149
[0m16:29:39.149323 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_nation_region
[0m16:29:39.151564 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_nation_region"
[0m16:29:39.153974 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m16:29:39.154238 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
create or replace transient table TEST.DBT.link_nation_region  as
        (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
        );
[0m16:29:39.154416 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:29:42.138076 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4 seconds
[0m16:29:42.142709 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m16:29:42.142950 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
drop view if exists TEST.DBT.link_inventory__dbt_tmp cascade
[0m16:29:42.145390 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4 seconds
[0m16:29:42.147127 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m16:29:42.147231 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
drop view if exists TEST.DBT.link_inventory_allocation__dbt_tmp cascade
[0m16:29:42.256079 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:42.259538 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory (execute): 2023-02-20 16:29:38.338369 => 2023-02-20 16:29:42.259459
[0m16:29:42.259760 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_inventory: Close
[0m16:29:42.264125 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:42.265348 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory_allocation (execute): 2023-02-20 16:29:38.402490 => 2023-02-20 16:29:42.265325
[0m16:29:42.265461 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
[0m16:29:42.350504 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12335e100>]}
[0m16:29:42.350942 [info ] [Thread-1  ]: 10 of 25 OK created sql incremental model DBT.link_inventory ................... [[32mSUCCESS 1[0m in 4.02s]
[0m16:29:42.351361 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116de53a0>]}
[0m16:29:42.351538 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory
[0m16:29:42.351763 [info ] [Thread-4  ]: 11 of 25 OK created sql incremental model DBT.link_inventory_allocation ........ [[32mSUCCESS 1[0m in 3.96s]
[0m16:29:42.352034 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_order_lineitem
[0m16:29:42.352167 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m16:29:42.352319 [info ] [Thread-1  ]: 13 of 25 START sql incremental model DBT.link_order_lineitem ................... [RUN]
[0m16:29:42.352634 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_supplier_nation
[0m16:29:42.352939 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_order_lineitem'
[0m16:29:42.353117 [info ] [Thread-4  ]: 14 of 25 START sql incremental model DBT.link_supplier_nation .................. [RUN]
[0m16:29:42.353277 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
[0m16:29:42.354159 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_supplier_nation'
[0m16:29:42.361199 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
[0m16:29:42.366874 [info ] [Thread-4  ]: 16:29:42 + Loading TEST.DBT.link_supplier_nation from 1 source(s)
[0m16:29:42.368233 [info ] [Thread-1  ]: 16:29:42 + Loading TEST.DBT.link_order_lineitem from 1 source(s)
[0m16:29:42.370713 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m16:29:42.372960 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m16:29:42.373479 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_supplier_nation (compile): 2023-02-20 16:29:42.361442 => 2023-02-20 16:29:42.373432
[0m16:29:42.373613 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
[0m16:29:42.376018 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m16:29:42.376177 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_order_lineitem (compile): 2023-02-20 16:29:42.354508 => 2023-02-20 16:29:42.376148
[0m16:29:42.376328 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
[0m16:29:42.378467 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m16:29:42.379662 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m16:29:42.379928 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
create or replace transient table TEST.DBT.link_supplier_nation  as
        (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_inventory AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
        );
[0m16:29:42.380087 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:29:42.381355 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m16:29:42.381477 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
create or replace transient table TEST.DBT.link_order_lineitem  as
        (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DBT.v_stg_orders AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
        );
[0m16:29:42.381864 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:29:44.528553 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 6 seconds
[0m16:29:44.532933 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m16:29:44.533100 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
drop view if exists TEST.DBT.link_customer_order__dbt_tmp cascade
[0m16:29:44.591211 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:44.596796 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_order (execute): 2023-02-20 16:29:38.295181 => 2023-02-20 16:29:44.596719
[0m16:29:44.597012 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_order: Close
[0m16:29:44.608371 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 5 seconds
[0m16:29:44.611915 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m16:29:44.612077 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
drop view if exists TEST.DBT.link_nation_region__dbt_tmp cascade
[0m16:29:44.651105 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m16:29:44.654321 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m16:29:44.654487 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
drop view if exists TEST.DBT.link_order_lineitem__dbt_tmp cascade
[0m16:29:44.671682 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:44.675597 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_nation_region (execute): 2023-02-20 16:29:39.149399 => 2023-02-20 16:29:44.675511
[0m16:29:44.675955 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: Close
[0m16:29:44.680506 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169f88e0>]}
[0m16:29:44.680801 [info ] [Thread-3  ]: 9 of 25 OK created sql incremental model DBT.link_customer_order ............... [[32mSUCCESS 1[0m in 6.40s]
[0m16:29:44.681014 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_order
[0m16:29:44.681196 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m16:29:44.681426 [info ] [Thread-3  ]: 15 of 25 START sql incremental model DBT.sat_inv_inventory_details ............. [RUN]
[0m16:29:44.681763 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_inventory_details'
[0m16:29:44.681897 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m16:29:44.713283 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m16:29:44.714714 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_inventory_details (compile): 2023-02-20 16:29:44.681979 => 2023-02-20 16:29:44.714673
[0m16:29:44.714851 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m16:29:44.717031 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m16:29:44.717920 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:44.719313 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_order_lineitem (execute): 2023-02-20 16:29:42.376445 => 2023-02-20 16:29:44.719282
[0m16:29:44.719479 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: Close
[0m16:29:44.721093 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m16:29:44.721212 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
create or replace transient table TEST.DBT.sat_inv_inventory_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DBT.v_stg_inventory AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m16:29:44.721311 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:29:44.804424 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168d4b80>]}
[0m16:29:44.810988 [info ] [Thread-2  ]: 12 of 25 OK created sql incremental model DBT.link_nation_region ............... [[32mSUCCESS 1[0m in 5.66s]
[0m16:29:44.811319 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_nation_region
[0m16:29:44.811503 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m16:29:44.811647 [info ] [Thread-2  ]: 16 of 25 START sql incremental model DBT.sat_inv_part_details .................. [RUN]
[0m16:29:44.817572 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_part_details'
[0m16:29:44.817769 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m16:29:44.826733 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m16:29:44.829952 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_part_details (compile): 2023-02-20 16:29:44.817856 => 2023-02-20 16:29:44.829902
[0m16:29:44.830145 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m16:29:44.833019 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m16:29:44.834341 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m16:29:44.834459 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
create or replace transient table TEST.DBT.sat_inv_part_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DBT.v_stg_inventory AS a
    WHERE a.PART_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m16:29:44.834552 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:29:44.859302 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169f8910>]}
[0m16:29:44.859572 [info ] [Thread-1  ]: 13 of 25 OK created sql incremental model DBT.link_order_lineitem .............. [[32mSUCCESS 1[0m in 2.51s]
[0m16:29:44.859800 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
[0m16:29:44.860134 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m16:29:44.860305 [info ] [Thread-1  ]: 17 of 25 START sql incremental model DBT.sat_inv_supp_nation_details ........... [RUN]
[0m16:29:44.860732 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details'
[0m16:29:44.860873 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m16:29:44.868671 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m16:29:44.869560 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_nation_details (compile): 2023-02-20 16:29:44.860993 => 2023-02-20 16:29:44.869517
[0m16:29:44.869716 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m16:29:44.872026 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m16:29:44.872856 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m16:29:44.872962 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
create or replace transient table TEST.DBT.sat_inv_supp_nation_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DBT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m16:29:44.873055 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:29:45.332758 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3 seconds
[0m16:29:45.335990 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m16:29:45.336109 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
drop view if exists TEST.DBT.link_supplier_nation__dbt_tmp cascade
[0m16:29:45.419305 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:45.424613 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_supplier_nation (execute): 2023-02-20 16:29:42.373692 => 2023-02-20 16:29:45.424539
[0m16:29:45.424819 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: Close
[0m16:29:45.521826 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116de5400>]}
[0m16:29:45.522200 [info ] [Thread-4  ]: 14 of 25 OK created sql incremental model DBT.link_supplier_nation ............. [[32mSUCCESS 1[0m in 3.17s]
[0m16:29:45.522440 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
[0m16:29:45.522643 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m16:29:45.522805 [info ] [Thread-4  ]: 18 of 25 START sql incremental model DBT.sat_inv_supp_region_details ........... [RUN]
[0m16:29:45.523116 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details'
[0m16:29:45.523242 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m16:29:45.534732 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m16:29:45.535485 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_region_details (compile): 2023-02-20 16:29:45.523324 => 2023-02-20 16:29:45.535424
[0m16:29:45.535725 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m16:29:45.539688 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m16:29:45.540643 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m16:29:45.540745 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
create or replace transient table TEST.DBT.sat_inv_supp_region_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DBT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m16:29:45.540837 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:29:48.496561 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4 seconds
[0m16:29:48.501562 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m16:29:48.501829 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
drop view if exists TEST.DBT.sat_inv_inventory_details__dbt_tmp cascade
[0m16:29:48.575656 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:48.579017 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_inventory_details (execute): 2023-02-20 16:29:44.714931 => 2023-02-20 16:29:48.578942
[0m16:29:48.579239 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: Close
[0m16:29:48.659332 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232f8ee0>]}
[0m16:29:48.659669 [info ] [Thread-3  ]: 15 of 25 OK created sql incremental model DBT.sat_inv_inventory_details ........ [[32mSUCCESS 1[0m in 3.98s]
[0m16:29:48.659888 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m16:29:48.660087 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m16:29:48.660243 [info ] [Thread-3  ]: 19 of 25 START sql incremental model DBT.sat_inv_supplier_details .............. [RUN]
[0m16:29:48.661162 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details'
[0m16:29:48.661732 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m16:29:48.675722 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m16:29:48.676282 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supplier_details (compile): 2023-02-20 16:29:48.661967 => 2023-02-20 16:29:48.676241
[0m16:29:48.676440 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m16:29:48.678702 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m16:29:48.679575 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m16:29:48.679666 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
create or replace transient table TEST.DBT.sat_inv_supplier_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DBT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m16:29:48.679753 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:29:48.865298 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4 seconds
[0m16:29:48.867400 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m16:29:48.867506 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
drop view if exists TEST.DBT.sat_inv_supp_nation_details__dbt_tmp cascade
[0m16:29:48.941008 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:48.942199 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_nation_details (execute): 2023-02-20 16:29:44.869799 => 2023-02-20 16:29:48.942162
[0m16:29:48.942327 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: Close
[0m16:29:48.986325 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4 seconds
[0m16:29:49.018023 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m16:29:49.018189 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
drop view if exists TEST.DBT.sat_inv_part_details__dbt_tmp cascade
[0m16:29:49.036465 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12327c9d0>]}
[0m16:29:49.036693 [info ] [Thread-1  ]: 17 of 25 OK created sql incremental model DBT.sat_inv_supp_nation_details ...... [[32mSUCCESS 1[0m in 4.18s]
[0m16:29:49.036875 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m16:29:49.037034 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m16:29:49.037222 [info ] [Thread-1  ]: 20 of 25 START sql incremental model DBT.sat_order_cust_nation_details ......... [RUN]
[0m16:29:49.037540 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_cust_nation_details'
[0m16:29:49.037653 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m16:29:49.045211 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m16:29:49.045742 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_nation_details (compile): 2023-02-20 16:29:49.037727 => 2023-02-20 16:29:49.045699
[0m16:29:49.045878 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m16:29:49.048142 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m16:29:49.048910 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m16:29:49.049007 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
create or replace transient table TEST.DBT.sat_order_cust_nation_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DBT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m16:29:49.049093 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:29:49.104911 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:49.106162 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_part_details (execute): 2023-02-20 16:29:44.830230 => 2023-02-20 16:29:49.106132
[0m16:29:49.106294 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: Close
[0m16:29:49.249981 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123325100>]}
[0m16:29:49.250266 [info ] [Thread-2  ]: 16 of 25 OK created sql incremental model DBT.sat_inv_part_details ............. [[32mSUCCESS 1[0m in 4.43s]
[0m16:29:49.250456 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m16:29:49.250614 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m16:29:49.250752 [info ] [Thread-2  ]: 21 of 25 START sql incremental model DBT.sat_order_cust_region_details ......... [RUN]
[0m16:29:49.251084 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_cust_region_details'
[0m16:29:49.251215 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m16:29:49.259289 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m16:29:49.259773 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_region_details (compile): 2023-02-20 16:29:49.251292 => 2023-02-20 16:29:49.259735
[0m16:29:49.259902 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m16:29:49.262107 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m16:29:49.262862 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m16:29:49.262954 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
create or replace transient table TEST.DBT.sat_order_cust_region_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DBT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m16:29:49.263039 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:29:49.449639 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4 seconds
[0m16:29:49.451695 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m16:29:49.451797 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
drop view if exists TEST.DBT.sat_inv_supp_region_details__dbt_tmp cascade
[0m16:29:49.493929 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:49.494988 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_region_details (execute): 2023-02-20 16:29:45.535882 => 2023-02-20 16:29:49.494957
[0m16:29:49.495103 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: Close
[0m16:29:49.567038 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233026a0>]}
[0m16:29:49.567295 [info ] [Thread-4  ]: 18 of 25 OK created sql incremental model DBT.sat_inv_supp_region_details ...... [[32mSUCCESS 1[0m in 4.04s]
[0m16:29:49.567482 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m16:29:49.567644 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m16:29:49.567834 [info ] [Thread-4  ]: 22 of 25 START sql incremental model DBT.sat_order_customer_details ............ [RUN]
[0m16:29:49.568121 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_customer_details'
[0m16:29:49.568236 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m16:29:49.577896 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m16:29:49.578413 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_customer_details (compile): 2023-02-20 16:29:49.568310 => 2023-02-20 16:29:49.578377
[0m16:29:49.578538 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m16:29:49.580656 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m16:29:49.581499 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m16:29:49.581590 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
create or replace transient table TEST.DBT.sat_order_customer_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DBT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m16:29:49.581678 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:29:50.692504 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m16:29:50.697112 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m16:29:50.697360 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
drop view if exists TEST.DBT.sat_order_cust_nation_details__dbt_tmp cascade
[0m16:29:50.766787 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:50.770915 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_nation_details (execute): 2023-02-20 16:29:49.045958 => 2023-02-20 16:29:50.770852
[0m16:29:50.771118 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
[0m16:29:50.868494 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233efdc0>]}
[0m16:29:50.869031 [info ] [Thread-1  ]: 20 of 25 OK created sql incremental model DBT.sat_order_cust_nation_details .... [[32mSUCCESS 1[0m in 1.83s]
[0m16:29:50.869261 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m16:29:50.869465 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m16:29:50.869623 [info ] [Thread-1  ]: 23 of 25 START sql incremental model DBT.sat_order_lineitem_details ............ [RUN]
[0m16:29:50.870086 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_lineitem_details'
[0m16:29:50.870245 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m16:29:50.882033 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m16:29:50.882583 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_lineitem_details (compile): 2023-02-20 16:29:50.870342 => 2023-02-20 16:29:50.882545
[0m16:29:50.882709 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m16:29:50.884927 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m16:29:50.885962 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m16:29:50.886058 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
create or replace transient table TEST.DBT.sat_order_lineitem_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DBT.v_stg_orders AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m16:29:50.886149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:29:51.433645 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m16:29:51.437995 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m16:29:51.438209 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
drop view if exists TEST.DBT.sat_order_cust_region_details__dbt_tmp cascade
[0m16:29:51.500902 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:51.504791 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_region_details (execute): 2023-02-20 16:29:49.259979 => 2023-02-20 16:29:51.504719
[0m16:29:51.504982 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
[0m16:29:51.589699 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116929eb0>]}
[0m16:29:51.590085 [info ] [Thread-2  ]: 21 of 25 OK created sql incremental model DBT.sat_order_cust_region_details .... [[32mSUCCESS 1[0m in 2.34s]
[0m16:29:51.590310 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m16:29:51.590512 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_order_details
[0m16:29:51.590678 [info ] [Thread-2  ]: 24 of 25 START sql incremental model DBT.sat_order_order_details ............... [RUN]
[0m16:29:51.591001 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_order_details'
[0m16:29:51.591128 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
[0m16:29:51.601200 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m16:29:51.601696 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_order_details (compile): 2023-02-20 16:29:51.591213 => 2023-02-20 16:29:51.601661
[0m16:29:51.601824 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
[0m16:29:51.604620 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m16:29:51.605424 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m16:29:51.605511 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
create or replace transient table TEST.DBT.sat_order_order_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DBT.v_stg_orders AS a
    WHERE a.ORDER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m16:29:51.605593 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:29:51.837448 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3 seconds
[0m16:29:51.839727 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m16:29:51.839852 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
drop view if exists TEST.DBT.sat_inv_supplier_details__dbt_tmp cascade
[0m16:29:51.897104 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:51.898397 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supplier_details (execute): 2023-02-20 16:29:48.676536 => 2023-02-20 16:29:51.898365
[0m16:29:51.898523 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: Close
[0m16:29:51.986676 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116d6ec70>]}
[0m16:29:51.986947 [info ] [Thread-3  ]: 19 of 25 OK created sql incremental model DBT.sat_inv_supplier_details ......... [[32mSUCCESS 1[0m in 3.33s]
[0m16:29:51.987136 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m16:29:51.987297 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.t_link_transactions
[0m16:29:51.987432 [info ] [Thread-3  ]: 25 of 25 START sql incremental model DBT.t_link_transactions ................... [RUN]
[0m16:29:51.987722 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.t_link_transactions'
[0m16:29:51.987831 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
[0m16:29:52.002843 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
[0m16:29:52.003570 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.t_link_transactions (compile): 2023-02-20 16:29:51.987904 => 2023-02-20 16:29:52.003509
[0m16:29:52.003758 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.t_link_transactions
[0m16:29:52.006153 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.t_link_transactions"
[0m16:29:52.007047 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m16:29:52.007140 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
create or replace transient table TEST.DBT.t_link_transactions  as
        (-- Generated by dbtvault.

    

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM TEST.DBT.v_stg_transactions
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    
)

SELECT * FROM records_to_insert
        );
[0m16:29:52.007230 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:29:52.570799 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3 seconds
[0m16:29:52.574984 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m16:29:52.575218 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
drop view if exists TEST.DBT.sat_order_customer_details__dbt_tmp cascade
[0m16:29:52.629413 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:52.633254 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_customer_details (execute): 2023-02-20 16:29:49.578610 => 2023-02-20 16:29:52.633191
[0m16:29:52.633435 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
[0m16:29:52.747803 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232e6670>]}
[0m16:29:52.748172 [info ] [Thread-4  ]: 22 of 25 OK created sql incremental model DBT.sat_order_customer_details ....... [[32mSUCCESS 1[0m in 3.18s]
[0m16:29:52.748416 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m16:29:55.290520 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3 seconds
[0m16:29:55.294885 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m16:29:55.295085 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
drop view if exists TEST.DBT.t_link_transactions__dbt_tmp cascade
[0m16:29:55.362996 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:55.366040 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.t_link_transactions (execute): 2023-02-20 16:29:52.003837 => 2023-02-20 16:29:55.365976
[0m16:29:55.366235 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.t_link_transactions: Close
[0m16:29:55.499602 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116d9f6a0>]}
[0m16:29:55.500049 [info ] [Thread-3  ]: 25 of 25 OK created sql incremental model DBT.t_link_transactions .............. [[32mSUCCESS 1[0m in 3.51s]
[0m16:29:55.500281 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.t_link_transactions
[0m16:29:55.520072 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 5 seconds
[0m16:29:55.522319 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m16:29:55.522432 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
drop view if exists TEST.DBT.sat_order_lineitem_details__dbt_tmp cascade
[0m16:29:55.587264 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:55.590426 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_lineitem_details (execute): 2023-02-20 16:29:50.882790 => 2023-02-20 16:29:55.590355
[0m16:29:55.590627 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
[0m16:29:55.689684 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12322aca0>]}
[0m16:29:55.690035 [info ] [Thread-1  ]: 23 of 25 OK created sql incremental model DBT.sat_order_lineitem_details ....... [[32mSUCCESS 1[0m in 4.82s]
[0m16:29:55.690272 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m16:29:55.860943 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4 seconds
[0m16:29:55.865864 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m16:29:55.866042 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
drop view if exists TEST.DBT.sat_order_order_details__dbt_tmp cascade
[0m16:29:55.917595 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:29:55.921099 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_order_details (execute): 2023-02-20 16:29:51.601896 => 2023-02-20 16:29:55.921059
[0m16:29:55.921263 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: Close
[0m16:29:56.090238 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86a0605d-8877-4b00-8abc-16489b399ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116df9070>]}
[0m16:29:56.665785 [info ] [Thread-2  ]: 24 of 25 OK created sql incremental model DBT.sat_order_order_details .......... [[32mSUCCESS 1[0m in 4.50s]
[0m16:29:56.666222 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
[0m16:29:56.667384 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:29:56.667657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:56.667741 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_order_lineitem_details' was properly closed.
[0m16:29:56.667812 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_order_order_details' was properly closed.
[0m16:29:56.667878 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.t_link_transactions' was properly closed.
[0m16:29:56.667942 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_order_customer_details' was properly closed.
[0m16:29:56.668081 [info ] [MainThread]: 
[0m16:29:56.668211 [info ] [MainThread]: Finished running 25 incremental models in 0 hours 0 minutes and 31.14 seconds (31.14s).
[0m16:29:56.668861 [debug] [MainThread]: Command end result
[0m16:29:56.678929 [info ] [MainThread]: 
[0m16:29:56.679164 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:29:56.679309 [info ] [MainThread]: 
[0m16:29:56.679426 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 TOTAL=25
[0m16:29:56.679623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169fc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169fca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169fc280>]}
[0m16:29:56.679766 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 17:16:17.353144 | 89de63da-852e-459a-88d8-8f1b4737f23b ==============================
[0m17:16:17.353144 [info ] [MainThread]: Running with dbt=1.4.0
[0m17:16:17.353937 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m17:16:17.354036 [debug] [MainThread]: Tracking: tracking
[0m17:16:17.365182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a64580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aaf220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad9310>]}
[0m17:16:17.366278 [debug] [MainThread]: Set downloads directory='/var/folders/ft/vyzwzhsj5pz7mw7_yvfwm3y80000gq/T/dbt-downloads-jgmrcnmd'
[0m17:16:17.366698 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:16:17.420720 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:16:17.421034 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
[0m17:16:17.565597 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
[0m17:16:17.571850 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:16:17.659194 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:16:17.738483 [info ] [MainThread]: Installing Datavault-UK/dbtvault
[0m17:16:18.078038 [info ] [MainThread]:   Installed from version 0.9.4
[0m17:16:18.078316 [info ] [MainThread]:   Up to date!
[0m17:16:18.078543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '89de63da-852e-459a-88d8-8f1b4737f23b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad9b80>]}
[0m17:16:18.078737 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:16:18.411593 [info ] [MainThread]:   Installed from version 1.0.0
[0m17:16:18.411824 [info ] [MainThread]:   Up to date!
[0m17:16:18.411998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '89de63da-852e-459a-88d8-8f1b4737f23b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad99d0>]}
[0m17:16:18.414147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102622970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b77370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aaf430>]}
[0m17:16:18.414326 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 17:17:17.214181 | b5e893e6-d56a-4c41-b1fe-c58ef0e44ec3 ==============================
[0m17:17:17.214181 [info ] [MainThread]: Running with dbt=1.4.0
[0m17:17:17.214788 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m17:17:17.214888 [debug] [MainThread]: Tracking: tracking
[0m17:17:17.219938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10119e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d30a0>]}
[0m17:17:17.221141 [debug] [MainThread]: Set downloads directory='/var/folders/ft/vyzwzhsj5pz7mw7_yvfwm3y80000gq/T/dbt-downloads-0gswhb82'
[0m17:17:17.221580 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:17:17.285360 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:17:17.285653 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
[0m17:17:17.416702 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
[0m17:17:17.423807 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:17:17.482280 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:17:17.530179 [info ] [MainThread]: Installing Datavault-UK/dbtvault
[0m17:17:17.884408 [info ] [MainThread]:   Installed from version 0.9.4
[0m17:17:17.884688 [info ] [MainThread]:   Up to date!
[0m17:17:17.884917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b5e893e6-d56a-4c41-b1fe-c58ef0e44ec3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a04bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e3610>]}
[0m17:17:17.885110 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:17:18.286280 [info ] [MainThread]:   Installed from version 1.0.0
[0m17:17:18.286522 [info ] [MainThread]:   Up to date!
[0m17:17:18.286702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b5e893e6-d56a-4c41-b1fe-c58ef0e44ec3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104999f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a076d0>]}
[0m17:17:18.288909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ad820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ad700>]}
[0m17:17:18.289105 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 14:37:57.666733 | acc2828b-c227-489e-b668-e32d88148b90 ==============================
[0m14:37:57.666733 [info ] [MainThread]: Running with dbt=1.4.0
[0m14:37:57.667795 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m14:37:57.667949 [debug] [MainThread]: Tracking: tracking
[0m14:37:57.668177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db95b0>]}
[0m14:37:57.730733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:37:57.730918 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:37:57.735803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acc2828b-c227-489e-b668-e32d88148b90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b0e80>]}
[0m14:37:57.743783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acc2828b-c227-489e-b668-e32d88148b90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef7460>]}
[0m14:37:57.743981 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 630 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m14:37:57.744129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acc2828b-c227-489e-b668-e32d88148b90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef77c0>]}
[0m14:37:57.745390 [info ] [MainThread]: 
[0m14:37:57.746153 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:37:57.747377 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST_DBT'
[0m14:37:57.755368 [debug] [ThreadPool]: Using snowflake connection "list_TEST_DBT"
[0m14:37:57.755549 [debug] [ThreadPool]: On list_TEST_DBT: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_TEST_DBT"} */
show terse objects in TEST.DBT
[0m14:37:57.755672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:01.398562 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 4 seconds
[0m14:38:01.403520 [debug] [ThreadPool]: On list_TEST_DBT: Close
[0m14:38:01.595549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acc2828b-c227-489e-b668-e32d88148b90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef7310>]}
[0m14:38:01.596432 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:38:01.596794 [info ] [MainThread]: 
[0m14:38:01.603197 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.raw_orders
[0m14:38:01.603643 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_transactions
[0m14:38:01.604224 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_orders'
[0m14:38:01.604741 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_transactions'
[0m14:38:01.604998 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.raw_orders
[0m14:38:01.605221 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_transactions
[0m14:38:01.611755 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
[0m14:38:01.614993 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
[0m14:38:01.615941 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.raw_orders (compile): 2023-02-21 14:38:01.605426 => 2023-02-21 14:38:01.615888
[0m14:38:01.616122 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_transactions (compile): 2023-02-21 14:38:01.611929 => 2023-02-21 14:38:01.616087
[0m14:38:01.616283 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.raw_orders
[0m14:38:01.616450 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_transactions
[0m14:38:01.616600 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.raw_orders (execute): 2023-02-21 14:38:01.616566 => 2023-02-21 14:38:01.616575
[0m14:38:01.616741 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_transactions (execute): 2023-02-21 14:38:01.616715 => 2023-02-21 14:38:01.616719
[0m14:38:01.617952 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.raw_orders
[0m14:38:01.618386 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_transactions
[0m14:38:01.618845 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.raw_inventory
[0m14:38:01.619075 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.v_stg_orders
[0m14:38:01.619419 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_inventory'
[0m14:38:01.619605 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.v_stg_transactions
[0m14:38:01.619955 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_orders'
[0m14:38:01.620119 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.raw_inventory
[0m14:38:01.620446 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_transactions'
[0m14:38:01.620602 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
[0m14:38:01.624947 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
[0m14:38:01.625136 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
[0m14:38:01.659903 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m14:38:01.661714 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m14:38:01.661815 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
describe table TEST.DBT.raw_transactions
[0m14:38:01.661927 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
describe table TEST.DBT.raw_orders
[0m14:38:01.662052 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.raw_inventory (compile): 2023-02-21 14:38:01.620721 => 2023-02-21 14:38:01.662024
[0m14:38:01.662139 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:38:01.662231 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:38:01.662343 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.raw_inventory
[0m14:38:01.663702 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.raw_inventory (execute): 2023-02-21 14:38:01.663671 => 2023-02-21 14:38:01.663677
[0m14:38:01.664073 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.raw_inventory
[0m14:38:01.664302 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.v_stg_inventory
[0m14:38:01.664551 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_inventory'
[0m14:38:01.664663 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
[0m14:38:01.671751 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m14:38:01.671960 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
describe table TEST.DBT.raw_inventory
[0m14:38:01.672169 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:38:02.396703 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 1 seconds
[0m14:38:02.456565 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m14:38:02.456731 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
describe table TEST.DBT.raw_orders
[0m14:38:02.481071 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 1 seconds
[0m14:38:02.486197 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m14:38:02.486324 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
describe table TEST.DBT.raw_transactions
[0m14:38:02.744605 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0 seconds
[0m14:38:02.766272 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m14:38:02.828239 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m14:38:02.845745 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_transactions (compile): 2023-02-21 14:38:01.650567 => 2023-02-21 14:38:02.845704
[0m14:38:02.858280 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
[0m14:38:02.864808 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_transactions (execute): 2023-02-21 14:38:02.864773 => 2023-02-21 14:38:02.864781
[0m14:38:02.864937 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: Close
[0m14:38:02.875008 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
[0m14:38:02.875418 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_orders (compile): 2023-02-21 14:38:01.625250 => 2023-02-21 14:38:02.875391
[0m14:38:02.875535 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_orders
[0m14:38:02.875627 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_orders (execute): 2023-02-21 14:38:02.875608 => 2023-02-21 14:38:02.875611
[0m14:38:02.875718 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: Close
[0m14:38:03.038803 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_orders
[0m14:38:03.039533 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
[0m14:38:03.040458 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
[0m14:38:03.040757 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
[0m14:38:03.041240 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_customer'
[0m14:38:03.041481 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_order
[0m14:38:03.041924 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_lineitem'
[0m14:38:03.042160 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
[0m14:38:03.042591 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_order'
[0m14:38:03.042795 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
[0m14:38:03.061699 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
[0m14:38:03.063811 [info ] [Thread-4  ]: 14:38:03 + Loading TEST.DBT.hub_customer from 1 source(s)
[0m14:38:03.067876 [info ] [Thread-3  ]: 14:38:03 + Loading TEST.DBT.hub_lineitem from 1 source(s)
[0m14:38:03.071639 [info ] [Thread-1  ]: 14:38:03 + Loading TEST.DBT.hub_order from 1 source(s)
[0m14:38:03.123420 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
[0m14:38:03.125327 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
[0m14:38:03.126430 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
[0m14:38:03.127884 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (compile): 2023-02-21 14:38:03.064018 => 2023-02-21 14:38:03.127841
[0m14:38:03.128025 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
[0m14:38:03.128142 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (execute): 2023-02-21 14:38:03.128119 => 2023-02-21 14:38:03.128125
[0m14:38:03.128445 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
[0m14:38:03.128592 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_customer_nation
[0m14:38:03.128815 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_customer_nation'
[0m14:38:03.128925 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
[0m14:38:03.133935 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (compile): 2023-02-21 14:38:03.068135 => 2023-02-21 14:38:03.133904
[0m14:38:03.134086 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
[0m14:38:03.134189 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (execute): 2023-02-21 14:38:03.134168 => 2023-02-21 14:38:03.134172
[0m14:38:03.133827 [info ] [Thread-3  ]: 14:38:03 + Loading TEST.DBT.link_customer_nation from 1 source(s)
[0m14:38:03.134603 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
[0m14:38:03.134691 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (compile): 2023-02-21 14:38:03.042949 => 2023-02-21 14:38:03.134672
[0m14:38:03.146440 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
[0m14:38:03.146678 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_customer_order
[0m14:38:03.146813 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
[0m14:38:03.147206 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_customer_order'
[0m14:38:03.147446 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (execute): 2023-02-21 14:38:03.147383 => 2023-02-21 14:38:03.147395
[0m14:38:03.147651 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_order
[0m14:38:03.147936 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_nation (compile): 2023-02-21 14:38:03.129002 => 2023-02-21 14:38:03.147890
[0m14:38:03.148373 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
[0m14:38:03.151544 [info ] [Thread-1  ]: 14:38:03 + Loading TEST.DBT.link_customer_order from 1 source(s)
[0m14:38:03.151755 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_nation
[0m14:38:03.151939 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m14:38:03.155254 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
[0m14:38:03.155405 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_nation (execute): 2023-02-21 14:38:03.155373 => 2023-02-21 14:38:03.155379
[0m14:38:03.155685 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_inventory_allocation'
[0m14:38:03.156048 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_nation
[0m14:38:03.156183 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m14:38:03.156347 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_order_lineitem
[0m14:38:03.159517 [info ] [Thread-4  ]: 14:38:03 + Loading TEST.DBT.link_inventory_allocation from 1 source(s)
[0m14:38:03.159905 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_order_lineitem'
[0m14:38:03.163666 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m14:38:03.163799 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_order (compile): 2023-02-21 14:38:03.148497 => 2023-02-21 14:38:03.163771
[0m14:38:03.163930 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
[0m14:38:03.164095 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_order
[0m14:38:03.167432 [info ] [Thread-3  ]: 14:38:03 + Loading TEST.DBT.link_order_lineitem from 1 source(s)
[0m14:38:03.167793 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_order (execute): 2023-02-21 14:38:03.167723 => 2023-02-21 14:38:03.167739
[0m14:38:03.167985 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory_allocation (compile): 2023-02-21 14:38:03.156492 => 2023-02-21 14:38:03.167944
[0m14:38:03.171321 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m14:38:03.171701 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_order
[0m14:38:03.171832 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m14:38:03.172061 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m14:38:03.172278 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory_allocation (execute): 2023-02-21 14:38:03.172248 => 2023-02-21 14:38:03.172253
[0m14:38:03.172589 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_cust_nation_details'
[0m14:38:03.172947 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m14:38:03.173099 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m14:38:03.173221 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_order_lineitem (compile): 2023-02-21 14:38:03.164182 => 2023-02-21 14:38:03.173199
[0m14:38:03.173410 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m14:38:03.192437 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
[0m14:38:03.204183 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m14:38:03.204535 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_cust_region_details'
[0m14:38:03.204675 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_order_lineitem (execute): 2023-02-21 14:38:03.204641 => 2023-02-21 14:38:03.204647
[0m14:38:03.204857 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m14:38:03.205167 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
[0m14:38:03.214924 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m14:38:03.215090 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m14:38:03.215482 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_customer_details'
[0m14:38:03.215606 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m14:38:03.220939 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_nation_details (compile): 2023-02-21 14:38:03.173541 => 2023-02-21 14:38:03.220909
[0m14:38:03.226142 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m14:38:03.226258 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m14:38:03.226412 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_region_details (compile): 2023-02-21 14:38:03.205251 => 2023-02-21 14:38:03.226390
[0m14:38:03.226542 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_nation_details (execute): 2023-02-21 14:38:03.226516 => 2023-02-21 14:38:03.226521
[0m14:38:03.226653 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m14:38:03.226976 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m14:38:03.227062 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_customer_details (compile): 2023-02-21 14:38:03.215683 => 2023-02-21 14:38:03.227045
[0m14:38:03.227161 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_region_details (execute): 2023-02-21 14:38:03.227143 => 2023-02-21 14:38:03.227146
[0m14:38:03.227295 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m14:38:03.227400 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m14:38:03.227685 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m14:38:03.227893 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_lineitem_details'
[0m14:38:03.227986 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_customer_details (execute): 2023-02-21 14:38:03.227967 => 2023-02-21 14:38:03.227970
[0m14:38:03.228116 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_order_details
[0m14:38:03.228212 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m14:38:03.228476 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m14:38:03.228679 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_order_details'
[0m14:38:03.240884 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m14:38:03.241058 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.t_link_transactions
[0m14:38:03.241168 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
[0m14:38:03.241491 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.t_link_transactions'
[0m14:38:03.267564 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_lineitem_details (compile): 2023-02-21 14:38:03.228754 => 2023-02-21 14:38:03.267498
[0m14:38:03.274066 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
[0m14:38:03.279931 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m14:38:03.280068 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m14:38:03.290410 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
[0m14:38:03.290582 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_lineitem_details (execute): 2023-02-21 14:38:03.290547 => 2023-02-21 14:38:03.290554
[0m14:38:03.290957 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m14:38:03.291210 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.t_link_transactions (compile): 2023-02-21 14:38:03.280150 => 2023-02-21 14:38:03.291189
[0m14:38:03.291326 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.t_link_transactions
[0m14:38:03.291416 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.t_link_transactions (execute): 2023-02-21 14:38:03.291397 => 2023-02-21 14:38:03.291400
[0m14:38:03.291667 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.t_link_transactions
[0m14:38:03.291777 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_order_details (compile): 2023-02-21 14:38:03.241597 => 2023-02-21 14:38:03.291756
[0m14:38:03.291889 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
[0m14:38:03.292004 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_order_details (execute): 2023-02-21 14:38:03.291986 => 2023-02-21 14:38:03.291989
[0m14:38:03.292275 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
[0m14:38:04.311618 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 3 seconds
[0m14:38:04.326848 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m14:38:04.327123 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
describe table TEST.DBT.raw_inventory
[0m14:38:04.553231 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0 seconds
[0m14:38:04.611395 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m14:38:04.612755 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_inventory (compile): 2023-02-21 14:38:01.664744 => 2023-02-21 14:38:04.612701
[0m14:38:04.612942 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
[0m14:38:04.613068 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_inventory (execute): 2023-02-21 14:38:04.613039 => 2023-02-21 14:38:04.613047
[0m14:38:04.613192 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: Close
[0m14:38:04.820943 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
[0m14:38:04.822475 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
[0m14:38:04.822852 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_part
[0m14:38:04.823506 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_nation'
[0m14:38:04.823807 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_region
[0m14:38:04.824068 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
[0m14:38:04.824520 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_part'
[0m14:38:04.824766 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
[0m14:38:04.825212 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_region'
[0m14:38:04.825639 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_supplier'
[0m14:38:04.825849 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
[0m14:38:04.832957 [info ] [Thread-1  ]: 14:38:04 + Loading TEST.DBT.hub_nation from 2 source(s)
[0m14:38:04.833323 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
[0m14:38:04.833545 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
[0m14:38:04.838639 [info ] [Thread-3  ]: 14:38:04 + Loading TEST.DBT.hub_part from 2 source(s)
[0m14:38:04.845429 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
[0m14:38:04.849859 [info ] [Thread-4  ]: 14:38:04 + Loading TEST.DBT.hub_region from 2 source(s)
[0m14:38:04.854133 [info ] [Thread-2  ]: 14:38:04 + Loading TEST.DBT.hub_supplier from 2 source(s)
[0m14:38:04.861420 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
[0m14:38:04.871714 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
[0m14:38:04.872367 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
[0m14:38:04.873214 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (compile): 2023-02-21 14:38:04.826009 => 2023-02-21 14:38:04.873150
[0m14:38:04.873654 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
[0m14:38:04.873460 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (compile): 2023-02-21 14:38:04.833693 => 2023-02-21 14:38:04.873396
[0m14:38:04.873881 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (execute): 2023-02-21 14:38:04.873833 => 2023-02-21 14:38:04.873843
[0m14:38:04.874043 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (compile): 2023-02-21 14:38:04.845580 => 2023-02-21 14:38:04.874006
[0m14:38:04.874185 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (compile): 2023-02-21 14:38:04.850257 => 2023-02-21 14:38:04.874156
[0m14:38:04.874304 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
[0m14:38:04.874685 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
[0m14:38:04.874817 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
[0m14:38:04.874925 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
[0m14:38:04.875027 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (execute): 2023-02-21 14:38:04.875004 => 2023-02-21 14:38:04.875008
[0m14:38:04.875184 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_inventory
[0m14:38:04.875337 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (execute): 2023-02-21 14:38:04.875314 => 2023-02-21 14:38:04.875318
[0m14:38:04.875444 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (execute): 2023-02-21 14:38:04.875426 => 2023-02-21 14:38:04.875429
[0m14:38:04.875758 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
[0m14:38:04.876006 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_inventory'
[0m14:38:04.876289 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
[0m14:38:04.876578 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
[0m14:38:04.876734 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_nation_region
[0m14:38:04.876845 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory
[0m14:38:04.877006 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_supplier_nation
[0m14:38:04.877131 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m14:38:04.877425 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_nation_region'
[0m14:38:04.880774 [info ] [Thread-1  ]: 14:38:04 + Loading TEST.DBT.link_inventory from 1 source(s)
[0m14:38:04.881301 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_supplier_nation'
[0m14:38:04.881564 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_inventory_details'
[0m14:38:04.881699 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_nation_region
[0m14:38:04.885027 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
[0m14:38:04.885156 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
[0m14:38:04.885260 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m14:38:04.888238 [info ] [Thread-3  ]: 14:38:04 + Loading TEST.DBT.link_nation_region from 2 source(s)
[0m14:38:04.892171 [info ] [Thread-4  ]: 14:38:04 + Loading TEST.DBT.link_supplier_nation from 1 source(s)
[0m14:38:04.898833 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory (compile): 2023-02-21 14:38:04.877519 => 2023-02-21 14:38:04.898755
[0m14:38:04.903227 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m14:38:04.907863 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
[0m14:38:04.911069 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m14:38:04.911220 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory
[0m14:38:04.911518 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory (execute): 2023-02-21 14:38:04.911478 => 2023-02-21 14:38:04.911486
[0m14:38:04.911863 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory
[0m14:38:04.912031 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m14:38:04.912262 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_part_details'
[0m14:38:04.912376 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m14:38:04.924980 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m14:38:04.925325 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_supplier_nation (compile): 2023-02-21 14:38:04.888521 => 2023-02-21 14:38:04.925292
[0m14:38:04.925464 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
[0m14:38:04.925562 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_supplier_nation (execute): 2023-02-21 14:38:04.925541 => 2023-02-21 14:38:04.925546
[0m14:38:04.925857 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
[0m14:38:04.926005 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m14:38:04.926220 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details'
[0m14:38:04.926321 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m14:38:04.932609 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_nation_region (compile): 2023-02-21 14:38:04.885337 => 2023-02-21 14:38:04.932578
[0m14:38:04.932775 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_part_details (compile): 2023-02-21 14:38:04.912452 => 2023-02-21 14:38:04.932756
[0m14:38:04.936143 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m14:38:04.936281 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_nation_region
[0m14:38:04.936383 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_inventory_details (compile): 2023-02-21 14:38:04.892461 => 2023-02-21 14:38:04.936365
[0m14:38:04.936483 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m14:38:04.936622 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_nation_region (execute): 2023-02-21 14:38:04.936599 => 2023-02-21 14:38:04.936603
[0m14:38:04.936733 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m14:38:04.936837 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_part_details (execute): 2023-02-21 14:38:04.936818 => 2023-02-21 14:38:04.936821
[0m14:38:04.937138 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_nation_region
[0m14:38:04.937250 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_inventory_details (execute): 2023-02-21 14:38:04.937225 => 2023-02-21 14:38:04.937227
[0m14:38:04.937343 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_nation_details (compile): 2023-02-21 14:38:04.926396 => 2023-02-21 14:38:04.937328
[0m14:38:04.937626 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m14:38:04.937773 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m14:38:04.938058 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m14:38:04.938160 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m14:38:04.938299 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m14:38:04.938712 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details'
[0m14:38:04.938877 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_nation_details (execute): 2023-02-21 14:38:04.938855 => 2023-02-21 14:38:04.938859
[0m14:38:04.939093 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details'
[0m14:38:04.939201 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m14:38:04.939451 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m14:38:04.939547 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m14:38:04.948572 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m14:38:04.959168 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m14:38:04.959491 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supplier_details (compile): 2023-02-21 14:38:04.948741 => 2023-02-21 14:38:04.959460
[0m14:38:04.959605 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m14:38:04.959696 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supplier_details (execute): 2023-02-21 14:38:04.959676 => 2023-02-21 14:38:04.959680
[0m14:38:04.959966 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m14:38:04.960082 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_region_details (compile): 2023-02-21 14:38:04.939620 => 2023-02-21 14:38:04.960062
[0m14:38:04.960187 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m14:38:04.960300 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_region_details (execute): 2023-02-21 14:38:04.960283 => 2023-02-21 14:38:04.960285
[0m14:38:04.960547 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m14:38:04.960999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:04.961088 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
[0m14:38:04.961166 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_inventory_details' was properly closed.
[0m14:38:04.961237 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details' was properly closed.
[0m14:38:04.961304 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
[0m14:38:04.961973 [debug] [MainThread]: Command end result
[0m14:38:04.968960 [info ] [MainThread]: Done.
[0m14:38:04.971347 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m14:38:04.971472 [info ] [MainThread]: Building catalog
[0m14:38:04.974174 [debug] [ThreadPool]: Acquiring new snowflake connection 'TEST.information_schema'
[0m14:38:04.974504 [debug] [ThreadPool]: Acquiring new snowflake connection 'SNOWFLAKE_SAMPLE_DATA.information_schema'
[0m14:38:04.979013 [debug] [ThreadPool]: Using snowflake connection "TEST.information_schema"
[0m14:38:04.981320 [debug] [ThreadPool]: Using snowflake connection "SNOWFLAKE_SAMPLE_DATA.information_schema"
[0m14:38:04.981547 [debug] [ThreadPool]: On TEST.information_schema: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "TEST.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from TEST.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from TEST.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt'))
      order by "column_index"
[0m14:38:04.981654 [debug] [ThreadPool]: On SNOWFLAKE_SAMPLE_DATA.information_schema: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "SNOWFLAKE_SAMPLE_DATA.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from SNOWFLAKE_SAMPLE_DATA.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from SNOWFLAKE_SAMPLE_DATA.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('tpch_sf10'))
      order by "column_index"
[0m14:38:04.981779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:04.981897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:08.268461 [debug] [ThreadPool]: SQL status: SUCCESS 61 in 3 seconds
[0m14:38:08.287582 [debug] [ThreadPool]: On SNOWFLAKE_SAMPLE_DATA.information_schema: Close
[0m14:38:08.421272 [debug] [ThreadPool]: SQL status: SUCCESS 358 in 3 seconds
[0m14:38:09.001984 [debug] [ThreadPool]: On TEST.information_schema: Close
[0m14:38:09.880229 [info ] [MainThread]: Catalog written to /Users/shrut.patel/Source/dbtvault/dbtvault/target/catalog.json
[0m14:38:09.880611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caefee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3dc9d0>]}
[0m14:38:09.880770 [debug] [MainThread]: Flushing usage events
[0m14:38:10.780080 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:38:10.780996 [debug] [MainThread]: Connection 'TEST.information_schema' was properly closed.
[0m14:38:10.781292 [debug] [MainThread]: Connection 'SNOWFLAKE_SAMPLE_DATA.information_schema' was properly closed.


============================== 2023-02-24 19:14:11.775122 | 6b5a1e51-01f5-441a-941f-3569ccfe3d30 ==============================
[0m19:14:11.775122 [info ] [MainThread]: Running with dbt=1.4.0
[0m19:14:11.775957 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m19:14:11.776085 [debug] [MainThread]: Tracking: tracking
[0m19:14:11.776305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106837b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106837a30>]}
[0m19:14:11.804668 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:14:11.804913 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m19:14:11.805061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b5a1e51-01f5-441a-941f-3569ccfe3d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106867c10>]}
[0m19:14:12.830554 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_customer_order.sql
[0m19:14:12.876628 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
[0m19:14:12.877360 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_customer_nation.sql
[0m19:14:12.882021 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
[0m19:14:12.882687 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_inventory.sql
[0m19:14:12.887737 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
[0m19:14:12.888400 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_nation_region.sql
[0m19:14:12.893996 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
[0m19:14:12.894655 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
[0m19:14:12.899336 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
[0m19:14:12.900144 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_lineitem.sql
[0m19:14:12.904739 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
[0m19:14:12.905398 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_supplier_nation.sql
[0m19:14:12.910427 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
[0m19:14:12.911082 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_order.sql
[0m19:14:12.924333 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
[0m19:14:12.925041 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_nation.sql
[0m19:14:12.930712 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
[0m19:14:12.931367 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_part.sql
[0m19:14:12.937304 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
[0m19:14:12.937970 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
[0m19:14:12.942355 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
[0m19:14:12.943018 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_customer.sql
[0m19:14:12.947290 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
[0m19:14:12.947949 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_supplier.sql
[0m19:14:12.953441 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
[0m19:14:12.954095 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_region.sql
[0m19:14:12.960158 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
[0m19:14:12.960824 [debug] [MainThread]: 1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
[0m19:14:12.970428 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
[0m19:14:12.971109 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
[0m19:14:12.996987 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
[0m19:14:12.997812 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
[0m19:14:13.005873 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
[0m19:14:13.006562 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
[0m19:14:13.015945 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
[0m19:14:13.016629 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
[0m19:14:13.024162 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
[0m19:14:13.024837 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
[0m19:14:13.031651 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
[0m19:14:13.032326 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
[0m19:14:13.038732 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
[0m19:14:13.039401 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
[0m19:14:13.046036 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
[0m19:14:13.046710 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
[0m19:14:13.054964 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
[0m19:14:13.055637 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
[0m19:14:13.061986 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
[0m19:14:13.062654 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
[0m19:14:13.070777 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
[0m19:14:13.072082 [debug] [MainThread]: 1603: static parser failed on raw_stage/raw_transactions.sql
[0m19:14:13.075182 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
[0m19:14:13.076123 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage/raw_inventory.sql
[0m19:14:13.077645 [debug] [MainThread]: 1603: static parser failed on raw_stage/raw_orders.sql
[0m19:14:13.081182 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
[0m19:14:13.081882 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_orders.sql
[0m19:14:13.205750 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
[0m19:14:13.206499 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_inventory.sql
[0m19:14:13.246079 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
[0m19:14:13.246739 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_transactions.sql
[0m19:14:13.257077 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
[0m19:14:13.330354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b5a1e51-01f5-441a-941f-3569ccfe3d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b07520>]}
[0m19:14:13.339276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b5a1e51-01f5-441a-941f-3569ccfe3d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106867b80>]}
[0m19:14:13.339450 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 630 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m19:14:13.339590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b5a1e51-01f5-441a-941f-3569ccfe3d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106834fa0>]}
[0m19:14:13.340772 [info ] [MainThread]: 
[0m19:14:13.341496 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:14:13.342681 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DB_DEV'
[0m19:14:13.350360 [debug] [ThreadPool]: Using snowflake connection "list_DB_DEV"
[0m19:14:13.350525 [debug] [ThreadPool]: On list_DB_DEV: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DB_DEV"} */
show terse schemas in database DB_DEV
    limit 10000
[0m19:14:13.350628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:46.144930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:46.146014 [debug] [MainThread]: Connection 'list_DB_DEV' was properly closed.
[0m19:14:46.146544 [info ] [MainThread]: 
[0m19:14:46.147240 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 32.81 seconds (32.81s).
[0m19:14:46.147829 [debug] [MainThread]: Flushing usage events
[0m19:14:46.818711 [info ] [MainThread]: ctrl-c


============================== 2023-02-24 19:14:55.533755 | 454ed499-bddc-4587-ada1-35b79235e685 ==============================
[0m19:14:55.533755 [info ] [MainThread]: Running with dbt=1.4.0
[0m19:14:55.534391 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m19:14:55.534489 [debug] [MainThread]: Tracking: tracking
[0m19:14:55.541718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bc730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646e700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064463a0>]}
[0m19:14:55.695859 [debug] [MainThread]: Executing "git --help"
[0m19:14:55.729329 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:14:55.729755 [debug] [MainThread]: STDERR: "b''"
[0m19:14:55.734168 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:14:55.734867 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:14:55.735021 [debug] [MainThread]: On debug: select 1 as id
[0m19:14:55.735188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:15:26.271913 [debug] [MainThread]: Flushing usage events
[0m19:15:26.691070 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:15:26.692302 [info ] [MainThread]: ctrl-c


============================== 2023-02-24 19:15:29.578064 | dcb090f1-cc4f-49d6-954f-e1414b6a0a33 ==============================
[0m19:15:29.578064 [info ] [MainThread]: Running with dbt=1.4.0
[0m19:15:29.578713 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m19:15:29.578811 [debug] [MainThread]: Tracking: tracking
[0m19:15:29.583982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108419b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108426970>]}
[0m19:15:29.739072 [debug] [MainThread]: Executing "git --help"
[0m19:15:29.745156 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:15:29.745690 [debug] [MainThread]: STDERR: "b''"
[0m19:15:29.750159 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:15:29.750891 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:15:29.751031 [debug] [MainThread]: On debug: select 1 as id
[0m19:15:29.751171 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:15:30.406783 [debug] [MainThread]: SQL status: SUCCESS 1 in 1 seconds
[0m19:15:30.410111 [debug] [MainThread]: On debug: Close
[0m19:15:30.540468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10957a670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109582d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109595460>]}
[0m19:15:30.540897 [debug] [MainThread]: Flushing usage events
[0m19:15:30.939242 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-02-24 19:15:35.041031 | 812813ed-d446-4042-9085-e3b44dbd8252 ==============================
[0m19:15:35.041031 [info ] [MainThread]: Running with dbt=1.4.0
[0m19:15:35.041887 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m19:15:35.042011 [debug] [MainThread]: Tracking: tracking
[0m19:15:35.042264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a637310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a637be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a637ac0>]}
[0m19:15:35.070249 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:15:35.070552 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m19:15:35.070758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '812813ed-d446-4042-9085-e3b44dbd8252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a667a60>]}
[0m19:15:36.085394 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_customer_order.sql
[0m19:15:36.131701 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
[0m19:15:36.132426 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_customer_nation.sql
[0m19:15:36.137091 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
[0m19:15:36.137749 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_inventory.sql
[0m19:15:36.142762 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
[0m19:15:36.143420 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_nation_region.sql
[0m19:15:36.148928 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
[0m19:15:36.149577 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
[0m19:15:36.154238 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
[0m19:15:36.155043 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_lineitem.sql
[0m19:15:36.159585 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
[0m19:15:36.160235 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_supplier_nation.sql
[0m19:15:36.165248 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
[0m19:15:36.165900 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_order.sql
[0m19:15:36.179059 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
[0m19:15:36.179719 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_nation.sql
[0m19:15:36.185294 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
[0m19:15:36.185943 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_part.sql
[0m19:15:36.191807 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
[0m19:15:36.192461 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
[0m19:15:36.196780 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
[0m19:15:36.197426 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_customer.sql
[0m19:15:36.201642 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
[0m19:15:36.202289 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_supplier.sql
[0m19:15:36.207732 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
[0m19:15:36.208386 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_region.sql
[0m19:15:36.214438 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
[0m19:15:36.215108 [debug] [MainThread]: 1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
[0m19:15:36.224737 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
[0m19:15:36.225416 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
[0m19:15:36.251251 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
[0m19:15:36.251937 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
[0m19:15:36.259641 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
[0m19:15:36.260322 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
[0m19:15:36.269547 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
[0m19:15:36.270220 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
[0m19:15:36.277684 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
[0m19:15:36.278351 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
[0m19:15:36.285126 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
[0m19:15:36.285801 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
[0m19:15:36.292150 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
[0m19:15:36.292821 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
[0m19:15:36.299398 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
[0m19:15:36.300067 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
[0m19:15:36.308258 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
[0m19:15:36.308926 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
[0m19:15:36.315206 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
[0m19:15:36.315872 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
[0m19:15:36.323907 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
[0m19:15:36.324714 [debug] [MainThread]: 1603: static parser failed on raw_stage/raw_transactions.sql
[0m19:15:36.327689 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
[0m19:15:36.328555 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage/raw_inventory.sql
[0m19:15:36.330157 [debug] [MainThread]: 1603: static parser failed on raw_stage/raw_orders.sql
[0m19:15:36.333567 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
[0m19:15:36.334239 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_orders.sql
[0m19:15:36.457654 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
[0m19:15:36.458437 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_inventory.sql
[0m19:15:36.497977 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
[0m19:15:36.498646 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_transactions.sql
[0m19:15:36.508960 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
[0m19:15:36.580993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '812813ed-d446-4042-9085-e3b44dbd8252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a889fa0>]}
[0m19:15:36.589817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '812813ed-d446-4042-9085-e3b44dbd8252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a667b20>]}
[0m19:15:36.589994 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 630 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m19:15:36.590136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '812813ed-d446-4042-9085-e3b44dbd8252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5f2f10>]}
[0m19:15:36.591306 [info ] [MainThread]: 
[0m19:15:36.592030 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:15:36.593265 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST'
[0m19:15:36.601633 [debug] [ThreadPool]: Using snowflake connection "list_TEST"
[0m19:15:36.601815 [debug] [ThreadPool]: On list_TEST: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_TEST"} */
show terse schemas in database TEST
    limit 10000
[0m19:15:36.601915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:37.445921 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01aa8d03-0000-4993-0000-f0ad00046006
[0m19:15:37.446409 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m19:15:37.446823 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m19:15:37.447049 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:15:37.447456 [debug] [ThreadPool]: On list_TEST: Close
[0m19:15:37.555564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:37.555932 [debug] [MainThread]: Connection 'list_TEST' was properly closed.
[0m19:15:37.556255 [info ] [MainThread]: 
[0m19:15:37.556658 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m19:15:37.557164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8894f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a907a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9ab070>]}
[0m19:15:37.557514 [debug] [MainThread]: Flushing usage events
[0m19:15:37.968059 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "TEST"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.


============================== 2023-02-24 19:16:00.166804 | 41c716dd-3490-4660-b259-f9ade51947d9 ==============================
[0m19:16:00.166804 [info ] [MainThread]: Running with dbt=1.4.0
[0m19:16:00.167716 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m19:16:00.167827 [debug] [MainThread]: Tracking: tracking
[0m19:16:00.168040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081da400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081dabb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081daa90>]}
[0m19:16:00.222452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:16:00.222644 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:16:00.227085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41c716dd-3490-4660-b259-f9ade51947d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c91c0>]}
[0m19:16:00.235462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41c716dd-3490-4660-b259-f9ade51947d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108479760>]}
[0m19:16:00.235668 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 630 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m19:16:00.235817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41c716dd-3490-4660-b259-f9ade51947d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108479ac0>]}
[0m19:16:00.237179 [info ] [MainThread]: 
[0m19:16:00.238006 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:16:00.239233 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST_DATA_VAULT'
[0m19:16:00.247659 [debug] [ThreadPool]: Using snowflake connection "list_TEST_DATA_VAULT"
[0m19:16:00.247857 [debug] [ThreadPool]: On list_TEST_DATA_VAULT: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_TEST_DATA_VAULT"} */
show terse objects in TEST.DATA_VAULT
[0m19:16:00.247971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:01.045969 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01aa8d04-0000-4901-0000-f0ad0003a0be
[0m19:16:01.046919 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m19:16:01.047540 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m19:16:01.047842 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:16:01.048269 [debug] [ThreadPool]: On list_TEST_DATA_VAULT: Close
[0m19:16:01.171497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41c716dd-3490-4660-b259-f9ade51947d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b08e0>]}
[0m19:16:01.172625 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:16:01.173066 [info ] [MainThread]: 
[0m19:16:01.178361 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.raw_orders
[0m19:16:01.178733 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_transactions
[0m19:16:01.179406 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_orders'
[0m19:16:01.180047 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_transactions'
[0m19:16:01.180344 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.raw_orders
[0m19:16:01.180641 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_transactions
[0m19:16:01.187790 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
[0m19:16:01.191179 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
[0m19:16:01.191986 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.raw_orders (compile): 2023-02-24 19:16:01.180859 => 2023-02-24 19:16:01.191901
[0m19:16:01.192251 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_transactions (compile): 2023-02-24 19:16:01.188004 => 2023-02-24 19:16:01.192199
[0m19:16:01.192459 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.raw_orders
[0m19:16:01.192706 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_transactions
[0m19:16:01.192860 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.raw_orders (execute): 2023-02-24 19:16:01.192822 => 2023-02-24 19:16:01.192834
[0m19:16:01.192999 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_transactions (execute): 2023-02-24 19:16:01.192974 => 2023-02-24 19:16:01.192978
[0m19:16:01.194229 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.raw_orders
[0m19:16:01.194807 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_transactions
[0m19:16:01.195328 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.raw_inventory
[0m19:16:01.195557 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.v_stg_orders
[0m19:16:01.196093 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_inventory'
[0m19:16:01.196265 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.v_stg_transactions
[0m19:16:01.196659 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_orders'
[0m19:16:01.196870 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.raw_inventory
[0m19:16:01.197246 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_transactions'
[0m19:16:01.197412 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
[0m19:16:01.202306 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
[0m19:16:01.202560 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
[0m19:16:01.245492 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m19:16:01.250634 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m19:16:01.250758 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
describe table TEST.DATA_VAULT.raw_orders
[0m19:16:01.250877 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
describe table TEST.DATA_VAULT.raw_transactions
[0m19:16:01.250979 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.raw_inventory (compile): 2023-02-24 19:16:01.197553 => 2023-02-24 19:16:01.250948
[0m19:16:01.251078 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:16:01.251162 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:16:01.251281 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.raw_inventory
[0m19:16:01.252666 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.raw_inventory (execute): 2023-02-24 19:16:01.252631 => 2023-02-24 19:16:01.252641
[0m19:16:01.253003 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.raw_inventory
[0m19:16:01.253512 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.v_stg_inventory
[0m19:16:01.253786 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_inventory'
[0m19:16:01.253903 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
[0m19:16:01.260924 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m19:16:01.261144 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
describe table TEST.DATA_VAULT.raw_inventory
[0m19:16:01.261246 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:16:02.002587 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01aa8d04-0000-4993-0000-f0ad0004600a
[0m19:16:02.003072 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'TEST' does not exist or not authorized.
[0m19:16:02.003434 [debug] [Thread-2  ]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
[0m19:16:02.003633 [debug] [Thread-2  ]: Snowflake adapter: Rolling back transaction.
[0m19:16:02.049911 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m19:16:02.050111 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
describe table TEST.DATA_VAULT.raw_transactions
[0m19:16:02.050932 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01aa8d04-0000-4981-0000-f0ad00043096
[0m19:16:02.051054 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'TEST' does not exist or not authorized.
[0m19:16:02.051214 [debug] [Thread-1  ]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
[0m19:16:02.051499 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01aa8d04-0000-48d0-0000-f0ad0003d0aa
[0m19:16:02.051600 [debug] [Thread-1  ]: Snowflake adapter: Rolling back transaction.
[0m19:16:02.051706 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'TEST' does not exist or not authorized.
[0m19:16:02.054916 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m19:16:02.055201 [debug] [Thread-3  ]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
[0m19:16:02.055423 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
describe table TEST.DATA_VAULT.raw_inventory
[0m19:16:02.055531 [debug] [Thread-3  ]: Snowflake adapter: Rolling back transaction.
[0m19:16:02.059592 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m19:16:02.059829 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
describe table TEST.DATA_VAULT.raw_orders
[0m19:16:02.153503 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01aa8d04-0000-4993-0000-f0ad0004600e
[0m19:16:02.153703 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'TEST' does not exist or not authorized.
[0m19:16:02.153940 [debug] [Thread-2  ]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
[0m19:16:02.154093 [debug] [Thread-2  ]: Snowflake adapter: Rolling back transaction.
[0m19:16:02.206023 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m19:16:02.206358 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01aa8d04-0000-4901-0000-f0ad0003a0c2
[0m19:16:02.206466 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'TEST' does not exist or not authorized.
[0m19:16:02.206624 [debug] [Thread-3  ]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
[0m19:16:02.206733 [debug] [Thread-3  ]: Snowflake adapter: Rolling back transaction.
[0m19:16:02.225701 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01aa8d04-0000-4981-0000-f0ad0004309a
[0m19:16:02.225807 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'TEST' does not exist or not authorized.
[0m19:16:02.225946 [debug] [Thread-1  ]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
[0m19:16:02.226027 [debug] [Thread-1  ]: Snowflake adapter: Rolling back transaction.
[0m19:16:02.244404 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_transactions (compile): 2023-02-24 19:16:01.221592 => 2023-02-24 19:16:02.244362
[0m19:16:02.244560 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
[0m19:16:02.244669 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_transactions (execute): 2023-02-24 19:16:02.244643 => 2023-02-24 19:16:02.244651
[0m19:16:02.244770 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: Close
[0m19:16:02.278330 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m19:16:02.290670 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
[0m19:16:02.290819 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_inventory (compile): 2023-02-24 19:16:01.253983 => 2023-02-24 19:16:02.290792
[0m19:16:02.290944 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
[0m19:16:02.291041 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_inventory (execute): 2023-02-24 19:16:02.291020 => 2023-02-24 19:16:02.291024
[0m19:16:02.291138 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: Close
[0m19:16:02.291981 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_orders (compile): 2023-02-24 19:16:01.202701 => 2023-02-24 19:16:02.291955
[0m19:16:02.292101 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_orders
[0m19:16:02.292194 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_orders (execute): 2023-02-24 19:16:02.292175 => 2023-02-24 19:16:02.292178
[0m19:16:02.292283 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: Close
[0m19:16:02.386107 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_orders
[0m19:16:02.386681 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
[0m19:16:02.386887 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
[0m19:16:02.387209 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_customer'
[0m19:16:02.387526 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_lineitem'
[0m19:16:02.387681 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
[0m19:16:02.387817 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
[0m19:16:02.403798 [info ] [Thread-4  ]: 19:16:02 + Loading TEST.DATA_VAULT.hub_customer from 1 source(s)
[0m19:16:02.407147 [info ] [Thread-3  ]: 19:16:02 + Loading TEST.DATA_VAULT.hub_lineitem from 1 source(s)
[0m19:16:02.420410 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
[0m19:16:02.440495 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
[0m19:16:02.452070 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
[0m19:16:02.452306 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_order
[0m19:16:02.453002 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
[0m19:16:02.453370 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_customer_nation
[0m19:16:02.453856 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_order'
[0m19:16:02.454442 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_customer_nation'
[0m19:16:02.454647 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (compile): 2023-02-24 19:16:02.403961 => 2023-02-24 19:16:02.454602
[0m19:16:02.454797 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
[0m19:16:02.454943 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (compile): 2023-02-24 19:16:02.387909 => 2023-02-24 19:16:02.454924
[0m19:16:02.455042 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
[0m19:16:02.455166 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
[0m19:16:02.458356 [info ] [Thread-2  ]: 19:16:02 + Loading TEST.DATA_VAULT.hub_order from 1 source(s)
[0m19:16:02.458553 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
[0m19:16:02.464288 [info ] [Thread-1  ]: 19:16:02 + Loading TEST.DATA_VAULT.link_customer_nation from 1 source(s)
[0m19:16:02.464609 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (execute): 2023-02-24 19:16:02.464557 => 2023-02-24 19:16:02.464569
[0m19:16:02.466390 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
[0m19:16:02.466533 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (execute): 2023-02-24 19:16:02.466504 => 2023-02-24 19:16:02.466510
[0m19:16:02.477551 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
[0m19:16:02.477983 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
[0m19:16:02.478579 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
[0m19:16:02.478967 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_customer_order
[0m19:16:02.479138 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m19:16:02.479500 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_customer_order'
[0m19:16:02.479742 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (compile): 2023-02-24 19:16:02.455264 => 2023-02-24 19:16:02.479698
[0m19:16:02.480087 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_inventory_allocation'
[0m19:16:02.480261 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_order
[0m19:16:02.480355 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_nation (compile): 2023-02-24 19:16:02.458661 => 2023-02-24 19:16:02.480333
[0m19:16:02.480467 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
[0m19:16:02.480572 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m19:16:02.483807 [info ] [Thread-3  ]: 19:16:02 + Loading TEST.DATA_VAULT.link_customer_order from 1 source(s)
[0m19:16:02.484004 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_nation
[0m19:16:02.484135 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (execute): 2023-02-24 19:16:02.484102 => 2023-02-24 19:16:02.484108
[0m19:16:02.487016 [info ] [Thread-4  ]: 19:16:02 + Loading TEST.DATA_VAULT.link_inventory_allocation from 1 source(s)
[0m19:16:02.489226 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
[0m19:16:02.489422 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_nation (execute): 2023-02-24 19:16:02.489380 => 2023-02-24 19:16:02.489389
[0m19:16:02.489774 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
[0m19:16:02.491770 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m19:16:02.492288 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_nation
[0m19:16:02.492502 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_order_lineitem
[0m19:16:02.492790 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m19:16:02.492932 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_order (compile): 2023-02-24 19:16:02.480653 => 2023-02-24 19:16:02.492907
[0m19:16:02.493199 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_order_lineitem'
[0m19:16:02.493466 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_cust_nation_details'
[0m19:16:02.493585 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory_allocation (compile): 2023-02-24 19:16:02.484228 => 2023-02-24 19:16:02.493564
[0m19:16:02.493692 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_order
[0m19:16:02.493811 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
[0m19:16:02.493920 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m19:16:02.494025 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m19:16:02.494126 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_order (execute): 2023-02-24 19:16:02.494104 => 2023-02-24 19:16:02.494109
[0m19:16:02.498019 [info ] [Thread-2  ]: 19:16:02 + Loading TEST.DATA_VAULT.link_order_lineitem from 1 source(s)
[0m19:16:02.516991 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory_allocation (execute): 2023-02-24 19:16:02.516909 => 2023-02-24 19:16:02.516926
[0m19:16:02.527474 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m19:16:02.527994 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_order
[0m19:16:02.529941 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m19:16:02.530254 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m19:16:02.530475 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m19:16:02.530755 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m19:16:02.531005 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_cust_region_details'
[0m19:16:02.531285 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_customer_details'
[0m19:16:02.531415 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m19:16:02.531576 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m19:16:02.537884 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_nation_details (compile): 2023-02-24 19:16:02.498338 => 2023-02-24 19:16:02.537852
[0m19:16:02.537998 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_order_lineitem (compile): 2023-02-24 19:16:02.494203 => 2023-02-24 19:16:02.537968
[0m19:16:02.538217 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m19:16:02.573798 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m19:16:02.574019 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m19:16:02.574150 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
[0m19:16:02.574390 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_nation_details (execute): 2023-02-24 19:16:02.574352 => 2023-02-24 19:16:02.574360
[0m19:16:02.574503 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_order_lineitem (execute): 2023-02-24 19:16:02.574482 => 2023-02-24 19:16:02.574485
[0m19:16:02.574873 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m19:16:02.574996 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_customer_details (compile): 2023-02-24 19:16:02.538310 => 2023-02-24 19:16:02.574976
[0m19:16:02.575073 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_region_details (compile): 2023-02-24 19:16:02.531671 => 2023-02-24 19:16:02.575058
[0m19:16:02.575327 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
[0m19:16:02.575495 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m19:16:02.575649 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m19:16:02.575755 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m19:16:02.575892 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_order_details
[0m19:16:02.576128 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_lineitem_details'
[0m19:16:02.576227 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_customer_details (execute): 2023-02-24 19:16:02.576205 => 2023-02-24 19:16:02.576209
[0m19:16:02.576326 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_region_details (execute): 2023-02-24 19:16:02.576306 => 2023-02-24 19:16:02.576309
[0m19:16:02.576712 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_order_details'
[0m19:16:02.576825 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m19:16:02.577091 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m19:16:02.577366 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m19:16:02.577477 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
[0m19:16:02.583902 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.t_link_transactions
[0m19:16:02.586301 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m19:16:02.586445 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
[0m19:16:02.593000 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.t_link_transactions'
[0m19:16:02.594086 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m19:16:02.594387 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_nation'
[0m19:16:02.594543 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
[0m19:16:02.594682 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_lineitem_details (compile): 2023-02-24 19:16:02.577553 => 2023-02-24 19:16:02.594658
[0m19:16:02.594788 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
[0m19:16:02.600556 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_order_details (compile): 2023-02-24 19:16:02.586555 => 2023-02-24 19:16:02.600528
[0m19:16:02.604544 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
[0m19:16:02.604677 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m19:16:02.607301 [info ] [Thread-3  ]: 19:16:02 + Loading TEST.DATA_VAULT.hub_nation from 2 source(s)
[0m19:16:02.607505 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
[0m19:16:02.607700 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_lineitem_details (execute): 2023-02-24 19:16:02.607668 => 2023-02-24 19:16:02.607675
[0m19:16:02.610576 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
[0m19:16:02.610780 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_order_details (execute): 2023-02-24 19:16:02.610737 => 2023-02-24 19:16:02.610745
[0m19:16:02.611156 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m19:16:02.611257 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.t_link_transactions (compile): 2023-02-24 19:16:02.594893 => 2023-02-24 19:16:02.611233
[0m19:16:02.611647 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
[0m19:16:02.611843 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_part
[0m19:16:02.612078 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.t_link_transactions
[0m19:16:02.612286 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_region
[0m19:16:02.612629 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_part'
[0m19:16:02.612736 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (compile): 2023-02-24 19:16:02.604757 => 2023-02-24 19:16:02.612708
[0m19:16:02.612852 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.t_link_transactions (execute): 2023-02-24 19:16:02.612830 => 2023-02-24 19:16:02.612836
[0m19:16:02.613079 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_region'
[0m19:16:02.613204 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
[0m19:16:02.613320 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
[0m19:16:02.613615 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.t_link_transactions
[0m19:16:02.613726 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
[0m19:16:02.616921 [info ] [Thread-1  ]: 19:16:02 + Loading TEST.DATA_VAULT.hub_part from 2 source(s)
[0m19:16:02.617110 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (execute): 2023-02-24 19:16:02.617080 => 2023-02-24 19:16:02.617085
[0m19:16:02.617293 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
[0m19:16:02.620074 [info ] [Thread-2  ]: 19:16:02 + Loading TEST.DATA_VAULT.hub_region from 2 source(s)
[0m19:16:02.623149 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
[0m19:16:02.623663 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
[0m19:16:02.623949 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_supplier'
[0m19:16:02.627550 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
[0m19:16:02.627838 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_inventory
[0m19:16:02.628070 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
[0m19:16:02.628583 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_inventory'
[0m19:16:02.628744 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (compile): 2023-02-24 19:16:02.613803 => 2023-02-24 19:16:02.628696
[0m19:16:02.631891 [info ] [Thread-4  ]: 19:16:02 + Loading TEST.DATA_VAULT.hub_supplier from 2 source(s)
[0m19:16:02.632117 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory
[0m19:16:02.632330 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
[0m19:16:02.635168 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
[0m19:16:02.635337 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (compile): 2023-02-24 19:16:02.617435 => 2023-02-24 19:16:02.635292
[0m19:16:02.641595 [info ] [Thread-3  ]: 19:16:02 + Loading TEST.DATA_VAULT.link_inventory from 1 source(s)
[0m19:16:02.641856 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (execute): 2023-02-24 19:16:02.641811 => 2023-02-24 19:16:02.641820
[0m19:16:02.642052 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
[0m19:16:02.644068 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
[0m19:16:02.644438 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
[0m19:16:02.644593 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (execute): 2023-02-24 19:16:02.644559 => 2023-02-24 19:16:02.644565
[0m19:16:02.644739 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (compile): 2023-02-24 19:16:02.628849 => 2023-02-24 19:16:02.644710
[0m19:16:02.644951 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_nation_region
[0m19:16:02.645351 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
[0m19:16:02.645540 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
[0m19:16:02.645817 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_nation_region'
[0m19:16:02.645942 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory (compile): 2023-02-24 19:16:02.638428 => 2023-02-24 19:16:02.645919
[0m19:16:02.646161 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_supplier_nation
[0m19:16:02.646327 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (execute): 2023-02-24 19:16:02.646301 => 2023-02-24 19:16:02.646305
[0m19:16:02.646449 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_nation_region
[0m19:16:02.646571 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory
[0m19:16:02.646830 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_supplier_nation'
[0m19:16:02.647133 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
[0m19:16:02.650482 [info ] [Thread-1  ]: 19:16:02 + Loading TEST.DATA_VAULT.link_nation_region from 2 source(s)
[0m19:16:02.650737 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory (execute): 2023-02-24 19:16:02.650690 => 2023-02-24 19:16:02.650702
[0m19:16:02.650885 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
[0m19:16:02.651059 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m19:16:02.654046 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
[0m19:16:02.654533 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory
[0m19:16:02.658735 [info ] [Thread-2  ]: 19:16:02 + Loading TEST.DATA_VAULT.link_supplier_nation from 1 source(s)
[0m19:16:02.659280 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_inventory_details'
[0m19:16:02.659554 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m19:16:02.661522 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m19:16:02.661786 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m19:16:02.662151 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_part_details'
[0m19:16:02.662292 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_nation_region (compile): 2023-02-24 19:16:02.647244 => 2023-02-24 19:16:02.662260
[0m19:16:02.669443 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m19:16:02.669691 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m19:16:02.669861 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_nation_region
[0m19:16:02.669994 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_supplier_nation (compile): 2023-02-24 19:16:02.654648 => 2023-02-24 19:16:02.669961
[0m19:16:02.678385 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m19:16:02.678615 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_nation_region (execute): 2023-02-24 19:16:02.678572 => 2023-02-24 19:16:02.678582
[0m19:16:02.678774 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
[0m19:16:02.678898 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_inventory_details (compile): 2023-02-24 19:16:02.662411 => 2023-02-24 19:16:02.678876
[0m19:16:02.679330 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_nation_region
[0m19:16:02.679472 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_supplier_nation (execute): 2023-02-24 19:16:02.679441 => 2023-02-24 19:16:02.679446
[0m19:16:02.679608 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m19:16:02.679769 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m19:16:02.679915 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_part_details (compile): 2023-02-24 19:16:02.670106 => 2023-02-24 19:16:02.679895
[0m19:16:02.680190 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
[0m19:16:02.680293 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_inventory_details (execute): 2023-02-24 19:16:02.680273 => 2023-02-24 19:16:02.680277
[0m19:16:02.680528 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details'
[0m19:16:02.680652 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m19:16:02.680798 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m19:16:02.681100 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m19:16:02.681210 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m19:16:02.681311 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_part_details (execute): 2023-02-24 19:16:02.681292 => 2023-02-24 19:16:02.681295
[0m19:16:02.681754 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details'
[0m19:16:02.681898 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m19:16:02.688753 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m19:16:02.689118 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m19:16:02.689239 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m19:16:02.689484 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details'
[0m19:16:02.695648 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m19:16:02.695795 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m19:16:02.702687 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m19:16:02.702851 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_nation_details (compile): 2023-02-24 19:16:02.682007 => 2023-02-24 19:16:02.702820
[0m19:16:02.702984 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m19:16:02.703104 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_nation_details (execute): 2023-02-24 19:16:02.703081 => 2023-02-24 19:16:02.703086
[0m19:16:02.703389 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m19:16:02.703568 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_region_details (compile): 2023-02-24 19:16:02.689693 => 2023-02-24 19:16:02.703548
[0m19:16:02.703656 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supplier_details (compile): 2023-02-24 19:16:02.695960 => 2023-02-24 19:16:02.703636
[0m19:16:02.703763 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m19:16:02.703870 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m19:16:02.703960 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_region_details (execute): 2023-02-24 19:16:02.703942 => 2023-02-24 19:16:02.703945
[0m19:16:02.704051 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supplier_details (execute): 2023-02-24 19:16:02.704033 => 2023-02-24 19:16:02.704036
[0m19:16:02.704302 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m19:16:02.704556 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m19:16:02.705083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:02.705178 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details' was properly closed.
[0m19:16:02.705253 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
[0m19:16:02.705347 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
[0m19:16:02.705414 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_part_details' was properly closed.
[0m19:16:02.706119 [debug] [MainThread]: Command end result
[0m19:16:02.714308 [info ] [MainThread]: Done.
[0m19:16:02.714624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5f7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085e2cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085e2910>]}
[0m19:16:02.714789 [debug] [MainThread]: Flushing usage events


============================== 2023-02-24 19:16:06.671801 | 5aa9cd4c-cce3-467d-8231-c83ab9cef314 ==============================
[0m19:16:06.671801 [info ] [MainThread]: Running with dbt=1.4.0
[0m19:16:06.672675 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
[0m19:16:06.672820 [debug] [MainThread]: Tracking: tracking
[0m19:16:06.673090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093839a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109383b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109383a30>]}
[0m19:16:06.673348 [info ] [MainThread]: Start parsing.
[0m19:16:06.690810 [info ] [MainThread]: Dependencies loaded
[0m19:16:06.700535 [info ] [MainThread]: ManifestLoader created
[0m19:16:06.729506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:16:06.729730 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:16:06.729832 [info ] [MainThread]: Manifest loaded
[0m19:16:06.730481 [info ] [MainThread]: Manifest checked
[0m19:16:06.731362 [info ] [MainThread]: Flat graph built
[0m19:16:06.731497 [info ] [MainThread]: Manifest finished loading
[0m19:16:06.731979 [info ] [MainThread]: Performance info: target/perf_info.json
[0m19:16:06.732119 [info ] [MainThread]: Done.
[0m19:16:06.732292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109523220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109523160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109523190>]}
[0m19:16:06.732452 [debug] [MainThread]: Flushing usage events


============================== 2023-02-24 19:16:10.227635 | 322348e5-7922-407e-9fcf-8abf8ed798f6 ==============================
[0m19:16:10.227635 [info ] [MainThread]: Running with dbt=1.4.0
[0m19:16:10.228551 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m19:16:10.228683 [debug] [MainThread]: Tracking: tracking
[0m19:16:10.228919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110238400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110238bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110238a90>]}
[0m19:16:10.282576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:16:10.282774 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:16:10.287390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '322348e5-7922-407e-9fcf-8abf8ed798f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106081c0>]}
[0m19:16:10.296797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '322348e5-7922-407e-9fcf-8abf8ed798f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104bc8e0>]}
[0m19:16:10.297007 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 630 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m19:16:10.297170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '322348e5-7922-407e-9fcf-8abf8ed798f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104bcac0>]}
[0m19:16:10.298546 [info ] [MainThread]: 
[0m19:16:10.299345 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:16:10.300596 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST'
[0m19:16:10.309598 [debug] [ThreadPool]: Using snowflake connection "list_TEST"
[0m19:16:10.309852 [debug] [ThreadPool]: On list_TEST: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_TEST"} */
show terse schemas in database TEST
    limit 10000
[0m19:16:10.309996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:11.059389 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01aa8d04-0000-4981-0000-f0ad0004309e
[0m19:16:11.059790 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m19:16:11.060051 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m19:16:11.060177 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:16:11.060439 [debug] [ThreadPool]: On list_TEST: Close
[0m19:16:11.184179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:11.184622 [debug] [MainThread]: Connection 'list_TEST' was properly closed.
[0m19:16:11.184956 [info ] [MainThread]: 
[0m19:16:11.185387 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m19:16:11.186017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104bc220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11026ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11063e910>]}
[0m19:16:11.186484 [debug] [MainThread]: Flushing usage events
[0m19:16:11.602003 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "TEST"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.


============================== 2023-02-24 21:35:38.232716 | 1e9e4f6e-e1ee-481e-9bf6-795b09df9e93 ==============================
[0m21:35:38.232716 [info ] [MainThread]: Running with dbt=1.4.0
[0m21:35:38.233699 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:35:38.233880 [debug] [MainThread]: Tracking: tracking
[0m21:35:38.234098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d29d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d2b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d2a60>]}
[0m21:35:38.263063 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:35:38.263316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1e9e4f6e-e1ee-481e-9bf6-795b09df9e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107403e80>]}
[0m21:35:39.306559 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_customer_order.sql
[0m21:35:39.353088 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
[0m21:35:39.353832 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_customer_nation.sql
[0m21:35:39.358500 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
[0m21:35:39.359165 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_inventory.sql
[0m21:35:39.364273 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
[0m21:35:39.364949 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_nation_region.sql
[0m21:35:39.370522 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
[0m21:35:39.371182 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
[0m21:35:39.375927 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
[0m21:35:39.376753 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_lineitem.sql
[0m21:35:39.381375 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
[0m21:35:39.382030 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_supplier_nation.sql
[0m21:35:39.387166 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
[0m21:35:39.387829 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_order.sql
[0m21:35:39.401161 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
[0m21:35:39.401827 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_nation.sql
[0m21:35:39.407412 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
[0m21:35:39.408130 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_part.sql
[0m21:35:39.413983 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
[0m21:35:39.414640 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
[0m21:35:39.419045 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
[0m21:35:39.419706 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_customer.sql
[0m21:35:39.424016 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
[0m21:35:39.424705 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_supplier.sql
[0m21:35:39.430192 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
[0m21:35:39.430856 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_region.sql
[0m21:35:39.437013 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
[0m21:35:39.437692 [debug] [MainThread]: 1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
[0m21:35:39.447461 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
[0m21:35:39.448198 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
[0m21:35:39.474292 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
[0m21:35:39.474997 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
[0m21:35:39.482828 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
[0m21:35:39.483512 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
[0m21:35:39.492889 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
[0m21:35:39.493568 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
[0m21:35:39.501063 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
[0m21:35:39.501735 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
[0m21:35:39.508566 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
[0m21:35:39.509240 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
[0m21:35:39.515679 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
[0m21:35:39.516360 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
[0m21:35:39.523029 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
[0m21:35:39.523708 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
[0m21:35:39.532047 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
[0m21:35:39.532723 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
[0m21:35:39.539147 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
[0m21:35:39.539820 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
[0m21:35:39.547986 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
[0m21:35:39.548869 [debug] [MainThread]: 1603: static parser failed on raw_stage/raw_transactions.sql
[0m21:35:39.552063 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
[0m21:35:39.553067 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage/raw_inventory.sql
[0m21:35:39.554720 [debug] [MainThread]: 1603: static parser failed on raw_stage/raw_orders.sql
[0m21:35:39.558200 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
[0m21:35:39.558946 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_orders.sql
[0m21:35:39.683565 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
[0m21:35:39.684329 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_inventory.sql
[0m21:35:39.723994 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
[0m21:35:39.724664 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_transactions.sql
[0m21:35:39.735116 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
[0m21:35:39.808258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e9e4f6e-e1ee-481e-9bf6-795b09df9e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a33d0>]}
[0m21:35:39.816439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e9e4f6e-e1ee-481e-9bf6-795b09df9e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a3df0>]}
[0m21:35:39.816619 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 630 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m21:35:39.816762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e9e4f6e-e1ee-481e-9bf6-795b09df9e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740ca30>]}
[0m21:35:39.817946 [info ] [MainThread]: 
[0m21:35:39.818677 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:35:39.819911 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST'
[0m21:35:39.828042 [debug] [ThreadPool]: Using snowflake connection "list_TEST"
[0m21:35:39.828244 [debug] [ThreadPool]: On list_TEST: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_TEST"} */
show terse schemas in database TEST
    limit 10000
[0m21:35:39.828352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:40.672783 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01aa8d8f-0000-4993-0000-f0ad00046012
[0m21:35:40.673257 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:35:40.673660 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m21:35:40.673876 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:35:40.674326 [debug] [ThreadPool]: On list_TEST: Close
[0m21:35:40.809448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:40.809844 [debug] [MainThread]: Connection 'list_TEST' was properly closed.
[0m21:35:40.810188 [info ] [MainThread]: 
[0m21:35:40.810597 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m21:35:40.811151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a3130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10755b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ee520>]}
[0m21:35:40.811511 [debug] [MainThread]: Flushing usage events
[0m21:35:41.302700 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "TEST"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.


============================== 2023-02-24 21:36:11.291760 | d9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8 ==============================
[0m21:36:11.291760 [info ] [MainThread]: Running with dbt=1.4.0
[0m21:36:11.292602 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:36:11.292715 [debug] [MainThread]: Tracking: tracking
[0m21:36:11.292968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113537250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113537c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113537b50>]}
[0m21:36:11.346574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:36:11.346782 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:36:11.351312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114009280>]}
[0m21:36:11.359627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136bb820>]}
[0m21:36:11.359832 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 630 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m21:36:11.359979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136bbb80>]}
[0m21:36:11.361294 [info ] [MainThread]: 
[0m21:36:11.362071 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:36:11.363299 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST'
[0m21:36:11.371955 [debug] [ThreadPool]: Using snowflake connection "list_TEST"
[0m21:36:11.372165 [debug] [ThreadPool]: On list_TEST: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_TEST"} */
show terse schemas in database TEST
    limit 10000
[0m21:36:11.372282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:12.349371 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m21:36:12.351548 [debug] [ThreadPool]: On list_TEST: Close
[0m21:36:12.461029 [debug] [ThreadPool]: Acquiring new snowflake connection 'create_TEST_DATA_VAULT'
[0m21:36:12.461864 [debug] [ThreadPool]: Acquiring new snowflake connection 'create_TEST_DATA_VAULT'
[0m21:36:12.462281 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='test', schema='data_vault', identifier=None)"
[0m21:36:12.470175 [debug] [ThreadPool]: Using snowflake connection "create_TEST_DATA_VAULT"
[0m21:36:12.470496 [debug] [ThreadPool]: On create_TEST_DATA_VAULT: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "create_TEST_DATA_VAULT"} */
create schema if not exists TEST.DATA_VAULT
[0m21:36:12.470727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:36:13.278431 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1 seconds
[0m21:36:13.281143 [debug] [ThreadPool]: On create_TEST_DATA_VAULT: Close
[0m21:36:13.421494 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST_DATA_VAULT'
[0m21:36:13.431348 [debug] [ThreadPool]: Using snowflake connection "list_TEST_DATA_VAULT"
[0m21:36:13.431659 [debug] [ThreadPool]: On list_TEST_DATA_VAULT: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_TEST_DATA_VAULT"} */
show terse objects in TEST.DATA_VAULT
[0m21:36:13.431922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:36:14.131706 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1 seconds
[0m21:36:14.133355 [debug] [ThreadPool]: On list_TEST_DATA_VAULT: Close
[0m21:36:14.249073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137f2ee0>]}
[0m21:36:14.250358 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:36:14.250819 [info ] [MainThread]: 
[0m21:36:14.257489 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.raw_orders
[0m21:36:14.258833 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_transactions
[0m21:36:14.258493 [info ] [Thread-1  ]: 1 of 31 START sql view model DATA_VAULT.raw_orders ............................. [RUN]
[0m21:36:14.259343 [info ] [Thread-2  ]: 2 of 31 START sql view model DATA_VAULT.raw_transactions ....................... [RUN]
[0m21:36:14.260233 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_orders'
[0m21:36:14.260961 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_transactions'
[0m21:36:14.261262 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.raw_orders
[0m21:36:14.261487 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_transactions
[0m21:36:14.267733 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
[0m21:36:14.271129 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
[0m21:36:14.271729 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.raw_orders (compile): 2023-02-24 21:36:14.261650 => 2023-02-24 21:36:14.271678
[0m21:36:14.271925 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.raw_orders
[0m21:36:14.278408 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_transactions (compile): 2023-02-24 21:36:14.267996 => 2023-02-24 21:36:14.278333
[0m21:36:14.295011 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.raw_orders"
[0m21:36:14.295231 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_transactions
[0m21:36:14.298734 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.raw_transactions"
[0m21:36:14.301026 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
[0m21:36:14.301224 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */
create or replace   view TEST.DATA_VAULT.raw_orders
  
   as (
    SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
[0m21:36:14.301403 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:36:14.302190 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
[0m21:36:14.302744 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */
create or replace   view TEST.DATA_VAULT.raw_transactions
  
   as (
    SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS  AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
[0m21:36:14.302874 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:36:15.111899 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:36:15.133639 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_transactions (execute): 2023-02-24 21:36:14.295462 => 2023-02-24 21:36:15.133561
[0m21:36:15.133995 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: Close
[0m21:36:15.297918 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137f2ee0>]}
[0m21:36:15.299275 [info ] [Thread-2  ]: 2 of 31 OK created sql view model DATA_VAULT.raw_transactions .................. [[32mSUCCESS 1[0m in 1.04s]
[0m21:36:15.301212 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_transactions
[0m21:36:15.301987 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.v_stg_transactions
[0m21:36:15.302448 [info ] [Thread-4  ]: 3 of 31 START sql view model DATA_VAULT.v_stg_transactions ..................... [RUN]
[0m21:36:15.303255 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_transactions'
[0m21:36:15.303557 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
[0m21:36:15.341093 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m21:36:15.341324 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
describe table TEST.DATA_VAULT.raw_transactions
[0m21:36:15.341447 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m21:36:15.928049 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 1 seconds
[0m21:36:15.980078 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m21:36:15.980270 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
describe table TEST.DATA_VAULT.raw_transactions
[0m21:36:16.140261 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0 seconds
[0m21:36:16.204473 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m21:36:16.205031 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_transactions (compile): 2023-02-24 21:36:15.303754 => 2023-02-24 21:36:16.204987
[0m21:36:16.205199 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
[0m21:36:16.207390 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m21:36:16.209140 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m21:36:16.209254 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
create or replace   view TEST.DATA_VAULT.v_stg_transactions
  
   as (
    







-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM TEST.DATA_VAULT.raw_transactions
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATEADD(DAY, 1, TRANSACTION_DATE) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS TRANSACTION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS VARCHAR))), '')) AS BINARY(16)) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
[0m21:36:16.293844 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m21:36:16.295398 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.raw_orders (execute): 2023-02-24 21:36:14.272049 => 2023-02-24 21:36:16.295362
[0m21:36:16.295582 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: Close
[0m21:36:16.406095 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140373a0>]}
[0m21:36:16.407528 [info ] [Thread-1  ]: 1 of 31 OK created sql view model DATA_VAULT.raw_orders ........................ [[32mSUCCESS 1[0m in 2.15s]
[0m21:36:16.408367 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.raw_orders
[0m21:36:16.409248 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_inventory
[0m21:36:16.409646 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.v_stg_orders
[0m21:36:16.410044 [info ] [Thread-2  ]: 4 of 31 START sql view model DATA_VAULT.raw_inventory .......................... [RUN]
[0m21:36:16.410478 [info ] [Thread-3  ]: 5 of 31 START sql view model DATA_VAULT.v_stg_orders ........................... [RUN]
[0m21:36:16.411210 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_inventory'
[0m21:36:16.411764 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_orders'
[0m21:36:16.412045 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_inventory
[0m21:36:16.412262 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
[0m21:36:16.417976 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
[0m21:36:16.431576 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m21:36:16.431804 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
describe table TEST.DATA_VAULT.raw_orders
[0m21:36:16.431938 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m21:36:16.432994 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_inventory (compile): 2023-02-24 21:36:16.412419 => 2023-02-24 21:36:16.432943
[0m21:36:16.433256 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_inventory
[0m21:36:16.436436 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.raw_inventory"
[0m21:36:16.438745 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
[0m21:36:16.439119 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */
create or replace   view TEST.DATA_VAULT.raw_inventory
  
   as (
    SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PARTSUPP AS a
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN TEST.DATA_VAULT.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
  );
[0m21:36:16.439350 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:36:16.609632 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:16.615747 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_transactions (execute): 2023-02-24 21:36:16.205291 => 2023-02-24 21:36:16.615718
[0m21:36:16.615892 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: Close
[0m21:36:16.843932 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0 seconds
[0m21:36:16.858240 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m21:36:16.858430 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
describe table TEST.DATA_VAULT.raw_orders
[0m21:36:16.906755 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1164aa550>]}
[0m21:36:16.907212 [info ] [Thread-4  ]: 3 of 31 OK created sql view model DATA_VAULT.v_stg_transactions ................ [[32mSUCCESS 1[0m in 1.60s]
[0m21:36:16.907589 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
[0m21:36:16.908131 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.t_link_transactions
[0m21:36:16.908445 [info ] [Thread-1  ]: 6 of 31 START sql incremental model DATA_VAULT.t_link_transactions ............. [RUN]
[0m21:36:16.909006 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.t_link_transactions'
[0m21:36:16.909229 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
[0m21:36:16.954709 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0 seconds
[0m21:36:16.958863 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
[0m21:36:16.996949 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.t_link_transactions (compile): 2023-02-24 21:36:16.909380 => 2023-02-24 21:36:16.996902
[0m21:36:16.997098 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.t_link_transactions
[0m21:36:17.031176 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
[0m21:36:17.038991 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.t_link_transactions"
[0m21:36:17.039485 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_orders (compile): 2023-02-24 21:36:16.418232 => 2023-02-24 21:36:17.039446
[0m21:36:17.039654 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_orders
[0m21:36:17.041536 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.v_stg_orders"
[0m21:36:17.042231 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m21:36:17.042343 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
create or replace transient table TEST.DATA_VAULT.t_link_transactions  as
        (-- Generated by dbtvault.

    

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_transactions
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    
)

SELECT * FROM records_to_insert
        );
[0m21:36:17.042451 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:36:17.049470 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m21:36:17.049577 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
create or replace   view TEST.DATA_VAULT.v_stg_orders
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM TEST.DATA_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMERKEY AS CUSTOMER_KEY,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS REGION_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '')) AS BINARY(16)) AS ORDER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '')) AS BINARY(16)) AS PART_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
  );
[0m21:36:17.211765 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:36:17.212873 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_inventory (execute): 2023-02-24 21:36:16.433380 => 2023-02-24 21:36:17.212843
[0m21:36:17.213000 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_inventory: Close
[0m21:36:17.313518 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140373a0>]}
[0m21:36:17.313915 [info ] [Thread-2  ]: 4 of 31 OK created sql view model DATA_VAULT.raw_inventory ..................... [[32mSUCCESS 1[0m in 0.90s]
[0m21:36:17.314212 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_inventory
[0m21:36:17.314643 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.v_stg_inventory
[0m21:36:17.314911 [info ] [Thread-4  ]: 7 of 31 START sql view model DATA_VAULT.v_stg_inventory ........................ [RUN]
[0m21:36:17.315373 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_inventory'
[0m21:36:17.315556 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
[0m21:36:17.325138 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m21:36:17.325333 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
describe table TEST.DATA_VAULT.raw_inventory
[0m21:36:17.325428 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m21:36:17.448294 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:17.455663 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_orders (execute): 2023-02-24 21:36:17.039743 => 2023-02-24 21:36:17.455634
[0m21:36:17.455794 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: Close
[0m21:36:17.590763 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116489fa0>]}
[0m21:36:17.591162 [info ] [Thread-3  ]: 5 of 31 OK created sql view model DATA_VAULT.v_stg_orders ...................... [[32mSUCCESS 1[0m in 1.18s]
[0m21:36:17.591438 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_orders
[0m21:36:17.591990 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
[0m21:36:17.592199 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
[0m21:36:17.592381 [info ] [Thread-2  ]: 8 of 31 START sql incremental model DATA_VAULT.hub_customer .................... [RUN]
[0m21:36:17.592622 [info ] [Thread-3  ]: 9 of 31 START sql incremental model DATA_VAULT.hub_lineitem .................... [RUN]
[0m21:36:17.593016 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_customer'
[0m21:36:17.593396 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_lineitem'
[0m21:36:17.593584 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
[0m21:36:17.593739 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
[0m21:36:17.606552 [info ] [Thread-2  ]: 21:36:17 + Loading TEST.DATA_VAULT.hub_customer from 1 source(s)
[0m21:36:17.609733 [info ] [Thread-3  ]: 21:36:17 + Loading TEST.DATA_VAULT.hub_lineitem from 1 source(s)
[0m21:36:17.619732 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
[0m21:36:17.621863 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
[0m21:36:17.622470 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (compile): 2023-02-24 21:36:17.593849 => 2023-02-24 21:36:17.622407
[0m21:36:17.622647 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
[0m21:36:17.654197 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (compile): 2023-02-24 21:36:17.606781 => 2023-02-24 21:36:17.654122
[0m21:36:17.657080 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_customer"
[0m21:36:17.657240 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
[0m21:36:17.659375 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_lineitem"
[0m21:36:17.660255 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m21:36:17.660788 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m21:36:17.660874 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
create or replace transient table TEST.DATA_VAULT.hub_lineitem  as
        (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
        );
[0m21:36:17.660970 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
create or replace transient table TEST.DATA_VAULT.hub_customer  as
        (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
        );
[0m21:36:17.661078 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m21:36:17.661171 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:36:17.801338 [debug] [Thread-4  ]: SQL status: SUCCESS 24 in 0 seconds
[0m21:36:17.810693 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m21:36:17.810858 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
describe table TEST.DATA_VAULT.raw_inventory
[0m21:36:17.913047 [debug] [Thread-4  ]: SQL status: SUCCESS 24 in 0 seconds
[0m21:36:17.948164 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m21:36:17.949535 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_inventory (compile): 2023-02-24 21:36:17.315678 => 2023-02-24 21:36:17.949492
[0m21:36:17.949679 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
[0m21:36:17.951489 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m21:36:17.957922 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m21:36:17.958027 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
create or replace   view TEST.DATA_VAULT.v_stg_inventory
  
   as (
    








WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM TEST.DATA_VAULT.raw_inventory
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS NATION_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_SUPPLIER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '')) AS BINARY(16)) AS PART_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS PART_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_REGION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_NATION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging
  );
[0m21:36:18.692622 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:36:18.695526 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_inventory (execute): 2023-02-24 21:36:17.949758 => 2023-02-24 21:36:18.695456
[0m21:36:18.695864 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: Close
[0m21:36:18.803234 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178a3820>]}
[0m21:36:18.804063 [info ] [Thread-4  ]: 7 of 31 OK created sql view model DATA_VAULT.v_stg_inventory ................... [[32mSUCCESS 1[0m in 1.49s]
[0m21:36:18.804562 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
[0m21:36:18.804970 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_order
[0m21:36:18.805304 [info ] [Thread-4  ]: 10 of 31 START sql incremental model DATA_VAULT.hub_order ...................... [RUN]
[0m21:36:18.805992 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_order'
[0m21:36:18.806463 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
[0m21:36:18.813823 [info ] [Thread-4  ]: 21:36:18 + Loading TEST.DATA_VAULT.hub_order from 1 source(s)
[0m21:36:18.817503 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
[0m21:36:18.818192 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (compile): 2023-02-24 21:36:18.807038 => 2023-02-24 21:36:18.818133
[0m21:36:18.818414 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
[0m21:36:18.822002 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_order"
[0m21:36:18.823255 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m21:36:18.823458 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
create or replace transient table TEST.DATA_VAULT.hub_order  as
        (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
        );
[0m21:36:18.823602 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m21:36:20.433751 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m21:36:20.444991 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m21:36:20.445310 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
drop view if exists TEST.DATA_VAULT.t_link_transactions__dbt_tmp cascade
[0m21:36:20.508571 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:20.515186 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.t_link_transactions (execute): 2023-02-24 21:36:16.997180 => 2023-02-24 21:36:20.515138
[0m21:36:20.515438 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.t_link_transactions: Close
[0m21:36:20.621260 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11654a3d0>]}
[0m21:36:20.621710 [info ] [Thread-1  ]: 6 of 31 OK created sql incremental model DATA_VAULT.t_link_transactions ........ [[32mSUCCESS 1[0m in 3.71s]
[0m21:36:20.621981 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.t_link_transactions
[0m21:36:20.622187 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_customer_nation
[0m21:36:20.622374 [info ] [Thread-1  ]: 11 of 31 START sql incremental model DATA_VAULT.link_customer_nation ........... [RUN]
[0m21:36:20.622845 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_customer_nation'
[0m21:36:20.623003 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
[0m21:36:20.629065 [info ] [Thread-1  ]: 21:36:20 + Loading TEST.DATA_VAULT.link_customer_nation from 1 source(s)
[0m21:36:20.641379 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
[0m21:36:20.641899 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_nation (compile): 2023-02-24 21:36:20.623108 => 2023-02-24 21:36:20.641862
[0m21:36:20.642039 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_nation
[0m21:36:20.644651 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_customer_nation"
[0m21:36:20.645733 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m21:36:20.645870 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
create or replace transient table TEST.DATA_VAULT.link_customer_nation  as
        (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
        );
[0m21:36:20.645969 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:36:22.687921 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4 seconds
[0m21:36:22.691790 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m21:36:22.691962 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
drop view if exists TEST.DATA_VAULT.hub_order__dbt_tmp cascade
[0m21:36:22.694568 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 5 seconds
[0m21:36:22.697301 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m21:36:22.697526 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
drop view if exists TEST.DATA_VAULT.hub_lineitem__dbt_tmp cascade
[0m21:36:22.700337 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 5 seconds
[0m21:36:22.702696 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m21:36:22.702849 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
drop view if exists TEST.DATA_VAULT.hub_customer__dbt_tmp cascade
[0m21:36:22.723970 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m21:36:22.726450 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m21:36:22.726582 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
drop view if exists TEST.DATA_VAULT.link_customer_nation__dbt_tmp cascade
[0m21:36:22.761316 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:22.763116 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (execute): 2023-02-24 21:36:17.657455 => 2023-02-24 21:36:22.763078
[0m21:36:22.763321 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: Close
[0m21:36:22.764768 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:22.765041 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:22.766300 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (execute): 2023-02-24 21:36:17.622743 => 2023-02-24 21:36:22.766274
[0m21:36:22.767647 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (execute): 2023-02-24 21:36:18.818563 => 2023-02-24 21:36:22.767623
[0m21:36:22.767902 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: Close
[0m21:36:22.768032 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: Close
[0m21:36:22.790456 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:22.791907 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_nation (execute): 2023-02-24 21:36:20.642141 => 2023-02-24 21:36:22.791879
[0m21:36:22.792053 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_nation: Close
[0m21:36:22.857488 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178defa0>]}
[0m21:36:22.857854 [info ] [Thread-3  ]: 9 of 31 OK created sql incremental model DATA_VAULT.hub_lineitem ............... [[32mSUCCESS 1[0m in 5.26s]
[0m21:36:22.858115 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
[0m21:36:22.858327 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_customer_order
[0m21:36:22.858527 [info ] [Thread-3  ]: 12 of 31 START sql incremental model DATA_VAULT.link_customer_order ............ [RUN]
[0m21:36:22.858914 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_customer_order'
[0m21:36:22.859133 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_order
[0m21:36:22.863659 [info ] [Thread-3  ]: 21:36:22 + Loading TEST.DATA_VAULT.link_customer_order from 1 source(s)
[0m21:36:22.867102 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
[0m21:36:22.867718 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_order (compile): 2023-02-24 21:36:22.859269 => 2023-02-24 21:36:22.867673
[0m21:36:22.867883 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_order
[0m21:36:22.871859 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_customer_order"
[0m21:36:22.873018 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m21:36:22.873180 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
create or replace transient table TEST.DATA_VAULT.link_customer_order  as
        (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
        );
[0m21:36:22.873305 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m21:36:22.883873 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178f1df0>]}
[0m21:36:22.884240 [info ] [Thread-2  ]: 8 of 31 OK created sql incremental model DATA_VAULT.hub_customer ............... [[32mSUCCESS 1[0m in 5.29s]
[0m21:36:22.884472 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
[0m21:36:22.884651 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m21:36:22.884883 [info ] [Thread-2  ]: 13 of 31 START sql incremental model DATA_VAULT.link_inventory_allocation ...... [RUN]
[0m21:36:22.885247 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_inventory_allocation'
[0m21:36:22.885390 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m21:36:22.888956 [info ] [Thread-2  ]: 21:36:22 + Loading TEST.DATA_VAULT.link_inventory_allocation from 1 source(s)
[0m21:36:22.892311 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m21:36:22.892986 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory_allocation (compile): 2023-02-24 21:36:22.885481 => 2023-02-24 21:36:22.892916
[0m21:36:22.893184 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m21:36:22.895676 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m21:36:22.896114 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1164aa4c0>]}
[0m21:36:22.896472 [info ] [Thread-1  ]: 11 of 31 OK created sql incremental model DATA_VAULT.link_customer_nation ...... [[32mSUCCESS 1[0m in 2.27s]
[0m21:36:22.896838 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_nation
[0m21:36:22.897138 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_order_lineitem
[0m21:36:22.897938 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m21:36:22.898295 [info ] [Thread-1  ]: 14 of 31 START sql incremental model DATA_VAULT.link_order_lineitem ............ [RUN]
[0m21:36:22.898601 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
create or replace transient table TEST.DATA_VAULT.link_inventory_allocation  as
        (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
        );
[0m21:36:22.898984 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_order_lineitem'
[0m21:36:22.899164 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:36:22.899331 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
[0m21:36:22.903296 [info ] [Thread-1  ]: 21:36:22 + Loading TEST.DATA_VAULT.link_order_lineitem from 1 source(s)
[0m21:36:22.906073 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m21:36:22.906603 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_order_lineitem (compile): 2023-02-24 21:36:22.899895 => 2023-02-24 21:36:22.906557
[0m21:36:22.906759 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
[0m21:36:22.910083 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m21:36:22.911198 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m21:36:22.911305 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
create or replace transient table TEST.DATA_VAULT.link_order_lineitem  as
        (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
        );
[0m21:36:22.911493 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:36:22.918075 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114415100>]}
[0m21:36:22.918374 [info ] [Thread-4  ]: 10 of 31 OK created sql incremental model DATA_VAULT.hub_order ................. [[32mSUCCESS 1[0m in 4.11s]
[0m21:36:22.918564 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
[0m21:36:22.918722 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m21:36:22.918862 [info ] [Thread-4  ]: 15 of 31 START sql incremental model DATA_VAULT.sat_order_cust_nation_details .. [RUN]
[0m21:36:22.919228 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_cust_nation_details'
[0m21:36:22.919369 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m21:36:22.948371 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m21:36:22.949296 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_nation_details (compile): 2023-02-24 21:36:22.919454 => 2023-02-24 21:36:22.949248
[0m21:36:22.949450 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m21:36:22.951680 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m21:36:22.952493 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m21:36:22.952611 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
create or replace transient table TEST.DATA_VAULT.sat_order_cust_nation_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m21:36:22.952708 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m21:36:25.249691 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m21:36:25.256462 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m21:36:25.256802 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
drop view if exists TEST.DATA_VAULT.link_customer_order__dbt_tmp cascade
[0m21:36:25.323672 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:25.328175 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_order (execute): 2023-02-24 21:36:22.867994 => 2023-02-24 21:36:25.328077
[0m21:36:25.328642 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_order: Close
[0m21:36:25.655671 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3 seconds
[0m21:36:25.658380 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m21:36:25.658541 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
drop view if exists TEST.DATA_VAULT.sat_order_cust_nation_details__dbt_tmp cascade
[0m21:36:25.660165 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11650e070>]}
[0m21:36:25.660562 [info ] [Thread-3  ]: 12 of 31 OK created sql incremental model DATA_VAULT.link_customer_order ....... [[32mSUCCESS 1[0m in 2.80s]
[0m21:36:25.661051 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_order
[0m21:36:25.661268 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m21:36:25.661623 [info ] [Thread-3  ]: 16 of 31 START sql incremental model DATA_VAULT.sat_order_cust_region_details .. [RUN]
[0m21:36:25.662002 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_cust_region_details'
[0m21:36:25.662178 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m21:36:25.671691 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m21:36:25.672709 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_region_details (compile): 2023-02-24 21:36:25.662278 => 2023-02-24 21:36:25.672652
[0m21:36:25.672942 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m21:36:25.676019 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m21:36:25.677177 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m21:36:25.677292 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
create or replace transient table TEST.DATA_VAULT.sat_order_cust_region_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m21:36:25.677400 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m21:36:25.737412 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:25.739005 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_nation_details (execute): 2023-02-24 21:36:22.949534 => 2023-02-24 21:36:25.738962
[0m21:36:25.739204 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
[0m21:36:25.879409 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114415820>]}
[0m21:36:25.879785 [info ] [Thread-4  ]: 15 of 31 OK created sql incremental model DATA_VAULT.sat_order_cust_nation_details  [[32mSUCCESS 1[0m in 2.96s]
[0m21:36:25.880016 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m21:36:25.880203 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m21:36:25.880360 [info ] [Thread-4  ]: 17 of 31 START sql incremental model DATA_VAULT.sat_order_customer_details ..... [RUN]
[0m21:36:25.880687 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_customer_details'
[0m21:36:25.880873 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m21:36:25.890817 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m21:36:25.891356 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_customer_details (compile): 2023-02-24 21:36:25.880991 => 2023-02-24 21:36:25.891309
[0m21:36:25.891497 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m21:36:25.894289 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m21:36:25.895243 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m21:36:25.895353 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
create or replace transient table TEST.DATA_VAULT.sat_order_customer_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m21:36:25.895452 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m21:36:26.178689 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m21:36:26.181976 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m21:36:26.182165 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
drop view if exists TEST.DATA_VAULT.link_order_lineitem__dbt_tmp cascade
[0m21:36:26.267259 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:26.269716 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_order_lineitem (execute): 2023-02-24 21:36:22.906957 => 2023-02-24 21:36:26.269647
[0m21:36:26.269949 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: Close
[0m21:36:26.321465 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3 seconds
[0m21:36:26.326124 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m21:36:26.326395 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
drop view if exists TEST.DATA_VAULT.link_inventory_allocation__dbt_tmp cascade
[0m21:36:26.383666 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1164ae730>]}
[0m21:36:26.384304 [info ] [Thread-1  ]: 14 of 31 OK created sql incremental model DATA_VAULT.link_order_lineitem ....... [[32mSUCCESS 1[0m in 3.48s]
[0m21:36:26.384758 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
[0m21:36:26.385119 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m21:36:26.385400 [info ] [Thread-1  ]: 18 of 31 START sql incremental model DATA_VAULT.sat_order_lineitem_details ..... [RUN]
[0m21:36:26.385974 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_lineitem_details'
[0m21:36:26.386318 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m21:36:26.404902 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m21:36:26.405895 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:26.407731 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory_allocation (execute): 2023-02-24 21:36:22.893276 => 2023-02-24 21:36:26.407692
[0m21:36:26.407933 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
[0m21:36:26.409041 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_lineitem_details (compile): 2023-02-24 21:36:26.386528 => 2023-02-24 21:36:26.408975
[0m21:36:26.409279 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m21:36:26.413482 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m21:36:26.415196 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m21:36:26.415526 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
create or replace transient table TEST.DATA_VAULT.sat_order_lineitem_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_orders AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m21:36:26.415709 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:36:26.539089 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178a9d30>]}
[0m21:36:26.545660 [info ] [Thread-2  ]: 13 of 31 OK created sql incremental model DATA_VAULT.link_inventory_allocation . [[32mSUCCESS 1[0m in 3.65s]
[0m21:36:26.545880 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m21:36:26.546052 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_order_details
[0m21:36:26.546260 [info ] [Thread-2  ]: 19 of 31 START sql incremental model DATA_VAULT.sat_order_order_details ........ [RUN]
[0m21:36:26.550628 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_order_details'
[0m21:36:26.550931 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
[0m21:36:26.565688 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m21:36:26.566770 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_order_details (compile): 2023-02-24 21:36:26.551044 => 2023-02-24 21:36:26.566730
[0m21:36:26.566922 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
[0m21:36:26.569150 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m21:36:26.572052 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m21:36:26.572214 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
create or replace transient table TEST.DATA_VAULT.sat_order_order_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_orders AS a
    WHERE a.ORDER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m21:36:26.572318 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:36:27.398721 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m21:36:27.405111 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m21:36:27.405408 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
drop view if exists TEST.DATA_VAULT.sat_order_cust_region_details__dbt_tmp cascade
[0m21:36:27.488241 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:27.492535 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_region_details (execute): 2023-02-24 21:36:25.673057 => 2023-02-24 21:36:27.492426
[0m21:36:27.492954 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
[0m21:36:27.607388 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1165aac70>]}
[0m21:36:27.608092 [info ] [Thread-3  ]: 16 of 31 OK created sql incremental model DATA_VAULT.sat_order_cust_region_details  [[32mSUCCESS 1[0m in 1.95s]
[0m21:36:27.608588 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m21:36:27.609016 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
[0m21:36:27.609526 [info ] [Thread-3  ]: 20 of 31 START sql incremental model DATA_VAULT.hub_nation ..................... [RUN]
[0m21:36:27.610260 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_nation'
[0m21:36:27.610547 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
[0m21:36:27.617300 [info ] [Thread-3  ]: 21:36:27 + Loading TEST.DATA_VAULT.hub_nation from 2 source(s)
[0m21:36:27.623847 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
[0m21:36:27.624553 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (compile): 2023-02-24 21:36:27.610734 => 2023-02-24 21:36:27.624490
[0m21:36:27.624783 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
[0m21:36:27.628230 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_nation"
[0m21:36:27.630150 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m21:36:27.630324 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
create or replace transient table TEST.DATA_VAULT.hub_nation  as
        (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
        );
[0m21:36:27.630462 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m21:36:28.418058 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3 seconds
[0m21:36:28.426632 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m21:36:28.427107 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
drop view if exists TEST.DATA_VAULT.sat_order_customer_details__dbt_tmp cascade
[0m21:36:28.497960 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:28.501736 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_customer_details (execute): 2023-02-24 21:36:25.891579 => 2023-02-24 21:36:28.501638
[0m21:36:28.502063 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
[0m21:36:28.613105 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11673e700>]}
[0m21:36:28.613971 [info ] [Thread-4  ]: 17 of 31 OK created sql incremental model DATA_VAULT.sat_order_customer_details  [[32mSUCCESS 1[0m in 2.73s]
[0m21:36:28.614551 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m21:36:28.615021 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_part
[0m21:36:28.615440 [info ] [Thread-4  ]: 21 of 31 START sql incremental model DATA_VAULT.hub_part ....................... [RUN]
[0m21:36:28.616505 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_part'
[0m21:36:28.616849 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
[0m21:36:28.624648 [info ] [Thread-4  ]: 21:36:28 + Loading TEST.DATA_VAULT.hub_part from 2 source(s)
[0m21:36:28.631975 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
[0m21:36:28.632674 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (compile): 2023-02-24 21:36:28.617057 => 2023-02-24 21:36:28.632616
[0m21:36:28.632901 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
[0m21:36:28.636710 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_part"
[0m21:36:28.638523 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m21:36:28.638673 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
create or replace transient table TEST.DATA_VAULT.hub_part  as
        (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
        );
[0m21:36:28.638982 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m21:36:31.073296 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 5 seconds
[0m21:36:31.075625 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m21:36:31.075778 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
drop view if exists TEST.DATA_VAULT.sat_order_lineitem_details__dbt_tmp cascade
[0m21:36:31.154296 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:31.155870 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_lineitem_details (execute): 2023-02-24 21:36:26.409395 => 2023-02-24 21:36:31.155835
[0m21:36:31.156025 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
[0m21:36:31.240968 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 5 seconds
[0m21:36:31.244420 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m21:36:31.244581 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
drop view if exists TEST.DATA_VAULT.sat_order_order_details__dbt_tmp cascade
[0m21:36:31.271609 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1164aeaf0>]}
[0m21:36:31.271961 [info ] [Thread-1  ]: 18 of 31 OK created sql incremental model DATA_VAULT.sat_order_lineitem_details  [[32mSUCCESS 1[0m in 4.89s]
[0m21:36:31.272185 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m21:36:31.272370 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_region
[0m21:36:31.272626 [info ] [Thread-1  ]: 22 of 31 START sql incremental model DATA_VAULT.hub_region ..................... [RUN]
[0m21:36:31.272996 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_region'
[0m21:36:31.273137 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
[0m21:36:31.276858 [info ] [Thread-1  ]: 21:36:31 + Loading TEST.DATA_VAULT.hub_region from 2 source(s)
[0m21:36:31.281112 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
[0m21:36:31.281651 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (compile): 2023-02-24 21:36:31.273243 => 2023-02-24 21:36:31.281606
[0m21:36:31.281808 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
[0m21:36:31.284619 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_region"
[0m21:36:31.286168 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m21:36:31.286295 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
create or replace transient table TEST.DATA_VAULT.hub_region  as
        (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
        );
[0m21:36:31.286401 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:36:31.344373 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:31.345827 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_order_details (execute): 2023-02-24 21:36:26.567002 => 2023-02-24 21:36:31.345790
[0m21:36:31.346005 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: Close
[0m21:36:31.488866 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178a9910>]}
[0m21:36:31.489230 [info ] [Thread-2  ]: 19 of 31 OK created sql incremental model DATA_VAULT.sat_order_order_details ... [[32mSUCCESS 1[0m in 4.94s]
[0m21:36:31.489456 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
[0m21:36:31.489639 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
[0m21:36:31.489880 [info ] [Thread-2  ]: 23 of 31 START sql incremental model DATA_VAULT.hub_supplier ................... [RUN]
[0m21:36:31.490260 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_supplier'
[0m21:36:31.490403 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
[0m21:36:31.494274 [info ] [Thread-2  ]: 21:36:31 + Loading TEST.DATA_VAULT.hub_supplier from 2 source(s)
[0m21:36:31.498555 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
[0m21:36:31.499094 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (compile): 2023-02-24 21:36:31.490495 => 2023-02-24 21:36:31.499056
[0m21:36:31.499235 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
[0m21:36:31.536298 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_supplier"
[0m21:36:31.537792 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m21:36:31.537912 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
create or replace transient table TEST.DATA_VAULT.hub_supplier  as
        (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
        );
[0m21:36:31.538007 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:36:33.695172 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 5 seconds
[0m21:36:33.700216 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m21:36:33.700517 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
drop view if exists TEST.DATA_VAULT.hub_part__dbt_tmp cascade
[0m21:36:33.701879 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 6 seconds
[0m21:36:33.705666 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m21:36:33.705960 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
drop view if exists TEST.DATA_VAULT.hub_nation__dbt_tmp cascade
[0m21:36:33.795507 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:33.798025 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (execute): 2023-02-24 21:36:27.624906 => 2023-02-24 21:36:33.797970
[0m21:36:33.798297 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: Close
[0m21:36:33.926904 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b250d0>]}
[0m21:36:33.927747 [info ] [Thread-3  ]: 20 of 31 OK created sql incremental model DATA_VAULT.hub_nation ................ [[32mSUCCESS 1[0m in 6.32s]
[0m21:36:33.928232 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
[0m21:36:33.928702 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_inventory
[0m21:36:33.929260 [info ] [Thread-3  ]: 24 of 31 START sql incremental model DATA_VAULT.link_inventory ................. [RUN]
[0m21:36:33.930018 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_inventory'
[0m21:36:33.930293 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory
[0m21:36:33.937792 [info ] [Thread-3  ]: 21:36:33 + Loading TEST.DATA_VAULT.link_inventory from 1 source(s)
[0m21:36:33.942897 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
[0m21:36:33.943604 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory (compile): 2023-02-24 21:36:33.930481 => 2023-02-24 21:36:33.943550
[0m21:36:33.943809 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory
[0m21:36:33.947388 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_inventory"
[0m21:36:33.948890 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m21:36:33.949108 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
create or replace transient table TEST.DATA_VAULT.link_inventory  as
        (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
        );
[0m21:36:33.949270 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m21:36:34.049063 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:34.051101 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (execute): 2023-02-24 21:36:28.633049 => 2023-02-24 21:36:34.051050
[0m21:36:34.051326 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_part: Close
[0m21:36:34.223423 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144154f0>]}
[0m21:36:34.223883 [info ] [Thread-4  ]: 21 of 31 OK created sql incremental model DATA_VAULT.hub_part .................. [[32mSUCCESS 1[0m in 5.61s]
[0m21:36:34.224137 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
[0m21:36:34.224341 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_nation_region
[0m21:36:34.224670 [info ] [Thread-4  ]: 25 of 31 START sql incremental model DATA_VAULT.link_nation_region ............. [RUN]
[0m21:36:34.225198 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_nation_region'
[0m21:36:34.225356 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_nation_region
[0m21:36:34.229220 [info ] [Thread-4  ]: 21:36:34 + Loading TEST.DATA_VAULT.link_nation_region from 2 source(s)
[0m21:36:34.233329 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
[0m21:36:34.234968 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_nation_region (compile): 2023-02-24 21:36:34.225458 => 2023-02-24 21:36:34.234910
[0m21:36:34.235188 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_nation_region
[0m21:36:34.238012 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_nation_region"
[0m21:36:34.239732 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m21:36:34.239976 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
create or replace transient table TEST.DATA_VAULT.link_nation_region  as
        (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
        );
[0m21:36:34.240112 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m21:36:35.797111 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4 seconds
[0m21:36:35.804308 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m21:36:35.804663 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
drop view if exists TEST.DATA_VAULT.hub_supplier__dbt_tmp cascade
[0m21:36:35.869514 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:35.872353 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (execute): 2023-02-24 21:36:31.499318 => 2023-02-24 21:36:35.872259
[0m21:36:35.872653 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: Close
[0m21:36:35.983996 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117be9250>]}
[0m21:36:35.984750 [info ] [Thread-2  ]: 23 of 31 OK created sql incremental model DATA_VAULT.hub_supplier .............. [[32mSUCCESS 1[0m in 4.49s]
[0m21:36:35.985061 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
[0m21:36:35.985268 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_supplier_nation
[0m21:36:35.985522 [info ] [Thread-2  ]: 26 of 31 START sql incremental model DATA_VAULT.link_supplier_nation ........... [RUN]
[0m21:36:35.985909 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_supplier_nation'
[0m21:36:35.986063 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
[0m21:36:35.989878 [info ] [Thread-2  ]: 21:36:35 + Loading TEST.DATA_VAULT.link_supplier_nation from 1 source(s)
[0m21:36:35.993138 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m21:36:35.993687 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_supplier_nation (compile): 2023-02-24 21:36:35.986157 => 2023-02-24 21:36:35.993633
[0m21:36:35.993844 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
[0m21:36:35.996482 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m21:36:35.997436 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m21:36:35.997535 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
create or replace transient table TEST.DATA_VAULT.link_supplier_nation  as
        (

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
        );
[0m21:36:35.997629 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:36:38.355360 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4 seconds
[0m21:36:38.357936 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m21:36:38.358133 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
drop view if exists TEST.DATA_VAULT.link_inventory__dbt_tmp cascade
[0m21:36:38.429924 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:38.431387 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory (execute): 2023-02-24 21:36:33.943932 => 2023-02-24 21:36:38.431353
[0m21:36:38.431534 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: Close
[0m21:36:38.545116 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11367ad90>]}
[0m21:36:38.545537 [info ] [Thread-3  ]: 24 of 31 OK created sql incremental model DATA_VAULT.link_inventory ............ [[32mSUCCESS 1[0m in 4.62s]
[0m21:36:38.545803 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory
[0m21:36:38.546021 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m21:36:38.546210 [info ] [Thread-3  ]: 27 of 31 START sql incremental model DATA_VAULT.sat_inv_inventory_details ...... [RUN]
[0m21:36:38.546590 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_inventory_details'
[0m21:36:38.546802 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m21:36:38.557706 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m21:36:38.558256 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_inventory_details (compile): 2023-02-24 21:36:38.546930 => 2023-02-24 21:36:38.558210
[0m21:36:38.558414 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m21:36:38.561397 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m21:36:38.562514 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m21:36:38.562633 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
create or replace transient table TEST.DATA_VAULT.sat_inv_inventory_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_inventory AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m21:36:38.562741 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m21:36:38.967232 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 8 seconds
[0m21:36:38.971114 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m21:36:38.971580 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
drop view if exists TEST.DATA_VAULT.hub_region__dbt_tmp cascade
[0m21:36:38.982822 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 5 seconds
[0m21:36:38.985324 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m21:36:38.985491 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
drop view if exists TEST.DATA_VAULT.link_nation_region__dbt_tmp cascade
[0m21:36:39.061331 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:39.063305 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (execute): 2023-02-24 21:36:31.282000 => 2023-02-24 21:36:39.063259
[0m21:36:39.063507 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: Close
[0m21:36:39.072550 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:39.074251 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_nation_region (execute): 2023-02-24 21:36:34.235287 => 2023-02-24 21:36:39.074216
[0m21:36:39.074434 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: Close
[0m21:36:39.181719 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114415190>]}
[0m21:36:39.182163 [info ] [Thread-4  ]: 25 of 31 OK created sql incremental model DATA_VAULT.link_nation_region ........ [[32mSUCCESS 1[0m in 4.96s]
[0m21:36:39.182441 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_nation_region
[0m21:36:39.182676 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m21:36:39.182934 [info ] [Thread-4  ]: 28 of 31 START sql incremental model DATA_VAULT.sat_inv_part_details ........... [RUN]
[0m21:36:39.183331 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_part_details'
[0m21:36:39.183488 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m21:36:39.197414 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m21:36:39.198037 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_part_details (compile): 2023-02-24 21:36:39.183618 => 2023-02-24 21:36:39.197990
[0m21:36:39.198207 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m21:36:39.201177 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m21:36:39.201685 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117814670>]}
[0m21:36:39.203234 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m21:36:39.203410 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
create or replace transient table TEST.DATA_VAULT.sat_inv_part_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_inventory AS a
    WHERE a.PART_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m21:36:39.203907 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m21:36:39.341740 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3 seconds
[0m21:36:39.344403 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m21:36:39.344516 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
drop view if exists TEST.DATA_VAULT.link_supplier_nation__dbt_tmp cascade
[0m21:36:39.425934 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:39.427494 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_supplier_nation (execute): 2023-02-24 21:36:35.993939 => 2023-02-24 21:36:39.427456
[0m21:36:39.427657 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: Close
[0m21:36:39.555302 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117be9490>]}
[0m21:36:39.740881 [info ] [Thread-1  ]: 22 of 31 OK created sql incremental model DATA_VAULT.hub_region ................ [[32mSUCCESS 1[0m in 7.93s]
[0m21:36:39.741403 [info ] [Thread-2  ]: 26 of 31 OK created sql incremental model DATA_VAULT.link_supplier_nation ...... [[32mSUCCESS 1[0m in 3.57s]
[0m21:36:39.742558 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
[0m21:36:39.743015 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
[0m21:36:39.743435 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m21:36:39.743993 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m21:36:39.744602 [info ] [Thread-1  ]: 29 of 31 START sql incremental model DATA_VAULT.sat_inv_supp_nation_details .... [RUN]
[0m21:36:39.745088 [info ] [Thread-2  ]: 30 of 31 START sql incremental model DATA_VAULT.sat_inv_supp_region_details .... [RUN]
[0m21:36:39.745926 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details'
[0m21:36:39.746471 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details'
[0m21:36:39.746746 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m21:36:39.746984 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m21:36:39.763264 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m21:36:39.775667 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m21:36:39.776386 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_region_details (compile): 2023-02-24 21:36:39.763448 => 2023-02-24 21:36:39.776324
[0m21:36:39.776611 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m21:36:39.776775 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_nation_details (compile): 2023-02-24 21:36:39.747164 => 2023-02-24 21:36:39.776729
[0m21:36:39.779969 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m21:36:39.780176 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m21:36:39.783934 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m21:36:39.785139 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m21:36:39.786063 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m21:36:39.786238 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
create or replace transient table TEST.DATA_VAULT.sat_inv_supp_nation_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m21:36:39.786382 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
create or replace transient table TEST.DATA_VAULT.sat_inv_supp_region_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m21:36:39.786505 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:36:39.786637 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:36:42.653366 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4 seconds
[0m21:36:42.655662 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m21:36:42.655816 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
drop view if exists TEST.DATA_VAULT.sat_inv_inventory_details__dbt_tmp cascade
[0m21:36:42.721366 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:42.722748 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_inventory_details (execute): 2023-02-24 21:36:38.558505 => 2023-02-24 21:36:42.722715
[0m21:36:42.722903 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: Close
[0m21:36:42.824384 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11646d9a0>]}
[0m21:36:42.824963 [info ] [Thread-3  ]: 27 of 31 OK created sql incremental model DATA_VAULT.sat_inv_inventory_details . [[32mSUCCESS 1[0m in 4.28s]
[0m21:36:42.825253 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m21:36:42.825489 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m21:36:42.825832 [info ] [Thread-3  ]: 31 of 31 START sql incremental model DATA_VAULT.sat_inv_supplier_details ....... [RUN]
[0m21:36:42.826363 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details'
[0m21:36:42.826539 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m21:36:42.839816 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m21:36:42.840400 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supplier_details (compile): 2023-02-24 21:36:42.826652 => 2023-02-24 21:36:42.840349
[0m21:36:42.840574 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m21:36:42.843304 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m21:36:42.844296 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m21:36:42.844412 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
create or replace transient table TEST.DATA_VAULT.sat_inv_supplier_details  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
[0m21:36:42.844516 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m21:36:43.374444 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4 seconds
[0m21:36:43.381248 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m21:36:43.381606 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
drop view if exists TEST.DATA_VAULT.sat_inv_supp_nation_details__dbt_tmp cascade
[0m21:36:43.398750 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4 seconds
[0m21:36:43.403034 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m21:36:43.403280 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
drop view if exists TEST.DATA_VAULT.sat_inv_part_details__dbt_tmp cascade
[0m21:36:43.467104 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:43.471049 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_part_details (execute): 2023-02-24 21:36:39.198319 => 2023-02-24 21:36:43.470957
[0m21:36:43.471473 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: Close
[0m21:36:43.473025 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:43.475597 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_nation_details (execute): 2023-02-24 21:36:39.780335 => 2023-02-24 21:36:43.475548
[0m21:36:43.476383 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: Close
[0m21:36:43.596132 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11671e8e0>]}
[0m21:36:43.596937 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114415e20>]}
[0m21:36:43.597497 [info ] [Thread-1  ]: 29 of 31 OK created sql incremental model DATA_VAULT.sat_inv_supp_nation_details  [[32mSUCCESS 1[0m in 3.85s]
[0m21:36:43.598189 [info ] [Thread-4  ]: 28 of 31 OK created sql incremental model DATA_VAULT.sat_inv_part_details ...... [[32mSUCCESS 1[0m in 4.41s]
[0m21:36:43.598668 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m21:36:43.599025 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m21:36:43.622770 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4 seconds
[0m21:36:43.628196 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m21:36:43.628410 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
drop view if exists TEST.DATA_VAULT.sat_inv_supp_region_details__dbt_tmp cascade
[0m21:36:43.703603 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:43.706331 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_region_details (execute): 2023-02-24 21:36:39.776899 => 2023-02-24 21:36:43.706263
[0m21:36:43.706622 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: Close
[0m21:36:43.850373 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116460130>]}
[0m21:36:43.851711 [info ] [Thread-2  ]: 30 of 31 OK created sql incremental model DATA_VAULT.sat_inv_supp_region_details  [[32mSUCCESS 1[0m in 4.10s]
[0m21:36:43.852433 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m21:36:45.931591 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3 seconds
[0m21:36:45.936807 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m21:36:45.937134 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
drop view if exists TEST.DATA_VAULT.sat_inv_supplier_details__dbt_tmp cascade
[0m21:36:46.061833 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:36:46.063871 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supplier_details (execute): 2023-02-24 21:36:42.840676 => 2023-02-24 21:36:46.063819
[0m21:36:46.064103 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: Close
[0m21:36:46.259681 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a880b4-a0cd-40c5-96fc-9f9dc9dd7ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b250d0>]}
[0m21:36:46.260670 [info ] [Thread-3  ]: 31 of 31 OK created sql incremental model DATA_VAULT.sat_inv_supplier_details .. [[32mSUCCESS 1[0m in 3.43s]
[0m21:36:46.261250 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m21:36:46.263748 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:36:46.264441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:46.264666 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details' was properly closed.
[0m21:36:46.264856 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
[0m21:36:46.265031 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_part_details' was properly closed.
[0m21:36:46.265200 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
[0m21:36:46.265595 [info ] [MainThread]: 
[0m21:36:46.265918 [info ] [MainThread]: Finished running 6 view models, 25 incremental models in 0 hours 0 minutes and 34.90 seconds (34.90s).
[0m21:36:46.267851 [debug] [MainThread]: Command end result
[0m21:36:46.281648 [info ] [MainThread]: 
[0m21:36:46.281973 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:36:46.282213 [info ] [MainThread]: 
[0m21:36:46.282395 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=0 SKIP=0 TOTAL=31
[0m21:36:46.282656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135375b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114032eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140323a0>]}
[0m21:36:46.282934 [debug] [MainThread]: Flushing usage events


============================== 2023-02-24 21:39:04.907237 | 3e7ab0a2-3d75-4d02-95e6-fb776dae9d1c ==============================
[0m21:39:04.907237 [info ] [MainThread]: Running with dbt=1.4.0
[0m21:39:04.908147 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m21:39:04.908263 [debug] [MainThread]: Tracking: tracking
[0m21:39:04.908481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a38850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a38a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a38970>]}
[0m21:39:04.964698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:39:04.965048 [debug] [MainThread]: Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_order_cust_region_details.sql
[0m21:39:04.973956 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
[0m21:39:05.038079 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
[0m21:39:05.075877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e7ab0a2-3d75-4d02-95e6-fb776dae9d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d1acd0>]}
[0m21:39:05.084527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e7ab0a2-3d75-4d02-95e6-fb776dae9d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a68d00>]}
[0m21:39:05.084738 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 630 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m21:39:05.084892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e7ab0a2-3d75-4d02-95e6-fb776dae9d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cbba00>]}
[0m21:39:05.086169 [info ] [MainThread]: 
[0m21:39:05.086944 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:39:05.088073 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST_DATA_VAULT'
[0m21:39:05.096285 [debug] [ThreadPool]: Using snowflake connection "list_TEST_DATA_VAULT"
[0m21:39:05.096499 [debug] [ThreadPool]: On list_TEST_DATA_VAULT: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_TEST_DATA_VAULT"} */
show terse objects in TEST.DATA_VAULT
[0m21:39:05.096611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:05.816530 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 1 seconds
[0m21:39:05.818925 [debug] [ThreadPool]: On list_TEST_DATA_VAULT: Close
[0m21:39:05.933369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e7ab0a2-3d75-4d02-95e6-fb776dae9d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cef7c0>]}
[0m21:39:05.934208 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:39:05.934513 [info ] [MainThread]: 
[0m21:39:05.938696 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.raw_orders
[0m21:39:05.939064 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_transactions
[0m21:39:05.939630 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_orders'
[0m21:39:05.940089 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_transactions'
[0m21:39:05.940306 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.raw_orders
[0m21:39:05.940494 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_transactions
[0m21:39:05.946569 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
[0m21:39:05.950372 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
[0m21:39:05.951028 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.raw_orders (compile): 2023-02-24 21:39:05.940675 => 2023-02-24 21:39:05.950967
[0m21:39:05.951218 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_transactions (compile): 2023-02-24 21:39:05.946816 => 2023-02-24 21:39:05.951186
[0m21:39:05.951412 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.raw_orders
[0m21:39:05.951614 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_transactions
[0m21:39:05.951788 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.raw_orders (execute): 2023-02-24 21:39:05.951746 => 2023-02-24 21:39:05.951758
[0m21:39:05.951940 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_transactions (execute): 2023-02-24 21:39:05.951910 => 2023-02-24 21:39:05.951915
[0m21:39:05.953432 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.raw_orders
[0m21:39:05.953977 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_transactions
[0m21:39:05.954561 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.raw_inventory
[0m21:39:05.955114 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_inventory'
[0m21:39:05.955330 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.v_stg_orders
[0m21:39:05.955487 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.raw_inventory
[0m21:39:05.955635 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.v_stg_transactions
[0m21:39:05.955978 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_orders'
[0m21:39:05.959744 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
[0m21:39:05.960240 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_transactions'
[0m21:39:05.960441 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
[0m21:39:05.960675 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
[0m21:39:05.979832 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.raw_inventory (compile): 2023-02-24 21:39:05.956093 => 2023-02-24 21:39:05.979756
[0m21:39:05.991825 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m21:39:05.997516 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m21:39:05.997769 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.raw_inventory
[0m21:39:05.997876 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
describe table TEST.DATA_VAULT.raw_orders
[0m21:39:05.997967 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
describe table TEST.DATA_VAULT.raw_transactions
[0m21:39:05.998131 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.raw_inventory (execute): 2023-02-24 21:39:05.998079 => 2023-02-24 21:39:05.998095
[0m21:39:05.998259 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m21:39:05.998357 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:39:05.998697 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.raw_inventory
[0m21:39:06.000316 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.v_stg_inventory
[0m21:39:06.000614 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_inventory'
[0m21:39:06.000739 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
[0m21:39:06.008420 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m21:39:06.008880 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
describe table TEST.DATA_VAULT.raw_inventory
[0m21:39:06.009099 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:39:06.490439 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0 seconds
[0m21:39:06.496053 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0 seconds
[0m21:39:06.557569 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m21:39:06.559010 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m21:39:06.559218 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
describe table TEST.DATA_VAULT.raw_inventory
[0m21:39:06.559395 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
describe table TEST.DATA_VAULT.raw_orders
[0m21:39:06.676301 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0 seconds
[0m21:39:06.712799 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0 seconds
[0m21:39:06.738420 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 1 seconds
[0m21:39:06.754708 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m21:39:06.754839 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
describe table TEST.DATA_VAULT.raw_transactions
[0m21:39:06.786772 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m21:39:06.809274 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
[0m21:39:06.809616 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_inventory (compile): 2023-02-24 21:39:06.000822 => 2023-02-24 21:39:06.809578
[0m21:39:06.809756 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
[0m21:39:06.809858 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_inventory (execute): 2023-02-24 21:39:06.809834 => 2023-02-24 21:39:06.809842
[0m21:39:06.809960 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: Close
[0m21:39:06.810852 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_orders (compile): 2023-02-24 21:39:05.960825 => 2023-02-24 21:39:06.810825
[0m21:39:06.810977 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_orders
[0m21:39:06.811077 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_orders (execute): 2023-02-24 21:39:06.811058 => 2023-02-24 21:39:06.811061
[0m21:39:06.811164 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: Close
[0m21:39:06.892427 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m21:39:06.900735 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m21:39:06.901202 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_transactions (compile): 2023-02-24 21:39:05.991976 => 2023-02-24 21:39:06.901168
[0m21:39:06.901353 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
[0m21:39:06.901484 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_transactions (execute): 2023-02-24 21:39:06.901450 => 2023-02-24 21:39:06.901456
[0m21:39:06.901606 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: Close
[0m21:39:06.910787 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_orders
[0m21:39:06.911191 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
[0m21:39:06.911727 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
[0m21:39:06.912155 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_customer'
[0m21:39:06.912327 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
[0m21:39:06.912448 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
[0m21:39:06.912587 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_order
[0m21:39:06.912875 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_lineitem'
[0m21:39:06.925715 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_order'
[0m21:39:06.925900 [info ] [Thread-4  ]: 21:39:06 + Loading TEST.DATA_VAULT.hub_customer from 1 source(s)
[0m21:39:06.926100 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
[0m21:39:06.926223 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
[0m21:39:06.940031 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
[0m21:39:06.973258 [info ] [Thread-2  ]: 21:39:06 + Loading TEST.DATA_VAULT.hub_order from 1 source(s)
[0m21:39:06.974935 [info ] [Thread-3  ]: 21:39:06 + Loading TEST.DATA_VAULT.hub_lineitem from 1 source(s)
[0m21:39:06.978522 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
[0m21:39:06.982001 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
[0m21:39:06.982166 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (compile): 2023-02-24 21:39:06.912977 => 2023-02-24 21:39:06.982128
[0m21:39:06.982509 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
[0m21:39:06.982616 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (execute): 2023-02-24 21:39:06.982590 => 2023-02-24 21:39:06.982598
[0m21:39:06.982974 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
[0m21:39:06.983150 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_customer_nation
[0m21:39:06.983384 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_customer_nation'
[0m21:39:06.983500 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
[0m21:39:06.988984 [info ] [Thread-4  ]: 21:39:06 + Loading TEST.DATA_VAULT.link_customer_nation from 1 source(s)
[0m21:39:06.995081 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (compile): 2023-02-24 21:39:06.970471 => 2023-02-24 21:39:06.995013
[0m21:39:06.995275 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (compile): 2023-02-24 21:39:06.940152 => 2023-02-24 21:39:06.995242
[0m21:39:07.001970 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
[0m21:39:07.002245 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
[0m21:39:07.002544 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
[0m21:39:07.002868 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (execute): 2023-02-24 21:39:07.002831 => 2023-02-24 21:39:07.002840
[0m21:39:07.003082 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (execute): 2023-02-24 21:39:07.003051 => 2023-02-24 21:39:07.003056
[0m21:39:07.003495 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
[0m21:39:07.003866 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
[0m21:39:07.003965 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_nation (compile): 2023-02-24 21:39:06.983580 => 2023-02-24 21:39:07.003946
[0m21:39:07.004125 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_customer_order
[0m21:39:07.004311 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m21:39:07.004443 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_nation
[0m21:39:07.004678 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_customer_order'
[0m21:39:07.004917 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_inventory_allocation'
[0m21:39:07.005024 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_nation (execute): 2023-02-24 21:39:07.005001 => 2023-02-24 21:39:07.005004
[0m21:39:07.005134 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_order
[0m21:39:07.005237 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m21:39:07.005509 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_nation
[0m21:39:07.008640 [info ] [Thread-2  ]: 21:39:07 + Loading TEST.DATA_VAULT.link_customer_order from 1 source(s)
[0m21:39:07.011828 [info ] [Thread-3  ]: 21:39:07 + Loading TEST.DATA_VAULT.link_inventory_allocation from 1 source(s)
[0m21:39:07.012136 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_order_lineitem
[0m21:39:07.016232 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
[0m21:39:07.019682 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m21:39:07.020106 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_order_lineitem'
[0m21:39:07.020414 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
[0m21:39:07.023428 [info ] [Thread-4  ]: 21:39:07 + Loading TEST.DATA_VAULT.link_order_lineitem from 1 source(s)
[0m21:39:07.026752 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m21:39:07.027119 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory_allocation (compile): 2023-02-24 21:39:07.008804 => 2023-02-24 21:39:07.027081
[0m21:39:07.027254 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m21:39:07.027361 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory_allocation (execute): 2023-02-24 21:39:07.027335 => 2023-02-24 21:39:07.027343
[0m21:39:07.027683 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m21:39:07.027799 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_order (compile): 2023-02-24 21:39:07.005594 => 2023-02-24 21:39:07.027772
[0m21:39:07.027893 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_order_lineitem (compile): 2023-02-24 21:39:07.020523 => 2023-02-24 21:39:07.027874
[0m21:39:07.028036 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m21:39:07.028153 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_order
[0m21:39:07.028327 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
[0m21:39:07.028610 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_cust_nation_details'
[0m21:39:07.028727 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_order (execute): 2023-02-24 21:39:07.028701 => 2023-02-24 21:39:07.028706
[0m21:39:07.028854 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_order_lineitem (execute): 2023-02-24 21:39:07.028831 => 2023-02-24 21:39:07.028835
[0m21:39:07.028978 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m21:39:07.029275 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_order
[0m21:39:07.029554 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
[0m21:39:07.039419 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m21:39:07.039635 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m21:39:07.039776 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m21:39:07.040140 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_cust_region_details'
[0m21:39:07.040417 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_customer_details'
[0m21:39:07.040535 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m21:39:07.040657 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m21:39:07.046673 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_nation_details (compile): 2023-02-24 21:39:07.029643 => 2023-02-24 21:39:07.046617
[0m21:39:07.050337 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m21:39:07.061285 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m21:39:07.061485 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m21:39:07.061737 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_nation_details (execute): 2023-02-24 21:39:07.061696 => 2023-02-24 21:39:07.061705
[0m21:39:07.062050 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m21:39:07.062196 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m21:39:07.062422 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_lineitem_details'
[0m21:39:07.062530 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m21:39:07.075302 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_region_details (compile): 2023-02-24 21:39:07.040762 => 2023-02-24 21:39:07.075257
[0m21:39:07.075484 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m21:39:07.076427 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m21:39:07.076569 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_region_details (execute): 2023-02-24 21:39:07.076536 => 2023-02-24 21:39:07.076544
[0m21:39:07.076669 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_customer_details (compile): 2023-02-24 21:39:07.050464 => 2023-02-24 21:39:07.076643
[0m21:39:07.077007 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
[0m21:39:07.077345 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m21:39:07.077471 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m21:39:07.077640 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_order_details
[0m21:39:07.077816 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
[0m21:39:07.077957 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_customer_details (execute): 2023-02-24 21:39:07.077938 => 2023-02-24 21:39:07.077941
[0m21:39:07.078058 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_lineitem_details (compile): 2023-02-24 21:39:07.062604 => 2023-02-24 21:39:07.078043
[0m21:39:07.078302 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_order_details'
[0m21:39:07.078526 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_nation'
[0m21:39:07.078799 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m21:39:07.078907 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m21:39:07.079014 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
[0m21:39:07.079123 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
[0m21:39:07.079258 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_part
[0m21:39:07.079378 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_lineitem_details (execute): 2023-02-24 21:39:07.079359 => 2023-02-24 21:39:07.079362
[0m21:39:07.091027 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m21:39:07.094027 [info ] [Thread-2  ]: 21:39:07 + Loading TEST.DATA_VAULT.hub_nation from 2 source(s)
[0m21:39:07.094396 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_part'
[0m21:39:07.094700 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m21:39:07.098777 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
[0m21:39:07.098908 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
[0m21:39:07.099088 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_region
[0m21:39:07.102135 [info ] [Thread-4  ]: 21:39:07 + Loading TEST.DATA_VAULT.hub_part from 2 source(s)
[0m21:39:07.102324 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_order_details (compile): 2023-02-24 21:39:07.079453 => 2023-02-24 21:39:07.102288
[0m21:39:07.102667 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_region'
[0m21:39:07.107617 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
[0m21:39:07.107802 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (compile): 2023-02-24 21:39:07.091147 => 2023-02-24 21:39:07.107761
[0m21:39:07.107964 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
[0m21:39:07.108100 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
[0m21:39:07.108267 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
[0m21:39:07.108392 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_order_details (execute): 2023-02-24 21:39:07.108364 => 2023-02-24 21:39:07.108372
[0m21:39:07.111599 [info ] [Thread-3  ]: 21:39:07 + Loading TEST.DATA_VAULT.hub_region from 2 source(s)
[0m21:39:07.111954 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (execute): 2023-02-24 21:39:07.111888 => 2023-02-24 21:39:07.111900
[0m21:39:07.112164 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (compile): 2023-02-24 21:39:07.099245 => 2023-02-24 21:39:07.112115
[0m21:39:07.112577 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
[0m21:39:07.117150 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
[0m21:39:07.117612 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
[0m21:39:07.117771 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
[0m21:39:07.117961 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
[0m21:39:07.118205 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_inventory
[0m21:39:07.118359 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (execute): 2023-02-24 21:39:07.118329 => 2023-02-24 21:39:07.118335
[0m21:39:07.118624 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_supplier'
[0m21:39:07.118879 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_inventory'
[0m21:39:07.119182 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
[0m21:39:07.119284 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (compile): 2023-02-24 21:39:07.108496 => 2023-02-24 21:39:07.119264
[0m21:39:07.119405 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
[0m21:39:07.119542 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory
[0m21:39:07.119710 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_nation_region
[0m21:39:07.119861 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
[0m21:39:07.123113 [info ] [Thread-1  ]: 21:39:07 + Loading TEST.DATA_VAULT.hub_supplier from 2 source(s)
[0m21:39:07.126243 [info ] [Thread-2  ]: 21:39:07 + Loading TEST.DATA_VAULT.link_inventory from 1 source(s)
[0m21:39:07.126670 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_nation_region'
[0m21:39:07.126817 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (execute): 2023-02-24 21:39:07.126779 => 2023-02-24 21:39:07.126787
[0m21:39:07.131173 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
[0m21:39:07.134501 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
[0m21:39:07.134699 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_nation_region
[0m21:39:07.135039 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
[0m21:39:07.139142 [info ] [Thread-4  ]: 21:39:07 + Loading TEST.DATA_VAULT.link_nation_region from 2 source(s)
[0m21:39:07.139511 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_supplier_nation
[0m21:39:07.139777 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (compile): 2023-02-24 21:39:07.119949 => 2023-02-24 21:39:07.139744
[0m21:39:07.139878 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory (compile): 2023-02-24 21:39:07.123315 => 2023-02-24 21:39:07.139859
[0m21:39:07.144259 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
[0m21:39:07.144585 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_supplier_nation'
[0m21:39:07.144715 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
[0m21:39:07.144847 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory
[0m21:39:07.145020 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
[0m21:39:07.145200 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (execute): 2023-02-24 21:39:07.145149 => 2023-02-24 21:39:07.145159
[0m21:39:07.145384 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory (execute): 2023-02-24 21:39:07.145335 => 2023-02-24 21:39:07.145344
[0m21:39:07.148804 [info ] [Thread-3  ]: 21:39:07 + Loading TEST.DATA_VAULT.link_supplier_nation from 1 source(s)
[0m21:39:07.149310 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
[0m21:39:07.149596 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory
[0m21:39:07.149684 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_nation_region (compile): 2023-02-24 21:39:07.135249 => 2023-02-24 21:39:07.149662
[0m21:39:07.153152 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m21:39:07.153387 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m21:39:07.153588 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m21:39:07.153728 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_nation_region
[0m21:39:07.154016 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_inventory_details'
[0m21:39:07.154295 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_part_details'
[0m21:39:07.154428 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_nation_region (execute): 2023-02-24 21:39:07.154400 => 2023-02-24 21:39:07.154406
[0m21:39:07.154561 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m21:39:07.154674 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m21:39:07.154784 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_supplier_nation (compile): 2023-02-24 21:39:07.145522 => 2023-02-24 21:39:07.154756
[0m21:39:07.155068 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_nation_region
[0m21:39:07.165565 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m21:39:07.171128 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
[0m21:39:07.178111 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m21:39:07.178347 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m21:39:07.178684 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_supplier_nation (execute): 2023-02-24 21:39:07.178616 => 2023-02-24 21:39:07.178630
[0m21:39:07.179088 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details'
[0m21:39:07.179475 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
[0m21:39:07.179617 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_part_details (compile): 2023-02-24 21:39:07.165716 => 2023-02-24 21:39:07.179589
[0m21:39:07.179759 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m21:39:07.179940 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m21:39:07.180038 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_inventory_details (compile): 2023-02-24 21:39:07.155146 => 2023-02-24 21:39:07.180014
[0m21:39:07.180200 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m21:39:07.190050 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m21:39:07.190341 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details'
[0m21:39:07.190474 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m21:39:07.190590 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_part_details (execute): 2023-02-24 21:39:07.190557 => 2023-02-24 21:39:07.190565
[0m21:39:07.190746 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m21:39:07.190887 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_inventory_details (execute): 2023-02-24 21:39:07.190860 => 2023-02-24 21:39:07.190864
[0m21:39:07.191189 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m21:39:07.201478 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m21:39:07.201622 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_nation_details (compile): 2023-02-24 21:39:07.180346 => 2023-02-24 21:39:07.201592
[0m21:39:07.201929 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m21:39:07.202091 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m21:39:07.202278 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m21:39:07.202442 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.t_link_transactions
[0m21:39:07.202719 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details'
[0m21:39:07.202831 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_nation_details (execute): 2023-02-24 21:39:07.202807 => 2023-02-24 21:39:07.202812
[0m21:39:07.202929 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_region_details (compile): 2023-02-24 21:39:07.191296 => 2023-02-24 21:39:07.202914
[0m21:39:07.203134 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.t_link_transactions'
[0m21:39:07.203246 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m21:39:07.203495 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m21:39:07.203597 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m21:39:07.203694 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
[0m21:39:07.213882 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m21:39:07.214076 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_region_details (execute): 2023-02-24 21:39:07.214051 => 2023-02-24 21:39:07.214056
[0m21:39:07.225173 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
[0m21:39:07.225574 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m21:39:07.225928 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.t_link_transactions (compile): 2023-02-24 21:39:07.214161 => 2023-02-24 21:39:07.225902
[0m21:39:07.226045 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.t_link_transactions
[0m21:39:07.226138 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.t_link_transactions (execute): 2023-02-24 21:39:07.226119 => 2023-02-24 21:39:07.226123
[0m21:39:07.226391 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.t_link_transactions
[0m21:39:07.226508 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supplier_details (compile): 2023-02-24 21:39:07.203768 => 2023-02-24 21:39:07.226482
[0m21:39:07.226624 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m21:39:07.226717 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supplier_details (execute): 2023-02-24 21:39:07.226698 => 2023-02-24 21:39:07.226702
[0m21:39:07.226983 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m21:39:07.227482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:39:07.227593 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.t_link_transactions' was properly closed.
[0m21:39:07.227679 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
[0m21:39:07.227753 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details' was properly closed.
[0m21:39:07.227821 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
[0m21:39:07.228478 [debug] [MainThread]: Command end result
[0m21:39:07.236015 [info ] [MainThread]: Done.
[0m21:39:07.236255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fca5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dda2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f25c70>]}
[0m21:39:07.236408 [debug] [MainThread]: Flushing usage events


============================== 2023-02-24 21:40:47.153084 | dcecbad5-f415-457d-a586-f691b8ce732a ==============================
[0m21:40:47.153084 [info ] [MainThread]: Running with dbt=1.4.0
[0m21:40:47.153896 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m21:40:47.154024 [debug] [MainThread]: Tracking: tracking
[0m21:40:47.154218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b38400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b38bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b38a90>]}
[0m21:40:47.209521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:40:47.209877 [debug] [MainThread]: Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_order_cust_region_details.sql
[0m21:40:47.218968 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
[0m21:40:47.281019 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
[0m21:40:47.316490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e19b80>]}
[0m21:40:47.326476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d31070>]}
[0m21:40:47.326664 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 630 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m21:40:47.326801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d29fd0>]}
[0m21:40:47.327914 [info ] [MainThread]: 
[0m21:40:47.328590 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:40:47.329674 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST'
[0m21:40:47.338248 [debug] [ThreadPool]: Using snowflake connection "list_TEST"
[0m21:40:47.338408 [debug] [ThreadPool]: On list_TEST: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_TEST"} */
show terse schemas in database TEST
    limit 10000
[0m21:40:47.338510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:49.036645 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2 seconds
[0m21:40:49.038335 [debug] [ThreadPool]: On list_TEST: Close
[0m21:40:49.158314 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST_DATA_VAULT'
[0m21:40:49.165591 [debug] [ThreadPool]: Using snowflake connection "list_TEST_DATA_VAULT"
[0m21:40:49.165808 [debug] [ThreadPool]: On list_TEST_DATA_VAULT: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_TEST_DATA_VAULT"} */
show terse objects in TEST.DATA_VAULT
[0m21:40:49.165988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:40:49.756125 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 1 seconds
[0m21:40:49.759862 [debug] [ThreadPool]: On list_TEST_DATA_VAULT: Close
[0m21:40:49.874744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df1820>]}
[0m21:40:49.875748 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:40:49.876031 [info ] [MainThread]: 
[0m21:40:49.880198 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.raw_orders
[0m21:40:49.880544 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_transactions
[0m21:40:49.880903 [info ] [Thread-1  ]: 1 of 31 START sql view model DATA_VAULT.raw_orders ............................. [RUN]
[0m21:40:49.881254 [info ] [Thread-2  ]: 2 of 31 START sql view model DATA_VAULT.raw_transactions ....................... [RUN]
[0m21:40:49.881799 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_orders'
[0m21:40:49.882176 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_transactions'
[0m21:40:49.882368 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.raw_orders
[0m21:40:49.882537 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_transactions
[0m21:40:49.888076 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
[0m21:40:49.891500 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
[0m21:40:49.892262 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_transactions (compile): 2023-02-24 21:40:49.888365 => 2023-02-24 21:40:49.892199
[0m21:40:49.892517 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_transactions
[0m21:40:49.899120 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.raw_orders (compile): 2023-02-24 21:40:49.882660 => 2023-02-24 21:40:49.899026
[0m21:40:49.911965 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.raw_orders
[0m21:40:49.914743 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.raw_transactions"
[0m21:40:49.917977 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.raw_orders"
[0m21:40:49.919135 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
[0m21:40:49.920958 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
[0m21:40:49.921098 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */
create or replace   view TEST.DATA_VAULT.raw_transactions
  
   as (
    SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS  AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
[0m21:40:49.921223 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */
create or replace   view TEST.DATA_VAULT.raw_orders
  
   as (
    SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
[0m21:40:49.921354 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:40:49.921451 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:40:50.774841 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:40:50.775357 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:40:50.793754 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_transactions (execute): 2023-02-24 21:40:49.892710 => 2023-02-24 21:40:50.793705
[0m21:40:50.795044 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.raw_orders (execute): 2023-02-24 21:40:49.914887 => 2023-02-24 21:40:50.795003
[0m21:40:50.795217 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: Close
[0m21:40:50.795392 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: Close
[0m21:40:50.905289 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f0df0>]}
[0m21:40:50.905961 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f0d60>]}
[0m21:40:50.906454 [info ] [Thread-2  ]: 2 of 31 OK created sql view model DATA_VAULT.raw_transactions .................. [[32mSUCCESS 1[0m in 1.02s]
[0m21:40:50.908079 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_transactions
[0m21:40:50.906838 [info ] [Thread-1  ]: 1 of 31 OK created sql view model DATA_VAULT.raw_orders ........................ [[32mSUCCESS 1[0m in 1.02s]
[0m21:40:50.908739 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.raw_orders
[0m21:40:50.909266 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.v_stg_transactions
[0m21:40:50.909688 [info ] [Thread-4  ]: 3 of 31 START sql view model DATA_VAULT.v_stg_transactions ..................... [RUN]
[0m21:40:50.910274 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_transactions'
[0m21:40:50.910537 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_inventory
[0m21:40:50.910725 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
[0m21:40:50.910917 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.v_stg_orders
[0m21:40:50.911177 [info ] [Thread-2  ]: 4 of 31 START sql view model DATA_VAULT.raw_inventory .......................... [RUN]
[0m21:40:50.923290 [info ] [Thread-1  ]: 5 of 31 START sql view model DATA_VAULT.v_stg_orders ........................... [RUN]
[0m21:40:50.930214 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_inventory'
[0m21:40:50.944829 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m21:40:50.945200 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_orders'
[0m21:40:50.945388 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_inventory
[0m21:40:50.945505 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
describe table TEST.DATA_VAULT.raw_transactions
[0m21:40:50.945630 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
[0m21:40:50.948681 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
[0m21:40:50.948932 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m21:40:50.958262 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m21:40:50.959308 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
describe table TEST.DATA_VAULT.raw_orders
[0m21:40:50.959472 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:40:50.959973 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_inventory (compile): 2023-02-24 21:40:50.945718 => 2023-02-24 21:40:50.959933
[0m21:40:50.960388 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_inventory
[0m21:40:50.962678 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.raw_inventory"
[0m21:40:50.964191 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
[0m21:40:50.964483 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */
create or replace   view TEST.DATA_VAULT.raw_inventory
  
   as (
    SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PARTSUPP AS a
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN TEST.DATA_VAULT.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
  );
[0m21:40:50.964755 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:40:51.434761 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0 seconds
[0m21:40:51.460314 [debug] [Thread-1  ]: SQL status: SUCCESS 36 in 1 seconds
[0m21:40:51.489636 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m21:40:51.495690 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m21:40:51.495792 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
describe table TEST.DATA_VAULT.raw_transactions
[0m21:40:51.495897 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
describe table TEST.DATA_VAULT.raw_orders
[0m21:40:51.584735 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0 seconds
[0m21:40:51.612405 [debug] [Thread-1  ]: SQL status: SUCCESS 36 in 0 seconds
[0m21:40:51.643004 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m21:40:51.643463 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:40:51.663012 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_inventory (execute): 2023-02-24 21:40:50.960575 => 2023-02-24 21:40:51.662981
[0m21:40:51.663142 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_inventory: Close
[0m21:40:51.676402 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_transactions (compile): 2023-02-24 21:40:50.911403 => 2023-02-24 21:40:51.676344
[0m21:40:51.683221 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
[0m21:40:51.685198 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m21:40:51.694813 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
[0m21:40:51.695294 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_orders (compile): 2023-02-24 21:40:50.949039 => 2023-02-24 21:40:51.695265
[0m21:40:51.695416 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_orders
[0m21:40:51.697295 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.v_stg_orders"
[0m21:40:51.698541 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m21:40:51.698646 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
create or replace   view TEST.DATA_VAULT.v_stg_transactions
  
   as (
    







-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM TEST.DATA_VAULT.raw_transactions
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATEADD(DAY, 1, TRANSACTION_DATE) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS TRANSACTION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS VARCHAR))), '')) AS BINARY(16)) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
[0m21:40:51.706324 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m21:40:51.706435 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
create or replace   view TEST.DATA_VAULT.v_stg_orders
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM TEST.DATA_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMERKEY AS CUSTOMER_KEY,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS REGION_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '')) AS BINARY(16)) AS ORDER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '')) AS BINARY(16)) AS PART_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
  );
[0m21:40:51.826670 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a428730>]}
[0m21:40:51.827102 [info ] [Thread-2  ]: 4 of 31 OK created sql view model DATA_VAULT.raw_inventory ..................... [[32mSUCCESS 1[0m in 0.90s]
[0m21:40:51.827409 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_inventory
[0m21:40:51.827857 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.v_stg_inventory
[0m21:40:51.828096 [info ] [Thread-3  ]: 6 of 31 START sql view model DATA_VAULT.v_stg_inventory ........................ [RUN]
[0m21:40:51.828543 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_inventory'
[0m21:40:51.828722 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
[0m21:40:51.869229 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m21:40:51.869415 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
describe table TEST.DATA_VAULT.raw_inventory
[0m21:40:51.869505 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m21:40:51.959812 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:51.961412 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_transactions (execute): 2023-02-24 21:40:51.683328 => 2023-02-24 21:40:51.961374
[0m21:40:51.961574 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: Close
[0m21:40:52.099152 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:52.105978 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_orders (execute): 2023-02-24 21:40:51.695493 => 2023-02-24 21:40:52.105954
[0m21:40:52.106098 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_orders: Close
[0m21:40:52.113319 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f0b50>]}
[0m21:40:52.113551 [info ] [Thread-4  ]: 3 of 31 OK created sql view model DATA_VAULT.v_stg_transactions ................ [[32mSUCCESS 1[0m in 1.20s]
[0m21:40:52.113738 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
[0m21:40:52.115847 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.t_link_transactions
[0m21:40:52.116035 [info ] [Thread-2  ]: 7 of 31 START sql incremental model DATA_VAULT.t_link_transactions ............. [RUN]
[0m21:40:52.117061 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.t_link_transactions'
[0m21:40:52.117397 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
[0m21:40:52.131278 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
[0m21:40:52.133988 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.t_link_transactions (compile): 2023-02-24 21:40:52.117490 => 2023-02-24 21:40:52.133934
[0m21:40:52.134342 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.t_link_transactions
[0m21:40:52.156584 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m21:40:52.156791 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
create or replace  temporary view TEST.DATA_VAULT.t_link_transactions__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_transactions
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    LEFT JOIN TEST.DATA_VAULT.t_link_transactions AS tgt
    ON stg.TRANSACTION_PK = tgt.TRANSACTION_PK
    WHERE tgt.TRANSACTION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:40:52.156892 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:40:52.272670 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a56a160>]}
[0m21:40:52.279249 [info ] [Thread-1  ]: 5 of 31 OK created sql view model DATA_VAULT.v_stg_orders ...................... [[32mSUCCESS 1[0m in 1.33s]
[0m21:40:52.279459 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_orders
[0m21:40:52.299585 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
[0m21:40:52.300023 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
[0m21:40:52.305435 [info ] [Thread-4  ]: 8 of 31 START sql incremental model DATA_VAULT.hub_customer .................... [RUN]
[0m21:40:52.305737 [info ] [Thread-1  ]: 9 of 31 START sql incremental model DATA_VAULT.hub_lineitem .................... [RUN]
[0m21:40:52.306686 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_customer'
[0m21:40:52.307001 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_lineitem'
[0m21:40:52.307142 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
[0m21:40:52.309609 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
[0m21:40:52.321301 [info ] [Thread-4  ]: 21:40:52 + Loading TEST.DATA_VAULT.hub_customer from 1 source(s)
[0m21:40:52.324762 [info ] [Thread-1  ]: 21:40:52 + Loading TEST.DATA_VAULT.hub_lineitem from 1 source(s)
[0m21:40:52.337062 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
[0m21:40:52.340268 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
[0m21:40:52.341486 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (compile): 2023-02-24 21:40:52.321547 => 2023-02-24 21:40:52.341430
[0m21:40:52.341674 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
[0m21:40:52.345190 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m21:40:52.345309 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
create or replace  temporary view TEST.DATA_VAULT.hub_lineitem__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DATA_VAULT.hub_lineitem AS d
    ON a.LINEITEM_PK = d.LINEITEM_PK
    WHERE d.LINEITEM_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:40:52.345412 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:40:52.345929 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (compile): 2023-02-24 21:40:52.309747 => 2023-02-24 21:40:52.345898
[0m21:40:52.346059 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
[0m21:40:52.348807 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m21:40:52.351559 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
create or replace  temporary view TEST.DATA_VAULT.hub_customer__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DATA_VAULT.hub_customer AS d
    ON a.CUSTOMER_PK = d.CUSTOMER_PK
    WHERE d.CUSTOMER_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:40:52.351681 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m21:40:52.654100 [debug] [Thread-3  ]: SQL status: SUCCESS 24 in 1 seconds
[0m21:40:52.660941 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m21:40:52.661105 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
describe table TEST.DATA_VAULT.raw_inventory
[0m21:40:52.750083 [debug] [Thread-3  ]: SQL status: SUCCESS 24 in 0 seconds
[0m21:40:52.794142 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m21:40:52.794653 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_inventory (compile): 2023-02-24 21:40:51.828847 => 2023-02-24 21:40:52.794616
[0m21:40:52.794792 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
[0m21:40:52.797099 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m21:40:52.802252 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m21:40:52.802352 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
create or replace   view TEST.DATA_VAULT.v_stg_inventory
  
   as (
    








WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM TEST.DATA_VAULT.raw_inventory
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS NATION_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_SUPPLIER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '')) AS BINARY(16)) AS PART_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS PART_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_REGION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_NATION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging
  );
[0m21:40:52.891670 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:40:52.894150 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m21:40:52.894317 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
describe table TEST.DATA_VAULT.t_link_transactions__dbt_tmp
[0m21:40:52.980827 [debug] [Thread-2  ]: SQL status: SUCCESS 10 in 0 seconds
[0m21:40:52.985123 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m21:40:52.985309 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
describe table TEST.DATA_VAULT.t_link_transactions
[0m21:40:53.072697 [debug] [Thread-2  ]: SQL status: SUCCESS 10 in 0 seconds
[0m21:40:53.083129 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m21:40:53.083895 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
describe table "TEST"."DATA_VAULT"."T_LINK_TRANSACTIONS"
[0m21:40:53.084374 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:53.087176 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_inventory (execute): 2023-02-24 21:40:52.794873 => 2023-02-24 21:40:53.087113
[0m21:40:53.087459 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: Close
[0m21:40:53.104727 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:40:53.109929 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m21:40:53.110201 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
describe table TEST.DATA_VAULT.hub_customer__dbt_tmp
[0m21:40:53.111783 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:40:53.114883 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m21:40:53.115211 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
describe table TEST.DATA_VAULT.hub_lineitem__dbt_tmp
[0m21:40:53.164095 [debug] [Thread-2  ]: SQL status: SUCCESS 10 in 0 seconds
[0m21:40:53.182850 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.t_link_transactions"
[0m21:40:53.183976 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m21:40:53.184156 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
-- back compat for old kwarg name
  
  begin;
[0m21:40:53.191402 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a86a670>]}
[0m21:40:53.191839 [info ] [Thread-3  ]: 6 of 31 OK created sql view model DATA_VAULT.v_stg_inventory ................... [[32mSUCCESS 1[0m in 1.36s]
[0m21:40:53.192173 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
[0m21:40:53.192431 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_order
[0m21:40:53.192656 [info ] [Thread-3  ]: 10 of 31 START sql incremental model DATA_VAULT.hub_order ...................... [RUN]
[0m21:40:53.193298 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_order'
[0m21:40:53.193699 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
[0m21:40:53.198058 [info ] [Thread-3  ]: 21:40:53 + Loading TEST.DATA_VAULT.hub_order from 1 source(s)
[0m21:40:53.202379 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
[0m21:40:53.203568 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m21:40:53.203893 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:40:53.206636 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m21:40:53.209497 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m21:40:53.209776 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (compile): 2023-02-24 21:40:53.193831 => 2023-02-24 21:40:53.209717
[0m21:40:53.209922 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
describe table TEST.DATA_VAULT.hub_customer
[0m21:40:53.210073 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
describe table TEST.DATA_VAULT.hub_lineitem
[0m21:40:53.210240 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
[0m21:40:53.214786 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m21:40:53.215378 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
create or replace  temporary view TEST.DATA_VAULT.hub_order__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DATA_VAULT.hub_order AS d
    ON a.ORDER_PK = d.ORDER_PK
    WHERE d.ORDER_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:40:53.215707 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m21:40:53.321280 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:40:53.321576 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:53.336149 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m21:40:53.346589 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m21:40:53.350635 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
describe table "TEST"."DATA_VAULT"."HUB_LINEITEM"
[0m21:40:53.351104 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m21:40:53.351362 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
insert into TEST.DATA_VAULT.t_link_transactions ("TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.t_link_transactions__dbt_tmp
        );
[0m21:40:53.358458 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m21:40:53.359674 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
describe table "TEST"."DATA_VAULT"."HUB_CUSTOMER"
[0m21:40:53.451409 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:40:53.453273 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_lineitem"
[0m21:40:53.453882 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m21:40:53.453998 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
-- back compat for old kwarg name
  
  begin;
[0m21:40:53.465770 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m21:40:53.467311 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_customer"
[0m21:40:53.468537 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m21:40:53.468685 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
-- back compat for old kwarg name
  
  begin;
[0m21:40:53.535304 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:53.535574 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m21:40:53.535707 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
insert into TEST.DATA_VAULT.hub_lineitem ("LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.hub_lineitem__dbt_tmp
        );
[0m21:40:53.559406 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:53.559639 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m21:40:53.559737 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
insert into TEST.DATA_VAULT.hub_customer ("CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.hub_customer__dbt_tmp
        );
[0m21:40:53.952776 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:40:53.959409 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m21:40:53.959791 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
describe table TEST.DATA_VAULT.hub_order__dbt_tmp
[0m21:40:54.049713 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m21:40:54.057133 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m21:40:54.057386 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
describe table TEST.DATA_VAULT.hub_order
[0m21:40:54.181989 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m21:40:54.189081 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m21:40:54.189388 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
describe table "TEST"."DATA_VAULT"."HUB_ORDER"
[0m21:40:54.267699 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m21:40:54.272924 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_order"
[0m21:40:54.274485 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m21:40:54.274761 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
-- back compat for old kwarg name
  
  begin;
[0m21:40:54.383393 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:54.385085 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m21:40:54.385682 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
insert into TEST.DATA_VAULT.hub_order ("ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.hub_order__dbt_tmp
        );
[0m21:40:54.407885 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 1 seconds
[0m21:40:54.408225 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m21:40:54.408408 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
COMMIT
[0m21:40:54.770196 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:54.783174 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
[0m21:40:54.783449 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
drop view if exists TEST.DATA_VAULT.t_link_transactions__dbt_tmp cascade
[0m21:40:54.885488 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:54.896592 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.t_link_transactions (execute): 2023-02-24 21:40:52.134457 => 2023-02-24 21:40:54.896506
[0m21:40:54.896882 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: Close
[0m21:40:55.001688 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5d0850>]}
[0m21:40:55.002412 [info ] [Thread-2  ]: 7 of 31 OK created sql incremental model DATA_VAULT.t_link_transactions ........ [[32mSUCCESS 0[0m in 2.88s]
[0m21:40:55.002979 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.t_link_transactions
[0m21:40:55.003465 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_customer_nation
[0m21:40:55.003886 [info ] [Thread-2  ]: 11 of 31 START sql incremental model DATA_VAULT.link_customer_nation ........... [RUN]
[0m21:40:55.005005 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_customer_nation'
[0m21:40:55.005415 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
[0m21:40:55.016993 [info ] [Thread-2  ]: 21:40:55 + Loading TEST.DATA_VAULT.link_customer_nation from 1 source(s)
[0m21:40:55.036938 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
[0m21:40:55.037517 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_nation (compile): 2023-02-24 21:40:55.005665 => 2023-02-24 21:40:55.037469
[0m21:40:55.037704 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_nation
[0m21:40:55.042952 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m21:40:55.043185 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
create or replace  temporary view TEST.DATA_VAULT.link_customer_nation__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DATA_VAULT.link_customer_nation AS d
    ON a.LINK_CUSTOMER_NATION_PK = d.LINK_CUSTOMER_NATION_PK
    WHERE d.LINK_CUSTOMER_NATION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:40:55.043310 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:40:55.183009 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 2 seconds
[0m21:40:55.183249 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m21:40:55.183350 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
COMMIT
[0m21:40:55.464643 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:55.475562 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
[0m21:40:55.475859 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
drop view if exists TEST.DATA_VAULT.hub_lineitem__dbt_tmp cascade
[0m21:40:55.610887 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:55.614022 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (execute): 2023-02-24 21:40:52.341774 => 2023-02-24 21:40:55.613939
[0m21:40:55.614343 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_lineitem: Close
[0m21:40:55.617349 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:40:55.621237 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m21:40:55.621695 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
describe table TEST.DATA_VAULT.link_customer_nation__dbt_tmp
[0m21:40:55.707303 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:40:55.710367 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m21:40:55.710522 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
describe table TEST.DATA_VAULT.link_customer_nation
[0m21:40:55.711636 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 2 seconds
[0m21:40:55.711837 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m21:40:55.711960 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
COMMIT
[0m21:40:55.757190 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083b99a0>]}
[0m21:40:55.757604 [info ] [Thread-1  ]: 9 of 31 OK created sql incremental model DATA_VAULT.hub_lineitem ............... [[32mSUCCESS 0[0m in 3.45s]
[0m21:40:55.757931 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
[0m21:40:55.758199 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_customer_order
[0m21:40:55.758543 [info ] [Thread-1  ]: 12 of 31 START sql incremental model DATA_VAULT.link_customer_order ............ [RUN]
[0m21:40:55.759076 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_customer_order'
[0m21:40:55.759258 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_order
[0m21:40:55.764166 [info ] [Thread-1  ]: 21:40:55 + Loading TEST.DATA_VAULT.link_customer_order from 1 source(s)
[0m21:40:55.769823 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
[0m21:40:55.770373 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_order (compile): 2023-02-24 21:40:55.759390 => 2023-02-24 21:40:55.770329
[0m21:40:55.770543 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_order
[0m21:40:55.774203 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m21:40:55.774362 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
create or replace  temporary view TEST.DATA_VAULT.link_customer_order__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DATA_VAULT.link_customer_order AS d
    ON a.ORDER_CUSTOMER_PK = d.ORDER_CUSTOMER_PK
    WHERE d.ORDER_CUSTOMER_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:40:55.774493 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:40:55.781018 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:40:55.783786 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m21:40:55.783979 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
describe table "TEST"."DATA_VAULT"."LINK_CUSTOMER_NATION"
[0m21:40:55.886654 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:40:55.894507 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_customer_nation"
[0m21:40:55.908537 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m21:40:55.908654 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
-- back compat for old kwarg name
  
  begin;
[0m21:40:55.968813 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:55.971028 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
[0m21:40:55.971154 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
drop view if exists TEST.DATA_VAULT.hub_customer__dbt_tmp cascade
[0m21:40:56.000780 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 2 seconds
[0m21:40:56.000980 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m21:40:56.001089 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
COMMIT
[0m21:40:56.005666 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:56.005820 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m21:40:56.005928 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
insert into TEST.DATA_VAULT.link_customer_nation ("LINK_CUSTOMER_NATION_PK", "CUSTOMER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_CUSTOMER_NATION_PK", "CUSTOMER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.link_customer_nation__dbt_tmp
        );
[0m21:40:56.070906 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:56.072917 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (execute): 2023-02-24 21:40:52.346137 => 2023-02-24 21:40:56.072866
[0m21:40:56.073123 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: Close
[0m21:40:56.183594 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a536040>]}
[0m21:40:56.184379 [info ] [Thread-4  ]: 8 of 31 OK created sql incremental model DATA_VAULT.hub_customer ............... [[32mSUCCESS 0[0m in 3.88s]
[0m21:40:56.184931 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
[0m21:40:56.185428 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m21:40:56.185972 [info ] [Thread-4  ]: 13 of 31 START sql incremental model DATA_VAULT.link_inventory_allocation ...... [RUN]
[0m21:40:56.186841 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_inventory_allocation'
[0m21:40:56.187162 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m21:40:56.194938 [info ] [Thread-4  ]: 21:40:56 + Loading TEST.DATA_VAULT.link_inventory_allocation from 1 source(s)
[0m21:40:56.202809 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m21:40:56.203444 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory_allocation (compile): 2023-02-24 21:40:56.187369 => 2023-02-24 21:40:56.203397
[0m21:40:56.203633 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m21:40:56.208167 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m21:40:56.208412 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
create or replace  temporary view TEST.DATA_VAULT.link_inventory_allocation__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DATA_VAULT.link_inventory_allocation AS d
    ON a.INVENTORY_ALLOCATION_PK = d.INVENTORY_ALLOCATION_PK
    WHERE d.INVENTORY_ALLOCATION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:40:56.208561 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m21:40:56.233140 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:56.236029 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
[0m21:40:56.236181 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
drop view if exists TEST.DATA_VAULT.hub_order__dbt_tmp cascade
[0m21:40:56.326867 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:40:56.335053 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m21:40:56.341459 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
describe table TEST.DATA_VAULT.link_customer_order__dbt_tmp
[0m21:40:56.348729 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:56.354493 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (execute): 2023-02-24 21:40:53.211106 => 2023-02-24 21:40:56.354459
[0m21:40:56.354643 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_order: Close
[0m21:40:56.444086 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:40:56.447691 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m21:40:56.447839 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
describe table TEST.DATA_VAULT.link_customer_order
[0m21:40:56.473282 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a46e070>]}
[0m21:40:56.473590 [info ] [Thread-3  ]: 10 of 31 OK created sql incremental model DATA_VAULT.hub_order ................. [[32mSUCCESS 0[0m in 3.28s]
[0m21:40:56.473829 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
[0m21:40:56.474026 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_order_lineitem
[0m21:40:56.474210 [info ] [Thread-3  ]: 14 of 31 START sql incremental model DATA_VAULT.link_order_lineitem ............ [RUN]
[0m21:40:56.474627 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_order_lineitem'
[0m21:40:56.474796 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
[0m21:40:56.478631 [info ] [Thread-3  ]: 21:40:56 + Loading TEST.DATA_VAULT.link_order_lineitem from 1 source(s)
[0m21:40:56.482940 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m21:40:56.483478 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_order_lineitem (compile): 2023-02-24 21:40:56.474904 => 2023-02-24 21:40:56.483436
[0m21:40:56.483625 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
[0m21:40:56.486895 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m21:40:56.487015 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
create or replace  temporary view TEST.DATA_VAULT.link_order_lineitem__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DATA_VAULT.link_order_lineitem AS d
    ON a.LINK_LINEITEM_ORDER_PK = d.LINK_LINEITEM_ORDER_PK
    WHERE d.LINK_LINEITEM_ORDER_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:40:56.487121 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m21:40:56.527668 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:40:56.530317 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m21:40:56.530446 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
describe table "TEST"."DATA_VAULT"."LINK_CUSTOMER_ORDER"
[0m21:40:56.625988 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:40:56.627426 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_customer_order"
[0m21:40:56.628418 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m21:40:56.630308 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
-- back compat for old kwarg name
  
  begin;
[0m21:40:56.787570 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:56.787955 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m21:40:56.788145 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
insert into TEST.DATA_VAULT.link_customer_order ("ORDER_CUSTOMER_PK", "CUSTOMER_PK", "ORDER_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_CUSTOMER_PK", "CUSTOMER_PK", "ORDER_PK", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.link_customer_order__dbt_tmp
        );
[0m21:40:56.791083 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:40:56.796267 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m21:40:56.833778 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
describe table TEST.DATA_VAULT.link_inventory_allocation__dbt_tmp
[0m21:40:56.921585 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0 seconds
[0m21:40:56.925027 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m21:40:56.925196 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
describe table TEST.DATA_VAULT.link_inventory_allocation
[0m21:40:57.012463 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0 seconds
[0m21:40:57.018000 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m21:40:57.018251 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
describe table "TEST"."DATA_VAULT"."LINK_INVENTORY_ALLOCATION"
[0m21:40:57.098078 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0 seconds
[0m21:40:57.101960 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m21:40:57.103423 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m21:40:57.103667 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
-- back compat for old kwarg name
  
  begin;
[0m21:40:57.204839 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:57.206125 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m21:40:57.206674 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
insert into TEST.DATA_VAULT.link_inventory_allocation ("INVENTORY_ALLOCATION_PK", "PART_PK", "SUPPLIER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_ALLOCATION_PK", "PART_PK", "SUPPLIER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.link_inventory_allocation__dbt_tmp
        );
[0m21:40:57.265886 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:40:57.273953 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m21:40:57.274320 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
describe table TEST.DATA_VAULT.link_order_lineitem__dbt_tmp
[0m21:40:57.397893 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:40:57.409417 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m21:40:57.409785 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
describe table TEST.DATA_VAULT.link_order_lineitem
[0m21:40:57.520082 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:40:57.529828 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m21:40:57.530193 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
describe table "TEST"."DATA_VAULT"."LINK_ORDER_LINEITEM"
[0m21:40:57.559894 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 2 seconds
[0m21:40:57.560310 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m21:40:57.560568 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
COMMIT
[0m21:40:57.609395 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:40:57.615703 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m21:40:57.617180 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m21:40:57.617439 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
-- back compat for old kwarg name
  
  begin;
[0m21:40:57.707536 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:57.708540 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m21:40:57.708853 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
insert into TEST.DATA_VAULT.link_order_lineitem ("LINK_LINEITEM_ORDER_PK", "ORDER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_LINEITEM_ORDER_PK", "ORDER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.link_order_lineitem__dbt_tmp
        );
[0m21:40:57.853274 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:57.859992 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
[0m21:40:57.860330 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
drop view if exists TEST.DATA_VAULT.link_customer_nation__dbt_tmp cascade
[0m21:40:57.953808 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:57.961105 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_nation (execute): 2023-02-24 21:40:55.037815 => 2023-02-24 21:40:57.960996
[0m21:40:57.961530 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: Close
[0m21:40:58.083568 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c0880>]}
[0m21:40:58.084335 [info ] [Thread-2  ]: 11 of 31 OK created sql incremental model DATA_VAULT.link_customer_nation ...... [[32mSUCCESS 0[0m in 3.08s]
[0m21:40:58.084896 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_nation
[0m21:40:58.085375 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m21:40:58.085869 [info ] [Thread-2  ]: 15 of 31 START sql incremental model DATA_VAULT.sat_order_cust_nation_details .. [RUN]
[0m21:40:58.086658 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_cust_nation_details'
[0m21:40:58.086961 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m21:40:58.104940 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m21:40:58.105615 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_nation_details (compile): 2023-02-24 21:40:58.087160 => 2023-02-24 21:40:58.105561
[0m21:40:58.105837 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m21:40:58.111004 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m21:40:58.111223 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_order_cust_nation_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.CUSTOMER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_order_cust_nation_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
        AND latest_records.CUSTOMER_NATION_HASHDIFF = stage.CUSTOMER_NATION_HASHDIFF
    WHERE latest_records.CUSTOMER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:40:58.111364 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:40:58.268838 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1 seconds
[0m21:40:58.269185 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m21:40:58.269281 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
COMMIT
[0m21:40:58.507236 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:58.517786 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
[0m21:40:58.518084 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
drop view if exists TEST.DATA_VAULT.link_customer_order__dbt_tmp cascade
[0m21:40:58.616535 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:58.621446 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_order (execute): 2023-02-24 21:40:55.770652 => 2023-02-24 21:40:58.621350
[0m21:40:58.621807 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: Close
[0m21:40:58.733348 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac30b80>]}
[0m21:40:58.734044 [info ] [Thread-1  ]: 12 of 31 OK created sql incremental model DATA_VAULT.link_customer_order ....... [[32mSUCCESS 0[0m in 2.97s]
[0m21:40:58.734598 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_order
[0m21:40:58.735065 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m21:40:58.735621 [info ] [Thread-1  ]: 16 of 31 START sql incremental model DATA_VAULT.sat_order_cust_region_details .. [RUN]
[0m21:40:58.736402 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_cust_region_details'
[0m21:40:58.737285 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m21:40:58.737893 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:40:58.753829 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m21:40:58.760406 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
describe table TEST.DATA_VAULT.sat_order_cust_nation_details__dbt_tmp
[0m21:40:58.761505 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m21:40:58.762920 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_region_details (compile): 2023-02-24 21:40:58.738123 => 2023-02-24 21:40:58.762849
[0m21:40:58.763141 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m21:40:58.768090 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m21:40:58.768381 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_order_cust_region_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_REGION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.CUSTOMER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_order_cust_region_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
        AND latest_records.CUSTOMER_REGION_HASHDIFF = stage.CUSTOMER_REGION_HASHDIFF
    WHERE latest_records.CUSTOMER_REGION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:40:58.768663 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:40:58.867325 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0 seconds
[0m21:40:58.875722 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m21:40:58.882157 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
describe table TEST.DATA_VAULT.sat_order_cust_nation_details
[0m21:40:58.973118 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 2 seconds
[0m21:40:58.973359 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m21:40:58.973468 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
COMMIT
[0m21:40:58.989468 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0 seconds
[0m21:40:58.992220 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m21:40:58.992344 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
describe table "TEST"."DATA_VAULT"."SAT_ORDER_CUST_NATION_DETAILS"
[0m21:40:59.071007 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0 seconds
[0m21:40:59.073343 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m21:40:59.074193 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m21:40:59.074343 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
-- back compat for old kwarg name
  
  begin;
[0m21:40:59.169211 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:59.169744 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m21:40:59.170008 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
insert into TEST.DATA_VAULT.sat_order_cust_nation_details ("CUSTOMER_PK", "CUSTOMER_NATION_HASHDIFF", "CUSTOMER_NATION_NAME", "CUSTOMER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_NATION_HASHDIFF", "CUSTOMER_NATION_NAME", "CUSTOMER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_order_cust_nation_details__dbt_tmp
        );
[0m21:40:59.199366 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:59.209520 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m21:40:59.209825 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
drop view if exists TEST.DATA_VAULT.link_inventory_allocation__dbt_tmp cascade
[0m21:40:59.312914 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:59.318180 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory_allocation (execute): 2023-02-24 21:40:56.203753 => 2023-02-24 21:40:59.318066
[0m21:40:59.318587 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
[0m21:40:59.408062 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:40:59.413943 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m21:40:59.414265 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
describe table TEST.DATA_VAULT.sat_order_cust_region_details__dbt_tmp
[0m21:40:59.445361 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f56a0>]}
[0m21:40:59.445979 [info ] [Thread-4  ]: 13 of 31 OK created sql incremental model DATA_VAULT.link_inventory_allocation . [[32mSUCCESS 0[0m in 3.26s]
[0m21:40:59.446451 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m21:40:59.446831 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m21:40:59.447325 [info ] [Thread-4  ]: 17 of 31 START sql incremental model DATA_VAULT.sat_order_customer_details ..... [RUN]
[0m21:40:59.448097 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_customer_details'
[0m21:40:59.448392 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m21:40:59.470416 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m21:40:59.471050 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_customer_details (compile): 2023-02-24 21:40:59.448592 => 2023-02-24 21:40:59.470998
[0m21:40:59.471249 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m21:40:59.476853 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m21:40:59.477278 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 2 seconds
[0m21:40:59.477409 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_order_customer_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.CUSTOMER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_order_customer_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
        AND latest_records.CUSTOMER_HASHDIFF = stage.CUSTOMER_HASHDIFF
    WHERE latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:40:59.477577 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m21:40:59.477709 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m21:40:59.477829 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
COMMIT
[0m21:40:59.504980 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m21:40:59.508323 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m21:40:59.508656 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
describe table TEST.DATA_VAULT.sat_order_cust_region_details
[0m21:40:59.613197 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m21:40:59.615404 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m21:40:59.615515 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
describe table "TEST"."DATA_VAULT"."SAT_ORDER_CUST_REGION_DETAILS"
[0m21:40:59.731431 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m21:40:59.733561 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m21:40:59.734303 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m21:40:59.734436 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
-- back compat for old kwarg name
  
  begin;
[0m21:40:59.765564 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:59.768473 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m21:40:59.768638 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
drop view if exists TEST.DATA_VAULT.link_order_lineitem__dbt_tmp cascade
[0m21:40:59.850509 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:59.850935 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m21:40:59.851160 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
insert into TEST.DATA_VAULT.sat_order_cust_region_details ("CUSTOMER_PK", "CUSTOMER_REGION_HASHDIFF", "CUSTOMER_REGION_NAME", "CUSTOMER_REGION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_REGION_HASHDIFF", "CUSTOMER_REGION_NAME", "CUSTOMER_REGION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_order_cust_region_details__dbt_tmp
        );
[0m21:40:59.895304 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:40:59.900568 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_order_lineitem (execute): 2023-02-24 21:40:56.483725 => 2023-02-24 21:40:59.900451
[0m21:40:59.900978 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: Close
[0m21:41:00.019200 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6bac0>]}
[0m21:41:00.019812 [info ] [Thread-3  ]: 14 of 31 OK created sql incremental model DATA_VAULT.link_order_lineitem ....... [[32mSUCCESS 0[0m in 3.54s]
[0m21:41:00.020091 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
[0m21:41:00.020313 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m21:41:00.020651 [info ] [Thread-3  ]: 18 of 31 START sql incremental model DATA_VAULT.sat_order_lineitem_details ..... [RUN]
[0m21:41:00.021064 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_lineitem_details'
[0m21:41:00.021211 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m21:41:00.045948 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m21:41:00.046620 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_lineitem_details (compile): 2023-02-24 21:41:00.021303 => 2023-02-24 21:41:00.046540
[0m21:41:00.046819 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m21:41:00.052267 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m21:41:00.052508 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_order_lineitem_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_orders AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

latest_records AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.LINEITEM_PK, current_records.LINEITEM_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.LINEITEM_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_order_lineitem_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.LINEITEM_PK
                FROM source_data
            ) AS source_records
                ON current_records.LINEITEM_PK = source_records.LINEITEM_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.LINEITEM_PK = stage.LINEITEM_PK
        AND latest_records.LINEITEM_HASHDIFF = stage.LINEITEM_HASHDIFF
    WHERE latest_records.LINEITEM_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:41:00.052648 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m21:41:00.355294 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:41:00.359258 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m21:41:00.359454 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
describe table TEST.DATA_VAULT.sat_order_customer_details__dbt_tmp
[0m21:41:00.440798 [debug] [Thread-4  ]: SQL status: SUCCESS 11 in 0 seconds
[0m21:41:00.447377 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m21:41:00.447631 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
describe table TEST.DATA_VAULT.sat_order_customer_details
[0m21:41:00.548565 [debug] [Thread-4  ]: SQL status: SUCCESS 11 in 0 seconds
[0m21:41:00.561334 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m21:41:00.561709 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
describe table "TEST"."DATA_VAULT"."SAT_ORDER_CUSTOMER_DETAILS"
[0m21:41:00.581950 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 1 seconds
[0m21:41:00.582356 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m21:41:00.582629 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
COMMIT
[0m21:41:00.646141 [debug] [Thread-4  ]: SQL status: SUCCESS 11 in 0 seconds
[0m21:41:00.649882 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m21:41:00.650837 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m21:41:00.650985 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
-- back compat for old kwarg name
  
  begin;
[0m21:41:00.678375 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:41:00.680749 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m21:41:00.680890 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
describe table TEST.DATA_VAULT.sat_order_lineitem_details__dbt_tmp
[0m21:41:00.746942 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:00.747195 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m21:41:00.747334 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
insert into TEST.DATA_VAULT.sat_order_customer_details ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_order_customer_details__dbt_tmp
        );
[0m21:41:00.767672 [debug] [Thread-3  ]: SQL status: SUCCESS 16 in 0 seconds
[0m21:41:00.771910 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m21:41:00.772090 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
describe table TEST.DATA_VAULT.sat_order_lineitem_details
[0m21:41:00.828848 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:00.835295 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m21:41:00.835547 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
drop view if exists TEST.DATA_VAULT.sat_order_cust_nation_details__dbt_tmp cascade
[0m21:41:00.854416 [debug] [Thread-3  ]: SQL status: SUCCESS 16 in 0 seconds
[0m21:41:00.859912 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m21:41:00.860128 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
describe table "TEST"."DATA_VAULT"."SAT_ORDER_LINEITEM_DETAILS"
[0m21:41:00.931161 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:00.935771 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_nation_details (execute): 2023-02-24 21:40:58.105973 => 2023-02-24 21:41:00.935673
[0m21:41:00.936150 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
[0m21:41:00.944595 [debug] [Thread-3  ]: SQL status: SUCCESS 16 in 0 seconds
[0m21:41:00.948811 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m21:41:00.950211 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m21:41:00.950415 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
-- back compat for old kwarg name
  
  begin;
[0m21:41:01.038998 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:01.039626 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m21:41:01.039904 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
insert into TEST.DATA_VAULT.sat_order_lineitem_details ("LINEITEM_PK", "LINEITEM_HASHDIFF", "COMMITDATE", "DISCOUNT", "EXTENDEDPRICE", "LINE_COMMENT", "QUANTITY", "RECEIPTDATE", "RETURNFLAG", "SHIPDATE", "SHIPINSTRUCT", "SHIPMODE", "TAX", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINEITEM_HASHDIFF", "COMMITDATE", "DISCOUNT", "EXTENDEDPRICE", "LINE_COMMENT", "QUANTITY", "RECEIPTDATE", "RETURNFLAG", "SHIPDATE", "SHIPINSTRUCT", "SHIPMODE", "TAX", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_order_lineitem_details__dbt_tmp
        );
[0m21:41:01.049488 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a977fd0>]}
[0m21:41:01.050138 [info ] [Thread-2  ]: 15 of 31 OK created sql incremental model DATA_VAULT.sat_order_cust_nation_details  [[32mSUCCESS 0[0m in 2.96s]
[0m21:41:01.050613 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m21:41:01.051005 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_order_details
[0m21:41:01.051512 [info ] [Thread-2  ]: 19 of 31 START sql incremental model DATA_VAULT.sat_order_order_details ........ [RUN]
[0m21:41:01.052314 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_order_details'
[0m21:41:01.052618 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
[0m21:41:01.073474 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m21:41:01.074124 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_order_details (compile): 2023-02-24 21:41:01.052787 => 2023-02-24 21:41:01.074074
[0m21:41:01.074319 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
[0m21:41:01.078795 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m21:41:01.078939 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_order_order_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_orders AS a
    WHERE a.ORDER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.ORDER_PK, current_records.ORDER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.ORDER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_order_order_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.ORDER_PK
                FROM source_data
            ) AS source_records
                ON current_records.ORDER_PK = source_records.ORDER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.ORDER_PK = stage.ORDER_PK
        AND latest_records.ORDER_HASHDIFF = stage.ORDER_HASHDIFF
    WHERE latest_records.ORDER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:41:01.079066 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:41:01.302511 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1 seconds
[0m21:41:01.302786 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m21:41:01.302905 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
COMMIT
[0m21:41:01.587848 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:01.597603 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m21:41:01.597995 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
drop view if exists TEST.DATA_VAULT.sat_order_cust_region_details__dbt_tmp cascade
[0m21:41:01.744434 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:01.748901 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_region_details (execute): 2023-02-24 21:40:58.763254 => 2023-02-24 21:41:01.748804
[0m21:41:01.749362 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
[0m21:41:01.862207 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9b23a0>]}
[0m21:41:01.862973 [info ] [Thread-1  ]: 16 of 31 OK created sql incremental model DATA_VAULT.sat_order_cust_region_details  [[32mSUCCESS 0[0m in 3.13s]
[0m21:41:01.863536 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m21:41:01.863981 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
[0m21:41:01.864482 [info ] [Thread-1  ]: 20 of 31 START sql incremental model DATA_VAULT.hub_nation ..................... [RUN]
[0m21:41:01.865254 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_nation'
[0m21:41:01.865555 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
[0m21:41:01.873316 [info ] [Thread-1  ]: 21:41:01 + Loading TEST.DATA_VAULT.hub_nation from 2 source(s)
[0m21:41:01.881539 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
[0m21:41:01.882179 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (compile): 2023-02-24 21:41:01.865753 => 2023-02-24 21:41:01.882131
[0m21:41:01.882340 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
[0m21:41:01.886450 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m21:41:01.886689 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
create or replace  temporary view TEST.DATA_VAULT.hub_nation__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN TEST.DATA_VAULT.hub_nation AS d
    ON a.NATION_PK = d.NATION_PK
    WHERE d.NATION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:41:01.886831 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:41:01.955957 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:41:01.959734 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m21:41:01.959901 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
describe table TEST.DATA_VAULT.sat_order_order_details__dbt_tmp
[0m21:41:02.120670 [debug] [Thread-2  ]: SQL status: SUCCESS 12 in 0 seconds
[0m21:41:02.123814 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m21:41:02.123960 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
describe table TEST.DATA_VAULT.sat_order_order_details
[0m21:41:02.198659 [debug] [Thread-2  ]: SQL status: SUCCESS 12 in 0 seconds
[0m21:41:02.202663 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m21:41:02.202848 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
describe table "TEST"."DATA_VAULT"."SAT_ORDER_ORDER_DETAILS"
[0m21:41:02.296492 [debug] [Thread-2  ]: SQL status: SUCCESS 12 in 0 seconds
[0m21:41:02.302844 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m21:41:02.304672 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m21:41:02.304962 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m21:41:02.409427 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:02.411035 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m21:41:02.411616 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
insert into TEST.DATA_VAULT.sat_order_order_details ("ORDER_PK", "ORDER_HASHDIFF", "ORDERSTATUS", "TOTALPRICE", "ORDERDATE", "ORDERPRIORITY", "CLERK", "SHIPPRIORITY", "ORDER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDER_HASHDIFF", "ORDERSTATUS", "TOTALPRICE", "ORDERDATE", "ORDERPRIORITY", "CLERK", "SHIPPRIORITY", "ORDER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_order_order_details__dbt_tmp
        );
[0m21:41:02.757664 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 2 seconds
[0m21:41:02.758920 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m21:41:02.759461 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
COMMIT
[0m21:41:02.886521 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:41:02.895765 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m21:41:02.896023 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
describe table TEST.DATA_VAULT.hub_nation__dbt_tmp
[0m21:41:03.003960 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m21:41:03.012855 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m21:41:03.013068 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
describe table TEST.DATA_VAULT.hub_nation
[0m21:41:03.038295 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:03.042392 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m21:41:03.042550 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
drop view if exists TEST.DATA_VAULT.sat_order_customer_details__dbt_tmp cascade
[0m21:41:03.109277 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m21:41:03.113567 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m21:41:03.113796 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
describe table "TEST"."DATA_VAULT"."HUB_NATION"
[0m21:41:03.134627 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:03.136968 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_customer_details (execute): 2023-02-24 21:40:59.471857 => 2023-02-24 21:41:03.136896
[0m21:41:03.137222 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
[0m21:41:03.191831 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m21:41:03.196032 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_nation"
[0m21:41:03.197439 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m21:41:03.197675 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
-- back compat for old kwarg name
  
  begin;
[0m21:41:03.245479 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a840490>]}
[0m21:41:03.246224 [info ] [Thread-4  ]: 17 of 31 OK created sql incremental model DATA_VAULT.sat_order_customer_details  [[32mSUCCESS 0[0m in 3.80s]
[0m21:41:03.246781 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m21:41:03.247238 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_part
[0m21:41:03.247831 [info ] [Thread-4  ]: 21 of 31 START sql incremental model DATA_VAULT.hub_part ....................... [RUN]
[0m21:41:03.248726 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_part'
[0m21:41:03.249027 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
[0m21:41:03.257072 [info ] [Thread-4  ]: 21:41:03 + Loading TEST.DATA_VAULT.hub_part from 2 source(s)
[0m21:41:03.265641 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
[0m21:41:03.266264 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (compile): 2023-02-24 21:41:03.249228 => 2023-02-24 21:41:03.266210
[0m21:41:03.266477 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
[0m21:41:03.271716 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m21:41:03.271885 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
create or replace  temporary view TEST.DATA_VAULT.hub_part__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN TEST.DATA_VAULT.hub_part AS d
    ON a.PART_PK = d.PART_PK
    WHERE d.PART_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:41:03.272029 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m21:41:03.286314 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:03.286586 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m21:41:03.286706 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
insert into TEST.DATA_VAULT.hub_nation ("NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.hub_nation__dbt_tmp
        );
[0m21:41:04.393897 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:41:04.397253 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m21:41:04.397448 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
describe table TEST.DATA_VAULT.hub_part__dbt_tmp
[0m21:41:04.477717 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m21:41:04.483911 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m21:41:04.484301 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
describe table TEST.DATA_VAULT.hub_part
[0m21:41:04.585561 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m21:41:04.591867 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m21:41:04.592157 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
describe table "TEST"."DATA_VAULT"."HUB_PART"
[0m21:41:04.668745 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m21:41:04.672281 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_part"
[0m21:41:04.673535 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m21:41:04.673749 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
-- back compat for old kwarg name
  
  begin;
[0m21:41:04.785527 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:04.786921 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m21:41:04.787399 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
insert into TEST.DATA_VAULT.hub_part ("PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.hub_part__dbt_tmp
        );
[0m21:41:05.114775 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 4 seconds
[0m21:41:05.116241 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m21:41:05.116728 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
COMMIT
[0m21:41:05.174862 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 3 seconds
[0m21:41:05.176091 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m21:41:05.176645 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
COMMIT
[0m21:41:05.378312 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:05.385365 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m21:41:05.385668 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
drop view if exists TEST.DATA_VAULT.sat_order_lineitem_details__dbt_tmp cascade
[0m21:41:05.460460 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:05.468549 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m21:41:05.468782 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
drop view if exists TEST.DATA_VAULT.sat_order_order_details__dbt_tmp cascade
[0m21:41:05.486250 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:05.488859 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_lineitem_details (execute): 2023-02-24 21:41:00.046940 => 2023-02-24 21:41:05.488761
[0m21:41:05.489134 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
[0m21:41:05.596853 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:05.601019 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_order_details (execute): 2023-02-24 21:41:01.074440 => 2023-02-24 21:41:05.600945
[0m21:41:05.601415 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: Close
[0m21:41:05.607290 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8b0f40>]}
[0m21:41:05.608135 [info ] [Thread-3  ]: 18 of 31 OK created sql incremental model DATA_VAULT.sat_order_lineitem_details  [[32mSUCCESS 0[0m in 5.59s]
[0m21:41:05.608710 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m21:41:05.609124 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_region
[0m21:41:05.609970 [info ] [Thread-3  ]: 22 of 31 START sql incremental model DATA_VAULT.hub_region ..................... [RUN]
[0m21:41:05.611082 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_region'
[0m21:41:05.611394 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
[0m21:41:05.620194 [info ] [Thread-3  ]: 21:41:05 + Loading TEST.DATA_VAULT.hub_region from 2 source(s)
[0m21:41:05.628157 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
[0m21:41:05.629049 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (compile): 2023-02-24 21:41:05.611804 => 2023-02-24 21:41:05.628960
[0m21:41:05.629330 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
[0m21:41:05.634203 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m21:41:05.634485 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
create or replace  temporary view TEST.DATA_VAULT.hub_region__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN TEST.DATA_VAULT.hub_region AS d
    ON a.REGION_PK = d.REGION_PK
    WHERE d.REGION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:41:05.634632 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m21:41:05.869228 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c0190>]}
[0m21:41:05.875811 [info ] [Thread-2  ]: 19 of 31 OK created sql incremental model DATA_VAULT.sat_order_order_details ... [[32mSUCCESS 0[0m in 4.82s]
[0m21:41:05.896518 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
[0m21:41:05.896912 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
[0m21:41:05.897115 [info ] [Thread-2  ]: 23 of 31 START sql incremental model DATA_VAULT.hub_supplier ................... [RUN]
[0m21:41:05.897514 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_supplier'
[0m21:41:05.897752 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
[0m21:41:05.901047 [info ] [Thread-2  ]: 21:41:05 + Loading TEST.DATA_VAULT.hub_supplier from 2 source(s)
[0m21:41:05.905504 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
[0m21:41:05.911526 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (compile): 2023-02-24 21:41:05.897919 => 2023-02-24 21:41:05.911465
[0m21:41:05.911715 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
[0m21:41:05.949590 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m21:41:05.949792 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
create or replace  temporary view TEST.DATA_VAULT.hub_supplier__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN TEST.DATA_VAULT.hub_supplier AS d
    ON a.SUPPLIER_PK = d.SUPPLIER_PK
    WHERE d.SUPPLIER_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:41:05.949888 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:41:06.662626 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:41:06.671908 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m21:41:06.672189 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
describe table TEST.DATA_VAULT.hub_region__dbt_tmp
[0m21:41:06.760412 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m21:41:06.765033 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m21:41:06.765256 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
describe table TEST.DATA_VAULT.hub_region
[0m21:41:06.855791 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m21:41:06.868528 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m21:41:06.868918 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
describe table "TEST"."DATA_VAULT"."HUB_REGION"
[0m21:41:06.894924 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:41:06.902157 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m21:41:06.902523 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
describe table TEST.DATA_VAULT.hub_supplier__dbt_tmp
[0m21:41:06.962927 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m21:41:06.971301 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_region"
[0m21:41:06.972538 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m21:41:06.972707 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
-- back compat for old kwarg name
  
  begin;
[0m21:41:06.990220 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0 seconds
[0m21:41:06.993826 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m21:41:06.994018 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
describe table TEST.DATA_VAULT.hub_supplier
[0m21:41:07.064501 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:07.064976 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m21:41:07.065234 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
insert into TEST.DATA_VAULT.hub_region ("REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.hub_region__dbt_tmp
        );
[0m21:41:07.090753 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0 seconds
[0m21:41:07.097132 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m21:41:07.097424 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
describe table "TEST"."DATA_VAULT"."HUB_SUPPLIER"
[0m21:41:07.193801 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0 seconds
[0m21:41:07.201632 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.hub_supplier"
[0m21:41:07.203287 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m21:41:07.203556 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
-- back compat for old kwarg name
  
  begin;
[0m21:41:07.294588 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:07.295735 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m21:41:07.296079 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
insert into TEST.DATA_VAULT.hub_supplier ("SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.hub_supplier__dbt_tmp
        );
[0m21:41:08.596171 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 5 seconds
[0m21:41:08.597820 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m21:41:08.598364 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
COMMIT
[0m21:41:08.901272 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:08.910763 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
[0m21:41:08.910975 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
drop view if exists TEST.DATA_VAULT.hub_nation__dbt_tmp cascade
[0m21:41:08.966979 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 4 seconds
[0m21:41:08.967220 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m21:41:08.967356 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
COMMIT
[0m21:41:09.009046 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:09.011488 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (execute): 2023-02-24 21:41:01.882431 => 2023-02-24 21:41:09.011401
[0m21:41:09.011745 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: Close
[0m21:41:09.115925 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a981190>]}
[0m21:41:09.116771 [info ] [Thread-1  ]: 20 of 31 OK created sql incremental model DATA_VAULT.hub_nation ................ [[32mSUCCESS 0[0m in 7.25s]
[0m21:41:09.117210 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
[0m21:41:09.117480 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_inventory
[0m21:41:09.117814 [info ] [Thread-1  ]: 24 of 31 START sql incremental model DATA_VAULT.link_inventory ................. [RUN]
[0m21:41:09.118339 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_inventory'
[0m21:41:09.118538 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory
[0m21:41:09.122711 [info ] [Thread-1  ]: 21:41:09 + Loading TEST.DATA_VAULT.link_inventory from 1 source(s)
[0m21:41:09.126513 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
[0m21:41:09.126946 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory (compile): 2023-02-24 21:41:09.118649 => 2023-02-24 21:41:09.126910
[0m21:41:09.127084 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory
[0m21:41:09.131354 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m21:41:09.131482 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
create or replace  temporary view TEST.DATA_VAULT.link_inventory__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DATA_VAULT.link_inventory AS d
    ON a.INVENTORY_PK = d.INVENTORY_PK
    WHERE d.INVENTORY_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:41:09.131580 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:41:09.194498 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:09.196769 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
[0m21:41:09.196949 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
drop view if exists TEST.DATA_VAULT.hub_part__dbt_tmp cascade
[0m21:41:09.364612 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:09.366249 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (execute): 2023-02-24 21:41:03.266611 => 2023-02-24 21:41:09.366208
[0m21:41:09.366423 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_part: Close
[0m21:41:09.464157 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4f3820>]}
[0m21:41:09.464625 [info ] [Thread-4  ]: 21 of 31 OK created sql incremental model DATA_VAULT.hub_part .................. [[32mSUCCESS 0[0m in 6.22s]
[0m21:41:09.464916 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
[0m21:41:09.465138 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_nation_region
[0m21:41:09.465332 [info ] [Thread-4  ]: 25 of 31 START sql incremental model DATA_VAULT.link_nation_region ............. [RUN]
[0m21:41:09.465757 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_nation_region'
[0m21:41:09.465993 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_nation_region
[0m21:41:09.470481 [info ] [Thread-4  ]: 21:41:09 + Loading TEST.DATA_VAULT.link_nation_region from 2 source(s)
[0m21:41:09.476161 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
[0m21:41:09.476806 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_nation_region (compile): 2023-02-24 21:41:09.466156 => 2023-02-24 21:41:09.476751
[0m21:41:09.476975 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_nation_region
[0m21:41:09.481784 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m21:41:09.482054 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
create or replace  temporary view TEST.DATA_VAULT.link_nation_region__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN TEST.DATA_VAULT.link_nation_region AS d
    ON a.NATION_REGION_PK = d.NATION_REGION_PK
    WHERE d.NATION_REGION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:41:09.482251 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m21:41:09.732031 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:41:09.734497 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m21:41:09.734627 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
describe table TEST.DATA_VAULT.link_inventory__dbt_tmp
[0m21:41:09.836802 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:41:09.840568 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m21:41:09.840781 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
describe table TEST.DATA_VAULT.link_inventory
[0m21:41:09.966667 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:41:09.973494 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m21:41:09.973863 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
describe table "TEST"."DATA_VAULT"."LINK_INVENTORY"
[0m21:41:10.053984 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:41:10.059136 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_inventory"
[0m21:41:10.060716 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m21:41:10.060947 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
-- back compat for old kwarg name
  
  begin;
[0m21:41:10.158459 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:10.159633 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m21:41:10.160175 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
insert into TEST.DATA_VAULT.link_inventory ("INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.link_inventory__dbt_tmp
        );
[0m21:41:10.229916 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:41:10.236602 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m21:41:10.237028 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
describe table TEST.DATA_VAULT.link_nation_region__dbt_tmp
[0m21:41:10.326608 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:41:10.337784 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m21:41:10.338120 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
describe table TEST.DATA_VAULT.link_nation_region
[0m21:41:10.437232 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:41:10.446696 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m21:41:10.447082 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
describe table "TEST"."DATA_VAULT"."LINK_NATION_REGION"
[0m21:41:10.531455 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:41:10.537505 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_nation_region"
[0m21:41:10.539231 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m21:41:10.539546 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
-- back compat for old kwarg name
  
  begin;
[0m21:41:10.711211 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:10.711499 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m21:41:10.711629 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
insert into TEST.DATA_VAULT.link_nation_region ("NATION_REGION_PK", "NATION_PK", "REGION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_REGION_PK", "NATION_PK", "REGION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.link_nation_region__dbt_tmp
        );
[0m21:41:10.925562 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 4 seconds
[0m21:41:10.926941 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m21:41:10.927398 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
COMMIT
[0m21:41:11.258407 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:11.264166 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
[0m21:41:11.264410 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
drop view if exists TEST.DATA_VAULT.hub_region__dbt_tmp cascade
[0m21:41:11.368861 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:11.373770 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (execute): 2023-02-24 21:41:05.629470 => 2023-02-24 21:41:11.373662
[0m21:41:11.374226 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: Close
[0m21:41:11.493472 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6bac0>]}
[0m21:41:11.494193 [info ] [Thread-3  ]: 22 of 31 OK created sql incremental model DATA_VAULT.hub_region ................ [[32mSUCCESS 0[0m in 5.88s]
[0m21:41:11.494741 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
[0m21:41:11.495207 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_supplier_nation
[0m21:41:11.495638 [info ] [Thread-3  ]: 26 of 31 START sql incremental model DATA_VAULT.link_supplier_nation ........... [RUN]
[0m21:41:11.496513 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_supplier_nation'
[0m21:41:11.497064 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
[0m21:41:11.504993 [info ] [Thread-3  ]: 21:41:11 + Loading TEST.DATA_VAULT.link_supplier_nation from 1 source(s)
[0m21:41:11.511786 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m21:41:11.512524 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_supplier_nation (compile): 2023-02-24 21:41:11.497369 => 2023-02-24 21:41:11.512441
[0m21:41:11.512777 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
[0m21:41:11.517781 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m21:41:11.518049 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
create or replace  temporary view TEST.DATA_VAULT.link_supplier_nation__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DATA_VAULT.link_supplier_nation AS d
    ON a.LINK_SUPPLIER_NATION_PK = d.LINK_SUPPLIER_NATION_PK
    WHERE d.LINK_SUPPLIER_NATION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:41:11.518195 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m21:41:12.077115 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 5 seconds
[0m21:41:12.078519 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m21:41:12.079016 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
COMMIT
[0m21:41:12.382686 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:12.386989 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
[0m21:41:12.387405 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:41:12.387570 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
drop view if exists TEST.DATA_VAULT.hub_supplier__dbt_tmp cascade
[0m21:41:12.390192 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m21:41:12.390630 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
describe table TEST.DATA_VAULT.link_supplier_nation__dbt_tmp
[0m21:41:12.478098 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:41:12.481539 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m21:41:12.481714 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
describe table TEST.DATA_VAULT.link_supplier_nation
[0m21:41:12.490743 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:12.492431 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (execute): 2023-02-24 21:41:05.911799 => 2023-02-24 21:41:12.492388
[0m21:41:12.492604 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: Close
[0m21:41:12.573286 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:41:12.578484 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m21:41:12.578730 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
describe table "TEST"."DATA_VAULT"."LINK_SUPPLIER_NATION"
[0m21:41:12.595764 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9ec8e0>]}
[0m21:41:12.596380 [info ] [Thread-2  ]: 23 of 31 OK created sql incremental model DATA_VAULT.hub_supplier .............. [[32mSUCCESS 0[0m in 6.70s]
[0m21:41:12.596785 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
[0m21:41:12.597124 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m21:41:12.597873 [info ] [Thread-2  ]: 27 of 31 START sql incremental model DATA_VAULT.sat_inv_inventory_details ...... [RUN]
[0m21:41:12.598749 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_inventory_details'
[0m21:41:12.599018 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m21:41:12.618417 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m21:41:12.619075 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_inventory_details (compile): 2023-02-24 21:41:12.599190 => 2023-02-24 21:41:12.619025
[0m21:41:12.619252 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m21:41:12.624070 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m21:41:12.624354 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_inv_inventory_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_inventory AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

latest_records AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.INVENTORY_PK, current_records.INVENTORY_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.INVENTORY_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_inv_inventory_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.INVENTORY_PK
                FROM source_data
            ) AS source_records
                ON current_records.INVENTORY_PK = source_records.INVENTORY_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.INVENTORY_PK = stage.INVENTORY_PK
        AND latest_records.INVENTORY_HASHDIFF = stage.INVENTORY_HASHDIFF
    WHERE latest_records.INVENTORY_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:41:12.624539 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:41:12.659234 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m21:41:12.661104 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m21:41:12.661775 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m21:41:12.661889 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
-- back compat for old kwarg name
  
  begin;
[0m21:41:12.762332 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:12.762623 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m21:41:12.763352 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
insert into TEST.DATA_VAULT.link_supplier_nation ("LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.link_supplier_nation__dbt_tmp
        );
[0m21:41:12.932444 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 3 seconds
[0m21:41:12.932750 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m21:41:12.932877 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
COMMIT
[0m21:41:13.225954 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:13.230217 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
[0m21:41:13.230480 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
drop view if exists TEST.DATA_VAULT.link_inventory__dbt_tmp cascade
[0m21:41:13.305937 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:41:13.311072 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m21:41:13.311339 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
describe table TEST.DATA_VAULT.sat_inv_inventory_details__dbt_tmp
[0m21:41:13.332852 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:13.335072 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory (execute): 2023-02-24 21:41:09.127173 => 2023-02-24 21:41:13.335001
[0m21:41:13.335295 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_inventory: Close
[0m21:41:13.409553 [debug] [Thread-2  ]: SQL status: SUCCESS 8 in 0 seconds
[0m21:41:13.414458 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m21:41:13.414714 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
describe table TEST.DATA_VAULT.sat_inv_inventory_details
[0m21:41:13.477753 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a981d60>]}
[0m21:41:13.478399 [info ] [Thread-1  ]: 24 of 31 OK created sql incremental model DATA_VAULT.link_inventory ............ [[32mSUCCESS 0[0m in 4.36s]
[0m21:41:13.478823 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory
[0m21:41:13.479158 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m21:41:13.479445 [info ] [Thread-1  ]: 28 of 31 START sql incremental model DATA_VAULT.sat_inv_part_details ........... [RUN]
[0m21:41:13.480212 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_part_details'
[0m21:41:13.480522 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m21:41:13.501032 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m21:41:13.501681 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_part_details (compile): 2023-02-24 21:41:13.480705 => 2023-02-24 21:41:13.501635
[0m21:41:13.501859 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m21:41:13.506568 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m21:41:13.506782 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_inv_part_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_inventory AS a
    WHERE a.PART_PK IS NOT NULL
),

latest_records AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.PART_PK, current_records.PART_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.PART_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_inv_part_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.PART_PK
                FROM source_data
            ) AS source_records
                ON current_records.PART_PK = source_records.PART_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.PART_PK = stage.PART_PK
        AND latest_records.PART_HASHDIFF = stage.PART_HASHDIFF
    WHERE latest_records.PART_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:41:13.507048 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:41:13.525020 [debug] [Thread-2  ]: SQL status: SUCCESS 8 in 0 seconds
[0m21:41:13.529357 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m21:41:13.529544 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
describe table "TEST"."DATA_VAULT"."SAT_INV_INVENTORY_DETAILS"
[0m21:41:13.640008 [debug] [Thread-2  ]: SQL status: SUCCESS 8 in 0 seconds
[0m21:41:13.642604 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m21:41:13.656033 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m21:41:13.662486 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
-- back compat for old kwarg name
  
  begin;
[0m21:41:13.823559 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:13.823850 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m21:41:13.823965 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
insert into TEST.DATA_VAULT.sat_inv_inventory_details ("INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_inv_inventory_details__dbt_tmp
        );
[0m21:41:14.283023 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:41:14.289959 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m21:41:14.290378 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
describe table TEST.DATA_VAULT.sat_inv_part_details__dbt_tmp
[0m21:41:14.375433 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0 seconds
[0m21:41:14.384319 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m21:41:14.384668 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
describe table TEST.DATA_VAULT.sat_inv_part_details
[0m21:41:14.442257 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 4 seconds
[0m21:41:14.442583 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m21:41:14.442747 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
COMMIT
[0m21:41:14.464993 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0 seconds
[0m21:41:14.469708 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m21:41:14.469910 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
describe table "TEST"."DATA_VAULT"."SAT_INV_PART_DETAILS"
[0m21:41:14.543168 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0 seconds
[0m21:41:14.547424 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m21:41:14.548547 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m21:41:14.548749 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
-- back compat for old kwarg name
  
  begin;
[0m21:41:14.650223 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:14.651505 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m21:41:14.652054 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
insert into TEST.DATA_VAULT.sat_inv_part_details ("PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_inv_part_details__dbt_tmp
        );
[0m21:41:14.694380 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:14.705293 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
[0m21:41:14.705730 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
drop view if exists TEST.DATA_VAULT.link_nation_region__dbt_tmp cascade
[0m21:41:14.818478 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:14.826199 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_nation_region (execute): 2023-02-24 21:41:09.477083 => 2023-02-24 21:41:14.826088
[0m21:41:14.826644 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: Close
[0m21:41:14.940892 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4f3dc0>]}
[0m21:41:15.566576 [info ] [Thread-4  ]: 25 of 31 OK created sql incremental model DATA_VAULT.link_nation_region ........ [[32mSUCCESS 0[0m in 5.47s]
[0m21:41:15.567219 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_nation_region
[0m21:41:15.567558 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m21:41:15.567949 [info ] [Thread-4  ]: 29 of 31 START sql incremental model DATA_VAULT.sat_inv_supp_nation_details .... [RUN]
[0m21:41:15.568925 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details'
[0m21:41:15.569180 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m21:41:15.590609 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m21:41:15.591243 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_nation_details (compile): 2023-02-24 21:41:15.569327 => 2023-02-24 21:41:15.591194
[0m21:41:15.591443 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m21:41:15.596051 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m21:41:15.596199 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_inv_supp_nation_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.SUPPLIER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_inv_supp_nation_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
        AND latest_records.SUPPLIER_NATION_HASHDIFF = stage.SUPPLIER_NATION_HASHDIFF
    WHERE latest_records.SUPPLIER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:41:15.596326 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m21:41:15.643931 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 3 seconds
[0m21:41:15.644228 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m21:41:15.644337 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
COMMIT
[0m21:41:16.038683 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:16.048397 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m21:41:16.048800 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
drop view if exists TEST.DATA_VAULT.link_supplier_nation__dbt_tmp cascade
[0m21:41:16.164026 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:16.170707 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_supplier_nation (execute): 2023-02-24 21:41:11.512942 => 2023-02-24 21:41:16.170508
[0m21:41:16.171375 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: Close
[0m21:41:16.291223 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a425eb0>]}
[0m21:41:16.291803 [info ] [Thread-3  ]: 26 of 31 OK created sql incremental model DATA_VAULT.link_supplier_nation ...... [[32mSUCCESS 0[0m in 4.79s]
[0m21:41:16.292192 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
[0m21:41:16.292516 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m21:41:16.292782 [info ] [Thread-3  ]: 30 of 31 START sql incremental model DATA_VAULT.sat_inv_supp_region_details .... [RUN]
[0m21:41:16.293382 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details'
[0m21:41:16.293697 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m21:41:16.310279 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m21:41:16.310905 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_region_details (compile): 2023-02-24 21:41:16.293877 => 2023-02-24 21:41:16.310854
[0m21:41:16.311077 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m21:41:16.315260 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m21:41:16.315435 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_inv_supp_region_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.SUPPLIER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_inv_supp_region_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
        AND latest_records.SUPPLIER_NATION_HASHDIFF = stage.SUPPLIER_NATION_HASHDIFF
    WHERE latest_records.SUPPLIER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:41:16.315572 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m21:41:16.378227 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:41:16.380778 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m21:41:16.380939 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
describe table TEST.DATA_VAULT.sat_inv_supp_nation_details__dbt_tmp
[0m21:41:16.554438 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0 seconds
[0m21:41:16.557370 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m21:41:16.557509 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
describe table TEST.DATA_VAULT.sat_inv_supp_nation_details
[0m21:41:16.650828 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0 seconds
[0m21:41:16.655959 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m21:41:16.656154 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
describe table "TEST"."DATA_VAULT"."SAT_INV_SUPP_NATION_DETAILS"
[0m21:41:16.746453 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0 seconds
[0m21:41:16.753152 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m21:41:16.754826 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m21:41:16.755097 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
-- back compat for old kwarg name
  
  begin;
[0m21:41:16.851347 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:16.852320 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m21:41:16.852651 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
insert into TEST.DATA_VAULT.sat_inv_supp_nation_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_inv_supp_nation_details__dbt_tmp
        );
[0m21:41:17.204182 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:41:17.209107 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m21:41:17.209357 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
describe table TEST.DATA_VAULT.sat_inv_supp_region_details__dbt_tmp
[0m21:41:17.307685 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 0 seconds
[0m21:41:17.314740 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m21:41:17.315071 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
describe table TEST.DATA_VAULT.sat_inv_supp_region_details
[0m21:41:17.404358 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 0 seconds
[0m21:41:17.410462 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m21:41:17.410761 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
describe table "TEST"."DATA_VAULT"."SAT_INV_SUPP_REGION_DETAILS"
[0m21:41:17.488833 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 0 seconds
[0m21:41:17.496535 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m21:41:17.498134 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m21:41:17.498334 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
-- back compat for old kwarg name
  
  begin;
[0m21:41:17.644018 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 3 seconds
[0m21:41:17.644808 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m21:41:17.645120 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
COMMIT
[0m21:41:17.850491 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 4 seconds
[0m21:41:17.851928 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m21:41:17.852490 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
COMMIT
[0m21:41:17.887561 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:17.888688 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m21:41:17.889202 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
insert into TEST.DATA_VAULT.sat_inv_supp_region_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_inv_supp_region_details__dbt_tmp
        );
[0m21:41:18.034581 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:18.044885 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m21:41:18.045115 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
drop view if exists TEST.DATA_VAULT.sat_inv_part_details__dbt_tmp cascade
[0m21:41:18.104595 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:18.110498 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m21:41:18.110715 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
drop view if exists TEST.DATA_VAULT.sat_inv_inventory_details__dbt_tmp cascade
[0m21:41:18.149617 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:18.152152 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_part_details (execute): 2023-02-24 21:41:13.501979 => 2023-02-24 21:41:18.152071
[0m21:41:18.152437 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: Close
[0m21:41:18.211812 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:18.214489 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_inventory_details (execute): 2023-02-24 21:41:12.619372 => 2023-02-24 21:41:18.214434
[0m21:41:18.214768 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: Close
[0m21:41:18.274907 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a52ebe0>]}
[0m21:41:18.275662 [info ] [Thread-1  ]: 28 of 31 OK created sql incremental model DATA_VAULT.sat_inv_part_details ...... [[32mSUCCESS 0[0m in 4.79s]
[0m21:41:18.276211 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m21:41:18.276665 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m21:41:18.277243 [info ] [Thread-1  ]: 31 of 31 START sql incremental model DATA_VAULT.sat_inv_supplier_details ....... [RUN]
[0m21:41:18.278045 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details'
[0m21:41:18.278357 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m21:41:18.300377 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m21:41:18.301012 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supplier_details (compile): 2023-02-24 21:41:18.278560 => 2023-02-24 21:41:18.300964
[0m21:41:18.301201 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m21:41:18.306013 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m21:41:18.306165 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_inv_supplier_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.SUPPLIER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_inv_supplier_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
        AND latest_records.SUPPLIER_HASHDIFF = stage.SUPPLIER_HASHDIFF
    WHERE latest_records.SUPPLIER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m21:41:18.306292 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:41:18.318474 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a437e20>]}
[0m21:41:18.318862 [info ] [Thread-2  ]: 27 of 31 OK created sql incremental model DATA_VAULT.sat_inv_inventory_details . [[32mSUCCESS 0[0m in 5.72s]
[0m21:41:18.319155 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m21:41:19.219989 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m21:41:19.224747 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m21:41:19.225037 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
describe table TEST.DATA_VAULT.sat_inv_supplier_details__dbt_tmp
[0m21:41:19.341133 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0 seconds
[0m21:41:19.344349 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m21:41:19.344538 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
describe table TEST.DATA_VAULT.sat_inv_supplier_details
[0m21:41:19.421569 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0 seconds
[0m21:41:19.425019 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m21:41:19.425208 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
describe table "TEST"."DATA_VAULT"."SAT_INV_SUPPLIER_DETAILS"
[0m21:41:19.494374 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0 seconds
[0m21:41:19.496672 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m21:41:19.497495 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m21:41:19.497635 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
-- back compat for old kwarg name
  
  begin;
[0m21:41:19.629732 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:19.630175 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m21:41:19.630346 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
insert into TEST.DATA_VAULT.sat_inv_supplier_details ("SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_inv_supplier_details__dbt_tmp
        );
[0m21:41:19.848104 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 3 seconds
[0m21:41:19.848827 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m21:41:19.849065 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
COMMIT
[0m21:41:20.164391 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:20.168704 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m21:41:20.168942 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
drop view if exists TEST.DATA_VAULT.sat_inv_supp_nation_details__dbt_tmp cascade
[0m21:41:20.256075 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:20.259082 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_nation_details (execute): 2023-02-24 21:41:15.591567 => 2023-02-24 21:41:20.258995
[0m21:41:20.259372 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: Close
[0m21:41:20.382253 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8d6f70>]}
[0m21:41:20.382726 [info ] [Thread-4  ]: 29 of 31 OK created sql incremental model DATA_VAULT.sat_inv_supp_nation_details  [[32mSUCCESS 0[0m in 4.81s]
[0m21:41:20.383026 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m21:41:20.466624 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 3 seconds
[0m21:41:20.467130 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m21:41:20.467329 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
COMMIT
[0m21:41:20.778295 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:20.782442 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m21:41:20.782661 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
drop view if exists TEST.DATA_VAULT.sat_inv_supp_region_details__dbt_tmp cascade
[0m21:41:20.877293 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:20.883199 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_region_details (execute): 2023-02-24 21:41:16.311188 => 2023-02-24 21:41:20.883020
[0m21:41:20.883712 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: Close
[0m21:41:20.987818 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a5d60>]}
[0m21:41:20.988293 [info ] [Thread-3  ]: 30 of 31 OK created sql incremental model DATA_VAULT.sat_inv_supp_region_details  [[32mSUCCESS 0[0m in 4.69s]
[0m21:41:20.988622 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m21:41:22.613320 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 3 seconds
[0m21:41:22.614988 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m21:41:22.615562 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
COMMIT
[0m21:41:22.881742 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:22.889288 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m21:41:22.889685 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
drop view if exists TEST.DATA_VAULT.sat_inv_supplier_details__dbt_tmp cascade
[0m21:41:22.995008 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m21:41:22.999190 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supplier_details (execute): 2023-02-24 21:41:18.301320 => 2023-02-24 21:41:22.999075
[0m21:41:22.999626 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: Close
[0m21:41:23.114592 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcecbad5-f415-457d-a586-f691b8ce732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb9eb0>]}
[0m21:41:23.115335 [info ] [Thread-1  ]: 31 of 31 OK created sql incremental model DATA_VAULT.sat_inv_supplier_details .. [[32mSUCCESS 0[0m in 4.84s]
[0m21:41:23.115891 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m21:41:23.118249 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:41:23.118957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:41:23.119202 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
[0m21:41:23.119394 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_inventory_details' was properly closed.
[0m21:41:23.119571 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details' was properly closed.
[0m21:41:23.119741 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
[0m21:41:23.120146 [info ] [MainThread]: 
[0m21:41:23.120480 [info ] [MainThread]: Finished running 6 view models, 25 incremental models in 0 hours 0 minutes and 35.79 seconds (35.79s).
[0m21:41:23.122440 [debug] [MainThread]: Command end result
[0m21:41:23.174715 [info ] [MainThread]: 
[0m21:41:23.174954 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:41:23.175114 [info ] [MainThread]: 
[0m21:41:23.175242 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=0 SKIP=0 TOTAL=31
[0m21:41:23.175434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b213a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f1af0>]}
[0m21:41:23.175630 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 11:18:14.423021 | 48f8831a-fa28-449c-bd73-01a69f6c2d77 ==============================
[0m11:18:14.423021 [info ] [MainThread]: Running with dbt=1.4.0
[0m11:18:14.424263 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m11:18:14.424405 [debug] [MainThread]: Tracking: tracking
[0m11:18:14.424626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edbf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edb430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef8250>]}
[0m11:18:14.490292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:18:14.490476 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:18:14.494740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48f8831a-fa28-449c-bd73-01a69f6c2d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ad9a0>]}
[0m11:18:14.503062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48f8831a-fa28-449c-bd73-01a69f6c2d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107089130>]}
[0m11:18:14.503260 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 630 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m11:18:14.503414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48f8831a-fa28-449c-bd73-01a69f6c2d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f14100>]}
[0m11:18:14.504664 [info ] [MainThread]: 
[0m11:18:14.505429 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:18:14.506584 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST_DATA_VAULT'
[0m11:18:14.515348 [debug] [ThreadPool]: Using snowflake connection "list_TEST_DATA_VAULT"
[0m11:18:14.515587 [debug] [ThreadPool]: On list_TEST_DATA_VAULT: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_TEST_DATA_VAULT"} */
show terse objects in TEST.DATA_VAULT
[0m11:18:14.515725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:16.022211 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2 seconds
[0m11:18:16.025990 [debug] [ThreadPool]: On list_TEST_DATA_VAULT: Close
[0m11:18:16.194604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48f8831a-fa28-449c-bd73-01a69f6c2d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed2a00>]}
[0m11:18:16.195442 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:18:16.195801 [info ] [MainThread]: 
[0m11:18:16.201474 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.raw_orders
[0m11:18:16.201857 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_transactions
[0m11:18:16.202440 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_orders'
[0m11:18:16.203107 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_transactions'
[0m11:18:16.203364 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.raw_orders
[0m11:18:16.203596 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_transactions
[0m11:18:16.210038 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
[0m11:18:16.213953 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
[0m11:18:16.214804 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_transactions (compile): 2023-02-27 11:18:16.210246 => 2023-02-27 11:18:16.214746
[0m11:18:16.215015 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_transactions
[0m11:18:16.215174 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.raw_orders (compile): 2023-02-27 11:18:16.203751 => 2023-02-27 11:18:16.215135
[0m11:18:16.215332 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_transactions (execute): 2023-02-27 11:18:16.215296 => 2023-02-27 11:18:16.215306
[0m11:18:16.215503 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.raw_orders
[0m11:18:16.216671 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_transactions
[0m11:18:16.216842 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.raw_orders (execute): 2023-02-27 11:18:16.216810 => 2023-02-27 11:18:16.216814
[0m11:18:16.217464 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.raw_orders
[0m11:18:16.217662 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.v_stg_transactions
[0m11:18:16.218159 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_transactions'
[0m11:18:16.218338 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_inventory
[0m11:18:16.218470 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
[0m11:18:16.218622 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.v_stg_orders
[0m11:18:16.218956 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.raw_inventory'
[0m11:18:16.244147 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_orders'
[0m11:18:16.248014 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m11:18:16.248199 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_inventory
[0m11:18:16.248315 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
[0m11:18:16.248410 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
describe table TEST.DATA_VAULT.raw_transactions
[0m11:18:16.250985 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
[0m11:18:16.259419 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m11:18:16.259522 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:18:16.259663 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
describe table TEST.DATA_VAULT.raw_orders
[0m11:18:16.260196 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:18:16.261181 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_inventory (compile): 2023-02-27 11:18:16.248494 => 2023-02-27 11:18:16.261148
[0m11:18:16.261308 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_inventory
[0m11:18:16.261406 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.raw_inventory (execute): 2023-02-27 11:18:16.261384 => 2023-02-27 11:18:16.261389
[0m11:18:16.261700 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_inventory
[0m11:18:16.262045 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.v_stg_inventory
[0m11:18:16.262477 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.v_stg_inventory'
[0m11:18:16.262695 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
[0m11:18:16.269816 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m11:18:16.269932 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
describe table TEST.DATA_VAULT.raw_inventory
[0m11:18:16.270022 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:18:17.067221 [debug] [Thread-1  ]: SQL status: SUCCESS 36 in 1 seconds
[0m11:18:17.078148 [debug] [Thread-3  ]: SQL status: SUCCESS 24 in 1 seconds
[0m11:18:17.151190 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m11:18:17.151339 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */
describe table TEST.DATA_VAULT.raw_inventory
[0m11:18:17.152163 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
[0m11:18:17.153074 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 1 seconds
[0m11:18:17.153219 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
describe table TEST.DATA_VAULT.raw_orders
[0m11:18:17.156830 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m11:18:17.157403 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */
describe table TEST.DATA_VAULT.raw_transactions
[0m11:18:17.230637 [debug] [Thread-3  ]: SQL status: SUCCESS 24 in 0 seconds
[0m11:18:17.280250 [debug] [Thread-1  ]: SQL status: SUCCESS 36 in 0 seconds
[0m11:18:17.305832 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0 seconds
[0m11:18:17.324590 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
[0m11:18:17.327398 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
[0m11:18:17.352489 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_transactions (compile): 2023-02-27 11:18:16.219067 => 2023-02-27 11:18:17.352418
[0m11:18:17.360638 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
[0m11:18:17.360869 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
[0m11:18:17.360988 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_inventory (compile): 2023-02-27 11:18:16.262796 => 2023-02-27 11:18:17.360957
[0m11:18:17.361167 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_transactions (execute): 2023-02-27 11:18:17.361129 => 2023-02-27 11:18:17.361137
[0m11:18:17.361465 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
[0m11:18:17.361622 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: Close
[0m11:18:17.361844 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_inventory (execute): 2023-02-27 11:18:17.361781 => 2023-02-27 11:18:17.361791
[0m11:18:17.362735 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_orders (compile): 2023-02-27 11:18:16.251087 => 2023-02-27 11:18:17.362702
[0m11:18:17.362926 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: Close
[0m11:18:17.363049 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_orders
[0m11:18:17.363633 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.v_stg_orders (execute): 2023-02-27 11:18:17.363599 => 2023-02-27 11:18:17.363605
[0m11:18:17.363760 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_orders: Close
[0m11:18:17.481544 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_orders
[0m11:18:17.482251 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
[0m11:18:17.482491 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
[0m11:18:17.482803 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_customer'
[0m11:18:17.483174 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
[0m11:18:17.483428 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_lineitem'
[0m11:18:17.483598 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
[0m11:18:17.483782 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_order
[0m11:18:17.483949 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
[0m11:18:17.499022 [info ] [Thread-2  ]: 11:18:17 + Loading TEST.DATA_VAULT.hub_customer from 1 source(s)
[0m11:18:17.499402 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_order'
[0m11:18:17.502397 [info ] [Thread-1  ]: 11:18:17 + Loading TEST.DATA_VAULT.hub_lineitem from 1 source(s)
[0m11:18:17.521610 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
[0m11:18:17.529287 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
[0m11:18:17.544046 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
[0m11:18:17.544721 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
[0m11:18:17.547660 [info ] [Thread-4  ]: 11:18:17 + Loading TEST.DATA_VAULT.hub_order from 1 source(s)
[0m11:18:17.547945 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_customer_nation
[0m11:18:17.551237 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
[0m11:18:17.551552 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_customer_nation'
[0m11:18:17.551796 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
[0m11:18:17.556942 [info ] [Thread-3  ]: 11:18:17 + Loading TEST.DATA_VAULT.link_customer_nation from 1 source(s)
[0m11:18:17.557153 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (compile): 2023-02-27 11:18:17.484093 => 2023-02-27 11:18:17.557112
[0m11:18:17.557252 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (compile): 2023-02-27 11:18:17.499518 => 2023-02-27 11:18:17.557232
[0m11:18:17.563017 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
[0m11:18:17.569320 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (compile): 2023-02-27 11:18:17.544856 => 2023-02-27 11:18:17.569243
[0m11:18:17.570418 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
[0m11:18:17.570587 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
[0m11:18:17.570727 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_customer (execute): 2023-02-27 11:18:17.570686 => 2023-02-27 11:18:17.570698
[0m11:18:17.570862 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
[0m11:18:17.571000 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_lineitem (execute): 2023-02-27 11:18:17.570978 => 2023-02-27 11:18:17.570982
[0m11:18:17.571341 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
[0m11:18:17.571484 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_order (execute): 2023-02-27 11:18:17.571459 => 2023-02-27 11:18:17.571463
[0m11:18:17.571773 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
[0m11:18:17.571872 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_nation (compile): 2023-02-27 11:18:17.551906 => 2023-02-27 11:18:17.571855
[0m11:18:17.572020 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_customer_order
[0m11:18:17.572360 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
[0m11:18:17.572568 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m11:18:17.572746 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_nation
[0m11:18:17.573050 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_customer_order'
[0m11:18:17.573246 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_order_lineitem
[0m11:18:17.573530 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_inventory_allocation'
[0m11:18:17.573713 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_nation (execute): 2023-02-27 11:18:17.573654 => 2023-02-27 11:18:17.573665
[0m11:18:17.573908 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_order
[0m11:18:17.574234 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_order_lineitem'
[0m11:18:17.574394 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m11:18:17.574712 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_nation
[0m11:18:17.578368 [info ] [Thread-2  ]: 11:18:17 + Loading TEST.DATA_VAULT.link_customer_order from 1 source(s)
[0m11:18:17.578606 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
[0m11:18:17.581926 [info ] [Thread-1  ]: 11:18:17 + Loading TEST.DATA_VAULT.link_inventory_allocation from 1 source(s)
[0m11:18:17.582279 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m11:18:17.585821 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
[0m11:18:17.588698 [info ] [Thread-4  ]: 11:18:17 + Loading TEST.DATA_VAULT.link_order_lineitem from 1 source(s)
[0m11:18:17.592019 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
[0m11:18:17.592519 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_cust_nation_details'
[0m11:18:17.595947 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
[0m11:18:17.596221 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m11:18:17.596380 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_order (compile): 2023-02-27 11:18:17.574805 => 2023-02-27 11:18:17.596338
[0m11:18:17.609191 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory_allocation (compile): 2023-02-27 11:18:17.578711 => 2023-02-27 11:18:17.609117
[0m11:18:17.621987 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_order
[0m11:18:17.628789 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
[0m11:18:17.628983 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m11:18:17.629119 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.link_customer_order (execute): 2023-02-27 11:18:17.629083 => 2023-02-27 11:18:17.629091
[0m11:18:17.629208 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_order_lineitem (compile): 2023-02-27 11:18:17.585952 => 2023-02-27 11:18:17.629190
[0m11:18:17.629380 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory_allocation (execute): 2023-02-27 11:18:17.629356 => 2023-02-27 11:18:17.629360
[0m11:18:17.629700 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_order
[0m11:18:17.629808 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
[0m11:18:17.630123 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
[0m11:18:17.630211 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_nation_details (compile): 2023-02-27 11:18:17.596529 => 2023-02-27 11:18:17.630191
[0m11:18:17.630371 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m11:18:17.630469 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_order_lineitem (execute): 2023-02-27 11:18:17.630450 => 2023-02-27 11:18:17.630453
[0m11:18:17.630637 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m11:18:17.630737 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m11:18:17.630977 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_cust_region_details'
[0m11:18:17.631234 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
[0m11:18:17.631433 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_customer_details'
[0m11:18:17.631525 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_nation_details (execute): 2023-02-27 11:18:17.631505 => 2023-02-27 11:18:17.631508
[0m11:18:17.631625 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m11:18:17.631753 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m11:18:17.631848 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m11:18:17.632112 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
[0m11:18:17.641762 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
[0m11:18:17.642088 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_lineitem_details'
[0m11:18:17.648640 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_order_details
[0m11:18:17.652898 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
[0m11:18:17.653121 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m11:18:17.653361 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_order_order_details'
[0m11:18:17.694621 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
[0m11:18:17.701840 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
[0m11:18:17.702040 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_region_details (compile): 2023-02-27 11:18:17.632229 => 2023-02-27 11:18:17.701999
[0m11:18:17.702149 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_customer_details (compile): 2023-02-27 11:18:17.642187 => 2023-02-27 11:18:17.702127
[0m11:18:17.707426 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
[0m11:18:17.707648 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m11:18:17.707776 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m11:18:17.707990 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_cust_region_details (execute): 2023-02-27 11:18:17.707954 => 2023-02-27 11:18:17.707961
[0m11:18:17.708117 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_lineitem_details (compile): 2023-02-27 11:18:17.653529 => 2023-02-27 11:18:17.708097
[0m11:18:17.708216 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_customer_details (execute): 2023-02-27 11:18:17.708198 => 2023-02-27 11:18:17.708201
[0m11:18:17.708343 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_order_details (compile): 2023-02-27 11:18:17.694768 => 2023-02-27 11:18:17.708327
[0m11:18:17.708649 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
[0m11:18:17.708766 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m11:18:17.709022 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
[0m11:18:17.709124 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
[0m11:18:17.709265 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.t_link_transactions
[0m11:18:17.709363 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_lineitem_details (execute): 2023-02-27 11:18:17.709345 => 2023-02-27 11:18:17.709348
[0m11:18:17.709540 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
[0m11:18:17.709710 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_order_order_details (execute): 2023-02-27 11:18:17.709689 => 2023-02-27 11:18:17.709693
[0m11:18:17.709950 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.t_link_transactions'
[0m11:18:17.710200 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
[0m11:18:17.710398 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_nation'
[0m11:18:17.710634 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
[0m11:18:17.710734 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
[0m11:18:17.710885 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_part
[0m11:18:17.711007 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
[0m11:18:17.711152 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_region
[0m11:18:17.723461 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
[0m11:18:17.723839 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_part'
[0m11:18:17.726798 [info ] [Thread-1  ]: 11:18:17 + Loading TEST.DATA_VAULT.hub_nation from 2 source(s)
[0m11:18:17.727090 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_region'
[0m11:18:17.727330 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
[0m11:18:17.731837 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
[0m11:18:17.732055 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
[0m11:18:17.735455 [info ] [Thread-4  ]: 11:18:17 + Loading TEST.DATA_VAULT.hub_part from 2 source(s)
[0m11:18:17.738827 [info ] [Thread-3  ]: 11:18:17 + Loading TEST.DATA_VAULT.hub_region from 2 source(s)
[0m11:18:17.739022 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.t_link_transactions (compile): 2023-02-27 11:18:17.711220 => 2023-02-27 11:18:17.738983
[0m11:18:17.743495 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
[0m11:18:17.743688 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (compile): 2023-02-27 11:18:17.723936 => 2023-02-27 11:18:17.743654
[0m11:18:17.748587 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
[0m11:18:17.748875 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.t_link_transactions
[0m11:18:17.749126 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
[0m11:18:17.749351 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.t_link_transactions (execute): 2023-02-27 11:18:17.749298 => 2023-02-27 11:18:17.749308
[0m11:18:17.749513 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (compile): 2023-02-27 11:18:17.732184 => 2023-02-27 11:18:17.749489
[0m11:18:17.749613 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.hub_nation (execute): 2023-02-27 11:18:17.749591 => 2023-02-27 11:18:17.749594
[0m11:18:17.750011 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.t_link_transactions
[0m11:18:17.750132 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (compile): 2023-02-27 11:18:17.735755 => 2023-02-27 11:18:17.750110
[0m11:18:17.750235 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
[0m11:18:17.750590 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
[0m11:18:17.750768 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
[0m11:18:17.750957 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
[0m11:18:17.751098 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.hub_part (execute): 2023-02-27 11:18:17.751066 => 2023-02-27 11:18:17.751072
[0m11:18:17.751257 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_inventory
[0m11:18:17.751558 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.hub_supplier'
[0m11:18:17.751667 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.hub_region (execute): 2023-02-27 11:18:17.751646 => 2023-02-27 11:18:17.751650
[0m11:18:17.751943 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
[0m11:18:17.752185 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_inventory'
[0m11:18:17.752299 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
[0m11:18:17.752571 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
[0m11:18:17.752707 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_nation_region
[0m11:18:17.752827 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory
[0m11:18:17.756081 [info ] [Thread-2  ]: 11:18:17 + Loading TEST.DATA_VAULT.hub_supplier from 2 source(s)
[0m11:18:17.756373 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_supplier_nation
[0m11:18:17.756737 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_nation_region'
[0m11:18:17.760076 [info ] [Thread-1  ]: 11:18:17 + Loading TEST.DATA_VAULT.link_inventory from 1 source(s)
[0m11:18:17.764299 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
[0m11:18:17.764592 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.link_supplier_nation'
[0m11:18:17.764717 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_nation_region
[0m11:18:17.767765 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
[0m11:18:17.768053 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
[0m11:18:17.771360 [info ] [Thread-4  ]: 11:18:17 + Loading TEST.DATA_VAULT.link_nation_region from 2 source(s)
[0m11:18:17.775437 [info ] [Thread-3  ]: 11:18:17 + Loading TEST.DATA_VAULT.link_supplier_nation from 1 source(s)
[0m11:18:17.779757 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
[0m11:18:17.782852 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
[0m11:18:17.783017 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (compile): 2023-02-27 11:18:17.752902 => 2023-02-27 11:18:17.782947
[0m11:18:17.783401 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
[0m11:18:17.783610 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.hub_supplier (execute): 2023-02-27 11:18:17.783577 => 2023-02-27 11:18:17.783586
[0m11:18:17.783736 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory (compile): 2023-02-27 11:18:17.756850 => 2023-02-27 11:18:17.783695
[0m11:18:17.784206 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
[0m11:18:17.784365 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_nation_region (compile): 2023-02-27 11:18:17.768206 => 2023-02-27 11:18:17.784340
[0m11:18:17.784498 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_supplier_nation (compile): 2023-02-27 11:18:17.771639 => 2023-02-27 11:18:17.784464
[0m11:18:17.784652 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory
[0m11:18:17.784849 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m11:18:17.785023 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_nation_region
[0m11:18:17.785149 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
[0m11:18:17.785264 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.link_inventory (execute): 2023-02-27 11:18:17.785235 => 2023-02-27 11:18:17.785239
[0m11:18:17.785545 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_inventory_details'
[0m11:18:17.785657 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.link_nation_region (execute): 2023-02-27 11:18:17.785636 => 2023-02-27 11:18:17.785640
[0m11:18:17.785757 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.link_supplier_nation (execute): 2023-02-27 11:18:17.785736 => 2023-02-27 11:18:17.785739
[0m11:18:17.786049 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory
[0m11:18:17.786171 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m11:18:17.786500 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_nation_region
[0m11:18:17.786840 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
[0m11:18:17.787012 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m11:18:17.797974 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
[0m11:18:17.798294 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m11:18:17.798462 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m11:18:17.798784 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_part_details'
[0m11:18:17.799102 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details'
[0m11:18:17.799327 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details'
[0m11:18:17.799467 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m11:18:17.799603 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m11:18:17.799706 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_inventory_details (compile): 2023-02-27 11:18:17.787123 => 2023-02-27 11:18:17.799677
[0m11:18:17.799810 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m11:18:17.818128 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
[0m11:18:17.820985 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
[0m11:18:17.821105 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m11:18:17.830114 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
[0m11:18:17.830328 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_inventory_details (execute): 2023-02-27 11:18:17.830290 => 2023-02-27 11:18:17.830297
[0m11:18:17.830777 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
[0m11:18:17.830932 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m11:18:17.831151 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details'
[0m11:18:17.831257 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m11:18:17.836770 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_region_details (compile): 2023-02-27 11:18:17.821191 => 2023-02-27 11:18:17.836739
[0m11:18:17.836873 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_nation_details (compile): 2023-02-27 11:18:17.811527 => 2023-02-27 11:18:17.836856
[0m11:18:17.842158 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
[0m11:18:17.842308 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_part_details (compile): 2023-02-27 11:18:17.799882 => 2023-02-27 11:18:17.842275
[0m11:18:17.842427 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m11:18:17.842551 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m11:18:17.842704 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m11:18:17.842831 [debug] [Thread-3  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_region_details (execute): 2023-02-27 11:18:17.842805 => 2023-02-27 11:18:17.842812
[0m11:18:17.842942 [debug] [Thread-4  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supp_nation_details (execute): 2023-02-27 11:18:17.842922 => 2023-02-27 11:18:17.842925
[0m11:18:17.843041 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supplier_details (compile): 2023-02-27 11:18:17.831331 => 2023-02-27 11:18:17.843024
[0m11:18:17.843123 [debug] [Thread-1  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_part_details (execute): 2023-02-27 11:18:17.843105 => 2023-02-27 11:18:17.843108
[0m11:18:17.843418 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
[0m11:18:17.843698 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
[0m11:18:17.843806 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m11:18:17.844070 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
[0m11:18:17.844291 [debug] [Thread-2  ]: Timing info for model.dbtvault_snowflake_demo.sat_inv_supplier_details (execute): 2023-02-27 11:18:17.844270 => 2023-02-27 11:18:17.844272
[0m11:18:17.844618 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
[0m11:18:17.845167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:17.845285 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_part_details' was properly closed.
[0m11:18:17.845374 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
[0m11:18:17.845453 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details' was properly closed.
[0m11:18:17.845527 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
[0m11:18:17.846208 [debug] [MainThread]: Command end result
[0m11:18:17.853209 [info ] [MainThread]: Done.
[0m11:18:17.856451 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m11:18:17.856579 [info ] [MainThread]: Building catalog
[0m11:18:17.859434 [debug] [ThreadPool]: Acquiring new snowflake connection 'TEST.information_schema'
[0m11:18:17.859807 [debug] [ThreadPool]: Acquiring new snowflake connection 'SNOWFLAKE_SAMPLE_DATA.information_schema'
[0m11:18:17.864436 [debug] [ThreadPool]: Using snowflake connection "TEST.information_schema"
[0m11:18:17.866932 [debug] [ThreadPool]: Using snowflake connection "SNOWFLAKE_SAMPLE_DATA.information_schema"
[0m11:18:17.867162 [debug] [ThreadPool]: On TEST.information_schema: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "TEST.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from TEST.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from TEST.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('data_vault'))
      order by "column_index"
[0m11:18:17.867320 [debug] [ThreadPool]: On SNOWFLAKE_SAMPLE_DATA.information_schema: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "SNOWFLAKE_SAMPLE_DATA.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from SNOWFLAKE_SAMPLE_DATA.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from SNOWFLAKE_SAMPLE_DATA.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('tpch_sf10'))
      order by "column_index"
[0m11:18:17.867447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:17.867551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:20.849748 [debug] [ThreadPool]: SQL status: SUCCESS 61 in 3 seconds
[0m11:18:20.869624 [debug] [ThreadPool]: On SNOWFLAKE_SAMPLE_DATA.information_schema: Close
[0m11:18:20.872696 [debug] [ThreadPool]: SQL status: SUCCESS 358 in 3 seconds
[0m11:18:21.495535 [debug] [ThreadPool]: On TEST.information_schema: Close
[0m11:18:21.630129 [info ] [MainThread]: Catalog written to /Users/shrut.patel/Source/dbtvault/dbtvault/target/catalog.json
[0m11:18:21.630528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edbf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e65ca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5c29a0>]}
[0m11:18:21.630699 [debug] [MainThread]: Flushing usage events
[0m11:18:22.045148 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:18:22.045844 [debug] [MainThread]: Connection 'TEST.information_schema' was properly closed.
[0m11:18:22.046096 [debug] [MainThread]: Connection 'SNOWFLAKE_SAMPLE_DATA.information_schema' was properly closed.


============================== 2023-02-27 11:18:45.788855 | 9ea63ca1-5773-46fd-8af2-f2f8460dcba8 ==============================
[0m11:18:45.788855 [info ] [MainThread]: Running with dbt=1.4.0
[0m11:18:45.789780 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m11:18:45.789896 [debug] [MainThread]: Tracking: tracking
[0m11:18:45.790104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10558d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ad1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ad0a0>]}
[0m11:18:45.791147 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m11:18:45.791375 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m11:18:45.791548 [info ] [MainThread]: 
[0m11:18:45.791673 [info ] [MainThread]: 
[0m11:18:45.791788 [info ] [MainThread]: Press Ctrl+C to exit.
[0m11:22:00.448512 [debug] [MainThread]: Flushing usage events
[0m11:22:00.960582 [info ] [MainThread]: ctrl-c


============================== 2023-02-27 11:22:49.455158 | 9efad325-3426-48c6-a6c4-5d922fe18426 ==============================
[0m11:22:49.455158 [info ] [MainThread]: Running with dbt=1.4.0
[0m11:22:49.456052 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m11:22:49.456170 [debug] [MainThread]: Tracking: tracking
[0m11:22:49.456372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109383850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093b7370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093b7250>]}
[0m11:22:49.521103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:22:49.521299 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:22:49.525707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9efad325-3426-48c6-a6c4-5d922fe18426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10966ea90>]}
[0m11:22:49.533910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9efad325-3426-48c6-a6c4-5d922fe18426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109492070>]}
[0m11:22:49.534110 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 630 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m11:22:49.534263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9efad325-3426-48c6-a6c4-5d922fe18426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094923d0>]}
[0m11:22:49.535308 [info ] [MainThread]: 
[0m11:22:49.535622 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:22:49.535793 [debug] [MainThread]: Command end result
[0m11:22:49.542902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109360a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094922b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109492250>]}
[0m11:22:49.543127 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 17:15:09.266698 | d25ae3ac-ce24-45e7-88e9-9058a91b77db ==============================
[0m17:15:09.266698 [info ] [MainThread]: Running with dbt=1.4.0
[0m17:15:09.267713 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m17:15:09.267845 [debug] [MainThread]: Tracking: tracking
[0m17:15:09.268069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109610f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109610430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109638250>]}
[0m17:15:09.295977 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:15:09.296233 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:15:09.296375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096386d0>]}
[0m17:15:10.310950 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_customer_order.sql
[0m17:15:10.357424 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
[0m17:15:10.358201 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_customer_nation.sql
[0m17:15:10.363238 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
[0m17:15:10.364021 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_inventory.sql
[0m17:15:10.369648 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
[0m17:15:10.370485 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_nation_region.sql
[0m17:15:10.376556 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
[0m17:15:10.377283 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
[0m17:15:10.382234 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
[0m17:15:10.383046 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_lineitem.sql
[0m17:15:10.387610 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
[0m17:15:10.388260 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_supplier_nation.sql
[0m17:15:10.393287 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
[0m17:15:10.393946 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_order.sql
[0m17:15:10.407201 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
[0m17:15:10.407865 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_nation.sql
[0m17:15:10.413434 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
[0m17:15:10.414088 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_part.sql
[0m17:15:10.419909 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
[0m17:15:10.420573 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
[0m17:15:10.424874 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
[0m17:15:10.425523 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_customer.sql
[0m17:15:10.429704 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
[0m17:15:10.430358 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_supplier.sql
[0m17:15:10.435776 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
[0m17:15:10.436427 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_region.sql
[0m17:15:10.442499 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
[0m17:15:10.443170 [debug] [MainThread]: 1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
[0m17:15:10.452702 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
[0m17:15:10.453375 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
[0m17:15:10.479915 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
[0m17:15:10.480743 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
[0m17:15:10.488992 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
[0m17:15:10.489750 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
[0m17:15:10.499168 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
[0m17:15:10.499905 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
[0m17:15:10.507419 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
[0m17:15:10.508099 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
[0m17:15:10.514866 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
[0m17:15:10.515547 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
[0m17:15:10.521850 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
[0m17:15:10.522521 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
[0m17:15:10.529111 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
[0m17:15:10.529793 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
[0m17:15:10.538024 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
[0m17:15:10.538717 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
[0m17:15:10.545003 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
[0m17:15:10.545664 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
[0m17:15:10.553663 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
[0m17:15:10.554581 [debug] [MainThread]: 1603: static parser failed on raw_stage/raw_transactions.sql
[0m17:15:10.557598 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
[0m17:15:10.558534 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage/raw_inventory.sql
[0m17:15:10.560028 [debug] [MainThread]: 1603: static parser failed on raw_stage/raw_orders.sql
[0m17:15:10.563565 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
[0m17:15:10.564257 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_orders.sql
[0m17:15:10.687974 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
[0m17:15:10.688811 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_inventory.sql
[0m17:15:10.727932 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
[0m17:15:10.728591 [debug] [MainThread]: 1603: static parser failed on stage/v_stg_transactions.sql
[0m17:15:10.738838 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
[0m17:15:10.809744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109756850>]}
[0m17:15:10.818912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10984e370>]}
[0m17:15:10.819096 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 630 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m17:15:10.819237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10993bac0>]}
[0m17:15:10.820430 [info ] [MainThread]: 
[0m17:15:10.821176 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:15:10.822384 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST'
[0m17:15:10.831294 [debug] [ThreadPool]: Using snowflake connection "list_TEST"
[0m17:15:10.831525 [debug] [ThreadPool]: On list_TEST: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "connection_name": "list_TEST"} */
show terse schemas in database TEST
    limit 10000
[0m17:15:10.831642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:11.843312 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m17:15:11.845359 [debug] [ThreadPool]: On list_TEST: Close
[0m17:15:11.947004 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TEST_DATA_VAULT'
[0m17:15:11.954521 [debug] [ThreadPool]: Using snowflake connection "list_TEST_DATA_VAULT"
[0m17:15:11.954718 [debug] [ThreadPool]: On list_TEST_DATA_VAULT: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "connection_name": "list_TEST_DATA_VAULT"} */
show terse objects in TEST.DATA_VAULT
[0m17:15:11.954866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:12.365844 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 0 seconds
[0m17:15:12.370749 [debug] [ThreadPool]: On list_TEST_DATA_VAULT: Close
[0m17:15:12.529604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099daca0>]}
[0m17:15:12.530350 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:15:12.530654 [info ] [MainThread]: 
[0m17:15:12.535348 [debug] [Thread-1  ]: Began running node model.ba_dbtvault.raw_orders
[0m17:15:12.535671 [debug] [Thread-2  ]: Began running node model.ba_dbtvault.raw_transactions
[0m17:15:12.536014 [info ] [Thread-1  ]: 1 of 31 START sql view model DATA_VAULT.raw_orders ............................. [RUN]
[0m17:15:12.536388 [info ] [Thread-2  ]: 2 of 31 START sql view model DATA_VAULT.raw_transactions ....................... [RUN]
[0m17:15:12.536974 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.ba_dbtvault.raw_orders'
[0m17:15:12.537436 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.ba_dbtvault.raw_transactions'
[0m17:15:12.537698 [debug] [Thread-1  ]: Began compiling node model.ba_dbtvault.raw_orders
[0m17:15:12.537948 [debug] [Thread-2  ]: Began compiling node model.ba_dbtvault.raw_transactions
[0m17:15:12.543007 [debug] [Thread-1  ]: Writing injected SQL for node "model.ba_dbtvault.raw_orders"
[0m17:15:12.545675 [debug] [Thread-2  ]: Writing injected SQL for node "model.ba_dbtvault.raw_transactions"
[0m17:15:12.546517 [debug] [Thread-1  ]: Timing info for model.ba_dbtvault.raw_orders (compile): 2023-02-27 17:15:12.538106 => 2023-02-27 17:15:12.546463
[0m17:15:12.546683 [debug] [Thread-2  ]: Timing info for model.ba_dbtvault.raw_transactions (compile): 2023-02-27 17:15:12.543223 => 2023-02-27 17:15:12.546646
[0m17:15:12.546852 [debug] [Thread-1  ]: Began executing node model.ba_dbtvault.raw_orders
[0m17:15:12.547025 [debug] [Thread-2  ]: Began executing node model.ba_dbtvault.raw_transactions
[0m17:15:12.571649 [debug] [Thread-2  ]: Writing runtime sql for node "model.ba_dbtvault.raw_transactions"
[0m17:15:12.574692 [debug] [Thread-1  ]: Writing runtime sql for node "model.ba_dbtvault.raw_orders"
[0m17:15:12.577082 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.raw_orders"
[0m17:15:12.577741 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.raw_transactions"
[0m17:15:12.577847 [debug] [Thread-1  ]: On model.ba_dbtvault.raw_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.raw_orders"} */
create or replace   view TEST.DATA_VAULT.raw_orders
  
   as (
    SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
[0m17:15:12.577952 [debug] [Thread-2  ]: On model.ba_dbtvault.raw_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.raw_transactions"} */
create or replace   view TEST.DATA_VAULT.raw_transactions
  
   as (
    SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS  AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
[0m17:15:12.578068 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:15:12.578163 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m17:15:13.878348 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:13.906077 [debug] [Thread-2  ]: Timing info for model.ba_dbtvault.raw_transactions (execute): 2023-02-27 17:15:12.566097 => 2023-02-27 17:15:13.905957
[0m17:15:13.906478 [debug] [Thread-2  ]: On model.ba_dbtvault.raw_transactions: Close
[0m17:15:14.025184 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:14.028620 [debug] [Thread-1  ]: Timing info for model.ba_dbtvault.raw_orders (execute): 2023-02-27 17:15:12.547137 => 2023-02-27 17:15:14.028543
[0m17:15:14.029585 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d27040>]}
[0m17:15:14.029845 [debug] [Thread-1  ]: On model.ba_dbtvault.raw_orders: Close
[0m17:15:14.030790 [info ] [Thread-2  ]: 2 of 31 OK created sql view model DATA_VAULT.raw_transactions .................. [[32mSUCCESS 1[0m in 1.49s]
[0m17:15:14.033753 [debug] [Thread-2  ]: Finished running node model.ba_dbtvault.raw_transactions
[0m17:15:14.035013 [debug] [Thread-4  ]: Began running node model.ba_dbtvault.v_stg_transactions
[0m17:15:14.035525 [info ] [Thread-4  ]: 3 of 31 START sql view model DATA_VAULT.v_stg_transactions ..................... [RUN]
[0m17:15:14.036326 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.ba_dbtvault.v_stg_transactions'
[0m17:15:14.036861 [debug] [Thread-4  ]: Began compiling node model.ba_dbtvault.v_stg_transactions
[0m17:15:14.052878 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.v_stg_transactions"
[0m17:15:14.053379 [debug] [Thread-4  ]: On model.ba_dbtvault.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.v_stg_transactions"} */
describe table TEST.DATA_VAULT.raw_transactions
[0m17:15:14.053696 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:15:14.259355 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d270d0>]}
[0m17:15:14.259712 [info ] [Thread-1  ]: 1 of 31 OK created sql view model DATA_VAULT.raw_orders ........................ [[32mSUCCESS 1[0m in 1.72s]
[0m17:15:14.259955 [debug] [Thread-1  ]: Finished running node model.ba_dbtvault.raw_orders
[0m17:15:14.260304 [debug] [Thread-2  ]: Began running node model.ba_dbtvault.raw_inventory
[0m17:15:14.260478 [debug] [Thread-3  ]: Began running node model.ba_dbtvault.v_stg_orders
[0m17:15:14.260676 [info ] [Thread-2  ]: 4 of 31 START sql view model DATA_VAULT.raw_inventory .......................... [RUN]
[0m17:15:14.260941 [info ] [Thread-3  ]: 5 of 31 START sql view model DATA_VAULT.v_stg_orders ........................... [RUN]
[0m17:15:14.261331 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.ba_dbtvault.raw_inventory'
[0m17:15:14.261620 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.ba_dbtvault.v_stg_orders'
[0m17:15:14.261778 [debug] [Thread-2  ]: Began compiling node model.ba_dbtvault.raw_inventory
[0m17:15:14.261907 [debug] [Thread-3  ]: Began compiling node model.ba_dbtvault.v_stg_orders
[0m17:15:14.265273 [debug] [Thread-2  ]: Writing injected SQL for node "model.ba_dbtvault.raw_inventory"
[0m17:15:14.275375 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.v_stg_orders"
[0m17:15:14.275623 [debug] [Thread-3  ]: On model.ba_dbtvault.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.v_stg_orders"} */
describe table TEST.DATA_VAULT.raw_orders
[0m17:15:14.275745 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:15:14.276749 [debug] [Thread-2  ]: Timing info for model.ba_dbtvault.raw_inventory (compile): 2023-02-27 17:15:14.262004 => 2023-02-27 17:15:14.276702
[0m17:15:14.276937 [debug] [Thread-2  ]: Began executing node model.ba_dbtvault.raw_inventory
[0m17:15:14.279155 [debug] [Thread-2  ]: Writing runtime sql for node "model.ba_dbtvault.raw_inventory"
[0m17:15:14.280758 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.raw_inventory"
[0m17:15:14.280875 [debug] [Thread-2  ]: On model.ba_dbtvault.raw_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.raw_inventory"} */
create or replace   view TEST.DATA_VAULT.raw_inventory
  
   as (
    SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PARTSUPP AS a
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN TEST.DATA_VAULT.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
  );
[0m17:15:14.280971 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:15:14.686082 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 1 seconds
[0m17:15:14.695758 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.v_stg_transactions"
[0m17:15:14.696000 [debug] [Thread-4  ]: On model.ba_dbtvault.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.v_stg_transactions"} */
describe table TEST.DATA_VAULT.raw_transactions
[0m17:15:14.797360 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 1 seconds
[0m17:15:14.815058 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.v_stg_orders"
[0m17:15:14.815326 [debug] [Thread-3  ]: On model.ba_dbtvault.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.v_stg_orders"} */
describe table TEST.DATA_VAULT.raw_orders
[0m17:15:14.950954 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0 seconds
[0m17:15:15.053103 [debug] [Thread-3  ]: Writing injected SQL for node "model.ba_dbtvault.v_stg_orders"
[0m17:15:15.053681 [debug] [Thread-3  ]: Timing info for model.ba_dbtvault.v_stg_orders (compile): 2023-02-27 17:15:14.265431 => 2023-02-27 17:15:15.053646
[0m17:15:15.053808 [debug] [Thread-3  ]: Began executing node model.ba_dbtvault.v_stg_orders
[0m17:15:15.055990 [debug] [Thread-3  ]: Writing runtime sql for node "model.ba_dbtvault.v_stg_orders"
[0m17:15:15.062652 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.v_stg_orders"
[0m17:15:15.062747 [debug] [Thread-3  ]: On model.ba_dbtvault.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.v_stg_orders"} */
create or replace   view TEST.DATA_VAULT.v_stg_orders
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM TEST.DATA_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMERKEY AS CUSTOMER_KEY,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS REGION_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), '')) AS BINARY(16)) AS ORDER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '')) AS BINARY(16)) AS PART_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
  );
[0m17:15:15.155003 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0 seconds
[0m17:15:15.163823 [debug] [Thread-4  ]: Writing injected SQL for node "model.ba_dbtvault.v_stg_transactions"
[0m17:15:15.164288 [debug] [Thread-4  ]: Timing info for model.ba_dbtvault.v_stg_transactions (compile): 2023-02-27 17:15:14.037036 => 2023-02-27 17:15:15.164253
[0m17:15:15.164455 [debug] [Thread-4  ]: Began executing node model.ba_dbtvault.v_stg_transactions
[0m17:15:15.167091 [debug] [Thread-4  ]: Writing runtime sql for node "model.ba_dbtvault.v_stg_transactions"
[0m17:15:15.168772 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.v_stg_transactions"
[0m17:15:15.168888 [debug] [Thread-4  ]: On model.ba_dbtvault.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.v_stg_transactions"} */
create or replace   view TEST.DATA_VAULT.v_stg_transactions
  
   as (
    







-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM TEST.DATA_VAULT.raw_transactions
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATEADD(DAY, 1, TRANSACTION_DATE) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS TRANSACTION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), '')) AS BINARY(16)) AS CUSTOMER_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS VARCHAR))), '')) AS BINARY(16)) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
[0m17:15:16.130870 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m17:15:16.133309 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:16.136551 [debug] [Thread-2  ]: Timing info for model.ba_dbtvault.raw_inventory (execute): 2023-02-27 17:15:14.277031 => 2023-02-27 17:15:16.136459
[0m17:15:16.138767 [debug] [Thread-4  ]: Timing info for model.ba_dbtvault.v_stg_transactions (execute): 2023-02-27 17:15:15.164566 => 2023-02-27 17:15:16.138727
[0m17:15:16.139061 [debug] [Thread-2  ]: On model.ba_dbtvault.raw_inventory: Close
[0m17:15:16.139267 [debug] [Thread-4  ]: On model.ba_dbtvault.v_stg_transactions: Close
[0m17:15:16.203571 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:16.206330 [debug] [Thread-3  ]: Timing info for model.ba_dbtvault.v_stg_orders (execute): 2023-02-27 17:15:15.053881 => 2023-02-27 17:15:16.206250
[0m17:15:16.206672 [debug] [Thread-3  ]: On model.ba_dbtvault.v_stg_orders: Close
[0m17:15:16.245080 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f381cd0>]}
[0m17:15:16.245875 [info ] [Thread-4  ]: 3 of 31 OK created sql view model DATA_VAULT.v_stg_transactions ................ [[32mSUCCESS 1[0m in 2.21s]
[0m17:15:16.246477 [debug] [Thread-4  ]: Finished running node model.ba_dbtvault.v_stg_transactions
[0m17:15:16.247106 [debug] [Thread-1  ]: Began running node model.ba_dbtvault.t_link_transactions
[0m17:15:16.247482 [info ] [Thread-1  ]: 6 of 31 START sql incremental model DATA_VAULT.t_link_transactions ............. [RUN]
[0m17:15:16.248111 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.ba_dbtvault.t_link_transactions'
[0m17:15:16.248378 [debug] [Thread-1  ]: Began compiling node model.ba_dbtvault.t_link_transactions
[0m17:15:16.261120 [debug] [Thread-1  ]: Writing injected SQL for node "model.ba_dbtvault.t_link_transactions"
[0m17:15:16.261893 [debug] [Thread-1  ]: Timing info for model.ba_dbtvault.t_link_transactions (compile): 2023-02-27 17:15:16.248540 => 2023-02-27 17:15:16.261840
[0m17:15:16.262083 [debug] [Thread-1  ]: Began executing node model.ba_dbtvault.t_link_transactions
[0m17:15:16.290334 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.t_link_transactions"
[0m17:15:16.290545 [debug] [Thread-1  ]: On model.ba_dbtvault.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.t_link_transactions"} */
create or replace  temporary view TEST.DATA_VAULT.t_link_transactions__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_transactions
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    LEFT JOIN TEST.DATA_VAULT.t_link_transactions AS tgt
    ON stg.TRANSACTION_PK = tgt.TRANSACTION_PK
    WHERE tgt.TRANSACTION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:16.290657 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:15:16.319046 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d27310>]}
[0m17:15:16.319452 [info ] [Thread-2  ]: 4 of 31 OK created sql view model DATA_VAULT.raw_inventory ..................... [[32mSUCCESS 1[0m in 2.06s]
[0m17:15:16.319721 [debug] [Thread-2  ]: Finished running node model.ba_dbtvault.raw_inventory
[0m17:15:16.320281 [debug] [Thread-4  ]: Began running node model.ba_dbtvault.v_stg_inventory
[0m17:15:16.320509 [info ] [Thread-4  ]: 7 of 31 START sql view model DATA_VAULT.v_stg_inventory ........................ [RUN]
[0m17:15:16.320881 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.ba_dbtvault.v_stg_inventory'
[0m17:15:16.321016 [debug] [Thread-4  ]: Began compiling node model.ba_dbtvault.v_stg_inventory
[0m17:15:16.329261 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.v_stg_inventory"
[0m17:15:16.329512 [debug] [Thread-4  ]: On model.ba_dbtvault.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.v_stg_inventory"} */
describe table TEST.DATA_VAULT.raw_inventory
[0m17:15:16.329712 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m17:15:16.351911 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f366400>]}
[0m17:15:16.352233 [info ] [Thread-3  ]: 5 of 31 OK created sql view model DATA_VAULT.v_stg_orders ...................... [[32mSUCCESS 1[0m in 2.09s]
[0m17:15:16.352432 [debug] [Thread-3  ]: Finished running node model.ba_dbtvault.v_stg_orders
[0m17:15:16.352888 [debug] [Thread-2  ]: Began running node model.ba_dbtvault.hub_customer
[0m17:15:16.353100 [debug] [Thread-3  ]: Began running node model.ba_dbtvault.hub_lineitem
[0m17:15:16.353272 [info ] [Thread-2  ]: 8 of 31 START sql incremental model DATA_VAULT.hub_customer .................... [RUN]
[0m17:15:16.353568 [info ] [Thread-3  ]: 9 of 31 START sql incremental model DATA_VAULT.hub_lineitem .................... [RUN]
[0m17:15:16.353965 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.ba_dbtvault.hub_customer'
[0m17:15:16.354409 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.ba_dbtvault.hub_lineitem'
[0m17:15:16.354580 [debug] [Thread-2  ]: Began compiling node model.ba_dbtvault.hub_customer
[0m17:15:16.354734 [debug] [Thread-3  ]: Began compiling node model.ba_dbtvault.hub_lineitem
[0m17:15:16.376388 [info ] [Thread-2  ]: 17:15:16 + Loading TEST.DATA_VAULT.hub_customer from 1 source(s)
[0m17:15:16.388725 [info ] [Thread-3  ]: 17:15:16 + Loading TEST.DATA_VAULT.hub_lineitem from 1 source(s)
[0m17:15:16.417994 [debug] [Thread-2  ]: Writing injected SQL for node "model.ba_dbtvault.hub_customer"
[0m17:15:16.435304 [debug] [Thread-3  ]: Writing injected SQL for node "model.ba_dbtvault.hub_lineitem"
[0m17:15:16.493143 [debug] [Thread-2  ]: Timing info for model.ba_dbtvault.hub_customer (compile): 2023-02-27 17:15:16.367351 => 2023-02-27 17:15:16.493060
[0m17:15:16.504428 [debug] [Thread-2  ]: Began executing node model.ba_dbtvault.hub_customer
[0m17:15:16.507318 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.hub_customer"
[0m17:15:16.507613 [debug] [Thread-2  ]: On model.ba_dbtvault.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_customer"} */
create or replace  temporary view TEST.DATA_VAULT.hub_customer__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DATA_VAULT.hub_customer AS d
    ON a.CUSTOMER_PK = d.CUSTOMER_PK
    WHERE d.CUSTOMER_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:16.507842 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:15:16.508363 [debug] [Thread-3  ]: Timing info for model.ba_dbtvault.hub_lineitem (compile): 2023-02-27 17:15:16.385887 => 2023-02-27 17:15:16.508330
[0m17:15:16.508551 [debug] [Thread-3  ]: Began executing node model.ba_dbtvault.hub_lineitem
[0m17:15:16.511091 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.hub_lineitem"
[0m17:15:16.511199 [debug] [Thread-3  ]: On model.ba_dbtvault.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_lineitem"} */
create or replace  temporary view TEST.DATA_VAULT.hub_lineitem__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DATA_VAULT.hub_lineitem AS d
    ON a.LINEITEM_PK = d.LINEITEM_PK
    WHERE d.LINEITEM_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:16.511328 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:15:16.883943 [debug] [Thread-4  ]: SQL status: SUCCESS 24 in 1 seconds
[0m17:15:16.894181 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.v_stg_inventory"
[0m17:15:16.894358 [debug] [Thread-4  ]: On model.ba_dbtvault.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.v_stg_inventory"} */
describe table TEST.DATA_VAULT.raw_inventory
[0m17:15:16.972662 [debug] [Thread-4  ]: SQL status: SUCCESS 24 in 0 seconds
[0m17:15:17.025646 [debug] [Thread-4  ]: Writing injected SQL for node "model.ba_dbtvault.v_stg_inventory"
[0m17:15:17.026154 [debug] [Thread-4  ]: Timing info for model.ba_dbtvault.v_stg_inventory (compile): 2023-02-27 17:15:16.321147 => 2023-02-27 17:15:17.026116
[0m17:15:17.026302 [debug] [Thread-4  ]: Began executing node model.ba_dbtvault.v_stg_inventory
[0m17:15:17.028872 [debug] [Thread-4  ]: Writing runtime sql for node "model.ba_dbtvault.v_stg_inventory"
[0m17:15:17.034173 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.v_stg_inventory"
[0m17:15:17.034281 [debug] [Thread-4  ]: On model.ba_dbtvault.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.v_stg_inventory"} */
create or replace   view TEST.DATA_VAULT.v_stg_inventory
  
   as (
    








WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM TEST.DATA_VAULT.raw_inventory
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS SUPPLIER_REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS REGION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), '')) AS BINARY(16)) AS NATION_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_SUPPLIER_NATION_PK,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), '')) AS BINARY(16)) AS PART_PK,

    CAST(MD5_BINARY(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS PART_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_REGION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_NATION_HASHDIFF,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging
  );
[0m17:15:17.138170 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:17.140377 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.t_link_transactions"
[0m17:15:17.140502 [debug] [Thread-1  ]: On model.ba_dbtvault.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.t_link_transactions"} */
describe table TEST.DATA_VAULT.t_link_transactions__dbt_tmp
[0m17:15:17.205552 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0 seconds
[0m17:15:17.210053 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.t_link_transactions"
[0m17:15:17.210275 [debug] [Thread-1  ]: On model.ba_dbtvault.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.t_link_transactions"} */
describe table TEST.DATA_VAULT.t_link_transactions
[0m17:15:17.295379 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:17.299565 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.hub_lineitem"
[0m17:15:17.299806 [debug] [Thread-3  ]: On model.ba_dbtvault.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_lineitem"} */
describe table TEST.DATA_VAULT.hub_lineitem__dbt_tmp
[0m17:15:17.374296 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:17.382296 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.hub_lineitem"
[0m17:15:17.382628 [debug] [Thread-3  ]: On model.ba_dbtvault.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_lineitem"} */
describe table TEST.DATA_VAULT.hub_lineitem
[0m17:15:17.385077 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0 seconds
[0m17:15:17.397543 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.t_link_transactions"
[0m17:15:17.397878 [debug] [Thread-1  ]: On model.ba_dbtvault.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.t_link_transactions"} */
describe table "TEST"."DATA_VAULT"."T_LINK_TRANSACTIONS"
[0m17:15:17.488564 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0 seconds
[0m17:15:17.511840 [debug] [Thread-1  ]: Writing runtime sql for node "model.ba_dbtvault.t_link_transactions"
[0m17:15:17.512297 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:17.512708 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:17.514819 [debug] [Thread-4  ]: Timing info for model.ba_dbtvault.v_stg_inventory (execute): 2023-02-27 17:15:17.026389 => 2023-02-27 17:15:17.514756
[0m17:15:17.518562 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.hub_lineitem"
[0m17:15:17.518785 [debug] [Thread-4  ]: On model.ba_dbtvault.v_stg_inventory: Close
[0m17:15:17.518942 [debug] [Thread-3  ]: On model.ba_dbtvault.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_lineitem"} */
describe table "TEST"."DATA_VAULT"."HUB_LINEITEM"
[0m17:15:17.520553 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.t_link_transactions"
[0m17:15:17.521103 [debug] [Thread-1  ]: On model.ba_dbtvault.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.t_link_transactions"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:17.580002 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:17.582890 [debug] [Thread-3  ]: Writing runtime sql for node "model.ba_dbtvault.hub_lineitem"
[0m17:15:17.583280 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:17.586378 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.hub_customer"
[0m17:15:17.586566 [debug] [Thread-2  ]: On model.ba_dbtvault.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_customer"} */
describe table TEST.DATA_VAULT.hub_customer__dbt_tmp
[0m17:15:17.587713 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.hub_lineitem"
[0m17:15:17.587931 [debug] [Thread-3  ]: On model.ba_dbtvault.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_lineitem"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:17.644171 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f507850>]}
[0m17:15:17.644670 [info ] [Thread-4  ]: 7 of 31 OK created sql view model DATA_VAULT.v_stg_inventory ................... [[32mSUCCESS 1[0m in 1.32s]
[0m17:15:17.645043 [debug] [Thread-4  ]: Finished running node model.ba_dbtvault.v_stg_inventory
[0m17:15:17.645352 [debug] [Thread-4  ]: Began running node model.ba_dbtvault.hub_order
[0m17:15:17.645624 [info ] [Thread-4  ]: 10 of 31 START sql incremental model DATA_VAULT.hub_order ...................... [RUN]
[0m17:15:17.646174 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.ba_dbtvault.hub_order'
[0m17:15:17.646498 [debug] [Thread-4  ]: Began compiling node model.ba_dbtvault.hub_order
[0m17:15:17.651912 [info ] [Thread-4  ]: 17:15:17 + Loading TEST.DATA_VAULT.hub_order from 1 source(s)
[0m17:15:17.656843 [debug] [Thread-4  ]: Writing injected SQL for node "model.ba_dbtvault.hub_order"
[0m17:15:17.657437 [debug] [Thread-4  ]: Timing info for model.ba_dbtvault.hub_order (compile): 2023-02-27 17:15:17.646871 => 2023-02-27 17:15:17.657388
[0m17:15:17.657623 [debug] [Thread-4  ]: Began executing node model.ba_dbtvault.hub_order
[0m17:15:17.661947 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.hub_order"
[0m17:15:17.662158 [debug] [Thread-4  ]: On model.ba_dbtvault.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_order"} */
create or replace  temporary view TEST.DATA_VAULT.hub_order__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DATA_VAULT.hub_order AS d
    ON a.ORDER_PK = d.ORDER_PK
    WHERE d.ORDER_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:17.662291 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m17:15:17.663879 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0 seconds
[0m17:15:17.668272 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.hub_customer"
[0m17:15:17.668630 [debug] [Thread-2  ]: On model.ba_dbtvault.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_customer"} */
describe table TEST.DATA_VAULT.hub_customer
[0m17:15:17.798178 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:17.798400 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.t_link_transactions"
[0m17:15:17.798497 [debug] [Thread-1  ]: On model.ba_dbtvault.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.t_link_transactions"} */
insert into TEST.DATA_VAULT.t_link_transactions ("TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.t_link_transactions__dbt_tmp
        );
[0m17:15:17.897402 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:17.897675 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.hub_lineitem"
[0m17:15:17.897806 [debug] [Thread-3  ]: On model.ba_dbtvault.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_lineitem"} */
insert into TEST.DATA_VAULT.hub_lineitem ("LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.hub_lineitem__dbt_tmp
        );
[0m17:15:17.998274 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0 seconds
[0m17:15:18.003889 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.hub_customer"
[0m17:15:18.004160 [debug] [Thread-2  ]: On model.ba_dbtvault.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_customer"} */
describe table "TEST"."DATA_VAULT"."HUB_CUSTOMER"
[0m17:15:18.081284 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0 seconds
[0m17:15:18.084952 [debug] [Thread-2  ]: Writing runtime sql for node "model.ba_dbtvault.hub_customer"
[0m17:15:18.086324 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.hub_customer"
[0m17:15:18.086571 [debug] [Thread-2  ]: On model.ba_dbtvault.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_customer"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:18.185217 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:18.186029 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.hub_customer"
[0m17:15:18.186321 [debug] [Thread-2  ]: On model.ba_dbtvault.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_customer"} */
insert into TEST.DATA_VAULT.hub_customer ("CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.hub_customer__dbt_tmp
        );
[0m17:15:18.843790 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:18.849504 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.hub_order"
[0m17:15:18.849780 [debug] [Thread-4  ]: On model.ba_dbtvault.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_order"} */
describe table TEST.DATA_VAULT.hub_order__dbt_tmp
[0m17:15:18.941973 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m17:15:18.951406 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.hub_order"
[0m17:15:18.951677 [debug] [Thread-4  ]: On model.ba_dbtvault.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_order"} */
describe table TEST.DATA_VAULT.hub_order
[0m17:15:19.145118 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m17:15:19.159628 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.hub_order"
[0m17:15:19.160229 [debug] [Thread-4  ]: On model.ba_dbtvault.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_order"} */
describe table "TEST"."DATA_VAULT"."HUB_ORDER"
[0m17:15:19.323631 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m17:15:19.328354 [debug] [Thread-4  ]: Writing runtime sql for node "model.ba_dbtvault.hub_order"
[0m17:15:19.329530 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.hub_order"
[0m17:15:19.329770 [debug] [Thread-4  ]: On model.ba_dbtvault.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_order"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:19.479522 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:19.481205 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.hub_order"
[0m17:15:19.481768 [debug] [Thread-4  ]: On model.ba_dbtvault.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_order"} */
insert into TEST.DATA_VAULT.hub_order ("ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.hub_order__dbt_tmp
        );
[0m17:15:22.175740 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 4 seconds
[0m17:15:22.177305 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.t_link_transactions"
[0m17:15:22.177610 [debug] [Thread-1  ]: On model.ba_dbtvault.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.t_link_transactions"} */
COMMIT
[0m17:15:22.404758 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:22.419951 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.t_link_transactions"
[0m17:15:22.420302 [debug] [Thread-1  ]: On model.ba_dbtvault.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.t_link_transactions"} */
drop view if exists TEST.DATA_VAULT.t_link_transactions__dbt_tmp cascade
[0m17:15:22.643480 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:22.655034 [debug] [Thread-1  ]: Timing info for model.ba_dbtvault.t_link_transactions (execute): 2023-02-27 17:15:16.262207 => 2023-02-27 17:15:22.654938
[0m17:15:22.655300 [debug] [Thread-1  ]: On model.ba_dbtvault.t_link_transactions: Close
[0m17:15:22.760590 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eea670>]}
[0m17:15:22.761284 [info ] [Thread-1  ]: 6 of 31 OK created sql incremental model DATA_VAULT.t_link_transactions ........ [[32mSUCCESS 0[0m in 6.51s]
[0m17:15:22.761744 [debug] [Thread-1  ]: Finished running node model.ba_dbtvault.t_link_transactions
[0m17:15:22.762121 [debug] [Thread-1  ]: Began running node model.ba_dbtvault.link_customer_nation
[0m17:15:22.762474 [info ] [Thread-1  ]: 11 of 31 START sql incremental model DATA_VAULT.link_customer_nation ........... [RUN]
[0m17:15:22.763329 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.ba_dbtvault.link_customer_nation'
[0m17:15:22.763653 [debug] [Thread-1  ]: Began compiling node model.ba_dbtvault.link_customer_nation
[0m17:15:22.770621 [info ] [Thread-1  ]: 17:15:22 + Loading TEST.DATA_VAULT.link_customer_nation from 1 source(s)
[0m17:15:22.777512 [debug] [Thread-1  ]: Writing injected SQL for node "model.ba_dbtvault.link_customer_nation"
[0m17:15:22.778286 [debug] [Thread-1  ]: Timing info for model.ba_dbtvault.link_customer_nation (compile): 2023-02-27 17:15:22.763831 => 2023-02-27 17:15:22.778232
[0m17:15:22.778483 [debug] [Thread-1  ]: Began executing node model.ba_dbtvault.link_customer_nation
[0m17:15:22.782997 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.link_customer_nation"
[0m17:15:22.783220 [debug] [Thread-1  ]: On model.ba_dbtvault.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_customer_nation"} */
create or replace  temporary view TEST.DATA_VAULT.link_customer_nation__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DATA_VAULT.link_customer_nation AS d
    ON a.LINK_CUSTOMER_NATION_PK = d.LINK_CUSTOMER_NATION_PK
    WHERE d.LINK_CUSTOMER_NATION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:22.783367 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:15:23.616474 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:23.618699 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 6 seconds
[0m17:15:23.624199 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.link_customer_nation"
[0m17:15:23.624897 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 4 seconds
[0m17:15:23.625219 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.hub_lineitem"
[0m17:15:23.625480 [debug] [Thread-1  ]: On model.ba_dbtvault.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_customer_nation"} */
describe table TEST.DATA_VAULT.link_customer_nation__dbt_tmp
[0m17:15:23.625775 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.hub_order"
[0m17:15:23.625984 [debug] [Thread-3  ]: On model.ba_dbtvault.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_lineitem"} */
COMMIT
[0m17:15:23.627327 [debug] [Thread-4  ]: On model.ba_dbtvault.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_order"} */
COMMIT
[0m17:15:23.717163 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:23.720637 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.link_customer_nation"
[0m17:15:23.720805 [debug] [Thread-1  ]: On model.ba_dbtvault.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_customer_nation"} */
describe table TEST.DATA_VAULT.link_customer_nation
[0m17:15:23.787902 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:23.792575 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.link_customer_nation"
[0m17:15:23.792789 [debug] [Thread-1  ]: On model.ba_dbtvault.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_customer_nation"} */
describe table "TEST"."DATA_VAULT"."LINK_CUSTOMER_NATION"
[0m17:15:23.905351 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:23.911366 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.hub_order"
[0m17:15:23.911665 [debug] [Thread-4  ]: On model.ba_dbtvault.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_order"} */
drop view if exists TEST.DATA_VAULT.hub_order__dbt_tmp cascade
[0m17:15:23.928962 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:23.932783 [debug] [Thread-1  ]: Writing runtime sql for node "model.ba_dbtvault.link_customer_nation"
[0m17:15:23.934293 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.link_customer_nation"
[0m17:15:23.934536 [debug] [Thread-1  ]: On model.ba_dbtvault.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_customer_nation"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:24.023992 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:24.024905 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.link_customer_nation"
[0m17:15:24.025222 [debug] [Thread-1  ]: On model.ba_dbtvault.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_customer_nation"} */
insert into TEST.DATA_VAULT.link_customer_nation ("LINK_CUSTOMER_NATION_PK", "CUSTOMER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_CUSTOMER_NATION_PK", "CUSTOMER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.link_customer_nation__dbt_tmp
        );
[0m17:15:24.087754 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:24.095599 [debug] [Thread-4  ]: Timing info for model.ba_dbtvault.hub_order (execute): 2023-02-27 17:15:17.657768 => 2023-02-27 17:15:24.095517
[0m17:15:24.095900 [debug] [Thread-4  ]: On model.ba_dbtvault.hub_order: Close
[0m17:15:24.117308 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:24.121033 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.hub_lineitem"
[0m17:15:24.121217 [debug] [Thread-3  ]: On model.ba_dbtvault.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_lineitem"} */
drop view if exists TEST.DATA_VAULT.hub_lineitem__dbt_tmp cascade
[0m17:15:24.217461 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 6 seconds
[0m17:15:24.218739 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.hub_customer"
[0m17:15:24.219287 [debug] [Thread-2  ]: On model.ba_dbtvault.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_customer"} */
COMMIT
[0m17:15:24.223378 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:24.227059 [debug] [Thread-3  ]: Timing info for model.ba_dbtvault.hub_lineitem (execute): 2023-02-27 17:15:16.508648 => 2023-02-27 17:15:24.226983
[0m17:15:24.227658 [debug] [Thread-3  ]: On model.ba_dbtvault.hub_lineitem: Close
[0m17:15:24.321717 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ee7400>]}
[0m17:15:24.322431 [info ] [Thread-4  ]: 10 of 31 OK created sql incremental model DATA_VAULT.hub_order ................. [[32mSUCCESS 0[0m in 6.68s]
[0m17:15:24.322988 [debug] [Thread-4  ]: Finished running node model.ba_dbtvault.hub_order
[0m17:15:24.323459 [debug] [Thread-4  ]: Began running node model.ba_dbtvault.link_customer_order
[0m17:15:24.324037 [info ] [Thread-4  ]: 12 of 31 START sql incremental model DATA_VAULT.link_customer_order ............ [RUN]
[0m17:15:24.324771 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.ba_dbtvault.link_customer_order'
[0m17:15:24.325067 [debug] [Thread-4  ]: Began compiling node model.ba_dbtvault.link_customer_order
[0m17:15:24.334783 [info ] [Thread-4  ]: 17:15:24 + Loading TEST.DATA_VAULT.link_customer_order from 1 source(s)
[0m17:15:24.341129 [debug] [Thread-4  ]: Writing injected SQL for node "model.ba_dbtvault.link_customer_order"
[0m17:15:24.341785 [debug] [Thread-4  ]: Timing info for model.ba_dbtvault.link_customer_order (compile): 2023-02-27 17:15:24.325257 => 2023-02-27 17:15:24.341727
[0m17:15:24.342008 [debug] [Thread-4  ]: Began executing node model.ba_dbtvault.link_customer_order
[0m17:15:24.346549 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.link_customer_order"
[0m17:15:24.346760 [debug] [Thread-4  ]: On model.ba_dbtvault.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_customer_order"} */
create or replace  temporary view TEST.DATA_VAULT.link_customer_order__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DATA_VAULT.link_customer_order AS d
    ON a.ORDER_CUSTOMER_PK = d.ORDER_CUSTOMER_PK
    WHERE d.ORDER_CUSTOMER_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:24.346910 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m17:15:24.378773 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f36e9a0>]}
[0m17:15:24.379185 [info ] [Thread-3  ]: 9 of 31 OK created sql incremental model DATA_VAULT.hub_lineitem ............... [[32mSUCCESS 0[0m in 8.02s]
[0m17:15:24.379448 [debug] [Thread-3  ]: Finished running node model.ba_dbtvault.hub_lineitem
[0m17:15:24.379664 [debug] [Thread-3  ]: Began running node model.ba_dbtvault.link_inventory_allocation
[0m17:15:24.380008 [info ] [Thread-3  ]: 13 of 31 START sql incremental model DATA_VAULT.link_inventory_allocation ...... [RUN]
[0m17:15:24.380542 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.ba_dbtvault.link_inventory_allocation'
[0m17:15:24.380708 [debug] [Thread-3  ]: Began compiling node model.ba_dbtvault.link_inventory_allocation
[0m17:15:24.385012 [info ] [Thread-3  ]: 17:15:24 + Loading TEST.DATA_VAULT.link_inventory_allocation from 1 source(s)
[0m17:15:24.390055 [debug] [Thread-3  ]: Writing injected SQL for node "model.ba_dbtvault.link_inventory_allocation"
[0m17:15:24.390672 [debug] [Thread-3  ]: Timing info for model.ba_dbtvault.link_inventory_allocation (compile): 2023-02-27 17:15:24.380813 => 2023-02-27 17:15:24.390622
[0m17:15:24.390839 [debug] [Thread-3  ]: Began executing node model.ba_dbtvault.link_inventory_allocation
[0m17:15:24.394721 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.link_inventory_allocation"
[0m17:15:24.394863 [debug] [Thread-3  ]: On model.ba_dbtvault.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_inventory_allocation"} */
create or replace  temporary view TEST.DATA_VAULT.link_inventory_allocation__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DATA_VAULT.link_inventory_allocation AS d
    ON a.INVENTORY_ALLOCATION_PK = d.INVENTORY_ALLOCATION_PK
    WHERE d.INVENTORY_ALLOCATION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:24.394980 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:15:24.664997 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:24.668207 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.hub_customer"
[0m17:15:24.668690 [debug] [Thread-2  ]: On model.ba_dbtvault.hub_customer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_customer"} */
drop view if exists TEST.DATA_VAULT.hub_customer__dbt_tmp cascade
[0m17:15:24.758687 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:24.761016 [debug] [Thread-2  ]: Timing info for model.ba_dbtvault.hub_customer (execute): 2023-02-27 17:15:16.504565 => 2023-02-27 17:15:24.760949
[0m17:15:24.761259 [debug] [Thread-2  ]: On model.ba_dbtvault.hub_customer: Close
[0m17:15:24.917185 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f36e670>]}
[0m17:15:24.917944 [info ] [Thread-2  ]: 8 of 31 OK created sql incremental model DATA_VAULT.hub_customer ............... [[32mSUCCESS 0[0m in 8.56s]
[0m17:15:24.918501 [debug] [Thread-2  ]: Finished running node model.ba_dbtvault.hub_customer
[0m17:15:24.918969 [debug] [Thread-2  ]: Began running node model.ba_dbtvault.link_order_lineitem
[0m17:15:24.919518 [info ] [Thread-2  ]: 14 of 31 START sql incremental model DATA_VAULT.link_order_lineitem ............ [RUN]
[0m17:15:24.920301 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.ba_dbtvault.link_order_lineitem'
[0m17:15:24.920615 [debug] [Thread-2  ]: Began compiling node model.ba_dbtvault.link_order_lineitem
[0m17:15:24.928425 [info ] [Thread-2  ]: 17:15:24 + Loading TEST.DATA_VAULT.link_order_lineitem from 1 source(s)
[0m17:15:24.935053 [debug] [Thread-2  ]: Writing injected SQL for node "model.ba_dbtvault.link_order_lineitem"
[0m17:15:24.935718 [debug] [Thread-2  ]: Timing info for model.ba_dbtvault.link_order_lineitem (compile): 2023-02-27 17:15:24.920817 => 2023-02-27 17:15:24.935665
[0m17:15:24.935923 [debug] [Thread-2  ]: Began executing node model.ba_dbtvault.link_order_lineitem
[0m17:15:24.940620 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.link_order_lineitem"
[0m17:15:24.940835 [debug] [Thread-2  ]: On model.ba_dbtvault.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_order_lineitem"} */
create or replace  temporary view TEST.DATA_VAULT.link_order_lineitem__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DATA_VAULT.link_order_lineitem AS d
    ON a.LINK_LINEITEM_ORDER_PK = d.LINK_LINEITEM_ORDER_PK
    WHERE d.LINK_LINEITEM_ORDER_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:24.940980 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:15:24.946970 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:24.986477 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.link_inventory_allocation"
[0m17:15:24.986878 [debug] [Thread-3  ]: On model.ba_dbtvault.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_inventory_allocation"} */
describe table TEST.DATA_VAULT.link_inventory_allocation__dbt_tmp
[0m17:15:25.084014 [debug] [Thread-3  ]: SQL status: SUCCESS 6 in 0 seconds
[0m17:15:25.092489 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.link_inventory_allocation"
[0m17:15:25.092603 [debug] [Thread-3  ]: On model.ba_dbtvault.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_inventory_allocation"} */
describe table TEST.DATA_VAULT.link_inventory_allocation
[0m17:15:25.181974 [debug] [Thread-3  ]: SQL status: SUCCESS 6 in 0 seconds
[0m17:15:25.184490 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.link_inventory_allocation"
[0m17:15:25.184610 [debug] [Thread-3  ]: On model.ba_dbtvault.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_inventory_allocation"} */
describe table "TEST"."DATA_VAULT"."LINK_INVENTORY_ALLOCATION"
[0m17:15:25.259292 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:25.262128 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.link_customer_order"
[0m17:15:25.262323 [debug] [Thread-4  ]: On model.ba_dbtvault.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_customer_order"} */
describe table TEST.DATA_VAULT.link_customer_order__dbt_tmp
[0m17:15:25.263170 [debug] [Thread-3  ]: SQL status: SUCCESS 6 in 0 seconds
[0m17:15:25.265691 [debug] [Thread-3  ]: Writing runtime sql for node "model.ba_dbtvault.link_inventory_allocation"
[0m17:15:25.266554 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.link_inventory_allocation"
[0m17:15:25.266829 [debug] [Thread-3  ]: On model.ba_dbtvault.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_inventory_allocation"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:25.349014 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:25.349373 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.link_inventory_allocation"
[0m17:15:25.349581 [debug] [Thread-3  ]: On model.ba_dbtvault.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_inventory_allocation"} */
insert into TEST.DATA_VAULT.link_inventory_allocation ("INVENTORY_ALLOCATION_PK", "PART_PK", "SUPPLIER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_ALLOCATION_PK", "PART_PK", "SUPPLIER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.link_inventory_allocation__dbt_tmp
        );
[0m17:15:25.446679 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:25.451938 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.link_customer_order"
[0m17:15:25.452549 [debug] [Thread-4  ]: On model.ba_dbtvault.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_customer_order"} */
describe table TEST.DATA_VAULT.link_customer_order
[0m17:15:25.552789 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:25.558248 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.link_customer_order"
[0m17:15:25.558576 [debug] [Thread-4  ]: On model.ba_dbtvault.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_customer_order"} */
describe table "TEST"."DATA_VAULT"."LINK_CUSTOMER_ORDER"
[0m17:15:25.640402 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:25.649102 [debug] [Thread-4  ]: Writing runtime sql for node "model.ba_dbtvault.link_customer_order"
[0m17:15:25.650855 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.link_customer_order"
[0m17:15:25.651143 [debug] [Thread-4  ]: On model.ba_dbtvault.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_customer_order"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:25.727970 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:25.729328 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.link_customer_order"
[0m17:15:25.729670 [debug] [Thread-4  ]: On model.ba_dbtvault.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_customer_order"} */
insert into TEST.DATA_VAULT.link_customer_order ("ORDER_CUSTOMER_PK", "CUSTOMER_PK", "ORDER_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_CUSTOMER_PK", "CUSTOMER_PK", "ORDER_PK", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.link_customer_order__dbt_tmp
        );
[0m17:15:25.872501 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:25.879113 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.link_order_lineitem"
[0m17:15:25.879493 [debug] [Thread-2  ]: On model.ba_dbtvault.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_order_lineitem"} */
describe table TEST.DATA_VAULT.link_order_lineitem__dbt_tmp
[0m17:15:25.974197 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:25.981780 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.link_order_lineitem"
[0m17:15:25.982091 [debug] [Thread-2  ]: On model.ba_dbtvault.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_order_lineitem"} */
describe table TEST.DATA_VAULT.link_order_lineitem
[0m17:15:25.983944 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 2 seconds
[0m17:15:25.984376 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.link_customer_nation"
[0m17:15:25.984578 [debug] [Thread-1  ]: On model.ba_dbtvault.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_customer_nation"} */
COMMIT
[0m17:15:26.078232 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:26.084389 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.link_order_lineitem"
[0m17:15:26.084627 [debug] [Thread-2  ]: On model.ba_dbtvault.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_order_lineitem"} */
describe table "TEST"."DATA_VAULT"."LINK_ORDER_LINEITEM"
[0m17:15:26.196777 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:26.201830 [debug] [Thread-2  ]: Writing runtime sql for node "model.ba_dbtvault.link_order_lineitem"
[0m17:15:26.203427 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.link_order_lineitem"
[0m17:15:26.203707 [debug] [Thread-2  ]: On model.ba_dbtvault.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_order_lineitem"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:26.225251 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:26.232914 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.link_customer_nation"
[0m17:15:26.233208 [debug] [Thread-1  ]: On model.ba_dbtvault.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_customer_nation"} */
drop view if exists TEST.DATA_VAULT.link_customer_nation__dbt_tmp cascade
[0m17:15:26.303453 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:26.304854 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.link_order_lineitem"
[0m17:15:26.305397 [debug] [Thread-2  ]: On model.ba_dbtvault.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_order_lineitem"} */
insert into TEST.DATA_VAULT.link_order_lineitem ("LINK_LINEITEM_ORDER_PK", "ORDER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_LINEITEM_ORDER_PK", "ORDER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.link_order_lineitem__dbt_tmp
        );
[0m17:15:26.366538 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:26.373885 [debug] [Thread-1  ]: Timing info for model.ba_dbtvault.link_customer_nation (execute): 2023-02-27 17:15:22.778603 => 2023-02-27 17:15:26.373697
[0m17:15:26.374697 [debug] [Thread-1  ]: On model.ba_dbtvault.link_customer_nation: Close
[0m17:15:26.534636 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d260d0>]}
[0m17:15:26.535305 [info ] [Thread-1  ]: 11 of 31 OK created sql incremental model DATA_VAULT.link_customer_nation ...... [[32mSUCCESS 0[0m in 3.77s]
[0m17:15:26.535788 [debug] [Thread-1  ]: Finished running node model.ba_dbtvault.link_customer_nation
[0m17:15:26.536196 [debug] [Thread-1  ]: Began running node model.ba_dbtvault.sat_order_cust_nation_details
[0m17:15:26.536737 [info ] [Thread-1  ]: 15 of 31 START sql incremental model DATA_VAULT.sat_order_cust_nation_details .. [RUN]
[0m17:15:26.537608 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.ba_dbtvault.sat_order_cust_nation_details'
[0m17:15:26.537909 [debug] [Thread-1  ]: Began compiling node model.ba_dbtvault.sat_order_cust_nation_details
[0m17:15:26.557436 [debug] [Thread-1  ]: Writing injected SQL for node "model.ba_dbtvault.sat_order_cust_nation_details"
[0m17:15:26.558182 [debug] [Thread-1  ]: Timing info for model.ba_dbtvault.sat_order_cust_nation_details (compile): 2023-02-27 17:15:26.538118 => 2023-02-27 17:15:26.558131
[0m17:15:26.558379 [debug] [Thread-1  ]: Began executing node model.ba_dbtvault.sat_order_cust_nation_details
[0m17:15:26.562970 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_order_cust_nation_details"
[0m17:15:26.563145 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_cust_nation_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_order_cust_nation_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.CUSTOMER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_order_cust_nation_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
        AND latest_records.CUSTOMER_NATION_HASHDIFF = stage.CUSTOMER_NATION_HASHDIFF
    WHERE latest_records.CUSTOMER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:26.563277 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:15:27.291143 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:27.300145 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_order_cust_nation_details"
[0m17:15:27.300508 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_cust_nation_details"} */
describe table TEST.DATA_VAULT.sat_order_cust_nation_details__dbt_tmp
[0m17:15:27.380968 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m17:15:27.393046 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_order_cust_nation_details"
[0m17:15:27.393345 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_cust_nation_details"} */
describe table TEST.DATA_VAULT.sat_order_cust_nation_details
[0m17:15:27.467141 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m17:15:27.476926 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_order_cust_nation_details"
[0m17:15:27.477148 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_cust_nation_details"} */
describe table "TEST"."DATA_VAULT"."SAT_ORDER_CUST_NATION_DETAILS"
[0m17:15:27.572693 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m17:15:27.579213 [debug] [Thread-1  ]: Writing runtime sql for node "model.ba_dbtvault.sat_order_cust_nation_details"
[0m17:15:27.580675 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 2 seconds
[0m17:15:27.581070 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.link_customer_order"
[0m17:15:27.581312 [debug] [Thread-4  ]: On model.ba_dbtvault.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_customer_order"} */
COMMIT
[0m17:15:27.583098 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_order_cust_nation_details"
[0m17:15:27.583412 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_cust_nation_details"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:27.676316 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:27.677783 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_order_cust_nation_details"
[0m17:15:27.678344 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_cust_nation_details"} */
insert into TEST.DATA_VAULT.sat_order_cust_nation_details ("CUSTOMER_PK", "CUSTOMER_NATION_HASHDIFF", "CUSTOMER_NATION_NAME", "CUSTOMER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_NATION_HASHDIFF", "CUSTOMER_NATION_NAME", "CUSTOMER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_order_cust_nation_details__dbt_tmp
        );
[0m17:15:27.818934 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:27.829274 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.link_customer_order"
[0m17:15:27.829577 [debug] [Thread-4  ]: On model.ba_dbtvault.link_customer_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_customer_order"} */
drop view if exists TEST.DATA_VAULT.link_customer_order__dbt_tmp cascade
[0m17:15:27.942656 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:27.950557 [debug] [Thread-4  ]: Timing info for model.ba_dbtvault.link_customer_order (execute): 2023-02-27 17:15:24.342145 => 2023-02-27 17:15:27.950384
[0m17:15:27.951179 [debug] [Thread-4  ]: On model.ba_dbtvault.link_customer_order: Close
[0m17:15:28.063514 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f788c10>]}
[0m17:15:28.064116 [info ] [Thread-4  ]: 12 of 31 OK created sql incremental model DATA_VAULT.link_customer_order ....... [[32mSUCCESS 0[0m in 3.74s]
[0m17:15:28.064523 [debug] [Thread-4  ]: Finished running node model.ba_dbtvault.link_customer_order
[0m17:15:28.064861 [debug] [Thread-4  ]: Began running node model.ba_dbtvault.sat_order_cust_region_details
[0m17:15:28.065289 [info ] [Thread-4  ]: 16 of 31 START sql incremental model DATA_VAULT.sat_order_cust_region_details .. [RUN]
[0m17:15:28.065939 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.ba_dbtvault.sat_order_cust_region_details'
[0m17:15:28.066186 [debug] [Thread-4  ]: Began compiling node model.ba_dbtvault.sat_order_cust_region_details
[0m17:15:28.084488 [debug] [Thread-4  ]: Writing injected SQL for node "model.ba_dbtvault.sat_order_cust_region_details"
[0m17:15:28.085156 [debug] [Thread-4  ]: Timing info for model.ba_dbtvault.sat_order_cust_region_details (compile): 2023-02-27 17:15:28.066348 => 2023-02-27 17:15:28.085109
[0m17:15:28.085347 [debug] [Thread-4  ]: Began executing node model.ba_dbtvault.sat_order_cust_region_details
[0m17:15:28.090991 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.sat_order_cust_region_details"
[0m17:15:28.091162 [debug] [Thread-4  ]: On model.ba_dbtvault.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_cust_region_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_order_cust_region_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_REGION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.CUSTOMER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_order_cust_region_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
        AND latest_records.CUSTOMER_REGION_HASHDIFF = stage.CUSTOMER_REGION_HASHDIFF
    WHERE latest_records.CUSTOMER_REGION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:28.091289 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m17:15:28.147457 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 3 seconds
[0m17:15:28.147761 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.link_inventory_allocation"
[0m17:15:28.147912 [debug] [Thread-3  ]: On model.ba_dbtvault.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_inventory_allocation"} */
COMMIT
[0m17:15:28.312213 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 2 seconds
[0m17:15:28.312420 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.link_order_lineitem"
[0m17:15:28.312518 [debug] [Thread-2  ]: On model.ba_dbtvault.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_order_lineitem"} */
COMMIT
[0m17:15:28.376751 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:28.379556 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.link_inventory_allocation"
[0m17:15:28.379697 [debug] [Thread-3  ]: On model.ba_dbtvault.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_inventory_allocation"} */
drop view if exists TEST.DATA_VAULT.link_inventory_allocation__dbt_tmp cascade
[0m17:15:28.457654 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:28.459817 [debug] [Thread-3  ]: Timing info for model.ba_dbtvault.link_inventory_allocation (execute): 2023-02-27 17:15:24.390935 => 2023-02-27 17:15:28.459761
[0m17:15:28.460043 [debug] [Thread-3  ]: On model.ba_dbtvault.link_inventory_allocation: Close
[0m17:15:28.561927 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099d9790>]}
[0m17:15:28.562520 [info ] [Thread-3  ]: 13 of 31 OK created sql incremental model DATA_VAULT.link_inventory_allocation . [[32mSUCCESS 0[0m in 4.18s]
[0m17:15:28.562921 [debug] [Thread-3  ]: Finished running node model.ba_dbtvault.link_inventory_allocation
[0m17:15:28.563271 [debug] [Thread-3  ]: Began running node model.ba_dbtvault.sat_order_customer_details
[0m17:15:28.563714 [info ] [Thread-3  ]: 17 of 31 START sql incremental model DATA_VAULT.sat_order_customer_details ..... [RUN]
[0m17:15:28.564424 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.ba_dbtvault.sat_order_customer_details'
[0m17:15:28.564650 [debug] [Thread-3  ]: Began compiling node model.ba_dbtvault.sat_order_customer_details
[0m17:15:28.583198 [debug] [Thread-3  ]: Writing injected SQL for node "model.ba_dbtvault.sat_order_customer_details"
[0m17:15:28.583822 [debug] [Thread-3  ]: Timing info for model.ba_dbtvault.sat_order_customer_details (compile): 2023-02-27 17:15:28.564796 => 2023-02-27 17:15:28.583775
[0m17:15:28.583995 [debug] [Thread-3  ]: Began executing node model.ba_dbtvault.sat_order_customer_details
[0m17:15:28.589525 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.sat_order_customer_details"
[0m17:15:28.589738 [debug] [Thread-3  ]: On model.ba_dbtvault.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_customer_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_order_customer_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.CUSTOMER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_order_customer_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
        AND latest_records.CUSTOMER_HASHDIFF = stage.CUSTOMER_HASHDIFF
    WHERE latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:28.589861 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:15:28.704345 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:28.712580 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.link_order_lineitem"
[0m17:15:28.712693 [debug] [Thread-2  ]: On model.ba_dbtvault.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_order_lineitem"} */
drop view if exists TEST.DATA_VAULT.link_order_lineitem__dbt_tmp cascade
[0m17:15:28.917940 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:28.920932 [debug] [Thread-2  ]: Timing info for model.ba_dbtvault.link_order_lineitem (execute): 2023-02-27 17:15:24.936065 => 2023-02-27 17:15:28.920843
[0m17:15:28.921259 [debug] [Thread-2  ]: On model.ba_dbtvault.link_order_lineitem: Close
[0m17:15:29.058382 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f36e3d0>]}
[0m17:15:29.059405 [info ] [Thread-2  ]: 14 of 31 OK created sql incremental model DATA_VAULT.link_order_lineitem ....... [[32mSUCCESS 0[0m in 4.14s]
[0m17:15:29.060131 [debug] [Thread-2  ]: Finished running node model.ba_dbtvault.link_order_lineitem
[0m17:15:29.060926 [debug] [Thread-2  ]: Began running node model.ba_dbtvault.sat_order_lineitem_details
[0m17:15:29.061595 [info ] [Thread-2  ]: 18 of 31 START sql incremental model DATA_VAULT.sat_order_lineitem_details ..... [RUN]
[0m17:15:29.062859 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.ba_dbtvault.sat_order_lineitem_details'
[0m17:15:29.063494 [debug] [Thread-2  ]: Began compiling node model.ba_dbtvault.sat_order_lineitem_details
[0m17:15:29.089644 [debug] [Thread-2  ]: Writing injected SQL for node "model.ba_dbtvault.sat_order_lineitem_details"
[0m17:15:29.090415 [debug] [Thread-2  ]: Timing info for model.ba_dbtvault.sat_order_lineitem_details (compile): 2023-02-27 17:15:29.063723 => 2023-02-27 17:15:29.090363
[0m17:15:29.090619 [debug] [Thread-2  ]: Began executing node model.ba_dbtvault.sat_order_lineitem_details
[0m17:15:29.096322 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.sat_order_lineitem_details"
[0m17:15:29.096518 [debug] [Thread-2  ]: On model.ba_dbtvault.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_lineitem_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_order_lineitem_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_orders AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

latest_records AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.LINEITEM_PK, current_records.LINEITEM_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.LINEITEM_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_order_lineitem_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.LINEITEM_PK
                FROM source_data
            ) AS source_records
                ON current_records.LINEITEM_PK = source_records.LINEITEM_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.LINEITEM_PK = stage.LINEITEM_PK
        AND latest_records.LINEITEM_HASHDIFF = stage.LINEITEM_HASHDIFF
    WHERE latest_records.LINEITEM_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:29.096647 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:15:29.545089 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:29.553143 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.sat_order_customer_details"
[0m17:15:29.553465 [debug] [Thread-3  ]: On model.ba_dbtvault.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_customer_details"} */
describe table TEST.DATA_VAULT.sat_order_customer_details__dbt_tmp
[0m17:15:29.635366 [debug] [Thread-3  ]: SQL status: SUCCESS 11 in 0 seconds
[0m17:15:29.641775 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.sat_order_customer_details"
[0m17:15:29.642034 [debug] [Thread-3  ]: On model.ba_dbtvault.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_customer_details"} */
describe table TEST.DATA_VAULT.sat_order_customer_details
[0m17:15:30.059197 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m17:15:30.065165 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.sat_order_cust_region_details"
[0m17:15:30.066062 [debug] [Thread-4  ]: On model.ba_dbtvault.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_cust_region_details"} */
describe table TEST.DATA_VAULT.sat_order_cust_region_details__dbt_tmp
[0m17:15:30.066795 [debug] [Thread-3  ]: SQL status: SUCCESS 11 in 0 seconds
[0m17:15:30.072678 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.sat_order_customer_details"
[0m17:15:30.072976 [debug] [Thread-3  ]: On model.ba_dbtvault.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_customer_details"} */
describe table "TEST"."DATA_VAULT"."SAT_ORDER_CUSTOMER_DETAILS"
[0m17:15:30.206257 [debug] [Thread-3  ]: SQL status: SUCCESS 11 in 0 seconds
[0m17:15:30.211741 [debug] [Thread-3  ]: Writing runtime sql for node "model.ba_dbtvault.sat_order_customer_details"
[0m17:15:30.213350 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.sat_order_customer_details"
[0m17:15:30.213600 [debug] [Thread-3  ]: On model.ba_dbtvault.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_customer_details"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:30.221000 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0 seconds
[0m17:15:30.225931 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.sat_order_cust_region_details"
[0m17:15:30.226142 [debug] [Thread-4  ]: On model.ba_dbtvault.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_cust_region_details"} */
describe table TEST.DATA_VAULT.sat_order_cust_region_details
[0m17:15:30.290190 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:30.298393 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.sat_order_lineitem_details"
[0m17:15:30.298764 [debug] [Thread-2  ]: On model.ba_dbtvault.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_lineitem_details"} */
describe table TEST.DATA_VAULT.sat_order_lineitem_details__dbt_tmp
[0m17:15:30.320070 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0 seconds
[0m17:15:30.326024 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.sat_order_cust_region_details"
[0m17:15:30.326274 [debug] [Thread-4  ]: On model.ba_dbtvault.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_cust_region_details"} */
describe table "TEST"."DATA_VAULT"."SAT_ORDER_CUST_REGION_DETAILS"
[0m17:15:30.392424 [debug] [Thread-2  ]: SQL status: SUCCESS 16 in 0 seconds
[0m17:15:30.399911 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.sat_order_lineitem_details"
[0m17:15:30.400229 [debug] [Thread-2  ]: On model.ba_dbtvault.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_lineitem_details"} */
describe table TEST.DATA_VAULT.sat_order_lineitem_details
[0m17:15:30.401751 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0 seconds
[0m17:15:30.405279 [debug] [Thread-4  ]: Writing runtime sql for node "model.ba_dbtvault.sat_order_cust_region_details"
[0m17:15:30.406552 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.sat_order_cust_region_details"
[0m17:15:30.406746 [debug] [Thread-4  ]: On model.ba_dbtvault.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_cust_region_details"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:30.454440 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:30.454849 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.sat_order_customer_details"
[0m17:15:30.455059 [debug] [Thread-3  ]: On model.ba_dbtvault.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_customer_details"} */
insert into TEST.DATA_VAULT.sat_order_customer_details ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_order_customer_details__dbt_tmp
        );
[0m17:15:30.477302 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:30.477585 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.sat_order_cust_region_details"
[0m17:15:30.477728 [debug] [Thread-4  ]: On model.ba_dbtvault.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_cust_region_details"} */
insert into TEST.DATA_VAULT.sat_order_cust_region_details ("CUSTOMER_PK", "CUSTOMER_REGION_HASHDIFF", "CUSTOMER_REGION_NAME", "CUSTOMER_REGION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_REGION_HASHDIFF", "CUSTOMER_REGION_NAME", "CUSTOMER_REGION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_order_cust_region_details__dbt_tmp
        );
[0m17:15:30.486461 [debug] [Thread-2  ]: SQL status: SUCCESS 16 in 0 seconds
[0m17:15:30.492038 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.sat_order_lineitem_details"
[0m17:15:30.492247 [debug] [Thread-2  ]: On model.ba_dbtvault.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_lineitem_details"} */
describe table "TEST"."DATA_VAULT"."SAT_ORDER_LINEITEM_DETAILS"
[0m17:15:30.595965 [debug] [Thread-2  ]: SQL status: SUCCESS 16 in 0 seconds
[0m17:15:30.599894 [debug] [Thread-2  ]: Writing runtime sql for node "model.ba_dbtvault.sat_order_lineitem_details"
[0m17:15:30.601049 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.sat_order_lineitem_details"
[0m17:15:30.601248 [debug] [Thread-2  ]: On model.ba_dbtvault.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_lineitem_details"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:30.852220 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:30.853540 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.sat_order_lineitem_details"
[0m17:15:30.853951 [debug] [Thread-2  ]: On model.ba_dbtvault.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_lineitem_details"} */
insert into TEST.DATA_VAULT.sat_order_lineitem_details ("LINEITEM_PK", "LINEITEM_HASHDIFF", "COMMITDATE", "DISCOUNT", "EXTENDEDPRICE", "LINE_COMMENT", "QUANTITY", "RECEIPTDATE", "RETURNFLAG", "SHIPDATE", "SHIPINSTRUCT", "SHIPMODE", "TAX", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINEITEM_HASHDIFF", "COMMITDATE", "DISCOUNT", "EXTENDEDPRICE", "LINE_COMMENT", "QUANTITY", "RECEIPTDATE", "RETURNFLAG", "SHIPDATE", "SHIPINSTRUCT", "SHIPMODE", "TAX", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_order_lineitem_details__dbt_tmp
        );
[0m17:15:31.387412 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 4 seconds
[0m17:15:31.388421 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_order_cust_nation_details"
[0m17:15:31.388945 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_cust_nation_details"} */
COMMIT
[0m17:15:31.613536 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:31.625987 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_order_cust_nation_details"
[0m17:15:31.626433 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_cust_nation_details"} */
drop view if exists TEST.DATA_VAULT.sat_order_cust_nation_details__dbt_tmp cascade
[0m17:15:31.778995 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:31.785929 [debug] [Thread-1  ]: Timing info for model.ba_dbtvault.sat_order_cust_nation_details (execute): 2023-02-27 17:15:26.558502 => 2023-02-27 17:15:31.785727
[0m17:15:31.786502 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_order_cust_nation_details: Close
[0m17:15:32.580098 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 2 seconds
[0m17:15:32.581336 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.sat_order_cust_region_details"
[0m17:15:32.581772 [debug] [Thread-4  ]: On model.ba_dbtvault.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_cust_region_details"} */
COMMIT
[0m17:15:32.585111 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3817c0>]}
[0m17:15:32.585951 [info ] [Thread-1  ]: 15 of 31 OK created sql incremental model DATA_VAULT.sat_order_cust_nation_details  [[32mSUCCESS 0[0m in 6.05s]
[0m17:15:32.586924 [debug] [Thread-1  ]: Finished running node model.ba_dbtvault.sat_order_cust_nation_details
[0m17:15:32.587354 [debug] [Thread-1  ]: Began running node model.ba_dbtvault.sat_order_order_details
[0m17:15:32.588106 [info ] [Thread-1  ]: 19 of 31 START sql incremental model DATA_VAULT.sat_order_order_details ........ [RUN]
[0m17:15:32.588917 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.ba_dbtvault.sat_order_order_details'
[0m17:15:32.589317 [debug] [Thread-1  ]: Began compiling node model.ba_dbtvault.sat_order_order_details
[0m17:15:32.612205 [debug] [Thread-1  ]: Writing injected SQL for node "model.ba_dbtvault.sat_order_order_details"
[0m17:15:32.613124 [debug] [Thread-1  ]: Timing info for model.ba_dbtvault.sat_order_order_details (compile): 2023-02-27 17:15:32.589515 => 2023-02-27 17:15:32.613062
[0m17:15:32.613362 [debug] [Thread-1  ]: Began executing node model.ba_dbtvault.sat_order_order_details
[0m17:15:32.618478 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_order_order_details"
[0m17:15:32.618703 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_order_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_order_order_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_orders AS a
    WHERE a.ORDER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.ORDER_PK, current_records.ORDER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.ORDER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_order_order_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.ORDER_PK
                FROM source_data
            ) AS source_records
                ON current_records.ORDER_PK = source_records.ORDER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.ORDER_PK = stage.ORDER_PK
        AND latest_records.ORDER_HASHDIFF = stage.ORDER_HASHDIFF
    WHERE latest_records.ORDER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:32.618842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:15:32.845545 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:32.847949 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.sat_order_cust_region_details"
[0m17:15:32.848076 [debug] [Thread-4  ]: On model.ba_dbtvault.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_cust_region_details"} */
drop view if exists TEST.DATA_VAULT.sat_order_cust_region_details__dbt_tmp cascade
[0m17:15:32.931345 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:32.933075 [debug] [Thread-4  ]: Timing info for model.ba_dbtvault.sat_order_cust_region_details (execute): 2023-02-27 17:15:28.085475 => 2023-02-27 17:15:32.933029
[0m17:15:32.933264 [debug] [Thread-4  ]: On model.ba_dbtvault.sat_order_cust_region_details: Close
[0m17:15:33.022915 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f507460>]}
[0m17:15:33.023566 [info ] [Thread-4  ]: 16 of 31 OK created sql incremental model DATA_VAULT.sat_order_cust_region_details  [[32mSUCCESS 0[0m in 4.96s]
[0m17:15:33.024020 [debug] [Thread-4  ]: Finished running node model.ba_dbtvault.sat_order_cust_region_details
[0m17:15:33.024365 [debug] [Thread-4  ]: Began running node model.ba_dbtvault.hub_nation
[0m17:15:33.024667 [info ] [Thread-4  ]: 20 of 31 START sql incremental model DATA_VAULT.hub_nation ..................... [RUN]
[0m17:15:33.025255 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.ba_dbtvault.hub_nation'
[0m17:15:33.025637 [debug] [Thread-4  ]: Began compiling node model.ba_dbtvault.hub_nation
[0m17:15:33.032218 [info ] [Thread-4  ]: 17:15:33 + Loading TEST.DATA_VAULT.hub_nation from 2 source(s)
[0m17:15:33.039752 [debug] [Thread-4  ]: Writing injected SQL for node "model.ba_dbtvault.hub_nation"
[0m17:15:33.040474 [debug] [Thread-4  ]: Timing info for model.ba_dbtvault.hub_nation (compile): 2023-02-27 17:15:33.025850 => 2023-02-27 17:15:33.040398
[0m17:15:33.040740 [debug] [Thread-4  ]: Began executing node model.ba_dbtvault.hub_nation
[0m17:15:33.046035 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.hub_nation"
[0m17:15:33.046211 [debug] [Thread-4  ]: On model.ba_dbtvault.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_nation"} */
create or replace  temporary view TEST.DATA_VAULT.hub_nation__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN TEST.DATA_VAULT.hub_nation AS d
    ON a.NATION_PK = d.NATION_PK
    WHERE d.NATION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:33.046346 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m17:15:33.285587 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:33.289606 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_order_order_details"
[0m17:15:33.289798 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_order_details"} */
describe table TEST.DATA_VAULT.sat_order_order_details__dbt_tmp
[0m17:15:33.449859 [debug] [Thread-1  ]: SQL status: SUCCESS 12 in 0 seconds
[0m17:15:33.459103 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_order_order_details"
[0m17:15:33.459413 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_order_details"} */
describe table TEST.DATA_VAULT.sat_order_order_details
[0m17:15:33.533996 [debug] [Thread-1  ]: SQL status: SUCCESS 12 in 0 seconds
[0m17:15:33.546428 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_order_order_details"
[0m17:15:33.546981 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_order_details"} */
describe table "TEST"."DATA_VAULT"."SAT_ORDER_ORDER_DETAILS"
[0m17:15:33.646728 [debug] [Thread-1  ]: SQL status: SUCCESS 12 in 0 seconds
[0m17:15:33.650749 [debug] [Thread-1  ]: Writing runtime sql for node "model.ba_dbtvault.sat_order_order_details"
[0m17:15:33.652011 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_order_order_details"
[0m17:15:33.652189 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:33.737377 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:33.737707 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_order_order_details"
[0m17:15:33.737866 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_order_details"} */
insert into TEST.DATA_VAULT.sat_order_order_details ("ORDER_PK", "ORDER_HASHDIFF", "ORDERSTATUS", "TOTALPRICE", "ORDERDATE", "ORDERPRIORITY", "CLERK", "SHIPPRIORITY", "ORDER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDER_HASHDIFF", "ORDERSTATUS", "TOTALPRICE", "ORDERDATE", "ORDERPRIORITY", "CLERK", "SHIPPRIORITY", "ORDER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_order_order_details__dbt_tmp
        );
[0m17:15:33.782422 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:33.785966 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.hub_nation"
[0m17:15:33.786169 [debug] [Thread-4  ]: On model.ba_dbtvault.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_nation"} */
describe table TEST.DATA_VAULT.hub_nation__dbt_tmp
[0m17:15:33.854491 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m17:15:33.864386 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.hub_nation"
[0m17:15:33.864674 [debug] [Thread-4  ]: On model.ba_dbtvault.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_nation"} */
describe table TEST.DATA_VAULT.hub_nation
[0m17:15:33.994703 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m17:15:34.002055 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.hub_nation"
[0m17:15:34.002385 [debug] [Thread-4  ]: On model.ba_dbtvault.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_nation"} */
describe table "TEST"."DATA_VAULT"."HUB_NATION"
[0m17:15:34.092252 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0 seconds
[0m17:15:34.106365 [debug] [Thread-4  ]: Writing runtime sql for node "model.ba_dbtvault.hub_nation"
[0m17:15:34.107736 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.hub_nation"
[0m17:15:34.107945 [debug] [Thread-4  ]: On model.ba_dbtvault.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_nation"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:34.214007 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:34.214525 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.hub_nation"
[0m17:15:34.214779 [debug] [Thread-4  ]: On model.ba_dbtvault.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_nation"} */
insert into TEST.DATA_VAULT.hub_nation ("NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.hub_nation__dbt_tmp
        );
[0m17:15:34.884406 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 4 seconds
[0m17:15:34.885922 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.sat_order_customer_details"
[0m17:15:34.886470 [debug] [Thread-3  ]: On model.ba_dbtvault.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_customer_details"} */
COMMIT
[0m17:15:35.643973 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:35.649992 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.sat_order_customer_details"
[0m17:15:35.650265 [debug] [Thread-3  ]: On model.ba_dbtvault.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_customer_details"} */
drop view if exists TEST.DATA_VAULT.sat_order_customer_details__dbt_tmp cascade
[0m17:15:35.739939 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:35.746871 [debug] [Thread-3  ]: Timing info for model.ba_dbtvault.sat_order_customer_details (execute): 2023-02-27 17:15:28.584101 => 2023-02-27 17:15:35.746774
[0m17:15:35.747283 [debug] [Thread-3  ]: On model.ba_dbtvault.sat_order_customer_details: Close
[0m17:15:36.072305 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5072e0>]}
[0m17:15:36.074064 [info ] [Thread-3  ]: 17 of 31 OK created sql incremental model DATA_VAULT.sat_order_customer_details  [[32mSUCCESS 0[0m in 7.51s]
[0m17:15:36.074744 [debug] [Thread-3  ]: Finished running node model.ba_dbtvault.sat_order_customer_details
[0m17:15:36.075216 [debug] [Thread-3  ]: Began running node model.ba_dbtvault.hub_part
[0m17:15:36.075772 [info ] [Thread-3  ]: 21 of 31 START sql incremental model DATA_VAULT.hub_part ....................... [RUN]
[0m17:15:36.076619 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.ba_dbtvault.hub_part'
[0m17:15:36.076935 [debug] [Thread-3  ]: Began compiling node model.ba_dbtvault.hub_part
[0m17:15:36.084423 [info ] [Thread-3  ]: 17:15:36 + Loading TEST.DATA_VAULT.hub_part from 2 source(s)
[0m17:15:36.092732 [debug] [Thread-3  ]: Writing injected SQL for node "model.ba_dbtvault.hub_part"
[0m17:15:36.093526 [debug] [Thread-3  ]: Timing info for model.ba_dbtvault.hub_part (compile): 2023-02-27 17:15:36.077137 => 2023-02-27 17:15:36.093444
[0m17:15:36.093772 [debug] [Thread-3  ]: Began executing node model.ba_dbtvault.hub_part
[0m17:15:36.098917 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.hub_part"
[0m17:15:36.099186 [debug] [Thread-3  ]: On model.ba_dbtvault.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_part"} */
create or replace  temporary view TEST.DATA_VAULT.hub_part__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN TEST.DATA_VAULT.hub_part AS d
    ON a.PART_PK = d.PART_PK
    WHERE d.PART_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:36.099350 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:15:37.124225 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:37.132199 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.hub_part"
[0m17:15:37.132483 [debug] [Thread-3  ]: On model.ba_dbtvault.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_part"} */
describe table TEST.DATA_VAULT.hub_part__dbt_tmp
[0m17:15:37.216470 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m17:15:37.226208 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.hub_part"
[0m17:15:37.226462 [debug] [Thread-3  ]: On model.ba_dbtvault.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_part"} */
describe table TEST.DATA_VAULT.hub_part
[0m17:15:37.287882 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m17:15:37.292655 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.hub_part"
[0m17:15:37.292893 [debug] [Thread-3  ]: On model.ba_dbtvault.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_part"} */
describe table "TEST"."DATA_VAULT"."HUB_PART"
[0m17:15:37.314090 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 6 seconds
[0m17:15:37.314411 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.sat_order_lineitem_details"
[0m17:15:37.314615 [debug] [Thread-2  ]: On model.ba_dbtvault.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_lineitem_details"} */
COMMIT
[0m17:15:37.364083 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m17:15:37.372257 [debug] [Thread-3  ]: Writing runtime sql for node "model.ba_dbtvault.hub_part"
[0m17:15:37.374515 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.hub_part"
[0m17:15:37.374890 [debug] [Thread-3  ]: On model.ba_dbtvault.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_part"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:37.485937 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:37.487446 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.hub_part"
[0m17:15:37.487990 [debug] [Thread-3  ]: On model.ba_dbtvault.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_part"} */
insert into TEST.DATA_VAULT.hub_part ("PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.hub_part__dbt_tmp
        );
[0m17:15:37.549012 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:37.559378 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.sat_order_lineitem_details"
[0m17:15:37.559662 [debug] [Thread-2  ]: On model.ba_dbtvault.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_lineitem_details"} */
drop view if exists TEST.DATA_VAULT.sat_order_lineitem_details__dbt_tmp cascade
[0m17:15:37.566086 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 4 seconds
[0m17:15:37.566375 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_order_order_details"
[0m17:15:37.566550 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_order_details"} */
COMMIT
[0m17:15:37.716590 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:37.723477 [debug] [Thread-2  ]: Timing info for model.ba_dbtvault.sat_order_lineitem_details (execute): 2023-02-27 17:15:29.090741 => 2023-02-27 17:15:37.723393
[0m17:15:37.723777 [debug] [Thread-2  ]: On model.ba_dbtvault.sat_order_lineitem_details: Close
[0m17:15:37.826938 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:37.837103 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_order_order_details"
[0m17:15:37.837393 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_order_order_details"} */
drop view if exists TEST.DATA_VAULT.sat_order_order_details__dbt_tmp cascade
[0m17:15:37.908356 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f36e340>]}
[0m17:15:37.909211 [info ] [Thread-2  ]: 18 of 31 OK created sql incremental model DATA_VAULT.sat_order_lineitem_details  [[32mSUCCESS 0[0m in 8.85s]
[0m17:15:37.909758 [debug] [Thread-2  ]: Finished running node model.ba_dbtvault.sat_order_lineitem_details
[0m17:15:37.910242 [debug] [Thread-2  ]: Began running node model.ba_dbtvault.hub_region
[0m17:15:37.910666 [info ] [Thread-2  ]: 22 of 31 START sql incremental model DATA_VAULT.hub_region ..................... [RUN]
[0m17:15:37.911763 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.ba_dbtvault.hub_region'
[0m17:15:37.912162 [debug] [Thread-2  ]: Began compiling node model.ba_dbtvault.hub_region
[0m17:15:37.920063 [info ] [Thread-2  ]: 17:15:37 + Loading TEST.DATA_VAULT.hub_region from 2 source(s)
[0m17:15:37.930661 [debug] [Thread-2  ]: Writing injected SQL for node "model.ba_dbtvault.hub_region"
[0m17:15:37.931355 [debug] [Thread-2  ]: Timing info for model.ba_dbtvault.hub_region (compile): 2023-02-27 17:15:37.912407 => 2023-02-27 17:15:37.931299
[0m17:15:37.931572 [debug] [Thread-2  ]: Began executing node model.ba_dbtvault.hub_region
[0m17:15:37.936749 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.hub_region"
[0m17:15:37.936957 [debug] [Thread-2  ]: On model.ba_dbtvault.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_region"} */
create or replace  temporary view TEST.DATA_VAULT.hub_region__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN TEST.DATA_VAULT.hub_region AS d
    ON a.REGION_PK = d.REGION_PK
    WHERE d.REGION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:37.937099 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:15:37.954869 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:37.956666 [debug] [Thread-1  ]: Timing info for model.ba_dbtvault.sat_order_order_details (execute): 2023-02-27 17:15:32.613534 => 2023-02-27 17:15:37.956627
[0m17:15:37.956842 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_order_order_details: Close
[0m17:15:38.077519 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f381340>]}
[0m17:15:38.077809 [info ] [Thread-1  ]: 19 of 31 OK created sql incremental model DATA_VAULT.sat_order_order_details ... [[32mSUCCESS 0[0m in 5.49s]
[0m17:15:38.078007 [debug] [Thread-1  ]: Finished running node model.ba_dbtvault.sat_order_order_details
[0m17:15:38.078169 [debug] [Thread-1  ]: Began running node model.ba_dbtvault.hub_supplier
[0m17:15:38.078428 [info ] [Thread-1  ]: 23 of 31 START sql incremental model DATA_VAULT.hub_supplier ................... [RUN]
[0m17:15:38.078753 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.ba_dbtvault.hub_supplier'
[0m17:15:38.078870 [debug] [Thread-1  ]: Began compiling node model.ba_dbtvault.hub_supplier
[0m17:15:38.081964 [info ] [Thread-1  ]: 17:15:38 + Loading TEST.DATA_VAULT.hub_supplier from 2 source(s)
[0m17:15:38.086504 [debug] [Thread-1  ]: Writing injected SQL for node "model.ba_dbtvault.hub_supplier"
[0m17:15:38.089560 [debug] [Thread-1  ]: Timing info for model.ba_dbtvault.hub_supplier (compile): 2023-02-27 17:15:38.078947 => 2023-02-27 17:15:38.089514
[0m17:15:38.089747 [debug] [Thread-1  ]: Began executing node model.ba_dbtvault.hub_supplier
[0m17:15:38.093115 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.hub_supplier"
[0m17:15:38.093290 [debug] [Thread-1  ]: On model.ba_dbtvault.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_supplier"} */
create or replace  temporary view TEST.DATA_VAULT.hub_supplier__dbt_tmp
  
   as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN TEST.DATA_VAULT.hub_supplier AS d
    ON a.SUPPLIER_PK = d.SUPPLIER_PK
    WHERE d.SUPPLIER_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:38.093388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:15:39.077988 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:39.087035 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.hub_region"
[0m17:15:39.087358 [debug] [Thread-2  ]: On model.ba_dbtvault.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_region"} */
describe table TEST.DATA_VAULT.hub_region__dbt_tmp
[0m17:15:39.167420 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0 seconds
[0m17:15:39.171713 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.hub_region"
[0m17:15:39.171932 [debug] [Thread-2  ]: On model.ba_dbtvault.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_region"} */
describe table TEST.DATA_VAULT.hub_region
[0m17:15:39.262234 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0 seconds
[0m17:15:39.273437 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.hub_region"
[0m17:15:39.273792 [debug] [Thread-2  ]: On model.ba_dbtvault.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_region"} */
describe table "TEST"."DATA_VAULT"."HUB_REGION"
[0m17:15:39.382890 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0 seconds
[0m17:15:39.390802 [debug] [Thread-2  ]: Writing runtime sql for node "model.ba_dbtvault.hub_region"
[0m17:15:39.391969 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.hub_region"
[0m17:15:39.392114 [debug] [Thread-2  ]: On model.ba_dbtvault.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_region"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:39.404433 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:39.407115 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.hub_supplier"
[0m17:15:39.407262 [debug] [Thread-1  ]: On model.ba_dbtvault.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_supplier"} */
describe table TEST.DATA_VAULT.hub_supplier__dbt_tmp
[0m17:15:39.478163 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:39.478527 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.hub_region"
[0m17:15:39.478706 [debug] [Thread-2  ]: On model.ba_dbtvault.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_region"} */
insert into TEST.DATA_VAULT.hub_region ("REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.hub_region__dbt_tmp
        );
[0m17:15:39.496678 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m17:15:39.542099 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.hub_supplier"
[0m17:15:39.542295 [debug] [Thread-1  ]: On model.ba_dbtvault.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_supplier"} */
describe table TEST.DATA_VAULT.hub_supplier
[0m17:15:39.655695 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m17:15:39.659769 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.hub_supplier"
[0m17:15:39.659973 [debug] [Thread-1  ]: On model.ba_dbtvault.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_supplier"} */
describe table "TEST"."DATA_VAULT"."HUB_SUPPLIER"
[0m17:15:39.742479 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m17:15:39.750004 [debug] [Thread-1  ]: Writing runtime sql for node "model.ba_dbtvault.hub_supplier"
[0m17:15:39.751048 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.hub_supplier"
[0m17:15:39.751181 [debug] [Thread-1  ]: On model.ba_dbtvault.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_supplier"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:39.842826 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:39.843173 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.hub_supplier"
[0m17:15:39.843349 [debug] [Thread-1  ]: On model.ba_dbtvault.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_supplier"} */
insert into TEST.DATA_VAULT.hub_supplier ("SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.hub_supplier__dbt_tmp
        );
[0m17:15:40.273888 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 6 seconds
[0m17:15:40.275041 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.hub_nation"
[0m17:15:40.275382 [debug] [Thread-4  ]: On model.ba_dbtvault.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_nation"} */
COMMIT
[0m17:15:40.811485 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:40.820566 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.hub_nation"
[0m17:15:40.821033 [debug] [Thread-4  ]: On model.ba_dbtvault.hub_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_nation"} */
drop view if exists TEST.DATA_VAULT.hub_nation__dbt_tmp cascade
[0m17:15:40.918796 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:40.923883 [debug] [Thread-4  ]: Timing info for model.ba_dbtvault.hub_nation (execute): 2023-02-27 17:15:33.040871 => 2023-02-27 17:15:40.923782
[0m17:15:40.924281 [debug] [Thread-4  ]: On model.ba_dbtvault.hub_nation: Close
[0m17:15:41.031352 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f774220>]}
[0m17:15:41.032143 [info ] [Thread-4  ]: 20 of 31 OK created sql incremental model DATA_VAULT.hub_nation ................ [[32mSUCCESS 0[0m in 8.01s]
[0m17:15:41.032613 [debug] [Thread-4  ]: Finished running node model.ba_dbtvault.hub_nation
[0m17:15:41.033030 [debug] [Thread-4  ]: Began running node model.ba_dbtvault.link_inventory
[0m17:15:41.033387 [info ] [Thread-4  ]: 24 of 31 START sql incremental model DATA_VAULT.link_inventory ................. [RUN]
[0m17:15:41.034348 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.ba_dbtvault.link_inventory'
[0m17:15:41.034656 [debug] [Thread-4  ]: Began compiling node model.ba_dbtvault.link_inventory
[0m17:15:41.042415 [info ] [Thread-4  ]: 17:15:41 + Loading TEST.DATA_VAULT.link_inventory from 1 source(s)
[0m17:15:41.048784 [debug] [Thread-4  ]: Writing injected SQL for node "model.ba_dbtvault.link_inventory"
[0m17:15:41.049459 [debug] [Thread-4  ]: Timing info for model.ba_dbtvault.link_inventory (compile): 2023-02-27 17:15:41.034858 => 2023-02-27 17:15:41.049405
[0m17:15:41.049674 [debug] [Thread-4  ]: Began executing node model.ba_dbtvault.link_inventory
[0m17:15:41.054024 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.link_inventory"
[0m17:15:41.054289 [debug] [Thread-4  ]: On model.ba_dbtvault.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_inventory"} */
create or replace  temporary view TEST.DATA_VAULT.link_inventory__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DATA_VAULT.link_inventory AS d
    ON a.INVENTORY_PK = d.INVENTORY_PK
    WHERE d.INVENTORY_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:41.054453 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m17:15:42.865391 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m17:15:42.871708 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.link_inventory"
[0m17:15:42.872006 [debug] [Thread-4  ]: On model.ba_dbtvault.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_inventory"} */
describe table TEST.DATA_VAULT.link_inventory__dbt_tmp
[0m17:15:42.903579 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 5 seconds
[0m17:15:42.903988 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.hub_part"
[0m17:15:42.904243 [debug] [Thread-3  ]: On model.ba_dbtvault.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_part"} */
COMMIT
[0m17:15:42.949543 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:42.962037 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.link_inventory"
[0m17:15:42.962316 [debug] [Thread-4  ]: On model.ba_dbtvault.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_inventory"} */
describe table TEST.DATA_VAULT.link_inventory
[0m17:15:43.042545 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:43.048734 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.link_inventory"
[0m17:15:43.049008 [debug] [Thread-4  ]: On model.ba_dbtvault.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_inventory"} */
describe table "TEST"."DATA_VAULT"."LINK_INVENTORY"
[0m17:15:43.155828 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:43.163404 [debug] [Thread-4  ]: Writing runtime sql for node "model.ba_dbtvault.link_inventory"
[0m17:15:43.164769 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.link_inventory"
[0m17:15:43.164993 [debug] [Thread-4  ]: On model.ba_dbtvault.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_inventory"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:43.166829 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:43.170896 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.hub_part"
[0m17:15:43.171292 [debug] [Thread-3  ]: On model.ba_dbtvault.hub_part: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_part"} */
drop view if exists TEST.DATA_VAULT.hub_part__dbt_tmp cascade
[0m17:15:43.272243 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:43.273514 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.link_inventory"
[0m17:15:43.274050 [debug] [Thread-4  ]: On model.ba_dbtvault.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_inventory"} */
insert into TEST.DATA_VAULT.link_inventory ("INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.link_inventory__dbt_tmp
        );
[0m17:15:43.311469 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:43.319618 [debug] [Thread-3  ]: Timing info for model.ba_dbtvault.hub_part (execute): 2023-02-27 17:15:36.093897 => 2023-02-27 17:15:43.319359
[0m17:15:43.320100 [debug] [Thread-3  ]: On model.ba_dbtvault.hub_part: Close
[0m17:15:43.437146 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7297f0>]}
[0m17:15:43.437902 [info ] [Thread-3  ]: 21 of 31 OK created sql incremental model DATA_VAULT.hub_part .................. [[32mSUCCESS 0[0m in 7.36s]
[0m17:15:43.438455 [debug] [Thread-3  ]: Finished running node model.ba_dbtvault.hub_part
[0m17:15:43.438914 [debug] [Thread-3  ]: Began running node model.ba_dbtvault.link_nation_region
[0m17:15:43.439476 [info ] [Thread-3  ]: 25 of 31 START sql incremental model DATA_VAULT.link_nation_region ............. [RUN]
[0m17:15:43.440354 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.ba_dbtvault.link_nation_region'
[0m17:15:43.440640 [debug] [Thread-3  ]: Began compiling node model.ba_dbtvault.link_nation_region
[0m17:15:43.450325 [info ] [Thread-3  ]: 17:15:43 + Loading TEST.DATA_VAULT.link_nation_region from 2 source(s)
[0m17:15:43.459067 [debug] [Thread-3  ]: Writing injected SQL for node "model.ba_dbtvault.link_nation_region"
[0m17:15:43.459857 [debug] [Thread-3  ]: Timing info for model.ba_dbtvault.link_nation_region (compile): 2023-02-27 17:15:43.440829 => 2023-02-27 17:15:43.459793
[0m17:15:43.460096 [debug] [Thread-3  ]: Began executing node model.ba_dbtvault.link_nation_region
[0m17:15:43.465427 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.link_nation_region"
[0m17:15:43.465635 [debug] [Thread-3  ]: On model.ba_dbtvault.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_nation_region"} */
create or replace  temporary view TEST.DATA_VAULT.link_nation_region__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN TEST.DATA_VAULT.link_nation_region AS d
    ON a.NATION_REGION_PK = d.NATION_REGION_PK
    WHERE d.NATION_REGION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:43.465775 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:15:44.088451 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 5 seconds
[0m17:15:44.089253 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.hub_region"
[0m17:15:44.090379 [debug] [Thread-2  ]: On model.ba_dbtvault.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_region"} */
COMMIT
[0m17:15:44.806878 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:44.814247 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.hub_region"
[0m17:15:44.814892 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:44.815125 [debug] [Thread-2  ]: On model.ba_dbtvault.hub_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_region"} */
drop view if exists TEST.DATA_VAULT.hub_region__dbt_tmp cascade
[0m17:15:44.818923 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.link_nation_region"
[0m17:15:44.819519 [debug] [Thread-3  ]: On model.ba_dbtvault.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_nation_region"} */
describe table TEST.DATA_VAULT.link_nation_region__dbt_tmp
[0m17:15:44.926625 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:44.927750 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:44.930412 [debug] [Thread-2  ]: Timing info for model.ba_dbtvault.hub_region (execute): 2023-02-27 17:15:37.931712 => 2023-02-27 17:15:44.930313
[0m17:15:44.936060 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.link_nation_region"
[0m17:15:44.936322 [debug] [Thread-2  ]: On model.ba_dbtvault.hub_region: Close
[0m17:15:44.936495 [debug] [Thread-3  ]: On model.ba_dbtvault.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_nation_region"} */
describe table TEST.DATA_VAULT.link_nation_region
[0m17:15:45.053205 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:45.064752 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.link_nation_region"
[0m17:15:45.065626 [debug] [Thread-3  ]: On model.ba_dbtvault.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_nation_region"} */
describe table "TEST"."DATA_VAULT"."LINK_NATION_REGION"
[0m17:15:45.069763 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aeff10>]}
[0m17:15:45.070516 [info ] [Thread-2  ]: 22 of 31 OK created sql incremental model DATA_VAULT.hub_region ................ [[32mSUCCESS 0[0m in 7.16s]
[0m17:15:45.071507 [debug] [Thread-2  ]: Finished running node model.ba_dbtvault.hub_region
[0m17:15:45.072093 [debug] [Thread-2  ]: Began running node model.ba_dbtvault.link_supplier_nation
[0m17:15:45.072543 [info ] [Thread-2  ]: 26 of 31 START sql incremental model DATA_VAULT.link_supplier_nation ........... [RUN]
[0m17:15:45.073179 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.ba_dbtvault.link_supplier_nation'
[0m17:15:45.073430 [debug] [Thread-2  ]: Began compiling node model.ba_dbtvault.link_supplier_nation
[0m17:15:45.079946 [info ] [Thread-2  ]: 17:15:45 + Loading TEST.DATA_VAULT.link_supplier_nation from 1 source(s)
[0m17:15:45.086353 [debug] [Thread-2  ]: Writing injected SQL for node "model.ba_dbtvault.link_supplier_nation"
[0m17:15:45.087074 [debug] [Thread-2  ]: Timing info for model.ba_dbtvault.link_supplier_nation (compile): 2023-02-27 17:15:45.073593 => 2023-02-27 17:15:45.086992
[0m17:15:45.087287 [debug] [Thread-2  ]: Began executing node model.ba_dbtvault.link_supplier_nation
[0m17:15:45.091640 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.link_supplier_nation"
[0m17:15:45.091858 [debug] [Thread-2  ]: On model.ba_dbtvault.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_supplier_nation"} */
create or replace  temporary view TEST.DATA_VAULT.link_supplier_nation__dbt_tmp
  
   as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM TEST.DATA_VAULT.v_stg_inventory AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN TEST.DATA_VAULT.link_supplier_nation AS d
    ON a.LINK_SUPPLIER_NATION_PK = d.LINK_SUPPLIER_NATION_PK
    WHERE d.LINK_SUPPLIER_NATION_PK IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:45.092028 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:15:45.151065 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:45.153374 [debug] [Thread-3  ]: Writing runtime sql for node "model.ba_dbtvault.link_nation_region"
[0m17:15:45.154051 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.link_nation_region"
[0m17:15:45.154189 [debug] [Thread-3  ]: On model.ba_dbtvault.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_nation_region"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:45.211143 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 5 seconds
[0m17:15:45.217587 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.hub_supplier"
[0m17:15:45.217682 [debug] [Thread-1  ]: On model.ba_dbtvault.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_supplier"} */
COMMIT
[0m17:15:45.233056 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:45.233277 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.link_nation_region"
[0m17:15:45.233368 [debug] [Thread-3  ]: On model.ba_dbtvault.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_nation_region"} */
insert into TEST.DATA_VAULT.link_nation_region ("NATION_REGION_PK", "NATION_PK", "REGION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_REGION_PK", "NATION_PK", "REGION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.link_nation_region__dbt_tmp
        );
[0m17:15:45.739723 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:45.746351 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.hub_supplier"
[0m17:15:45.746693 [debug] [Thread-1  ]: On model.ba_dbtvault.hub_supplier: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.hub_supplier"} */
drop view if exists TEST.DATA_VAULT.hub_supplier__dbt_tmp cascade
[0m17:15:45.855918 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:45.858600 [debug] [Thread-1  ]: Timing info for model.ba_dbtvault.hub_supplier (execute): 2023-02-27 17:15:38.089832 => 2023-02-27 17:15:45.858509
[0m17:15:45.858879 [debug] [Thread-1  ]: On model.ba_dbtvault.hub_supplier: Close
[0m17:15:45.990030 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f35a430>]}
[0m17:15:45.991245 [info ] [Thread-1  ]: 23 of 31 OK created sql incremental model DATA_VAULT.hub_supplier .............. [[32mSUCCESS 0[0m in 7.91s]
[0m17:15:45.991773 [debug] [Thread-1  ]: Finished running node model.ba_dbtvault.hub_supplier
[0m17:15:45.992134 [debug] [Thread-1  ]: Began running node model.ba_dbtvault.sat_inv_inventory_details
[0m17:15:45.992546 [info ] [Thread-1  ]: 27 of 31 START sql incremental model DATA_VAULT.sat_inv_inventory_details ...... [RUN]
[0m17:15:45.993216 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.ba_dbtvault.sat_inv_inventory_details'
[0m17:15:45.993468 [debug] [Thread-1  ]: Began compiling node model.ba_dbtvault.sat_inv_inventory_details
[0m17:15:46.011020 [debug] [Thread-1  ]: Writing injected SQL for node "model.ba_dbtvault.sat_inv_inventory_details"
[0m17:15:46.011647 [debug] [Thread-1  ]: Timing info for model.ba_dbtvault.sat_inv_inventory_details (compile): 2023-02-27 17:15:45.993618 => 2023-02-27 17:15:46.011601
[0m17:15:46.011832 [debug] [Thread-1  ]: Began executing node model.ba_dbtvault.sat_inv_inventory_details
[0m17:15:46.016687 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_inventory_details"
[0m17:15:46.016882 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_inventory_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_inv_inventory_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_inventory AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

latest_records AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.INVENTORY_PK, current_records.INVENTORY_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.INVENTORY_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_inv_inventory_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.INVENTORY_PK
                FROM source_data
            ) AS source_records
                ON current_records.INVENTORY_PK = source_records.INVENTORY_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.INVENTORY_PK = stage.INVENTORY_PK
        AND latest_records.INVENTORY_HASHDIFF = stage.INVENTORY_HASHDIFF
    WHERE latest_records.INVENTORY_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:46.017017 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:15:46.230111 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:46.233711 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.link_supplier_nation"
[0m17:15:46.233868 [debug] [Thread-2  ]: On model.ba_dbtvault.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_supplier_nation"} */
describe table TEST.DATA_VAULT.link_supplier_nation__dbt_tmp
[0m17:15:46.326423 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:46.331076 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.link_supplier_nation"
[0m17:15:46.331359 [debug] [Thread-2  ]: On model.ba_dbtvault.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_supplier_nation"} */
describe table TEST.DATA_VAULT.link_supplier_nation
[0m17:15:46.427247 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:46.440252 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.link_supplier_nation"
[0m17:15:46.440636 [debug] [Thread-2  ]: On model.ba_dbtvault.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_supplier_nation"} */
describe table "TEST"."DATA_VAULT"."LINK_SUPPLIER_NATION"
[0m17:15:46.506361 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m17:15:46.510708 [debug] [Thread-2  ]: Writing runtime sql for node "model.ba_dbtvault.link_supplier_nation"
[0m17:15:46.512275 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.link_supplier_nation"
[0m17:15:46.512518 [debug] [Thread-2  ]: On model.ba_dbtvault.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_supplier_nation"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:46.568547 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 3 seconds
[0m17:15:46.570234 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.link_inventory"
[0m17:15:46.570823 [debug] [Thread-4  ]: On model.ba_dbtvault.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_inventory"} */
COMMIT
[0m17:15:46.604454 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:46.604934 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.link_supplier_nation"
[0m17:15:46.605192 [debug] [Thread-2  ]: On model.ba_dbtvault.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_supplier_nation"} */
insert into TEST.DATA_VAULT.link_supplier_nation ("LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.link_supplier_nation__dbt_tmp
        );
[0m17:15:46.695460 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:46.704933 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_inventory_details"
[0m17:15:46.705237 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_inventory_details"} */
describe table TEST.DATA_VAULT.sat_inv_inventory_details__dbt_tmp
[0m17:15:47.271802 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 1 seconds
[0m17:15:47.273197 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:47.278596 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_inventory_details"
[0m17:15:47.283828 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.link_inventory"
[0m17:15:47.284043 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_inventory_details"} */
describe table TEST.DATA_VAULT.sat_inv_inventory_details
[0m17:15:47.284199 [debug] [Thread-4  ]: On model.ba_dbtvault.link_inventory: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_inventory"} */
drop view if exists TEST.DATA_VAULT.link_inventory__dbt_tmp cascade
[0m17:15:47.362805 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0 seconds
[0m17:15:47.369658 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_inventory_details"
[0m17:15:47.369969 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_inventory_details"} */
describe table "TEST"."DATA_VAULT"."SAT_INV_INVENTORY_DETAILS"
[0m17:15:47.377383 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:47.380135 [debug] [Thread-4  ]: Timing info for model.ba_dbtvault.link_inventory (execute): 2023-02-27 17:15:41.049810 => 2023-02-27 17:15:47.380039
[0m17:15:47.380446 [debug] [Thread-4  ]: On model.ba_dbtvault.link_inventory: Close
[0m17:15:47.481731 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f566370>]}
[0m17:15:47.484963 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0 seconds
[0m17:15:47.488407 [debug] [Thread-1  ]: Writing runtime sql for node "model.ba_dbtvault.sat_inv_inventory_details"
[0m17:15:47.489760 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_inventory_details"
[0m17:15:47.489921 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_inventory_details"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:47.684887 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:47.686127 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_inventory_details"
[0m17:15:47.686674 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_inventory_details"} */
insert into TEST.DATA_VAULT.sat_inv_inventory_details ("INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_inv_inventory_details__dbt_tmp
        );
[0m17:15:48.092199 [info ] [Thread-4  ]: 24 of 31 OK created sql incremental model DATA_VAULT.link_inventory ............ [[32mSUCCESS 0[0m in 6.45s]
[0m17:15:48.093334 [debug] [Thread-4  ]: Finished running node model.ba_dbtvault.link_inventory
[0m17:15:48.093762 [debug] [Thread-4  ]: Began running node model.ba_dbtvault.sat_inv_part_details
[0m17:15:48.094262 [info ] [Thread-4  ]: 28 of 31 START sql incremental model DATA_VAULT.sat_inv_part_details ........... [RUN]
[0m17:15:48.095065 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.ba_dbtvault.sat_inv_part_details'
[0m17:15:48.095342 [debug] [Thread-4  ]: Began compiling node model.ba_dbtvault.sat_inv_part_details
[0m17:15:48.116635 [debug] [Thread-4  ]: Writing injected SQL for node "model.ba_dbtvault.sat_inv_part_details"
[0m17:15:48.117253 [debug] [Thread-4  ]: Timing info for model.ba_dbtvault.sat_inv_part_details (compile): 2023-02-27 17:15:48.095513 => 2023-02-27 17:15:48.117207
[0m17:15:48.117429 [debug] [Thread-4  ]: Began executing node model.ba_dbtvault.sat_inv_part_details
[0m17:15:48.122095 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_part_details"
[0m17:15:48.122241 [debug] [Thread-4  ]: On model.ba_dbtvault.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_part_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_inv_part_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_inventory AS a
    WHERE a.PART_PK IS NOT NULL
),

latest_records AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.PART_PK, current_records.PART_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.PART_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_inv_part_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.PART_PK
                FROM source_data
            ) AS source_records
                ON current_records.PART_PK = source_records.PART_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.PART_PK = stage.PART_PK
        AND latest_records.PART_HASHDIFF = stage.PART_HASHDIFF
    WHERE latest_records.PART_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:48.122498 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m17:15:49.313093 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:49.322314 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_part_details"
[0m17:15:49.322712 [debug] [Thread-4  ]: On model.ba_dbtvault.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_part_details"} */
describe table TEST.DATA_VAULT.sat_inv_part_details__dbt_tmp
[0m17:15:49.504640 [debug] [Thread-4  ]: SQL status: SUCCESS 13 in 0 seconds
[0m17:15:49.512532 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_part_details"
[0m17:15:49.512812 [debug] [Thread-4  ]: On model.ba_dbtvault.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_part_details"} */
describe table TEST.DATA_VAULT.sat_inv_part_details
[0m17:15:50.029413 [debug] [Thread-4  ]: SQL status: SUCCESS 13 in 1 seconds
[0m17:15:50.039092 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_part_details"
[0m17:15:50.039407 [debug] [Thread-4  ]: On model.ba_dbtvault.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_part_details"} */
describe table "TEST"."DATA_VAULT"."SAT_INV_PART_DETAILS"
[0m17:15:50.140601 [debug] [Thread-4  ]: SQL status: SUCCESS 13 in 0 seconds
[0m17:15:50.148518 [debug] [Thread-4  ]: Writing runtime sql for node "model.ba_dbtvault.sat_inv_part_details"
[0m17:15:50.150262 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_part_details"
[0m17:15:50.150514 [debug] [Thread-4  ]: On model.ba_dbtvault.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_part_details"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:50.275935 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:50.277229 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_part_details"
[0m17:15:50.277741 [debug] [Thread-4  ]: On model.ba_dbtvault.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_part_details"} */
insert into TEST.DATA_VAULT.sat_inv_part_details ("PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_inv_part_details__dbt_tmp
        );
[0m17:15:50.944067 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 6 seconds
[0m17:15:50.945288 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.link_nation_region"
[0m17:15:50.945700 [debug] [Thread-3  ]: On model.ba_dbtvault.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_nation_region"} */
COMMIT
[0m17:15:51.263456 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:51.270319 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.link_nation_region"
[0m17:15:51.270629 [debug] [Thread-3  ]: On model.ba_dbtvault.link_nation_region: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_nation_region"} */
drop view if exists TEST.DATA_VAULT.link_nation_region__dbt_tmp cascade
[0m17:15:51.369947 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:51.377542 [debug] [Thread-3  ]: Timing info for model.ba_dbtvault.link_nation_region (execute): 2023-02-27 17:15:43.460240 => 2023-02-27 17:15:51.377448
[0m17:15:51.377879 [debug] [Thread-3  ]: On model.ba_dbtvault.link_nation_region: Close
[0m17:15:51.499625 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f729d90>]}
[0m17:15:51.500454 [info ] [Thread-3  ]: 25 of 31 OK created sql incremental model DATA_VAULT.link_nation_region ........ [[32mSUCCESS 0[0m in 8.06s]
[0m17:15:51.500955 [debug] [Thread-3  ]: Finished running node model.ba_dbtvault.link_nation_region
[0m17:15:51.501343 [debug] [Thread-3  ]: Began running node model.ba_dbtvault.sat_inv_supp_nation_details
[0m17:15:51.501839 [info ] [Thread-3  ]: 29 of 31 START sql incremental model DATA_VAULT.sat_inv_supp_nation_details .... [RUN]
[0m17:15:51.502586 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.ba_dbtvault.sat_inv_supp_nation_details'
[0m17:15:51.502867 [debug] [Thread-3  ]: Began compiling node model.ba_dbtvault.sat_inv_supp_nation_details
[0m17:15:51.524650 [debug] [Thread-3  ]: Writing injected SQL for node "model.ba_dbtvault.sat_inv_supp_nation_details"
[0m17:15:51.525343 [debug] [Thread-3  ]: Timing info for model.ba_dbtvault.sat_inv_supp_nation_details (compile): 2023-02-27 17:15:51.503062 => 2023-02-27 17:15:51.525290
[0m17:15:51.525535 [debug] [Thread-3  ]: Began executing node model.ba_dbtvault.sat_inv_supp_nation_details
[0m17:15:51.530544 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supp_nation_details"
[0m17:15:51.530718 [debug] [Thread-3  ]: On model.ba_dbtvault.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supp_nation_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_inv_supp_nation_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.SUPPLIER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_inv_supp_nation_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
        AND latest_records.SUPPLIER_NATION_HASHDIFF = stage.SUPPLIER_NATION_HASHDIFF
    WHERE latest_records.SUPPLIER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:51.530974 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:15:52.801455 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 6 seconds
[0m17:15:52.802875 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.link_supplier_nation"
[0m17:15:52.803606 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:52.803891 [debug] [Thread-2  ]: On model.ba_dbtvault.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_supplier_nation"} */
COMMIT
[0m17:15:52.809438 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supp_nation_details"
[0m17:15:52.810178 [debug] [Thread-3  ]: On model.ba_dbtvault.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supp_nation_details"} */
describe table TEST.DATA_VAULT.sat_inv_supp_nation_details__dbt_tmp
[0m17:15:52.875929 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 5 seconds
[0m17:15:52.877208 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_inventory_details"
[0m17:15:52.877745 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_inventory_details"} */
COMMIT
[0m17:15:52.907892 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 0 seconds
[0m17:15:52.912433 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supp_nation_details"
[0m17:15:52.912647 [debug] [Thread-3  ]: On model.ba_dbtvault.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supp_nation_details"} */
describe table TEST.DATA_VAULT.sat_inv_supp_nation_details
[0m17:15:53.009430 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 0 seconds
[0m17:15:53.020632 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supp_nation_details"
[0m17:15:53.020934 [debug] [Thread-3  ]: On model.ba_dbtvault.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supp_nation_details"} */
describe table "TEST"."DATA_VAULT"."SAT_INV_SUPP_NATION_DETAILS"
[0m17:15:53.026257 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:53.029883 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_inventory_details"
[0m17:15:53.030072 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_inventory_details"} */
drop view if exists TEST.DATA_VAULT.sat_inv_inventory_details__dbt_tmp cascade
[0m17:15:53.075967 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:53.080255 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.link_supplier_nation"
[0m17:15:53.080491 [debug] [Thread-2  ]: On model.ba_dbtvault.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.link_supplier_nation"} */
drop view if exists TEST.DATA_VAULT.link_supplier_nation__dbt_tmp cascade
[0m17:15:53.103573 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 0 seconds
[0m17:15:53.107213 [debug] [Thread-3  ]: Writing runtime sql for node "model.ba_dbtvault.sat_inv_supp_nation_details"
[0m17:15:53.108693 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supp_nation_details"
[0m17:15:53.108927 [debug] [Thread-3  ]: On model.ba_dbtvault.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supp_nation_details"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:53.132896 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:53.135609 [debug] [Thread-1  ]: Timing info for model.ba_dbtvault.sat_inv_inventory_details (execute): 2023-02-27 17:15:46.011941 => 2023-02-27 17:15:53.135512
[0m17:15:53.135914 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_inv_inventory_details: Close
[0m17:15:53.189418 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:53.190338 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supp_nation_details"
[0m17:15:53.190876 [debug] [Thread-3  ]: On model.ba_dbtvault.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supp_nation_details"} */
insert into TEST.DATA_VAULT.sat_inv_supp_nation_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_inv_supp_nation_details__dbt_tmp
        );
[0m17:15:53.235240 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:53.242740 [debug] [Thread-2  ]: Timing info for model.ba_dbtvault.link_supplier_nation (execute): 2023-02-27 17:15:45.087408 => 2023-02-27 17:15:53.242636
[0m17:15:53.243274 [debug] [Thread-2  ]: On model.ba_dbtvault.link_supplier_nation: Close
[0m17:15:53.245799 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f35ae80>]}
[0m17:15:53.246496 [info ] [Thread-1  ]: 27 of 31 OK created sql incremental model DATA_VAULT.sat_inv_inventory_details . [[32mSUCCESS 0[0m in 7.25s]
[0m17:15:53.247111 [debug] [Thread-1  ]: Finished running node model.ba_dbtvault.sat_inv_inventory_details
[0m17:15:53.247463 [debug] [Thread-1  ]: Began running node model.ba_dbtvault.sat_inv_supp_region_details
[0m17:15:53.247944 [info ] [Thread-1  ]: 30 of 31 START sql incremental model DATA_VAULT.sat_inv_supp_region_details .... [RUN]
[0m17:15:53.248774 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.ba_dbtvault.sat_inv_supp_region_details'
[0m17:15:53.249071 [debug] [Thread-1  ]: Began compiling node model.ba_dbtvault.sat_inv_supp_region_details
[0m17:15:53.266706 [debug] [Thread-1  ]: Writing injected SQL for node "model.ba_dbtvault.sat_inv_supp_region_details"
[0m17:15:53.267594 [debug] [Thread-1  ]: Timing info for model.ba_dbtvault.sat_inv_supp_region_details (compile): 2023-02-27 17:15:53.249214 => 2023-02-27 17:15:53.267536
[0m17:15:53.267802 [debug] [Thread-1  ]: Began executing node model.ba_dbtvault.sat_inv_supp_region_details
[0m17:15:53.273485 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supp_region_details"
[0m17:15:53.273635 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supp_region_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_inv_supp_region_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.SUPPLIER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_inv_supp_region_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
        AND latest_records.SUPPLIER_NATION_HASHDIFF = stage.SUPPLIER_NATION_HASHDIFF
    WHERE latest_records.SUPPLIER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:53.273750 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:15:53.552596 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d4cdf0>]}
[0m17:15:53.553287 [info ] [Thread-2  ]: 26 of 31 OK created sql incremental model DATA_VAULT.link_supplier_nation ...... [[32mSUCCESS 0[0m in 8.48s]
[0m17:15:53.553693 [debug] [Thread-2  ]: Finished running node model.ba_dbtvault.link_supplier_nation
[0m17:15:53.554026 [debug] [Thread-2  ]: Began running node model.ba_dbtvault.sat_inv_supplier_details
[0m17:15:53.554327 [info ] [Thread-2  ]: 31 of 31 START sql incremental model DATA_VAULT.sat_inv_supplier_details ....... [RUN]
[0m17:15:53.554898 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.ba_dbtvault.sat_inv_supplier_details'
[0m17:15:53.555227 [debug] [Thread-2  ]: Began compiling node model.ba_dbtvault.sat_inv_supplier_details
[0m17:15:53.573391 [debug] [Thread-2  ]: Writing injected SQL for node "model.ba_dbtvault.sat_inv_supplier_details"
[0m17:15:53.574005 [debug] [Thread-2  ]: Timing info for model.ba_dbtvault.sat_inv_supplier_details (compile): 2023-02-27 17:15:53.555427 => 2023-02-27 17:15:53.573958
[0m17:15:53.574175 [debug] [Thread-2  ]: Began executing node model.ba_dbtvault.sat_inv_supplier_details
[0m17:15:53.578744 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supplier_details"
[0m17:15:53.578910 [debug] [Thread-2  ]: On model.ba_dbtvault.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supplier_details"} */
create or replace  temporary view TEST.DATA_VAULT.sat_inv_supplier_details__dbt_tmp
  
   as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM TEST.DATA_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
               PARTITION BY current_records.SUPPLIER_PK
               ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM TEST.DATA_VAULT.sat_inv_supplier_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
        AND latest_records.SUPPLIER_HASHDIFF = stage.SUPPLIER_HASHDIFF
    WHERE latest_records.SUPPLIER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
  );
[0m17:15:53.579034 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:15:54.449101 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 4 seconds
[0m17:15:54.450957 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:54.451457 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_part_details"
[0m17:15:54.456556 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supp_region_details"
[0m17:15:54.457053 [debug] [Thread-4  ]: On model.ba_dbtvault.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_part_details"} */
COMMIT
[0m17:15:54.457530 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supp_region_details"} */
describe table TEST.DATA_VAULT.sat_inv_supp_region_details__dbt_tmp
[0m17:15:54.563585 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m17:15:54.573850 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supp_region_details"
[0m17:15:54.574166 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supp_region_details"} */
describe table TEST.DATA_VAULT.sat_inv_supp_region_details
[0m17:15:54.652149 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m17:15:54.660103 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supp_region_details"
[0m17:15:54.660423 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supp_region_details"} */
describe table "TEST"."DATA_VAULT"."SAT_INV_SUPP_REGION_DETAILS"
[0m17:15:54.726748 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:54.736105 [debug] [Thread-4  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_part_details"
[0m17:15:54.736456 [debug] [Thread-4  ]: On model.ba_dbtvault.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_part_details"} */
drop view if exists TEST.DATA_VAULT.sat_inv_part_details__dbt_tmp cascade
[0m17:15:54.738204 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m17:15:54.742648 [debug] [Thread-1  ]: Writing runtime sql for node "model.ba_dbtvault.sat_inv_supp_region_details"
[0m17:15:54.744136 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supp_region_details"
[0m17:15:54.744510 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supp_region_details"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:54.831466 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:54.831969 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supp_region_details"
[0m17:15:54.832245 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supp_region_details"} */
insert into TEST.DATA_VAULT.sat_inv_supp_region_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_inv_supp_region_details__dbt_tmp
        );
[0m17:15:54.838232 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:54.841726 [debug] [Thread-4  ]: Timing info for model.ba_dbtvault.sat_inv_part_details (execute): 2023-02-27 17:15:48.117538 => 2023-02-27 17:15:54.841631
[0m17:15:54.842197 [debug] [Thread-4  ]: On model.ba_dbtvault.sat_inv_part_details: Close
[0m17:15:54.845215 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:54.849642 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supplier_details"
[0m17:15:54.850071 [debug] [Thread-2  ]: On model.ba_dbtvault.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supplier_details"} */
describe table TEST.DATA_VAULT.sat_inv_supplier_details__dbt_tmp
[0m17:15:54.942784 [debug] [Thread-2  ]: SQL status: SUCCESS 10 in 0 seconds
[0m17:15:54.952634 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f774bb0>]}
[0m17:15:54.951771 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supplier_details"
[0m17:15:54.953260 [info ] [Thread-4  ]: 28 of 31 OK created sql incremental model DATA_VAULT.sat_inv_part_details ...... [[32mSUCCESS 0[0m in 6.86s]
[0m17:15:54.953633 [debug] [Thread-2  ]: On model.ba_dbtvault.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supplier_details"} */
describe table TEST.DATA_VAULT.sat_inv_supplier_details
[0m17:15:54.953968 [debug] [Thread-4  ]: Finished running node model.ba_dbtvault.sat_inv_part_details
[0m17:15:55.031726 [debug] [Thread-2  ]: SQL status: SUCCESS 10 in 0 seconds
[0m17:15:55.037774 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supplier_details"
[0m17:15:55.038017 [debug] [Thread-2  ]: On model.ba_dbtvault.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supplier_details"} */
describe table "TEST"."DATA_VAULT"."SAT_INV_SUPPLIER_DETAILS"
[0m17:15:55.368141 [debug] [Thread-2  ]: SQL status: SUCCESS 10 in 0 seconds
[0m17:15:55.374797 [debug] [Thread-2  ]: Writing runtime sql for node "model.ba_dbtvault.sat_inv_supplier_details"
[0m17:15:55.376551 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supplier_details"
[0m17:15:55.376815 [debug] [Thread-2  ]: On model.ba_dbtvault.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supplier_details"} */
-- back compat for old kwarg name
  
  begin;
[0m17:15:55.510843 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:55.511490 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supplier_details"
[0m17:15:55.511764 [debug] [Thread-2  ]: On model.ba_dbtvault.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supplier_details"} */
insert into TEST.DATA_VAULT.sat_inv_supplier_details ("SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from TEST.DATA_VAULT.sat_inv_supplier_details__dbt_tmp
        );
[0m17:15:58.627891 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 4 seconds
[0m17:15:58.629404 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supp_region_details"
[0m17:15:58.630099 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 5 seconds
[0m17:15:58.630357 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supp_region_details"} */
COMMIT
[0m17:15:58.630671 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supp_nation_details"
[0m17:15:58.631411 [debug] [Thread-3  ]: On model.ba_dbtvault.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supp_nation_details"} */
COMMIT
[0m17:15:59.141500 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:59.148127 [debug] [Thread-3  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supp_nation_details"
[0m17:15:59.149390 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m17:15:59.149622 [debug] [Thread-3  ]: On model.ba_dbtvault.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supp_nation_details"} */
drop view if exists TEST.DATA_VAULT.sat_inv_supp_nation_details__dbt_tmp cascade
[0m17:15:59.153661 [debug] [Thread-1  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supp_region_details"
[0m17:15:59.154326 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supp_region_details"} */
drop view if exists TEST.DATA_VAULT.sat_inv_supp_region_details__dbt_tmp cascade
[0m17:15:59.263176 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:59.270408 [debug] [Thread-1  ]: Timing info for model.ba_dbtvault.sat_inv_supp_region_details (execute): 2023-02-27 17:15:53.267921 => 2023-02-27 17:15:59.270307
[0m17:15:59.270763 [debug] [Thread-1  ]: On model.ba_dbtvault.sat_inv_supp_region_details: Close
[0m17:15:59.280680 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:15:59.283375 [debug] [Thread-3  ]: Timing info for model.ba_dbtvault.sat_inv_supp_nation_details (execute): 2023-02-27 17:15:51.525660 => 2023-02-27 17:15:59.283327
[0m17:15:59.283599 [debug] [Thread-3  ]: On model.ba_dbtvault.sat_inv_supp_nation_details: Close
[0m17:15:59.409725 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f381340>]}
[0m17:15:59.411153 [info ] [Thread-1  ]: 30 of 31 OK created sql incremental model DATA_VAULT.sat_inv_supp_region_details  [[32mSUCCESS 0[0m in 6.16s]
[0m17:15:59.411730 [debug] [Thread-1  ]: Finished running node model.ba_dbtvault.sat_inv_supp_region_details
[0m17:15:59.414183 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7292e0>]}
[0m17:15:59.414630 [info ] [Thread-3  ]: 29 of 31 OK created sql incremental model DATA_VAULT.sat_inv_supp_nation_details  [[32mSUCCESS 0[0m in 7.91s]
[0m17:15:59.414986 [debug] [Thread-3  ]: Finished running node model.ba_dbtvault.sat_inv_supp_nation_details
[0m17:16:00.217188 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 5 seconds
[0m17:16:00.218811 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supplier_details"
[0m17:16:00.219370 [debug] [Thread-2  ]: On model.ba_dbtvault.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supplier_details"} */
COMMIT
[0m17:16:00.516629 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:16:00.525856 [debug] [Thread-2  ]: Using snowflake connection "model.ba_dbtvault.sat_inv_supplier_details"
[0m17:16:00.526231 [debug] [Thread-2  ]: On model.ba_dbtvault.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "ba_dbtvault", "target_name": "dev", "node_id": "model.ba_dbtvault.sat_inv_supplier_details"} */
drop view if exists TEST.DATA_VAULT.sat_inv_supplier_details__dbt_tmp cascade
[0m17:16:00.655699 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m17:16:00.657730 [debug] [Thread-2  ]: Timing info for model.ba_dbtvault.sat_inv_supplier_details (execute): 2023-02-27 17:15:53.574280 => 2023-02-27 17:16:00.657685
[0m17:16:00.657939 [debug] [Thread-2  ]: On model.ba_dbtvault.sat_inv_supplier_details: Close
[0m17:16:00.759958 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25ae3ac-ce24-45e7-88e9-9058a91b77db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a36070>]}
[0m17:16:00.760743 [info ] [Thread-2  ]: 31 of 31 OK created sql incremental model DATA_VAULT.sat_inv_supplier_details .. [[32mSUCCESS 0[0m in 7.21s]
[0m17:16:00.761225 [debug] [Thread-2  ]: Finished running node model.ba_dbtvault.sat_inv_supplier_details
[0m17:16:00.763199 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:16:00.763846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:00.764075 [debug] [MainThread]: Connection 'model.ba_dbtvault.sat_inv_supp_region_details' was properly closed.
[0m17:16:00.764261 [debug] [MainThread]: Connection 'model.ba_dbtvault.sat_inv_supplier_details' was properly closed.
[0m17:16:00.764438 [debug] [MainThread]: Connection 'model.ba_dbtvault.sat_inv_part_details' was properly closed.
[0m17:16:00.764608 [debug] [MainThread]: Connection 'model.ba_dbtvault.sat_inv_supp_nation_details' was properly closed.
[0m17:16:00.764976 [info ] [MainThread]: 
[0m17:16:00.765300 [info ] [MainThread]: Finished running 6 view models, 25 incremental models in 0 hours 0 minutes and 49.94 seconds (49.94s).
[0m17:16:00.767083 [debug] [MainThread]: Command end result
[0m17:16:00.783855 [info ] [MainThread]: 
[0m17:16:00.784238 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:00.784478 [info ] [MainThread]: 
[0m17:16:00.784673 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=0 SKIP=0 TOTAL=31
[0m17:16:00.784991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109610160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d156a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d15400>]}
[0m17:16:00.785227 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 17:16:37.864085 | 9a28451d-ec92-41f7-9dd8-b1349d1b3060 ==============================
[0m17:16:37.864085 [info ] [MainThread]: Running with dbt=1.4.0
[0m17:16:37.865422 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/shrut.patel/Source/dbtvault/dbtvault', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:16:37.865585 [debug] [MainThread]: Tracking: tracking
[0m17:16:37.865845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f2d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f67370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f67250>]}
[0m17:16:37.934676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:16:37.934895 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:16:37.939653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a28451d-ec92-41f7-9dd8-b1349d1b3060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b19a90>]}
[0m17:16:37.948272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a28451d-ec92-41f7-9dd8-b1349d1b3060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110940070>]}
[0m17:16:37.948497 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 630 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m17:16:37.948647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a28451d-ec92-41f7-9dd8-b1349d1b3060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109403d0>]}
[0m17:16:37.949783 [info ] [MainThread]: 
[0m17:16:37.950130 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:16:37.950307 [debug] [MainThread]: Command end result
[0m17:16:37.956898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f3b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109402b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110940250>]}
[0m17:16:37.957059 [debug] [MainThread]: Flushing usage events
